OpenReceiptArchive is a BusinessTask
    owned by ma

    Patterns
        implements ManualTransaction
        implements StaticJava
            is report for InventoryManager, PurchasingManager, Buyer, SupplyManagementProcessor, ApplicationAdministrator, SupplyManagementViewer, Purchasing
                category is "Period_\Close"
                module is po
                report name is "OpenReceiptArchive"
				Description
                    Post written off and archived receipt transactions to Global Ledger.
                    Written off receipts are still available in the match process.
                    Archived receipts are no longer available in the match process.
            Reports
                OpenReceiptArchiveReport
                OpenReceiptArchiveErrorReport

    Parameters
        Company                 is a PayablesCompany
    		disable surrogates	
        CompanyGroup            is a GeneralLedgerCompanyGroup
        ProcessLevel            is a PayablesProcessLevel
        ReceiptDateFrom         is Date
        ReceiptDateTo           is Date
        CreateDateFrom          is Date
        CreateDateTo            is Date
        PostingOption           is AlphaUpper size 1
            States
                Archive            value is "A"
                WriteOffAndArchive value is "B"
                    default label is "Write-off and Archive"
                WriteOff           value is "W"
                    default label is "Write-off"
        SequenceOption          is AlphaUpper size 1
            States
                No  value is "N"
                Yes value is "Y"
        UpdateOption            is AlphaUpper size 1
            States
                No  value is "N"
                Yes value is "Y"
        VendorGroup        
        Vendor                   
        RecNumber               is a PurchaseOrderReceipt 
        RecNumberFrom           is a PurchaseOrderReceipt 
        RecNumberTo             is a PurchaseOrderReceipt 
        PoNumberSelect          is AlphaUpper size 1
            States
                IncludeAllPoNumbers      value is "A"
                    default label is "Include All PO Numbers"
                ExcludeSelectedPoNumbers value is "E"
                    default label is "Exclude Selected PO Numbers"
                IncludeSelectedPoNumbers value is "I"
                    default label is "Include Selected PO Numbers"
		PoNumber                is a MA180PoNumberArray
        PoCodeSelect            is AlphaUpper size 1
            States
                IncludeAllPoCodes      value is "A"
                    default label is "Include All PO Codes"
                ExcludeSelectedPoCodes value is "E"
                    default label is "Exclude Selected PO Codes"
                IncludeSelectedPoCodes value is "I"
                    default label is "Include Selected PO Codes"
        PoCodeGroup				is a MA180PoCodeGroup

    Parameter Rules
    	Company
    		if (PoNumber entered)
    			required
    	VendorGroup
    		if(Company entered)
    			default to Company.VendorGroup
			if (Vendor entered)
				required    				
        PostingOption
        	initial value is "B"
            default to "B"
        SequenceOption
        	initial value is "N"
            default to "N"
        UpdateOption
        	initial value is "N"
            default to "N"
        PoNumberSelect
        	initial value is "A"
            default to "A"
        PoCodeSelect
        	initial value is "A"
            default to "A"       		 	

    Actions
        OpenReceiptArchive is a Set Action
            allow unlimited concurrency
