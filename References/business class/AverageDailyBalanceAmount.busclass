AverageDailyBalanceAmount is a BusinessClass
    owned by ad
    prefix is ADBDB

    Ontology
    	symbolic key is AverageDailyBalanceAmount

    Patterns
 		implements DynamicCreation
		implements LightweightAuditing
		disable AuditIndex
 		disable EffectiveDated
		disable AsOfDateProcessing 		

    Persistent Fields
        ADBDimension1					is like AccountingUnit
        ADBDimension2					is like AccountingUnit
        ADBDimension3					is like AccountingUnit
		Amount							is an InternationalAmount		
			default label is "FunctionalAmount"
        	disable Auditing
 			precision is AccountingEntity.FunctionalCurrency.NumberOfDecimals
		AdjustmentAmount				is an InternationalAmount		
			default label is "FunctionalAdjustmentAmount"
        	disable Auditing
 			precision is AccountingEntity.FunctionalCurrency.NumberOfDecimals
		BalanceOnPostDate				is an InternationalAmount		
			default label is "FunctionalEndingBalanceOnPostDate"
        	disable Auditing
 			precision is AccountingEntity.FunctionalCurrency.NumberOfDecimals
		BalanceOnTransactionDate		is an InternationalAmount		
			default label is "FunctionalEndingBalanceOnTransactionDate"
        	disable Auditing
 			precision is AccountingEntity.FunctionalCurrency.NumberOfDecimals
        TransactionLedger						is like Ledger
	        default label is "Ledger"
	    TransactionCurrency						is like Currency
		TransactionAmount						is an InternationalAmount	
        	disable Auditing
			precision is TransactionCurrencyDecimals
        OnPostDateTransactionAmount				is a InternationalAmount	
			default label is "TransactionEndingBalanceOnPostDate"
        	disable Auditing
			precision is TransactionCurrencyDecimals
        OnPostDateAlternateAmount1				is a InternationalAmount	
			default label is "Alternate1EndingBalanceOnPostDate"
        	disable Auditing
			precision is AccountingEntity.AlternateCurrency.NumberOfDecimals
        OnPostDateAlternateAmount2				is a InternationalAmount
			default label is "Alternate2EndingBalanceOnPostDate"
        	disable Auditing
			precision is AccountingEntity.AlternateCurrency2.NumberOfDecimals
        OnPostDateAlternateAmount3				is a InternationalAmount
			default label is "Alternate3EndingBalanceOnPostDate"
        	disable Auditing
			precision is AccountingEntity.AlternateCurrency3.NumberOfDecimals
		OnPostDateReportAmount1					is a InternationalAmount	
			default label is "Reporting1EndingBalanceOnPostDate"
        	disable Auditing
 			precision is FinanceEnterpriseGroup.ReportCurrencyOne.NumberOfDecimals
		OnPostDateReportAmount2					is a InternationalAmount
			default label is "Reporting2EndingBalanceOnPostDate"
        	disable Auditing
			precision is FinanceEnterpriseGroup.ReportCurrencyTwo.NumberOfDecimals
		OnPostDateReportAmount3					is a InternationalAmount
			default label is "Reporting3EndingBalanceOnPostDate"
        	disable Auditing
			precision is FinanceEnterpriseGroup.ReportCurrencyThree.NumberOfDecimals
		OnPostDateReportAmount4					is a InternationalAmount
			default label is "Reporting4EndingBalanceOnPostDate"
        	disable Auditing
			precision is FinanceEnterpriseGroup.ReportCurrencyFour.NumberOfDecimals
		OnPostDateReportAmount5					is a InternationalAmount
			default label is "Reporting5EndingBalanceOnPostDate"
        	disable Auditing
			precision is FinanceEnterpriseGroup.ReportCurrencyFive.NumberOfDecimals

	Transient Fields
		PrmAmount						is an InternationalAmount
			default label is "FunctionalAmount"
		PrmAdjustmentAmount				is an InternationalAmount
			default label is "FunctionalAdjustmentAmount"
		PrmBalanceOnPostDate			is an InternationalAmount
			default label is "FunctionalEndingBalanceOnPostDate"
		PrmBalanceOnTransactionDate		is an InternationalAmount
			default label is "FunctionalEndingBalanceOnTransactionDate"
		PrmTransactionAmount			is a InternationalAmount
			default label is "TransactionAmount"
        PrmOnPostDateTransactionAmount	is a InternationalAmount
			default label is "TransactionEndingBalanceOnPostDate"
        PrmOnPostDateAlternateAmount1	is a InternationalAmount
			default label is "Alternate1EndingBalanceOnPostDate"
        PrmOnPostDateAlternateAmount2	is a InternationalAmount
			default label is "Alternate2EndingBalanceOnPostDate"
        PrmOnPostDateAlternateAmount3	is a InternationalAmount
			default label is "Alternate3EndingBalanceOnPostDate"
		PrmOnPostDateReportAmount1		is a InternationalAmount
			default label is "Reporting1EndingBalanceOnPostDate"
		PrmOnPostDateReportAmount2		is a InternationalAmount
			default label is "Reporting2EndingBalanceOnPostDate"
		PrmOnPostDateReportAmount3		is a InternationalAmount
			default label is "Reporting3EndingBalanceOnPostDate"
		PrmOnPostDateReportAmount4		is a InternationalAmount
			default label is "Reporting4EndingBalanceOnPostDate"
		PrmOnPostDateReportAmount5		is a InternationalAmount
			default label is "Reporting5EndingBalanceOnPostDate"

	Derived Fields
		LedgerDescription				is a DerivedField
			type is like Description
			if (FinanceEnterpriseGroup.IncludeLedgerInAverageDailyBalance)
				LocalLedger = TransactionLedger
				if (LocalLedger exists)
					return LocalLedger.Description
			else
				return ""
		TransactionCurrencyDecimals 	is a DerivedField
			type is Numeric 1
			restricted
			LocalCurrencyCode = TransactionCurrency
			return LocalCurrencyCode.NumberOfDecimals

	Local Fields
		LocalLedger						is a Ledger
		LocalCurrencyCode				is a Currency

	Relations

	Conditions

	Sets				
		ByEntityAccountRunDate
			duplicates
			Sort Order
				FinanceEnterpriseGroup
				ReportingBasis
				AccountingEntity
				AverageDailyBalanceAmount.GeneralLedgerChartAccount
				ADBDimension1
				ADBDimension2
				ADBDimension3
				AverageDailyBalanceAmount.RunDate
				AverageDailyBalanceAmount.DimensionCode

		ByBasisRunDate
			Sort Order
				FinanceEnterpriseGroup
				ReportingBasis
				AverageDailyBalanceAmount.RunDate
				AccountingEntity
				AverageDailyBalanceAmount.GeneralLedgerChartAccount
				ADBDimension1
				ADBDimension2
				ADBDimension3
				AverageDailyBalanceAmount.DimensionCode

	Field Rules

	Rule Blocks
		UpdateDailyAmount
			Amount							+= PrmAmount
			BalanceOnPostDate				+= PrmBalanceOnPostDate
			AdjustmentAmount				+= PrmAdjustmentAmount
			BalanceOnTransactionDate		+= PrmBalanceOnTransactionDate
			if (FinanceEnterpriseGroup.CalculateADBOption.AllCurrencyAmounts)
				TransactionAmount				+= PrmTransactionAmount
		        OnPostDateTransactionAmount		+= PrmOnPostDateTransactionAmount
		        OnPostDateAlternateAmount1		+= PrmOnPostDateAlternateAmount1
		        OnPostDateAlternateAmount2		+= PrmOnPostDateAlternateAmount2
		        OnPostDateAlternateAmount3		+= PrmOnPostDateAlternateAmount3
				OnPostDateReportAmount1			+= PrmOnPostDateReportAmount1
				OnPostDateReportAmount2			+= PrmOnPostDateReportAmount2
				OnPostDateReportAmount3			+= PrmOnPostDateReportAmount3
				OnPostDateReportAmount4			+= PrmOnPostDateReportAmount4
				OnPostDateReportAmount5			+= PrmOnPostDateReportAmount5

			initialize PrmAmount
			initialize PrmAdjustmentAmount
			initialize PrmBalanceOnPostDate
			initialize PrmBalanceOnTransactionDate
			initialize PrmTransactionAmount
			initialize PrmOnPostDateTransactionAmount
			initialize PrmOnPostDateAlternateAmount1
			initialize PrmOnPostDateAlternateAmount2
			initialize PrmOnPostDateAlternateAmount3
			initialize PrmOnPostDateReportAmount1
			initialize PrmOnPostDateReportAmount2
			initialize PrmOnPostDateReportAmount3
			initialize PrmOnPostDateReportAmount4
			initialize PrmOnPostDateReportAmount5

	Actions
		Create is a Create Action
			default label is untranslatable
			restricted
			bypass field rules
			Action Rules
				include UpdateDailyAmount

		Update is an Update Action
			default label is untranslatable
			restricted
			bypass field rules
			Action Rules
				include UpdateDailyAmount

		Delete is a Delete Action
			default label is untranslatable
			restricted
			Action Rules

		DeleteData is a Set Action
			default label is untranslatable
			restricted
			Parameters
				PrmFinanceEnterpriseGroup	is like FinanceEnterpriseGroup
					default label is "FinanceEnterpriseGroup"
				PrmReportingBasis			is like ReportingBasis
					default label is "ReportingBasis"
			Instance Selection
				where (FinanceEnterpriseGroup		= PrmFinanceEnterpriseGroup
				and	   ReportingBasis				= PrmReportingBasis)
			Set Is
				PrmFinanceEnterpriseGroup
				PrmReportingBasis
			Action Rules
				Empty Set Rules
				Instance Rules
					invoke Delete 

		Purge is a Purge Action
			default label is untranslatable
			restricted

		PurgeData is a Set Action
			default label is untranslatable
			restricted
			Parameters
				PrmFinanceEnterpriseGroup		is a FinanceEnterpriseGroup
				PrmReportingBasis				is a ReportingBasis
				PrmAccount						is like GeneralLedgerChartAccount
				PrmStartDate					is Date
				PrmEndDate						is Date
				PrmAccountingEntity				is like AccountingEntity
				PrmDimension1					is like AccountingUnit
				PrmDimension2					is like AccountingUnit
				PrmDimension3					is like AccountingUnit

			Instance Selection
				where (FinanceEnterpriseGroup = PrmFinanceEnterpriseGroup
				and    (PrmReportingBasis           not entered or PrmReportingBasis       = ReportingBasis)
				and    (PrmAccountingEntity         not entered or PrmAccountingEntity     = AccountingEntity)
				and    (PrmAccount                  not entered or PrmAccount              = AverageDailyBalanceAmount.GeneralLedgerChartAccount)
				and    (PrmDimension1               not entered or PrmDimension1           = ADBDimension1)
				and    (PrmDimension2               not entered or PrmDimension2           = ADBDimension2)
				and    (PrmDimension3               not entered or PrmDimension2           = ADBDimension3)
				and    (PrmStartDate                not entered or AverageDailyBalanceAmount.RunDate >= PrmStartDate)
				and    (PrmEndDate                  not entered or AverageDailyBalanceAmount.RunDate <= PrmEndDate))

			Action Rules
				Instance Rules
					invoke Purge
