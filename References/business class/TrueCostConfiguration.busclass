TrueCostConfiguration is a BusinessClass
	default label is "True\CostConfiguration"
	owned by truecost
	prefix is TCCFG
   
    Ontology
    	symbolic key is TrueCostConfiguration
    	
	Patterns
    	
    Persistent Fields
		CostObjectDimension					is a StructureRow
		DepartmentDimension					is a StructureRow
		LocationDimension					is a StructureRow
		Calendar							is a GeneralLedgerCalendar
		RebuildRequired						is Boolean
    	DefaultContraAccount				is a GeneralLedgerChartAccount
		HasAccount							is Boolean
			restricted
			default label is "<TrueCostConfiguration.AccountLabel>"
		HasProject							is Boolean
			default label is "<TrueCostConfiguration.ProjectLabel>"
		HasAccountingUnit					is Boolean
			default label is "<TrueCostConfiguration.AccountingUnitLabel>"
        HasDimension1        				is Boolean
        	default label is "<TrueCostConfiguration.FinanceDimension1Label>"
        HasDimension2        				is Boolean
        	default label is "<TrueCostConfiguration.FinanceDimension2Label>"
        HasDimension3        				is Boolean
        	default label is "<TrueCostConfiguration.FinanceDimension3Label>"
        HasDimension4        				is Boolean
        	default label is "<TrueCostConfiguration.FinanceDimension4Label>"
        HasDimension5        				is Boolean
        	default label is "<TrueCostConfiguration.FinanceDimension5Label>"
        HasDimension6        				is Boolean
        	default label is "<TrueCostConfiguration.FinanceDimension6Label>"
        HasDimension7        				is Boolean
        	default label is "<TrueCostConfiguration.FinanceDimension7Label>"
        HasDimension8        				is Boolean
        	default label is "<TrueCostConfiguration.FinanceDimension8Label>"
        HasDimension9        				is Boolean
        	default label is "<TrueCostConfiguration.FinanceDimension9Label>"
        HasDimension10        				is Boolean
        	default label is "<TrueCostConfiguration.FinanceDimension10Label>"	
    	
    Transient Fields
					
	Local Fields
		LocalStructureRow					is a StructureRow
		
		AddressCode
    	FinanceDimension1Structure
    	FinanceDimension2Structure
    	FinanceDimension3Structure
    	FinanceDimension4Structure
    	FinanceDimension5Structure
    	FinanceDimension6Structure
    	FinanceDimension7Structure
    	FinanceDimension8Structure
    	FinanceDimension9Structure
    	FinanceDimension10Structure
    	
	Derived Fields
		DepartmentLabel						is a DerivedField
			type is Alpha 50
			return DepartmentDimension.DisplayLabel	
		CostObjectLabel						is a DerivedField
			type is Alpha 50
			return CostObjectDimension.DisplayLabel	
		DerivedHasAccountingEntity			is a DerivedField
			type is Boolean
			default label is "<TrueCostConfiguration.AccountingEntityLabel>"
			return true
		DerivedMessageCannotBeChange		is a MessageField
			"FieldCannotBeChanged.DimensionIsUsedInDriver,DriverWeightOrAllocationLine."

	

		ConfigurationCodeAndDesciption is a MessageField
			"<TrueCostConfiguration>-<TrueCostConfiguration.Description>"		
	
	Conditions
		CanUpdate
			restricted
			when (TrueCostAllocationControl set not exists)
		HasLocationDimension
			when (LocationDimension entered)
		HasDepartmentDimension
			when (DepartmentDimension entered)
		HasCostObjectDimension
			when (CostObjectDimension entered)
		CostObjectIsDimension1
			restricted
			when (CostObjectDimension.Type = CodeBlockDimensionType.Dimension1)
		CostObjectIsDimension2
			restricted
			when (CostObjectDimension.Type = CodeBlockDimensionType.Dimension2)
		CostObjectIsDimension3
			restricted
			when (CostObjectDimension.Type = CodeBlockDimensionType.Dimension3)
		CostObjectIsDimension4
			restricted
			when (CostObjectDimension.Type = CodeBlockDimensionType.Dimension4)
		CostObjectIsDimension5
			restricted
			when (CostObjectDimension.Type = CodeBlockDimensionType.Dimension5)
		CostObjectIsDimension6
			restricted
			when (CostObjectDimension.Type = CodeBlockDimensionType.Dimension6)
		CostObjectIsDimension7
			restricted
			when (CostObjectDimension.Type = CodeBlockDimensionType.Dimension7)
		CostObjectIsDimension8
			restricted
			when (CostObjectDimension.Type = CodeBlockDimensionType.Dimension8)
		CostObjectIsDimension9
			restricted
			when (CostObjectDimension.Type = CodeBlockDimensionType.Dimension9)
		CostObjectIsDimension10
			restricted
			when (CostObjectDimension.Type = CodeBlockDimensionType.Dimension10)
		DepartmentIsAccountingUnit
			when (DepartmentDimension.Type = CodeBlockDimensionType.AccountingUnit)
		DepartmentIsDimension1
			restricted
			when (DepartmentDimension.Type = CodeBlockDimensionType.Dimension1)
		DepartmentIsDimension2
			restricted
			when (DepartmentDimension.Type = CodeBlockDimensionType.Dimension2)
		DepartmentIsDimension3
			restricted
			when (DepartmentDimension.Type = CodeBlockDimensionType.Dimension3)
		DepartmentIsDimension4
			restricted
			when (DepartmentDimension.Type = CodeBlockDimensionType.Dimension4)
		DepartmentIsDimension5
			restricted
			when (DepartmentDimension.Type = CodeBlockDimensionType.Dimension5)
		DepartmentIsDimension6
			restricted
			when (DepartmentDimension.Type = CodeBlockDimensionType.Dimension6)
		DepartmentIsDimension7
			restricted
			when (DepartmentDimension.Type = CodeBlockDimensionType.Dimension7)
		DepartmentIsDimension8
			restricted
			when (DepartmentDimension.Type = CodeBlockDimensionType.Dimension8)
		DepartmentIsDimension9
			restricted
			when (DepartmentDimension.Type = CodeBlockDimensionType.Dimension9)
		DepartmentIsDimension10
			restricted
			when (DepartmentDimension.Type = CodeBlockDimensionType.Dimension10)
		LocationIsDimension1
			restricted
			when (LocationDimension.Type = CodeBlockDimensionType.Dimension1)
		LocationIsDimension2
			restricted
			when (LocationDimension.Type = CodeBlockDimensionType.Dimension2)
		LocationIsDimension3
			restricted
			when (LocationDimension.Type = CodeBlockDimensionType.Dimension3)
		LocationIsDimension4
			restricted
			when (LocationDimension.Type = CodeBlockDimensionType.Dimension4)
		LocationIsDimension5
			restricted
			when (LocationDimension.Type = CodeBlockDimensionType.Dimension5)
		LocationIsDimension6
			restricted
			when (LocationDimension.Type = CodeBlockDimensionType.Dimension6)
		LocationIsDimension7
			restricted
			when (LocationDimension.Type = CodeBlockDimensionType.Dimension7)
		LocationIsDimension8
			restricted
			when (LocationDimension.Type = CodeBlockDimensionType.Dimension8)
		LocationIsDimension9
			restricted
			when (LocationDimension.Type = CodeBlockDimensionType.Dimension9)
		LocationIsDimension10
			restricted
			when (LocationDimension.Type = CodeBlockDimensionType.Dimension10)
		AccountingUnitRequired
			restricted
			when (TrueCostConfiguration.FinanceEnterpriseGroup.AccountingUnitRequired)
		Dimension1Required
			restricted
			when (TrueCostConfiguration.FinanceEnterpriseGroup.FinanceDimension1Required
			and CostObjectDimension.Type! = CodeBlockDimensionType.Dimension1 
			and DepartmentDimension.Type! = CodeBlockDimensionType.Dimension1
			and LocationDimension.Type! = CodeBlockDimensionType.Dimension1)
		Dimension2Required
			restricted
			when (TrueCostConfiguration.FinanceEnterpriseGroup.FinanceDimension2Required
			and CostObjectDimension.Type! = CodeBlockDimensionType.Dimension2 
			and DepartmentDimension.Type! = CodeBlockDimensionType.Dimension2
			and LocationDimension.Type! = CodeBlockDimensionType.Dimension2)
		Dimension3Required
			restricted
			when (TrueCostConfiguration.FinanceEnterpriseGroup.FinanceDimension3Required
			and CostObjectDimension.Type! = CodeBlockDimensionType.Dimension3 
			and DepartmentDimension.Type! = CodeBlockDimensionType.Dimension3
			and LocationDimension.Type! = CodeBlockDimensionType.Dimension3)
		Dimension4Required
			restricted
			when (TrueCostConfiguration.FinanceEnterpriseGroup.FinanceDimension4Required
			and CostObjectDimension.Type! = CodeBlockDimensionType.Dimension4 
			and DepartmentDimension.Type! = CodeBlockDimensionType.Dimension4
			and LocationDimension.Type! = CodeBlockDimensionType.Dimension4)
		Dimension5Required
			restricted
			when (TrueCostConfiguration.FinanceEnterpriseGroup.FinanceDimension5Required
			and CostObjectDimension.Type! = CodeBlockDimensionType.Dimension5 
			and DepartmentDimension.Type! = CodeBlockDimensionType.Dimension5
			and LocationDimension.Type! = CodeBlockDimensionType.Dimension5)
		Dimension6Required
			restricted
			when (TrueCostConfiguration.FinanceEnterpriseGroup.FinanceDimension6Required
			and CostObjectDimension.Type! = CodeBlockDimensionType.Dimension6 
			and DepartmentDimension.Type! = CodeBlockDimensionType.Dimension6
			and LocationDimension.Type! = CodeBlockDimensionType.Dimension6)
		Dimension7Required
			restricted
			when (TrueCostConfiguration.FinanceEnterpriseGroup.FinanceDimension7Required
			and CostObjectDimension.Type! = CodeBlockDimensionType.Dimension7 
			and DepartmentDimension.Type! = CodeBlockDimensionType.Dimension7
			and LocationDimension.Type! = CodeBlockDimensionType.Dimension7)
		Dimension8Required
			restricted
			when (TrueCostConfiguration.FinanceEnterpriseGroup.FinanceDimension8Required
			and CostObjectDimension.Type! = CodeBlockDimensionType.Dimension8 
			and DepartmentDimension.Type! = CodeBlockDimensionType.Dimension8
			and LocationDimension.Type! = CodeBlockDimensionType.Dimension8)
		Dimension9Required
			restricted
			when (TrueCostConfiguration.FinanceEnterpriseGroup.FinanceDimension9Required
			and CostObjectDimension.Type! = CodeBlockDimensionType.Dimension9 
			and DepartmentDimension.Type! = CodeBlockDimensionType.Dimension9
			and LocationDimension.Type! = CodeBlockDimensionType.Dimension9)
		Dimension10Required
			restricted
			when (TrueCostConfiguration.FinanceEnterpriseGroup.FinanceDimension10Required
			and CostObjectDimension.Type! = CodeBlockDimensionType.Dimension10 
			and DepartmentDimension.Type! = CodeBlockDimensionType.Dimension10
			and LocationDimension.Type! = CodeBlockDimensionType.Dimension10)
		AccountingUnitEntry
			restricted
			when (TrueCostConfiguration.FinanceEnterpriseGroup.AccountingUnitSelected)
		Dimension1Entry
			restricted
			when (TrueCostConfiguration.FinanceEnterpriseGroup.FinanceDimension1Entry
			and CostObjectDimension.Type! = CodeBlockDimensionType.Dimension1 
			and DepartmentDimension.Type! = CodeBlockDimensionType.Dimension1
			and LocationDimension.Type! = CodeBlockDimensionType.Dimension1)
		Dimension2Entry
			restricted
			when (TrueCostConfiguration.FinanceEnterpriseGroup.FinanceDimension2Entry
			and CostObjectDimension.Type! = CodeBlockDimensionType.Dimension2 
			and DepartmentDimension.Type! = CodeBlockDimensionType.Dimension2
			and LocationDimension.Type! = CodeBlockDimensionType.Dimension2)
		Dimension3Entry
			restricted
			when (TrueCostConfiguration.FinanceEnterpriseGroup.FinanceDimension3Entry
			and CostObjectDimension.Type! = CodeBlockDimensionType.Dimension3 
			and DepartmentDimension.Type! = CodeBlockDimensionType.Dimension3
			and LocationDimension.Type! = CodeBlockDimensionType.Dimension3)
		Dimension4Entry
			restricted
			when (TrueCostConfiguration.FinanceEnterpriseGroup.FinanceDimension4Entry
			and CostObjectDimension.Type! = CodeBlockDimensionType.Dimension4 
			and DepartmentDimension.Type! = CodeBlockDimensionType.Dimension4
			and LocationDimension.Type! = CodeBlockDimensionType.Dimension4)
		Dimension5Entry
			restricted
			when (TrueCostConfiguration.FinanceEnterpriseGroup.FinanceDimension5Entry
			and CostObjectDimension.Type! = CodeBlockDimensionType.Dimension5 
			and DepartmentDimension.Type! = CodeBlockDimensionType.Dimension5
			and LocationDimension.Type! = CodeBlockDimensionType.Dimension5)
		Dimension6Entry
			restricted
			when (TrueCostConfiguration.FinanceEnterpriseGroup.FinanceDimension6Entry
			and CostObjectDimension.Type! = CodeBlockDimensionType.Dimension6 
			and DepartmentDimension.Type! = CodeBlockDimensionType.Dimension6
			and LocationDimension.Type! = CodeBlockDimensionType.Dimension6)
		Dimension7Entry
			restricted
			when (TrueCostConfiguration.FinanceEnterpriseGroup.FinanceDimension7Entry
			and CostObjectDimension.Type! = CodeBlockDimensionType.Dimension7 
			and DepartmentDimension.Type! = CodeBlockDimensionType.Dimension7
			and LocationDimension.Type! = CodeBlockDimensionType.Dimension7)
		Dimension8Entry
			restricted
			when (TrueCostConfiguration.FinanceEnterpriseGroup.FinanceDimension8Entry
			and CostObjectDimension.Type! = CodeBlockDimensionType.Dimension8 
			and DepartmentDimension.Type! = CodeBlockDimensionType.Dimension8
			and LocationDimension.Type! = CodeBlockDimensionType.Dimension8)
		Dimension9Entry
			restricted
			when (TrueCostConfiguration.FinanceEnterpriseGroup.FinanceDimension9Entry
			and CostObjectDimension.Type! = CodeBlockDimensionType.Dimension9 
			and DepartmentDimension.Type! = CodeBlockDimensionType.Dimension9
			and LocationDimension.Type! = CodeBlockDimensionType.Dimension9)
		Dimension10Entry
			restricted
			when (TrueCostConfiguration.FinanceEnterpriseGroup.FinanceDimension10Entry
			and CostObjectDimension.Type! = CodeBlockDimensionType.Dimension10 
			and DepartmentDimension.Type! = CodeBlockDimensionType.Dimension10
			and LocationDimension.Type! = CodeBlockDimensionType.Dimension10)
 		TrueCostConfigurationMatchesContext
 			restricted
 			when (TrueCostConfiguration = actor.context.TrueCostConfiguration)
		HasCalendar
			restricted
			when (Calendar entered)
		TrueCostConfigurationExists
			restricted
			when (TrueCostConfigurationRel exist)
		TrueCostDriverEventExists
			restricted
			when (TrueCostDriverEventRel exist)
		TrueCostResourceUtilizationDriverEventExists
		  	restricted
		 	when (TrueCostResourceUtilizationDriverEventRel exist)

	Relations
		TrueCostAllocationControlRel
 			one-to-many relation to TrueCostAllocationControl
 			Field Mapping uses symbolic key
 				related.TrueCostConfiguration 				= TrueCostConfiguration
 				
		TrueCostCostBehaviorRel
			one-to-many relation to TrueCostCostBehavior
			Field Mapping uses symbolic key
				related.TrueCostConfiguration		=	TrueCostConfiguration
			Instance Selection
				include deleted records
				

		TrueCostDriverUnitCountRel
 			one-to-one relation to TrueCostDriver
 			Field Mapping uses symbolic key
 				related.TrueCostConfiguration 		= TrueCostConfiguration
				related.TrueCostDriver				= "Unit Count"

		TrueCostDriverPerMinuteDurationRel
 			one-to-one relation to TrueCostDriver
 			Field Mapping uses symbolic key
 				related.TrueCostConfiguration 		= TrueCostConfiguration
				related.TrueCostDriver				= "Per Minute Duration"

		TrueCostConfigurationRel
 			one-to-one relation to TrueCostConfiguration
 			Field Mapping uses symbolic key
 				related.TrueCostConfiguration 		= TrueCostConfiguration

		TrueCostDriverEventRel
 			one-to-many relation to TrueCostDriverEvent
 			Field Mapping uses symbolic key
 				related.TrueCostConfiguration 		= TrueCostConfiguration

		TrueCostDriverEventTotalRel
 			one-to-many relation to TrueCostDriverEventTotal
 			Field Mapping uses symbolic key
 				related.TrueCostConfiguration 		= TrueCostConfiguration
 
 		CalendarPeriodsMatchingPeriodTypeRel
			one-to-many relation to GeneralLedgerCalendarPeriod
			Field Mapping uses ByTopNode
				related.FinanceEnterpriseGroup 				= TrueCostConfiguration
				related.TopNode		 						= Calendar.TopNode
			Instance Selection
				where (related.PeriodType		 			= 3)

		DriverHasAccountRel is a TrueCostResourceUtilizationDriver set
			Instance Selection
				where (related.HasAccount)
			
		DriverHasProjectRel	is a TrueCostResourceUtilizationDriver set
			Instance Selection
				where (related.HasProject)

		DriverHasAccountingUnitRel is a TrueCostResourceUtilizationDriver set
			Instance Selection
				where (related.HasAccountingUnit)

        DriverHasDimension1Rel  is a TrueCostResourceUtilizationDriver set
			Instance Selection
				where (related.HasDimension1)

        DriverHasDimension2Rel   is a TrueCostResourceUtilizationDriver set
			Instance Selection
				where (related.HasDimension2)

        DriverHasDimension3Rel   is a TrueCostResourceUtilizationDriver set
			Instance Selection
				where (related.HasDimension3)

        DriverHasDimension4Rel   is a TrueCostResourceUtilizationDriver set
			Instance Selection
				where (related.HasDimension4)
 
        DriverHasDimension5Rel   is a TrueCostResourceUtilizationDriver set
			Instance Selection
				where (related.HasDimension5)
				
        DriverHasDimension6Rel   is a TrueCostResourceUtilizationDriver set
			Instance Selection
				where (related.HasDimension6)

        DriverHasDimension7Rel   is a TrueCostResourceUtilizationDriver set
			Instance Selection
				where (related.HasDimension7)

        DriverHasDimension8Rel   is a TrueCostResourceUtilizationDriver set
			Instance Selection
				where (related.HasDimension8)

        DriverHasDimension9Rel   is a TrueCostResourceUtilizationDriver set
			Instance Selection
				where (related.HasDimension9)

        DriverHasDimension10Rel   is a TrueCostResourceUtilizationDriver set
			Instance Selection
				where (related.HasDimension10)
 
 		WeightHasAccountRel is a TrueCostResourceIntensityFactor set
			Instance Selection
				where (related.HasAccount) 
			
		WeightHasProjectRel	is a TrueCostResourceIntensityFactor set
			Instance Selection
				where (related.HasProject)

		WeightHasAccountingUnitRel is a TrueCostResourceIntensityFactor set
			Instance Selection
				where (related.HasAccountingUnit)

        WeightHasDimension1Rel  is a TrueCostResourceIntensityFactor set
			Instance Selection
				where (related.HasDimension1)

        WeightHasDimension2Rel   is a TrueCostResourceIntensityFactor set
			Instance Selection
				where (related.HasDimension2)

        WeightHasDimension3Rel   is a TrueCostResourceIntensityFactor set
			Instance Selection
				where (related.HasDimension3)

        WeightHasDimension4Rel   is a TrueCostResourceIntensityFactor set
			Instance Selection
				where (related.HasDimension4)
 
        WeightHasDimension5Rel   is a TrueCostResourceIntensityFactor set
			Instance Selection
				where (related.HasDimension5)
				
        WeightHasDimension6Rel   is a TrueCostResourceIntensityFactor set
			Instance Selection
				where (related.HasDimension6)

        WeightHasDimension7Rel   is a TrueCostResourceIntensityFactor set
			Instance Selection
				where (related.HasDimension7)

        WeightHasDimension8Rel   is a TrueCostResourceIntensityFactor set
			Instance Selection
				where (related.HasDimension8)

        WeightHasDimension9Rel   is a TrueCostResourceIntensityFactor set
			Instance Selection
				where (related.HasDimension9)

        WeightHasDimension10Rel   is a TrueCostResourceIntensityFactor set
			Instance Selection
				where (related.HasDimension10)

		PracticalCapacityHasAccountingUnitRel is a TrueCostCapacity set
			Instance Selection
				where (related.VolumeDimension.Type.AccountingUnit)

		PracticalCapacityHasProjectRel is a TrueCostCapacity set
			Instance Selection
				where (related.VolumeDimension.Type.Project)
				
		PracticalCapacityHasDimension1Rel is a TrueCostCapacity set
			Instance Selection
				where (related.VolumeDimension.Type.Dimension1)

		PracticalCapacityHasDimension2Rel is a TrueCostCapacity set
			Instance Selection
				where (related.VolumeDimension.Type.Dimension2)
				
		PracticalCapacityHasDimension3Rel is a TrueCostCapacity set
			Instance Selection
				where (related.VolumeDimension.Type.Dimension3)

		PracticalCapacityHasDimension4Rel is a TrueCostCapacity set
			Instance Selection
				where (related.VolumeDimension.Type.Dimension4)

		PracticalCapacityHasDimension5Rel is a TrueCostCapacity set
			Instance Selection
				where (related.VolumeDimension.Type.Dimension5)

		PracticalCapacityHasDimension6Rel is a TrueCostCapacity set
			Instance Selection
				where (related.VolumeDimension.Type.Dimension6)

		PracticalCapacityHasDimension7Rel is a TrueCostCapacity set
			Instance Selection
				where (related.VolumeDimension.Type.Dimension7)
	
		PracticalCapacityHasDimension8Rel is a TrueCostCapacity set
			Instance Selection
				where (related.VolumeDimension.Type.Dimension8)
	
		PracticalCapacityHasDimension9Rel is a TrueCostCapacity set
			Instance Selection
				where (related.VolumeDimension.Type.Dimension9)
	
		PracticalCapacityHasDimension10Rel is a TrueCostCapacity set
			Instance Selection
				where (related.VolumeDimension.Type.Dimension10)

		TrueCostResourceUtilizationDriverEventRel
		 	one-to-many relation to TrueCostResourceUtilizationDriverEvent
		 	Field Mapping uses symbolic key
		 		related.TrueCostConfiguration 		= TrueCostConfiguration
						

		StructureRowRel
    		one-to-many relation to StructureRow
    		Field Mapping uses ByType
    			related.FinanceEnterpriseGroup		= TrueCostConfiguration
    		Instance Selection
    			where (related.Type.AccountingEntity													
    			or (related.Type.AccountingUnit 		and TrueCostConfiguration.HasAccountingUnit)	
    			or (related.Type.Project				and TrueCostConfiguration.HasProject)			
    			or (related.Type.Dimension1				and TrueCostConfiguration.HasDimension1)		
    			or (related.Type.Dimension2				and TrueCostConfiguration.HasDimension2)		
    			or (related.Type.Dimension3				and TrueCostConfiguration.HasDimension3)			
    			or (related.Type.Dimension4				and TrueCostConfiguration.HasDimension4)
    			or (related.Type.Dimension5				and TrueCostConfiguration.HasDimension5)
    			or (related.Type.Dimension6				and TrueCostConfiguration.HasDimension6)
    			or (related.Type.Dimension7				and TrueCostConfiguration.HasDimension7)
    			or (related.Type.Dimension8				and TrueCostConfiguration.HasDimension8)
    			or (related.Type.Dimension9				and TrueCostConfiguration.HasDimension9)
    			or (related.Type.Dimension10			and TrueCostConfiguration.HasDimension10))
 	Sets

	Rule Blocks
		GenerateCostBehaviorDefaults
				invoke Create TrueCostCostBehavior
					invoked.TrueCostConfiguration	=	TrueCostConfiguration
					invoked.CostBehavior			=	"Not Specified"
					invoked.IsDefault				=	true
				invoke Create TrueCostCostBehavior
					invoked.TrueCostConfiguration	=	TrueCostConfiguration
					invoked.CostBehavior			=	"Direct-Fixed"
					invoked.IsDefault				=	false
				invoke Create TrueCostCostBehavior
					invoked.TrueCostConfiguration	=	TrueCostConfiguration
					invoked.CostBehavior			=	"Direct-Variable"
					invoked.IsDefault				=	true
				invoke Create TrueCostCostBehavior
					invoked.TrueCostConfiguration	=	TrueCostConfiguration
					invoked.CostBehavior			=	"Indirect-Fixed"
					invoked.IsDefault				=	false
				invoke Create TrueCostCostBehavior
					invoked.TrueCostConfiguration	=	TrueCostConfiguration
					invoked.CostBehavior			=	"Indirect-Variable"
					invoked.IsDefault				=	false

		CreateUnitCostDrivers
			invoke Create TrueCostDriver
				invoked.TrueCostConfiguration	=	TrueCostConfiguration
				invoked.TrueCostDriver			=   "UNIT COUNT"
				invoked.Description				=   "Actual Activity Count Volume"
				invoked.IsUnitCostDriver		=	true
			
			invoke Create TrueCostDriver
				invoked.TrueCostConfiguration	=	TrueCostConfiguration
				invoked.TrueCostDriver			=   "PER MINUTE DURATION"
				invoked.Description				=   "Actual Activity Duration Volume"
				invoked.IsUnitCostDriver		=	true

	Field Rules
		CostObjectDimension
			required				
			constraint (CostObjectDimension.Type > 5)
				"MustAssignToAUserDimension"
			if (!CanUpdate)
				cannot be changed
			LocalStructureRow	= CostObjectDimension
			
		DepartmentDimension
			required
			constraint (DepartmentDimension.Type > 5
			or DepartmentDimension.Type = CodeBlockDimensionType.AccountingUnit)
				"MustAssignToAUserDimensionOrAccountingUnit"
			constraint (DepartmentDimension != CostObjectDimension)
				"DimensionsMustBeDifferent"
			if (!CanUpdate)
				cannot be changed
			LocalStructureRow	= DepartmentDimension
			
		LocationDimension
			if (LocationDimension entered)
				constraint (LocationDimension != CostObjectDimension)
					"DimensionsMustBeDifferent"
				constraint (LocationDimension.Type > 5)
					"MustAssignToAUserDimension"
				if (!CanUpdate)
					cannot be changed
				LocalStructureRow	= LocationDimension
							
		Calendar
			required
			constraint (CalendarPeriodsMatchingPeriodTypeRel exists)
				"CalendarMustHavePeriodTypeMonth"
		
		DefaultContraAccount
			constraint(DefaultContraAccount.AccountType.Expense
			and 	   DefaultContraAccount.ChartSection.IncomeStatement
			and 	   DefaultContraAccount.ChartType.Posting)
				"ContraAccountMustBeAPostingExpenseAccount."

		HasAccount
			if (HasAccount changed)
				if (not HasAccount)
					constraint (WeightHasAccountRel not exists and DriverHasAccountRel  not exists)
						"<DerivedMessageCannotBeChange>"

		HasProject
			if (HasProject changed)
				if (not HasProject)
					constraint (WeightHasProjectRel not exists and DriverHasProjectRel  not exists)
						"<DerivedMessageCannotBeChange>"

		HasAccountingUnit
			if (HasAccountingUnit changed)
				if (not HasAccountingUnit)
					constraint (WeightHasAccountingUnitRel not exists and DriverHasAccountingUnitRel  not exists)
						"<DerivedMessageCannotBeChange>"

        HasDimension1
			if (HasDimension1 changed)
				if (not HasDimension1)
					constraint (WeightHasDimension1Rel not exists and DriverHasDimension1Rel  not exists)
						"<DerivedMessageCannotBeChange>"		

        HasDimension2
			if (HasDimension2 changed)
				if (not HasDimension2)
					constraint (WeightHasDimension2Rel not exists and DriverHasDimension2Rel  not exists)
						"<DerivedMessageCannotBeChange>"	

        HasDimension3
			if (HasDimension3 changed)
				if (not HasDimension3)
					constraint (WeightHasDimension3Rel not exists and DriverHasDimension3Rel  not exists)
						"<DerivedMessageCannotBeChange>"	

        HasDimension4
			if (HasDimension4 changed)
				if (not HasDimension4)
					constraint (WeightHasDimension4Rel not exists and DriverHasDimension4Rel  not exists)
						"<DerivedMessageCannotBeChange>"	

        HasDimension5
			if (HasDimension5 changed)
				if (not HasDimension5)
					constraint (WeightHasDimension5Rel not exists and DriverHasDimension5Rel  not exists)
						"<DerivedMessageCannotBeChange>"	

        HasDimension6
			if (HasDimension6 changed)
				if (not HasDimension6)
					constraint (WeightHasDimension6Rel not exists and DriverHasDimension6Rel  not exists)
						"<DerivedMessageCannotBeChange>"	

        HasDimension7
			if (HasDimension7 changed)
				if (not HasDimension7)
					constraint (WeightHasDimension7Rel not exists and DriverHasDimension7Rel  not exists)
						"<DerivedMessageCannotBeChange>"	

        HasDimension8
			if (HasDimension8 changed)
				if (not HasDimension8)
					constraint (WeightHasDimension8Rel not exists and DriverHasDimension8Rel  not exists)
						"<DerivedMessageCannotBeChange>"	

        HasDimension9
			if (HasDimension9 changed)
				if (not HasDimension9)
					constraint (WeightHasDimension9Rel not exists and DriverHasDimension9Rel  not exists)
						"<DerivedMessageCannotBeChange>"	

        HasDimension10
			if (HasDimension10 changed)
				if (not HasDimension10)
					constraint (WeightHasDimension10Rel not exists and DriverHasDimension10Rel  not exists)
						"<DerivedMessageCannotBeChange>"
 	Attach Rules
		
    Actions
	
    	Create is an Action
			Exit Rules
				include GenerateCostBehaviorDefaults

				include CreateUnitCostDrivers
				RebuildRequired = false

		Update is an Update Action
			Local Fields
		    	LocalPreviousCalendar			is like GeneralLedgerCalendar

			Action Rules
				LocalPreviousCalendar	= old Calendar

			Exit Rules
				if (LocalPreviousCalendar not = Calendar 
				and TrueCostResourceUtilizationDriverEventExists)
					RebuildRequired = true

		Delete is a Delete Action
			Action Rules
				invoke Purge TrueCostCostBehaviorRel
				invoke Delete TrueCostDriverEventTotalRel

		FixupPostingBalancesSetting is an Instance Action
			restricted
			Action Rules
				invoke FixPostingBalances TrueCostAllocationLine
					invoked.PrmTrueCostConfiguration	= TrueCostConfiguration
		
		CreateCostObject is an Instance Action
			restricted
			
			Parameters
				Dimension 				is like FinanceDimension1
				Description
				DimensionStructure		is like FinanceDimension1Structure
				TargetCostObject		is like FinanceDimension1
			
			Local Fields
		    	
			Action Rules
				if (TrueCostConfiguration.CostObjectIsDimension1)
					FinanceDimension1Structure = DimensionStructure
					invoke Create FinanceDimension1
						invoked.FinanceEnterpriseGroup 	= TrueCostConfiguration
						invoked.DimensionType			= 1
						invoked.FinanceDimension1 		= Dimension
						invoked.Description 			= Description
						invoked.DisplayDimension		= Dimension
						invoked.ParentDimension			= TargetCostObject
						invoked.Active 					= true

						invoked.AddressCode				= AddressCode
				else
				if (TrueCostConfiguration.CostObjectIsDimension2)
					FinanceDimension2Structure = DimensionStructure
					invoke Create FinanceDimension2
						invoked.FinanceEnterpriseGroup 	= TrueCostConfiguration
						invoked.DimensionType			= 1
						invoked.FinanceDimension2 		= Dimension
						invoked.Description 			= Description
						invoked.DisplayDimension		= Dimension
						invoked.ParentDimension			= TargetCostObject
						invoked.Active 					= true

						invoked.AddressCode				= AddressCode
				else
				if (TrueCostConfiguration.CostObjectIsDimension3)
					FinanceDimension3Structure = DimensionStructure
					invoke Create FinanceDimension3
						invoked.FinanceEnterpriseGroup 	= TrueCostConfiguration
						invoked.DimensionType			= 1
						invoked.FinanceDimension3 		= Dimension
						invoked.Description 			= Description
						invoked.DisplayDimension		= Dimension
						invoked.ParentDimension			= TargetCostObject
						invoked.Active 					= true

						invoked.AddressCode				= AddressCode
				else
				if (TrueCostConfiguration.CostObjectIsDimension4)
					FinanceDimension4Structure = DimensionStructure
					invoke Create FinanceDimension4
						invoked.FinanceEnterpriseGroup 	= TrueCostConfiguration
						invoked.DimensionType			= 1
						invoked.FinanceDimension4 		= Dimension
						invoked.Description 			= Description
						invoked.DisplayDimension		= Dimension
						invoked.ParentDimension			= TargetCostObject
						invoked.Active 					= true

						invoked.AddressCode				= AddressCode
				else
				if (TrueCostConfiguration.CostObjectIsDimension5)
					FinanceDimension5Structure = DimensionStructure
					invoke Create FinanceDimension5
						invoked.FinanceEnterpriseGroup 	= TrueCostConfiguration
						invoked.DimensionType			= 1
						invoked.FinanceDimension5 		= Dimension
						invoked.Description 			= Description
						invoked.DisplayDimension		= Dimension
						invoked.ParentDimension			= TargetCostObject
						invoked.Active 					= true

						invoked.AddressCode				= AddressCode
				else
				if (TrueCostConfiguration.CostObjectIsDimension6)
					FinanceDimension6Structure = DimensionStructure
					invoke Create FinanceDimension6
						invoked.FinanceEnterpriseGroup 	= TrueCostConfiguration
						invoked.DimensionType			= 1
						invoked.FinanceDimension6 		= Dimension
						invoked.Description 			= Description
						invoked.DisplayDimension		= Dimension
						invoked.ParentDimension			= TargetCostObject
						invoked.Active 					= true

						invoked.AddressCode				= AddressCode
				else
				if (TrueCostConfiguration.CostObjectIsDimension7)
					FinanceDimension7Structure = DimensionStructure
					invoke Create FinanceDimension7
						invoked.FinanceEnterpriseGroup 	= TrueCostConfiguration
						invoked.DimensionType			= 1
						invoked.FinanceDimension7 		= Dimension
						invoked.Description 			= Description
						invoked.DisplayDimension		= Dimension
						invoked.ParentDimension			= TargetCostObject
						invoked.Active 					= true

						invoked.AddressCode				= AddressCode
				else
				if (TrueCostConfiguration.CostObjectIsDimension8)
					FinanceDimension8Structure = DimensionStructure
					invoke Create FinanceDimension8
						invoked.FinanceEnterpriseGroup 	= TrueCostConfiguration
						invoked.DimensionType			= 1
						invoked.FinanceDimension8 		= Dimension
						invoked.Description 			= Description
						invoked.DisplayDimension		= Dimension
						invoked.ParentDimension			= TargetCostObject
						invoked.Active 					= true

						invoked.AddressCode				= AddressCode
				else
				if (TrueCostConfiguration.CostObjectIsDimension9)
					FinanceDimension9Structure = DimensionStructure
					invoke Create FinanceDimension9
						invoked.FinanceEnterpriseGroup 	= TrueCostConfiguration
						invoked.DimensionType			= 1
						invoked.FinanceDimension9 		= Dimension
						invoked.Description 			= Description
						invoked.DisplayDimension		= Dimension
						invoked.ParentDimension			= TargetCostObject
						invoked.Active 					= true

						invoked.AddressCode				= AddressCode
				else
				if (TrueCostConfiguration.CostObjectIsDimension10)
					FinanceDimension10Structure = DimensionStructure
					invoke Create FinanceDimension10
						invoked.FinanceEnterpriseGroup 	= TrueCostConfiguration
						invoked.DimensionType			= 1
						invoked.FinanceDimension10 		= Dimension
						invoked.Description 			= Description
						invoked.DisplayDimension		= Dimension
						invoked.ParentDimension			= TargetCostObject
						invoked.Active 					= true

						invoked.AddressCode				= AddressCode

		RebuildSummarizedDriverEvents is an Instance Action

			Local Fields
		    	AsyncId									is a AsyncActionRequest
				
	        Action Rules
	        	constraint (TrueCostResourceUtilizationDriverEventExists)
					"MustHaveDriverEvents"

				invoke PurgeAllTotals TrueCostResourceUtilizationDriverEventTotal
					assign async action request id to AsyncId
					invoked.PrmTrueCostConfiguration		=	TrueCostConfiguration
					
	        	invoke RebuildSummarizedDriverEvents TrueCostResourceUtilizationDriverEvent
					run after AsyncId
					assign async action request id to AsyncId
					invoked.PrmTrueCostConfiguration		=	TrueCostConfiguration
				
				invoke Update TrueCostConfiguration in background
					run after AsyncId
					invoked.RebuildRequired = false
				
					
