TrueCostSCMICTRANS is a BusinessClass
	owned by truecost
	prefix is TCSCI
	default label is "True\CostInventoryTransactionInterface"
	Ontology
		symbolic key is TrueCostSCMICTRANS
		
	Patterns
	
	Persistent Fields

	Field Rules
	
	Derived Fields
		LastDayOfMonth			is a DerivedField
			type is Date
			restricted
			while (!LocalDate is last day in month)
				LocalDate += 1 day
			return LocalDate
			
			
	Local Fields
		LocalTrueCostConfiguration		is like TrueCostConfiguration
		LocalDate						is Date
		LocalLastDayOfMonth				is Date
		
	Relations
		TCMMDISTRel
			one-to-many relation to TrueCostSCMMMDIST
			Field Mapping uses symbolic key
				related.TrueCostSCMMMDIST.DocType = TrueCostSCMICTRANS.DocType
				related.TrueCostSCMMMDIST.DocNumber = TrueCostSCMICTRANS.DocNumber

		
		TrueCostResourceRateRel
			one-to-many relation to TrueCostResourceRateTable
			Field Mapping uses symbolic key
				related.TrueCostConfiguration = LocalTrueCostConfiguration
				related.TrueCostResourceRateTable.AccountingEntity = TrueCostSCMICTRANS.Company
				related.TrueCostResourceRateTable.Department = TCMMDISTRel.AcctUnit
				related.TrueCostResourceRateTable.ResourceName = TrueCostSCMICTRANS.Item
				related.TrueCostResourceRateTable.EffectivePeriod = LocalLastDayOfMonth
				
	
	Actions
		Create is a Create Action
			
		Update is an Update Action
		
		Delete is a Delete Action
		
		GenerateResourceRateData					is a Set Action
			Parameters
				PrmTCConfig						is a TrueCostConfiguration
					default label is "True\CostConfiguration"
					
			Parameter Rules
				PrmTCConfig
					required
						"True\CostConfiguration_is_required"
				
			
			Action Rules
				Instance Rules
					LocalDate = TrueCostSCMICTRANS.TransDate
					LocalLastDayOfMonth = LastDayOfMonth
					if (!LocalTrueCostConfiguration entered)
						LocalTrueCostConfiguration = PrmTCConfig
					if (TrueCostSCMICTRANS.DocType = "PO")
						if(!TrueCostResourceRateRel exists)
							invoke Create TrueCostResourceRateTable
								resume on error
								invoked.TrueCostResourceRateTable.TrueCostConfiguration		= LocalTrueCostConfiguration
								invoked.TrueCostResourceRateTable.AccountingEntity			= TrueCostSCMICTRANS.Company
								invoked.TrueCostResourceRateTable.Department 				= TCMMDISTRel.AcctUnit
								invoked.TrueCostResourceRateTable.ResourceName				= TrueCostSCMICTRANS.Item
								invoked.TrueCostResourceRateTable.EffectivePeriod			= LocalLastDayOfMonth
								invoked.TrueCostResourceRateTable.WageAmount				= TrueCostSCMICTRANS.UnitCost 
								invoked.TrueCostResourceRateTable.Hours						= 1
								invoked.TrueCostResourceRateTable.AverageResourceRate		= TrueCostSCMICTRANS.UnitCost
						else
							invoke Update TrueCostResourceRateRel
								invoked.TrueCostResourceRateTable.WageAmount				+= TrueCostSCMICTRANS.UnitCost
								invoked.TrueCostResourceRateTable.Hours						+= 1
					

