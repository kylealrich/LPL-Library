IncomeWithholdingCode is a BusinessClass
	owned by ap
	prefix is INCWC

	Ontology
		symbolic key is IncomeWithholdingCode

	Patterns
		implements StaticJava
		disable AuditIndex

	Attach Rules
		constraint (Active)
			"IncomeWithholdingCodeIsNotActive"

	Persistent Fields
		Description
		Currency
		Type								is Numeric 1
			States
				Payment						value is 0
				Accrued						value is 1
		Accumulated							is Boolean
		IncludeTax							is Boolean
		VATWithholding						is Boolean
		IncludeDiscount						is Boolean
		Active

	Context Fields
		Vendor
		Company

	Field Rules
		Description
			required

		Currency
			if (Accumulated)
				required
					"CurrencyRequiredIfWithholdingBalancesAreAccumulated"




				
		VATWithholding
			if (VATWithholding)
				constraint (!IncludeTax)
					"IncludeTaxAndVATWithholdingCannotBothBeSelected"
	Derived Fields
        CreateMessage is a LabelField
			restricted
			"CreateIncomeWithholdingCode"
		
		FormLabel is a LabelField
			restricted
			"IncomeWithholdingCode:_"
		
		RepresentativeText is a StringField
			type is Text
			default label is "IncomeWithholdingCode"
			IncomeWithholdingCode " - " Description
		
		DerivedIncomeWithholdingCodeTitle	is a DerivedField
			type is Alpha size up to 132
			default label is "IncomeWithholdingCode"
			return RepresentativeText

		DerivedFormTitle is a DerivedField
			type is MessageField
			restricted
			if (RecordExists)
				return FormLabel + DerivedIncomeWithholdingCodeTitle
			else
				return CreateMessage

	Conditions
		IsVendorWithholdingCode
			restricted
			when (VendorWithholdingCodeRel exists)

		RecordExists
			restricted
			when (IncomeWithholdingCode exists)
		
		IsPaymentTypewithDiscount
			restricted
			when (VendorGroup.GlobalWithholding 
			and   Type.Payment)

	Relations
		VendorWithholdingCodeRel
			one-to-one relation to VendorWithholdingCode
			Field Mapping uses symbolic key
				related.VendorGroup				= VendorGroup
				related.Vendor					= Vendor
				related.Company					= Company
				related.IncomeWithholdingCode	= IncomeWithholdingCode

	Rule Blocks

	Actions
		Create is a Create Action

		Update is an Update Action

		Delete is a Delete Action

