VendorContact is a BusinessClass
	owned by ap
	prefix is VCT
	classic name is APCONTACT

	Ontology
		symbolic key is VendorContact
			classic set name is VCTSET1
			classic name for VendorContact.VendorContactCode is RESP-CODE
			classic name for VendorContact.ContactLevel is CONTACT-LVL
			classic name for VendorLocation is LOCATION-CODE

	Patterns
		implements StaticJava
			has attachments
		disable AuditIndex
		implements BODId

	Persistent Fields
		ContactName		is a VendorName 
			holds pii
			classic name is NAME
		PhoneNumber		is a TelephoneNumber 
			holds pii
			classic name for PhoneNumber.InternationalPrefix is INT-PREFIX
			classic name for PhoneNumber.SubscriberNumber is PHONE-NMBR
			classic name for PhoneNumber.Extension is PHONE-EXT
		MobileNumber	is a MobilePhone 
			holds pii
			classic name for MobileNumber.MobilePhoneNumber.InternationalPrefix is MBL-INT-PREFIX
			classic name for MobileNumber.MobilePhoneNumber.SubscriberNumber is MOBILE-NUM
			classic name for MobileNumber.MobilePhoneNumber.Extension is MOBILE-EXT
		FaxNumber 
			holds pii
			classic name for FaxNumber.InternationalPrefix is FAX-PREFIX
			classic name for FaxNumber.SubscriberNumber is FAX-NMBR
			classic name for FaxNumber.Extension is FAX-EXT
		EmailAddress	is an EmailAddressMulti 
			holds pii
			classic name is E-MAIL-ADDRESS
			default label is "Email"
		TwitterID 
			holds pii
			classic name is SOCIAL-ID1
		SocialNetworkID2 
			holds pii
			classic name is SOCIAL-ID2
		SocialNetworkID3 
			holds pii
			classic name is SOCIAL-ID3
		SocialNetworkID4 
			holds pii
			classic name is SOCIAL-ID4
		SocialNetworkID5 
			holds pii
			classic name is SOCIAL-ID5
		CommentText
			default label is "Comment"
		EmailCreditMemo			is Boolean 
			default label is "CreditMemo"
		EmailDebitMemo			is Boolean 
			default label is "DebitMemo"
		EmailPaymentCheck		is Boolean 
			default label is "PaymentCheck"
		EmailRemittanceAdvice	is Boolean 
			default label is "RemittanceAdvice"	
		Description											
		OverrideIDMEmailDistribution	is Boolean
			default label is "Override_I\D\MEmailDistribution"
	Transient Fields
		VendorAddress			is a PostalAddressV2	
			holds pii
			derive value from CurrentAddressRel.PostalAddress
		AddressEffectiveDate	is an EffectiveDate
			derive value from CurrentAddressRel.effective date
			default label is "EffectiveDate"

	Derived Fields
		ContextMessageEntityType is a StringField
			type is Alpha 30
			restricted
			"InforContactMaster"

		ContextMessageText is a MessageField
			restricted
			"VendorContact<VendorContact.VendorContactCode><VendorContact.ContactLevel>ForVendor<Vendor>,Location<VendorLocation>"

		VendorAddressLine1	is a ConditionalField
			type is Alpha size 30
			classic name is VDR-ADDR1
			if (CurrentAddressExists)
				CurrentAddressRel.PostalAddress.DeliveryAddress.AddressLine1
			else
				blank

		VendorAddressLine2	is a ConditionalField
			type is Alpha size 30
			classic name is VDR-ADDR2
			if (CurrentAddressExists)
				CurrentAddressRel.PostalAddress.DeliveryAddress.AddressLine2
			else
				blank

		VendorAddressLine3	is a ConditionalField
			type is Alpha size 30
			classic name is VDR-ADDR3
			if (CurrentAddressExists)
				CurrentAddressRel.PostalAddress.DeliveryAddress.AddressLine3
			else
				blank

		VendorAddressLine4	is a ConditionalField
			type is Alpha size 30
			classic name is VDR-ADDR4
			if (CurrentAddressExists)
				CurrentAddressRel.PostalAddress.DeliveryAddress.AddressLine4
			else
				blank

		VendorCity			is a ConditionalField
			type is Alpha size 18
			classic name is VDR-CITY-ADDR5
			if (CurrentAddressExists)
				CurrentAddressRel.PostalAddress.Municipality
			else
				blank

		VendorStateProvince	is a ConditionalField
			type is AlphaUpper size 2
			classic name is VDR-STATE
			if (CurrentAddressExists)
				CurrentAddressRel.PostalAddress.StateProvince
			else
				blank

		VendorPostalCode	is a ConditionalField
			type is Alpha size 10
			classic name is VDR-POSTAL
			if (CurrentAddressExists)
				CurrentAddressRel.PostalAddress.PostalCode
			else
				blank

		VendorCounty		is a ConditionalField
			type is Alpha size 25
			classic name is VDR-COUNTY
			if (CurrentAddressExists)
				CurrentAddressRel.PostalAddress.County
			else
				blank

		VendorCountry		is a ConditionalField
			type is Alpha size 30
			classic name is VDR-COUNTRY
			if (CurrentAddressExists)
				CurrentAddressRel.PostalAddress.Country
			else
				blank









		CityStateZIPDisplay is a ConditionalField
			type is Alpha 76
			if (CurrentAddressExists)
				CurrentAddressRel.CityStateZIPDisplay
			else
				blank

		FormattedPhoneNumber is a DerivedField
			type is MessageField
			default label is "Phone"
			return PhoneNumber.InternationalPrefix + " " + PhoneNumber.SubscriberNumber + "  " + PhoneNumber.Extension

		FormattedMobilePhoneNumber is a DerivedField
			type is MessageField
			default label is "Mobile"
			return MobileNumber.MobilePhoneNumber.InternationalPrefix + " " + MobileNumber.MobilePhoneNumber.SubscriberNumber + "  " + MobileNumber.MobilePhoneNumber.Extension

		FormattedFaxNumber is a DerivedField
			type is MessageField
			default label is "Fax"
			return FaxNumber.InternationalPrefix + " " + FaxNumber.SubscriberNumber + "  " + FaxNumber.Extension


		DerivedSubscriberNumberDesc is a DerivedField
			type is Alpha size 15
			restricted
			if (PhoneNumberEntered)
				return "Phone"
			else
				return ""

		DerivedEmailAddressDesc is a DerivedField
			type is Alpha size 15
			restricted
			if (EmailAddressEntered)
				return "EMail"
			else
				return ""



		DerivedDelimiter is a DerivedField
			type is Alpha size 5
			restricted
			LocalConfigurationParameter	= "Generic_Delimiter"
			if(FSMBODConfigurationParameterRel exists)
				return FSMBODConfigurationParameterRel.Value

		DerivedTenantID is a DerivedField
			type is Alpha size 60
			restricted
			LocalConfigurationParameter	= "tenantID"
			if(FSMBODConfigurationParameterRel exists)
				return FSMBODConfigurationParameterRel.Value

		DerivedReleaseID is a DerivedField
			type is Alpha size 60
			restricted
			LocalConfigurationParameter	= "releaseID"
			if(FSMBODConfigurationParameterRel exists)
				return FSMBODConfigurationParameterRel.Value

		DerivedLogicalID is a DerivedField
			type is Alpha size 60
			restricted
			LocalConfigurationParameter	= "logicalID"
			if(FSMBODConfigurationParameterRel exists)
				return FSMBODConfigurationParameterRel.Value

		DerivedVersionID is a DerivedField
			type is Alpha size 60
			restricted
			LocalConfigurationParameter	= "VersionID"
			if(FSMBODConfigurationParameterRel exists)
				return FSMBODConfigurationParameterRel.Value

		DerivedappProdline is a DerivedField
			type is Alpha size 60
			restricted
			LocalConfigurationParameter	= "appProdline"
			if(FSMBODConfigurationParameterRel exists)
				return FSMBODConfigurationParameterRel.Value

		BODCurrentTimeStamp is a DerivedField
			type is TimeStamp
			restricted
			BODCurrentTimeStamp = system current timestamp
			return BODCurrentTimeStamp

		AlphaCurrentTimeStamp is a DerivedField
			type is Alpha size 20
			restricted
			return BODCurrentTimeStamp

		BODFormattedCurrentTimeStamp is a DerivedField
			type is Alpha size 25
			restricted
			return AlphaCurrentTimeStamp[1:4] + "-" + AlphaCurrentTimeStamp[5:6] + "-" + AlphaCurrentTimeStamp[7:8] + "T" + AlphaCurrentTimeStamp[9:10] + ":" + AlphaCurrentTimeStamp[11:12] + ":" + AlphaCurrentTimeStamp[13:14] + "Z"

		DerivedAllCompanyFlag is a DerivedField
			type is Alpha size 60
			restricted
			LocalConfigurationParameter	= "SupplierPartyMaster_Outbound_AccountingEntity_All"
			if(FSMBODConfigurationParameterRel exists)
				return FSMBODConfigurationParameterRel.Value

		DerivedConfigAccountingEntity is a DerivedField
			type is Alpha size 60
			restricted
			LocalConfigurationParameter	= "SyncSupplierPartyMaster_Outbound_AccountingEntity"
			if(FSMBODConfigurationParameterRel exists)
				return FSMBODConfigurationParameterRel.Value

		Derivedrevision is a DerivedField
			type is AlphaUpper size 4
			restricted
			return ""

		Derivedlocation is a DerivedField
			type is AlphaUpper size 4
			restricted
			return ""

		DerivedFinanceEnterpriseGroup is a DerivedField				
			type is AlphaUpper size 4
			restricted
			return VendorGroup.FinanceEnterpriseGroup

		DerivedBODActionCode is a DerivedField
			type is Alpha size 10
			restricted
			if (action type.Delete or ActionCode.Delete)
				return "Delete"
			else
			if (action type.Create or ActionCode.Create)
				return "Add"
			else
			if (action type.Update or ActionCode.Update)
				return "Replace"
			else
				return ""

		DerivedVariationID is a DerivedField
			type is Alpha 25
			restricted
			return bod id.VariationID
		
		DerivedMultipleFEG is a DerivedField
			type is Alpha size 60
			restricted
			LocalConfigurationParameter	= "IsMultipleFEG"
			if(FSMBODConfigurationParameterRel exists)
				return FSMBODConfigurationParameterRel.Value
					
		DerivedCleanDocumentID is a DerivedField
			type is Alpha size 60
			restricted
			LocalConfigurationParameter	= "RequiredCleanDocumentID"
			if(FSMBODConfigurationParameterRel exists)
				return FSMBODConfigurationParameterRel.Value
		
		DerivedTriggerBODBasedOnCrossReference is a DerivedField
			type is Alpha size 60
			restricted
			LocalConfigurationParameter	= "TriggerBODBasedOnCrossReference"
			if(FSMBODConfigurationParameterRel exists)
				return FSMBODConfigurationParameterRel.Value

		DerivedDocumentID is a DerivedField
			type is AlphaUpper size 30
			restricted
			if(VendorLocation = "")
				if (VendorContact.ContactLevel = "0")
					return Vendor + DerivedDelimiter + VendorContact.VendorContactCode
				else
					return Vendor + DerivedDelimiter +VendorContact.VendorContactCode + DerivedDelimiter + DerivedContactLevel
			else
				if (VendorContact.ContactLevel = "0")
					return Vendor + DerivedDelimiter + VendorLocation + DerivedDelimiter + VendorContact.VendorContactCode
				else
					return Vendor + DerivedDelimiter + VendorLocation + DerivedDelimiter + VendorContact.VendorContactCode + DerivedDelimiter + DerivedContactLevel

		DerivedContactLevel is a DerivedField
			type is AlphaUpper size 3
			restricted
			return VendorContact.ContactLevel using "%d"

		DerivedVendor is a DerivedField
			type is Alpha size 9
			restricted
			return Vendor using "%d"

		DerivedVendorContactCode is a DerivedField
			type is AlphaUpper size 5
			restricted
			return VendorContact.VendorContactCode

		PrimaryContactDisplay is a DerivedField
			type is MessageField
			default label is "VendorContact"
			if (IsPrimaryContact)
				return PrimaryMessage

		DerivedDisplayDelimeter is a DerivedField
			type is Alpha size 5
			restricted
			return "-"

		DerivedDisplayID is a DerivedField
			type is Alpha size 30
			restricted
			if(DerivedCleanDocumentID = "Y")
				if(VendorLocation not entered)
					return DerivedVendorContactCode + DerivedDelimiter + DerivedContactLevel
				else
					return DerivedVendorContactCode + DerivedDelimiter + DerivedContactLevel + DerivedDelimiter + VendorLocation
			else
				if(VendorLocation not entered)
					return DerivedVendorContactCode + DerivedDisplayDelimeter + DerivedContactLevel
				else
					return DerivedVendorContactCode + DerivedDisplayDelimeter + DerivedContactLevel + DerivedDisplayDelimeter + VendorLocation

		DerivedstatusCode is a DerivedField
			type is Alpha size 10
			restricted
			if (action type.Delete or ActionCode = "D")
				return "Deleted"
			else
			if (action type.Create or action type.Update)
				return "Open"
			else
				return ""

		DerivedPInternationalPrefix is a DerivedField
			type is Alpha size 6
			restricted
			return PhoneNumber.InternationalPrefix

		DerivedPSubscriberNumber is a DerivedField
			type is Alpha size 15
			restricted
			return PhoneNumber.SubscriberNumber

		DerivedPExtension is a DerivedField
			type is Alpha size 10
			restricted
			return PhoneNumber.Extension

		DerivedMInternationalPrefix is a DerivedField
			type is Alpha size 6
			restricted
			return MobileNumber.MobilePhoneNumber.InternationalPrefix

		DerivedMSubscriberNumber is a DerivedField
			type is Alpha size 15
			restricted
			return MobileNumber.MobilePhoneNumber.SubscriberNumber

		DerivedMExtension  is a DerivedField
		 	type is Alpha size 10
			restricted
			return MobileNumber.MobilePhoneNumber.Extension

		DerivedFInternationalPrefix is a DerivedField
			type is Alpha size 6
			restricted
			return FaxNumber.InternationalPrefix

		DerivedFSubscriberNumber is a DerivedField
			type is Alpha size 15
			restricted
			return FaxNumber.SubscriberNumber

		DerivedFExtension is a DerivedField
		 	type is Alpha size 10
			restricted
			return FaxNumber.Extension

		DerivedAddressLine1 is a DerivedField
			type is Alpha size 40
			restricted
			return CurrentAddressRel.VendorAddress.PostalAddress.DeliveryAddress.AddressLine1

		DerivedAddressLine2 is a DerivedField
			type is Alpha size 40
			restricted
			return CurrentAddressRel.VendorAddress.PostalAddress.DeliveryAddress.AddressLine2

		DerivedAddressLine3 is a DerivedField
			type is Alpha size 40
			restricted
			return CurrentAddressRel.VendorAddress.PostalAddress.DeliveryAddress.AddressLine3

		DerivedAddressLine4 is a DerivedField
			type is Alpha size 40
			restricted
			return CurrentAddressRel.VendorAddress.PostalAddress.DeliveryAddress.AddressLine4

		DerivedMunicipality is a DerivedField
			type is Alpha size 60
			restricted
			return CurrentAddressRel.VendorAddress.PostalAddress.Municipality

		DerivedStateProvince is a DerivedField
			type is Alpha size 10
			restricted
			return CurrentAddressRel.VendorAddress.PostalAddress.StateProvince

		DerivedCountry is a DerivedField
			type is Alpha size 10
			restricted
			return CurrentAddressRel.VendorAddress.PostalAddress.Country

		DerivedPostalCode is a DerivedField
			type is Alpha 12
			restricted
			return CurrentAddressRel.VendorAddress.PostalAddress.PostalCode

		ContactMasterAPXMLBOD is a DerivedField
			type is XMLDocument
			restricted
			ContactMasterAPXMLBOD = template.IONContactMasterAPXML_ST document for this instance


		PrimaryMessage is a MessageField
			"Primary"
			


		DerivedAddressType is a DerivedField
			type is Alpha size 40
			restricted
			return CurrentAddressRel.VendorAddress.PostalAddress.Type
			
		DerivedAddressTypeText is a DerivedField
			type is Alpha size 20
			restricted
			if(DerivedAddressType = "1")
				return "PostOfficeBox"
			if(DerivedAddressType = "2")
				return "Street"
			if(DerivedAddressType = "3")
				return "Military"
			if(DerivedAddressType = "4")
				return "Undetermined"
			else
				return ""
				
		DerivedProcessBODStatusCode is a DerivedField
			type is Alpha size 10
			restricted
			if (action type.Delete or ActionCode.Delete)
				return "Delete"
			else
			if (action type.Create or ActionCode.Create)
				return "Add"
			else
			if (action type.Update or ActionCode.Update)
				return "Replace"
			else
				return ""
		
		DerivedProcessConfigAccountingEntity is a DerivedField
			type is Alpha size 60
			restricted
			LocalConfigurationParameter	= "ProcessSupplierPartyMaster_Outbound_AccountingEntity"
			if(FSMBODConfigurationParameterRel exists)
				return FSMBODConfigurationParameterRel.Value
					
		ProcessContactMasterAPXMLBOD is a DerivedField
			type is XMLDocument
			restricted
			ProcessContactMasterAPXMLBOD = template.IONProcessContactMasterMainXML_ST document for this instance

	Context Fields
		FSMInboundBODTracker
	Local Fields
		ActionCode							is Alpha size 1
			States
				Create  value is "C"
				Update	value is "U"
				Delete	value is "D"
		LocalTitle 					is Alpha size 255
		LocalTriggerFrom			is Alpha size 100	

		LocalAccountingEntity		is Alpha size 100
		LocalProcessAccountingEntity  is Alpha size 100
		LocalbodID 					is Alpha size 250
		NativeLPLBODTrigger			is Boolean			
		LocalBodAccountingEntity		is AlphaUpper size 12
		LocalCrossAccountingEntity 		is Alpha 40
		LocalBODFormattedID				is Alpha 100
		LocalCleanDocIDAccountingentity 	is Alpha 40
		ContactMasterCleanDocXMLBOD		is XMLDocument
		NewBODTracker  				is a FSMInboundBODTracker view
		LocalFSMInboundBODTracker	is Numeric 15
		Error            			is Boolean
	    ErrorMessage     			is Alpha 300
	    LocalBODTrigger				is Boolean
		LocalBODAE 					is Alpha size 100
		LocalConfigurationParameter	is Alpha size up to 200
		LocalSourceValue			is Alpha 30
		
	Conditions
		HasPrimaryContactForVendor
			restricted
			when (Vendor.PrimeVendorContactRel exists)

		HasPrimaryContactForVendorLocation
			restricted
			when (VendorLocation.PrimeVendorLocationContactRel exists)

		HasVendorLocation
			restricted
			when (VendorLocation entered)

		IsPrimaryContact
			restricted
			when (VendorContact.VendorContactCode = "PRIME")

		HasContactLevel
			restricted
			when (VendorContact.ContactLevel entered)

		IsMainVendorContact
			classic name is MAINVENDOR
			restricted
			when (VendorLocation not entered)

		CurrentAddressExists
			classic name is ADDR-VENDOR
			restricted
			when (CurrentAddressRel exists)

		VendorAddressLine3Entered
			restricted
			when (CurrentAddressRel.PostalAddress.DeliveryAddress.AddressLine3 entered)

		VendorAddressLine4Entered
			restricted
			when (CurrentAddressRel.PostalAddress.DeliveryAddress.AddressLine4 entered)

		AnonymizeLogAnonymizeRelExists
			restricted
			when (first AnonymizeLogAnonymizeRel exists)

		AnonymizeLogPurgeRelExists
			restricted
			when (first AnonymizeLogPurgeRel exists)

		OpenPayablesInvoicesRelExists
			restricted
			when (first OpenPayablesInvoicesRel exists)

		OpenCashLedgerPaymentsRelExists
			restricted
			when (first OpenCashLedgerPaymentsRel exists)

		RecordExists
			restricted
			when (VendorContact exists)

		EmailAddressEntered
			restricted
			when (EmailAddress entered)

		PhoneNumberEntered
			restricted
			when (PhoneNumber.SubscriberNumber entered)

		MobilePhoneNumberEntered
			restricted
			when (MobileNumber.MobilePhoneNumber.SubscriberNumber entered)

		IDMDocumentEmailDistribution
			restricted
			when (EmailCreditMemo			
			or EmailDebitMemo
			or EmailPaymentCheck
			or EmailRemittanceAdvice)			 

		IsValidForActorContext
			restricted
			when (VendorGroup.FinanceEnterpriseGroup = actor.context.FinanceEnterpriseGroup)

	Field Rules
		EmailAddress
			if (IsPrimaryContact
			and IsMainVendorContact)
				if (Vendor.VendorClass.InterfaceVendor)
					required
						"EmailForPrimaryContactIsRequiredIf_Create_Expense_Management_UserIsSelectedOnThe_Vendor_Class"

			if (IsPrimaryContact
			and Vendor.AutomaticEmailingOfCreditMemo)
				required
					"PrimaryContactEmailAddressIsRequiredWhenAutomaticEmailingOfCreditMemoIsEnabledOnVendor"

			
			if (IDMDocumentEmailDistribution)
				required
					"EmailAddressIsRequired.OneOfTheIDMDocumentEmailDistributionOptionsIsTurnedOn"

		EmailCreditMemo
			if (IsPrimaryContact 
			and not OverrideIDMEmailDistribution)
				initialize
	    
	    EmailDebitMemo
			if (IsPrimaryContact
			and not OverrideIDMEmailDistribution)
				initialize	 
				   
	    EmailPaymentCheck
			if (IsPrimaryContact
			and not OverrideIDMEmailDistribution)
				initialize	 
				    
	    EmailRemittanceAdvice
			if (IsPrimaryContact
			and not OverrideIDMEmailDistribution)
				initialize 
			
	Relations
		CurrentAddressRel
			classic name is ADDRESS1
			one-to-one relation to VendorAddress
			Field Mapping uses symbolic key
				related.VendorGroup						= VendorGroup
				related.Vendor							= Vendor
				related.VendorLocation					= VendorLocation
				related.VendorContact.VendorContactCode	= VendorContact.VendorContactCode
				related.VendorContact.ContactLevel		= VendorContact.ContactLevel

		VendorContactsRel
			one-to-many relation to VendorContact
			Field Mapping uses symbolic key
				related.VendorGroup		= VendorGroup
				related.Vendor			= Vendor
				related.VendorLocation	= VendorLocation
			Instance Selection
				where (related.VendorContact.VendorContactCode = VendorContact.VendorContactCode)

		OpenPayablesInvoicesRel
			one-to-many relation to PayablesInvoice
			Field Mapping uses ByVendorGroupVendor
				related.VendorGroup	= VendorGroup.FinanceEnterpriseGroup
				related.Vendor		= Vendor
			Instance Selection
				where (related.IsOpenInvoice)

		OpenCashLedgerPaymentsRel
			one-to-many relation to CashLedgerPayment
			Field Mapping uses Set4
				related.CashManagementGroup		= VendorGroup.FinanceEnterpriseGroup
			Instance Selection
				where (related.PayablesData.PayablesCompany.VendorGroup	= VendorGroup
				and    related.PayablesData.Vendor						= Vendor
				and    related.IsOpenCashLedgerPayment)

		AnonymizeLogAnonymizeRel
			one-to-many relation to AnonymizeLog
			Field Mapping uses ByVendorContact
				related.FinanceEnterpriseGroup	= VendorGroup.FinanceEnterpriseGroup
				related.VendorGroup				= VendorGroup
				related.Vendor					= Vendor
				related.VendorLocation          = VendorLocation
			Instance Selection
				where (related.Status.Anonymized
				and    related.VendorContactCode	= VendorContact.VendorContactCode
				and    related.ContactLevel			= VendorContact.ContactLevel)

		AnonymizeLogPurgeRel
			one-to-many relation to AnonymizeLog
			Field Mapping uses ByVendorContact
				related.FinanceEnterpriseGroup	= VendorGroup.FinanceEnterpriseGroup
				related.VendorGroup				= VendorGroup
				related.Vendor					= Vendor
				related.VendorLocation          = VendorLocation
			Instance Selection
				where (related.Status.AuditLogPurged
				and    related.VendorContactCode	= VendorContact.VendorContactCode
				and    related.ContactLevel			= VendorContact.ContactLevel)

		VendorRel
			one-to-one relation to Vendor
			Field Mapping uses symbolic key
				related.VendorGroup 	= VendorGroup
				related.Vendor      	= Vendor


		FSMBODConfigurationParameterRel
    		one-to-one relation to FSMBODConfigurationParameter
    		Field Mapping uses symbolic key
    			related.FSMBODConfigurationParameter	= LocalConfigurationParameter

		FSMBODConfigurationRel
			one-to-one relation to FSMBODConfiguration
			Field Mapping uses symbolic key
				related.FSMBODConfiguration.Verb 		= 1
				related.FSMBODConfiguration.Noun 		= "ContactMaster"
				related.FSMBODConfiguration.Direction 	= 1

		FSMInboundBODTrackerRel
            one-to-one relation to FSMInboundBODTracker
            Field Mapping uses symbolic key
                related.FSMInboundBODTracker	= LocalFSMInboundBODTracker

		FSMBODGeneralLedgerCompanyRel
	   		one-to-many relation to GeneralLedgerCompany
	   		Field Mapping uses symbolic key
	   		Instance Selection
				where(related.BusinessGroup  = VendorGroup)
				
		FSMBODAECrossReferenceDetailRel
			one-to-many relation to FSMBODCrossReferenceDetail
			Field Mapping uses symbolic key
            	related.FSMBODCrossReference.SourceField 		= "CSFGLC"
            	related.FSMBODCrossReference.DestinationField 	= "DESTAE"
            Instance Selection
				where (related.SourceValue	= LocalCleanDocIDAccountingentity )
				
		FSMCleanDocIDGLCCrossReferenceDetailRel
			one-to-many relation to FSMBODCrossReferenceDetail
			Field Mapping uses symbolic key
				related.FSMBODCrossReference.SourceField 		= "CSFGLC"
				related.FSMBODCrossReference.DestinationField 	= "DESTAE"
				
		FSMCleanDocIDGeneralLedgerCompanyRel
            one-to-one relation to GeneralLedgerCompany
            required
            Field Mapping uses symbolic key
                related.Company = LocalBodAccountingEntity

		FSMBODConfigurationProcessBODRel
			one-to-one relation to FSMBODConfiguration
			Field Mapping uses symbolic key
				related.FSMBODConfiguration.Verb 		= 2
				related.FSMBODConfiguration.Noun 		= "ContactMaster"
				related.FSMBODConfiguration.Direction 	= 1
		
		FSMBODCrossReferenceDetailRel
			one-to-many relation to FSMBODCrossReferenceDetail
			Field Mapping uses symbolic key
            	related.FSMBODCrossReference.SourceField 		= "SourceBusinessGroup"
            	related.FSMBODCrossReference.DestinationField 	= "DestinationAccountingEntity"
            Instance Selection
				where (related.SourceValue	= LocalProcessAccountingEntity)

	Rule Blocks
		TriggerContactMasterAPServiceRules
			increment bod id.VariationID
			trigger "ContactMasterAPService" PA service
				resume on error
				title is "<LocalTitle>"
				Criteria
					VendorGroup.FinanceEnterpriseGroup
				Variables
					ActionCode
					include persistent fields from Vendor
					include persistent fields from VendorContact
					include persistent fields from CurrentAddressRel.VendorAddress
					bod id.VariationID
				  		variable name is VariationId
					VendorGroup.FinanceEnterpriseGroup
						variable name is FinanceEnterpriseGroup

			invoke TriggerProcessContactMaster



	Sets

		Set2
			indexed
			Sort Order
				VendorGroup
				Vendor
				VendorLocation
				VendorContact
				ContactName

		Set3
			indexed
			Instance Selection
				where (IsMainVendorContact)
			Sort Order
				VendorGroup
				Vendor
				VendorContact
				VendorLocation

		Set4
			indexed
			Sort Order
				VendorGroup
				Vendor
				VendorLocation
				VendorContact.VendorContactCode
				VendorContact.ContactLevel descending
		
		ByContactName			
			indexed
			Sort Order
				ContactName
				VendorGroup
				Vendor
				VendorLocation
				VendorContact

	Actions
		Create is a Create Action
			Action Rules
				if (IsPrimaryContact)
					if (HasVendorLocation)
						constraint (!HasPrimaryContactForVendorLocation)
							"CannotCreateAnotherPrimaryContactForLocation"
					else
						constraint (!HasPrimaryContactForVendor)
							"CannotCreateAnotherPrimaryContact"

				if (HasContactLevel)
					constraint (!IsPrimaryContact)
						"PrimaryContactCannotHaveContactLevel"
				else
					if (!IsPrimaryContact
					and VendorContact.ContactLevel not entered)
						VendorContact.ContactLevel = (last VendorContactsRel.VendorContact.ContactLevel + 1)

			Exit Rules
				invoke Create CurrentAddressRel
					invoked.PostalAddress	= VendorAddress
					invoked.effective date	= AddressEffectiveDate
				if(Vendor.bod id.DocumentID entered) 
					invoke TriggerContactMaster






				if (!IsPrimaryContact) 
					invoke TriggerSupplierPartyMaster VendorGroup
						invoked.PrmVendor		= Vendor
						invoked.ActionCode		= ActionCode.Update
						invoked.PrmProcess      = true
						
					if (VendorGroup.FinanceEnterpriseGroup.BODTrigger)
						ActionCode = ActionCode.Create
						if(VendorContact.ContactLevel != "")
							LocalTitle = "EG:"+VendorGroup.FinanceEnterpriseGroup+" VN:"+Vendor+" VL:"+VendorLocation+" VC:"+VendorContact.VendorContactCode+" VCL:"+VendorContact.ContactLevel
						else
							LocalTitle = "EG:"+VendorGroup.FinanceEnterpriseGroup+" VN:"+Vendor+" VL:"+VendorLocation+" VC:"+VendorContact.VendorContactCode
						include TriggerContactMasterAPServiceRules



		FastUpdate is an Update Action
			restricted
			Action Rules
				invoke Update CurrentAddressRel
					invoked.PostalAddress	= VendorAddress
					invoked.effective date	= AddressEffectiveDate


		Update is an Update Action
			Entrance Rules
			Action Rules






			Exit Rules
				if (AddressEffectiveDate = CurrentAddressRel.effective date)
					invoke Update CurrentAddressRel
						invoked.PostalAddress	= VendorAddress
				else
					invoke Create VendorAddress
						invoked.VendorGroup		= VendorGroup
						invoked.Vendor			= Vendor
						invoked.VendorLocation	= VendorLocation
						invoked.VendorContact	= VendorContact
						invoked.effective date	= AddressEffectiveDate
						invoked.PostalAddress	= VendorAddress

				if (IsPrimaryContact)
					if (VendorLocation entered)
						invoke UpdatePrimaryContact VendorLocation
							invoked.PrmContactName		= ContactName
							invoked.PrmPhoneNumber		= PhoneNumber
							invoked.PrmMobileNumber		= MobileNumber
							invoked.PrmFaxNumber		= FaxNumber
							invoked.PrmEmailAddress		= EmailAddress
							invoked.PrmTwitterID		= TwitterID
							invoked.PrmSocialNetworkID2	= SocialNetworkID2
							invoked.PrmSocialNetworkID3	= SocialNetworkID3
							invoked.PrmSocialNetworkID4	= SocialNetworkID4
							invoked.PrmSocialNetworkID5	= SocialNetworkID5
					else
						invoke UpdatePrimaryContact Vendor
							invoked.PrmContactName		= ContactName
							invoked.PrmPhoneNumber		= PhoneNumber
							invoked.PrmMobileNumber		= MobileNumber
							invoked.PrmFaxNumber		= FaxNumber
							invoked.PrmEmailAddress		= EmailAddress
							invoked.PrmTwitterID		= TwitterID
							invoked.PrmSocialNetworkID2	= SocialNetworkID2
							invoked.PrmSocialNetworkID3	= SocialNetworkID3
							invoked.PrmSocialNetworkID4	= SocialNetworkID4
							invoked.PrmSocialNetworkID5	= SocialNetworkID5
				if (!IsPrimaryContact)	
					invoke TriggerSupplierPartyMaster VendorGroup
						invoked.PrmVendor		= Vendor
						invoked.ActionCode		= ActionCode.Update
						invoked.PrmProcess      = true

				if (VendorGroup.FinanceEnterpriseGroup.BODTrigger)
					if (!action type.Delete)
						if (action != "UpdateBODIdFields") 
							if (action type.Update)
								ActionCode = ActionCode.Update
								if(VendorContact.ContactLevel != "")
									LocalTitle = "EG:"+VendorGroup.FinanceEnterpriseGroup+" VN:"+Vendor+" VL:"+VendorLocation+" VC:"+VendorContact.VendorContactCode+" VCL:"+VendorContact.ContactLevel
								else
									LocalTitle = "EG:"+VendorGroup.FinanceEnterpriseGroup+" VN:"+Vendor+" VL:"+VendorLocation+" VC:"+VendorContact.VendorContactCode
								include TriggerContactMasterAPServiceRules




		UpdateBODIdFields is an Instance Action
			restricted
			Parameters
				PrmAccountingEntity  is Alpha size 22
					default label is "AccountingEntity"
				PrmLocation          is Alpha size 22
					default label is "Location"
				PrmDocumentID        is Alpha size 100
					default label is "DocumentID"
				PrmRevision          is Alpha size 22
					default label is "Revision"


				PrmSystemOfRecord    is Alpha size 1
					default label is "SystemOfRecord"
			Action Rules
				if (bod id.AccountingEntity != PrmAccountingEntity)
					bod id.AccountingEntity 	= PrmAccountingEntity
				if (bod id.Location != PrmLocation)
					bod id.Location				= PrmLocation
				if (bod id.DocumentID != PrmDocumentID)
					bod id.DocumentID			= PrmDocumentID
				if (bod id.Revision != PrmRevision)
					bod id.Revision				= PrmRevision
				if (bod id.SystemOfRecord != PrmSystemOfRecord)
					bod id.SystemOfRecord		= PrmSystemOfRecord




		Delete is a Delete Action
			valid when (!IsPrimaryContact)
			Entrance Rules
				constraint (!IsPrimaryContact)
					"CannotDeletePrimaryContact"

				if (VendorGroup.FinanceEnterpriseGroup.BODTrigger)
					ActionCode = ActionCode.Delete
					if(VendorContact.ContactLevel != "")
						LocalTitle = "EG:"+VendorGroup.FinanceEnterpriseGroup+" VN:"+Vendor+" VL:"+VendorLocation+" VC:"+VendorContact.VendorContactCode+" VCL:"+VendorContact.ContactLevel
					else
						LocalTitle = "EG:"+VendorGroup.FinanceEnterpriseGroup+" VN:"+Vendor+" VL:"+VendorLocation+" VC:"+VendorContact.VendorContactCode
					include TriggerContactMasterAPServiceRules



		FastDelete is a Delete Action
			restricted
			Entrance Rules
				invoke DeleteAddress CurrentAddressRel

		Anonymize is an Instance Action	
			restricted
			Parameters
				PrmFromVendor			is Boolean
			Action Rules
				if (!PrmFromVendor)
					constraint (!OpenPayablesInvoicesRelExists)
						"CannotAnonymize;OpenPayableInvoicesExistForVendor"
					constraint (!OpenCashLedgerPaymentsRelExists)
						"CannotAnonymize;OpenCashLedgerPaymentsExistForVendor"

					if (AnonymizeLogAnonymizeRelExists)
						confirmation required
							"Warning,TheAnonymizeActionIsNonReversableAndAnonymizeRecordAlreadyExists;AreYouSureYouWantToContinue?"
						confirmation required
							"ProceedToAnonymizeAgain?"
					else
						confirmation required
							"Warning,TheAnonymizeActionIsNonReversable;AreYouSureYouWantToContinue?"
						confirmation required
							"ProceedToAnonymize?"

				if (CurrentAddressExists)
					invoke Anonymize CurrentAddressRel

				initialize ContactName
				initialize PhoneNumber
				initialize MobileNumber
				initialize FaxNumber
				initialize EmailAddress
				initialize TwitterID
				initialize SocialNetworkID2
				initialize SocialNetworkID3
				initialize SocialNetworkID4
				initialize SocialNetworkID5

			Exit Rules
				invoke Create AnonymizeLog
					invoked.FinanceEnterpriseGroup		= VendorGroup.FinanceEnterpriseGroup
					invoked.Status						= 1
					invoked.AffectedBusinessClass		= "AP3"
					invoked.VendorGroup					= VendorGroup
					invoked.Vendor						= Vendor
					invoked.VendorLocation				= VendorLocation
					invoked.VendorContactCode			= VendorContact.VendorContactCode
					invoked.ContactLevel				= VendorContact.ContactLevel

		PurgeAuditLog is an Instance Action	
			restricted
			Parameters
				PrmFromVendor			is Boolean
			Action Rules
				if (!PrmFromVendor)
					constraint (AnonymizeLogAnonymizeRelExists)
						"CannotPurge;VendorContactMustBeAnonymizedFirst"
					if (AnonymizeLogPurgeRelExists)
						confirmation required
							"Warning,ThePurgeAuditLogActionIsNonReversableAndAnonymizeRecordAlreadyExists;AreYouSureYouWantToContinue?"
						confirmation required
							"ProceedToPurgeAuditLogAgain?"
					else
						confirmation required
							"Warning,ThePurgeAuditLogActionIsNonReversable;AreYouSureYouWantToContinue?"
						confirmation required
							"ProceedToPurgeAuditLog?"

			  	invoke purge audit log entries

		  	Exit Rules
				invoke Create AnonymizeLog
					invoked.FinanceEnterpriseGroup		= VendorGroup.FinanceEnterpriseGroup
					invoked.Status						= 2
					invoked.AffectedBusinessClass		= "AP3"
					invoked.VendorGroup					= VendorGroup
					invoked.Vendor						= Vendor
		  			invoked.VendorLocation				= VendorLocation
					invoked.VendorContactCode			= VendorContact.VendorContactCode
					invoked.ContactLevel				= VendorContact.ContactLevel

		BODDataInitialLoadContactMasterAPCriteria is a Set Action
			restricted
			Parameters
				PrmVendorGroup				is a VendorGroup
				PrmFromVendor				is a Vendor
				PrmToVendor					is a Vendor
				PrmFromContactCode 			is a VendorContactCode
				PrmToContactCode 			is a VendorContactCode

			Parameter Rules
			Instance Selection
				where  (((PrmVendorGroup entered
				and		  PrmVendorGroup = VendorGroup)
				or		  PrmVendorGroup not entered)
				and    ((PrmFromVendor entered
				and		 PrmFromVendor <= Vendor)
				or		 PrmFromVendor not entered)
				and    ((PrmToVendor entered
				and		 PrmToVendor >= Vendor)
				or		 PrmToVendor not entered)
				and    ((PrmFromContactCode entered
				and		 PrmFromContactCode <= VendorContact.VendorContactCode)
				or		 PrmFromContactCode not entered)
				and    ((PrmToContactCode entered
				and		 PrmToContactCode >= VendorContact.VendorContactCode)
				or		 PrmToContactCode not entered))

			Action Rules
				Instance Rules
					if (VendorGroup.FinanceEnterpriseGroup.BODTrigger)
						ActionCode = ActionCode.Create
						if(VendorContact.ContactLevel != "")
							LocalTitle = "EG:"+VendorGroup.FinanceEnterpriseGroup+" VN:"+Vendor+" VL:"+VendorLocation+" VC:"+VendorContact.VendorContactCode+" VCL:"+VendorContact.ContactLevel
						else
							LocalTitle = "EG:"+VendorGroup.FinanceEnterpriseGroup+" VN:"+Vendor+" VL:"+VendorLocation+" VC:"+VendorContact.VendorContactCode
						include TriggerContactMasterAPServiceRules



		TriggerContactMaster is an Instance Action
			restricted
			Parameters
				PrmActionCode		is Alpha size 1
			Action Rules
				ActionCode = ActionCode.Create
				if(VendorContact.ContactLevel != "")
					LocalTitle = "EG:"+VendorGroup.FinanceEnterpriseGroup+" VN:"+Vendor+" VL:"+VendorLocation+" VC:"+VendorContact.VendorContactCode+" VCL:"+VendorContact.ContactLevel
				else
					LocalTitle = "EG:"+VendorGroup.FinanceEnterpriseGroup+" VN:"+Vendor+" VL:"+VendorLocation+" VC:"+VendorContact.VendorContactCode
				include TriggerContactMasterAPServiceRules

		TriggerContactMasterNativeLPL is an Instance Action
			default label is untranslatable
			restricted
			Parameters
			Action Rules
				invoke TriggerContactMasterAPNativeLPLBOD


		TriggerProcessContactMaster is an Instance Action
			restricted
			Parameters
			Action Rules
				LocalTitle = "Process:EG:"+VendorGroup.FinanceEnterpriseGroup+" CO:"+Vendor+" VC:"+VendorContact
				trigger "ProcessContactMasterAPService" PA service
					resume on error
					title is "<LocalTitle>"
					Criteria
						VendorGroup.FinanceEnterpriseGroup
					Variables
						ActionCode
						include persistent fields from Vendor
						include persistent fields from VendorContact
						include persistent fields from CurrentAddressRel.VendorAddress
						bod id.VariationID
							variable name is VariationId
						VendorGroup.FinanceEnterpriseGroup
							variable name is FinanceEnterpriseGroup






		SendContactMasterAPNativeLPLBOD is an Instance Action
			restricted
			Entrance Rules
			Action Rules
				if(DerivedCleanDocumentID = "Y")
					send ion bod
						bod is ContactMasterCleanDocXMLBOD
						bod type is "Sync.ContactMaster"
						accounting entity is LocalCrossAccountingEntity
						document id is DerivedDocumentID
						variation id is DerivedVariationID
				else
					send ion bod
						bod is ContactMasterAPXMLBOD
						bod type is "Sync.ContactMaster"
						accounting entity is LocalAccountingEntity
						document id is DerivedDocumentID
						variation id is DerivedVariationID

		TriggerContactMasterAPNativeLPLBOD is an Instance Action 
			default label is untranslatable
			restricted
			Entrance Rules
			Parameters
				PrmTriggerFrom is Alpha size 100
				RestartFlag is Boolean
			Action Rules
				LocalTriggerFrom   			 = PrmTriggerFrom
				invoke NativeLPLBODTriggerChecks FSMBODConfigurationRel
					invoked.PrmVerb 					= 1
					invoked.PrmNoun						= "ContactMaster"
					invoked.PrmDirection				= 1
					invoked.PrmTriggerFrom				= LocalTriggerFrom
					invoked.PrmFinanceEnterpriseGroup	= VendorGroup.FinanceEnterpriseGroup
					invoked.PrmBusinessGroup 			= VendorGroup
					invoked.PrmMainUserTemplate 		= "IONContactMasterAPXML_ST"
				NativeLPLBODTrigger = FSMBODConfigurationRel.NativeLPLBODTrigger
				if(VendorGroup.FinanceEnterpriseGroup.BODTrigger and NativeLPLBODTrigger)
					if(DerivedCleanDocumentID = "Y")
						if(RestartFlag)
							if (FSMBODGeneralLedgerCompanyRel exists)
								initialize LocalBodAccountingEntity
								initialize LocalCleanDocIDAccountingentity
								initialize ContactMasterCleanDocXMLBOD
								initialize LocalCrossAccountingEntity
								initialize LocalBODFormattedID
								LocalBodAccountingEntity = FSMInboundBODTracker.Reference5
								if(DerivedMultipleFEG = "Y")
									LocalCleanDocIDAccountingentity = DerivedFinanceEnterpriseGroup + DerivedDelimiter + LocalBodAccountingEntity
								else
									LocalCleanDocIDAccountingentity = LocalBodAccountingEntity
								if(DerivedTriggerBODBasedOnCrossReference = "Y")
									if (FSMBODAECrossReferenceDetailRel.DestinationValue entered)
										LocalCrossAccountingEntity = FSMBODAECrossReferenceDetailRel.DestinationValue
								else								
									LocalCrossAccountingEntity = LocalCleanDocIDAccountingentity
								if(LocalCrossAccountingEntity entered)
									LocalFSMInboundBODTracker		= FSMInboundBODTracker
									invoke Update FSMInboundBODTrackerRel
										invoked.FinanceEnterpriseGroup	= DerivedFinanceEnterpriseGroup
										invoked.BODDocumentID			= DerivedDocumentID
										invoked.BODVariationID			= DerivedVariationID
										invoked.BODID					= LocalBODFormattedID
										invoked.Status					= 1
										invoked.StartDate				= system current timestamp
										invoked.Direction				= 1
										invoked.BODAccountingEntity		= LocalCrossAccountingEntity
										invoked.Vendor					= Vendor
										invoked.BODLocation				= VendorLocation
										invoked.Reference1				= VendorGroup
										invoked.Reference2				= VendorContact.VendorContactCode
										invoked.Reference3				= VendorContact.ContactLevel
										invoked.Reference4				= LocalTriggerFrom
										invoked.Reference5				= LocalBodAccountingEntity
										initialize invoked.Error			
										initialize invoked.ErrorMessage
									LocalBODFormattedID = "infor-nid:"+DerivedTenantID+":"+ LocalCrossAccountingEntity +":"+Derivedlocation+":"+DerivedDocumentID+":"+Derivedrevision+"?ContactMaster&verb=Sync&TrackerID="+ LocalFSMInboundBODTracker
									ContactMasterCleanDocXMLBOD = template.IONContactMasterAPXML_CleanDoc_ST document for this instance
									invoke SendContactMasterAPNativeLPLBOD
										resume on error
											Error            							= true
											ErrorMessage     							= error message
									if(Error)
										invoke Update FSMInboundBODTrackerRel
											invoked.Error 								= Error
											invoked.ErrorMessage 						= ErrorMessage
											invoked.Status								= 2
											invoked.CloseDate							= system current timestamp
											invoked.BODID								= LocalBODFormattedID
											invoked.BODXML								= ContactMasterCleanDocXMLBOD
									else
										invoke Update FSMInboundBODTrackerRel
											invoked.Status									= 3
											invoked.CloseDate								= system current timestamp
											invoked.BODID									= LocalBODFormattedID
											invoked.BODXML									= ContactMasterCleanDocXMLBOD
						else
						if(DerivedTriggerBODBasedOnCrossReference = "Y")
							if(FSMCleanDocIDGLCCrossReferenceDetailRel exists)
								for each FSMCleanDocIDGLCCrossReferenceDetailRel
									initialize LocalSourceValue
									initialize LocalCrossAccountingEntity
									initialize LocalBODFormattedID
									initialize ContactMasterCleanDocXMLBOD
									LocalSourceValue = each.SourceValue
									if (LocalSourceValue entered)
										for each LocalSourceValue split on "<DerivedDelimiter>"
											initialize LocalBodAccountingEntity
											LocalBodAccountingEntity = each
									if(FSMCleanDocIDGeneralLedgerCompanyRel exists)
										LocalCrossAccountingEntity = each.DestinationValue
										if(LocalCrossAccountingEntity entered)
											if(FSMInboundBODTracker not entered)
												invoke Create FSMInboundBODTracker
													assign result to NewBODTracker
													invoked.Verb 					= 1
													invoked.Noun 					= "ContactMaster"					
													invoked.BODDocumentID			= DerivedDocumentID
													invoked.BODVariationID			= DerivedVariationID
													invoked.Status					= 1
													invoked.StartDate				= system current timestamp
													invoked.FinanceEnterpriseGroup	= DerivedFinanceEnterpriseGroup
													invoked.Direction				= 1
													invoked.BODAccountingEntity		= LocalCrossAccountingEntity
													invoked.Vendor					= Vendor
													invoked.BODLocation				= VendorLocation
													invoked.Reference1				= VendorGroup
													invoked.Reference2				= VendorContact.VendorContactCode
													invoked.Reference3				= VendorContact.ContactLevel
													invoked.Reference4				= LocalTriggerFrom
													invoked.Reference5				= LocalBodAccountingEntity
													initialize invoked.Error			
													initialize invoked.ErrorMessage					
												LocalFSMInboundBODTracker	= NewBODTracker.FSMInboundBODTracker
											LocalBODFormattedID = "infor-nid:"+DerivedTenantID+":"+ LocalCrossAccountingEntity +":"+Derivedlocation+":"+DerivedDocumentID+":"+Derivedrevision+"?ContactMaster&verb=Sync&TrackerID="+ LocalFSMInboundBODTracker
											ContactMasterCleanDocXMLBOD = template.IONContactMasterAPXML_CleanDoc_ST document for this instance
											invoke SendContactMasterAPNativeLPLBOD
												resume on error
													Error            							= true
													ErrorMessage     							= error message
											if(Error)
												invoke Update FSMInboundBODTrackerRel
													invoked.Error 								= Error
													invoked.ErrorMessage 						= ErrorMessage
													invoked.Status								= 2
													invoked.CloseDate							= system current timestamp
													invoked.BODID								= LocalBODFormattedID
													invoked.BODXML								= ContactMasterCleanDocXMLBOD
											else
												invoke Update FSMInboundBODTrackerRel
													invoked.Status									= 3
													invoked.CloseDate								= system current timestamp
													invoked.BODID									= LocalBODFormattedID
													invoked.BODXML									= ContactMasterCleanDocXMLBOD	
						else
						if(DerivedTriggerBODBasedOnCrossReference = "N")	
							if (FSMBODGeneralLedgerCompanyRel exist)
								for each FSMBODGeneralLedgerCompanyRel
									initialize LocalBodAccountingEntity
									initialize LocalCrossAccountingEntity
									initialize ContactMasterCleanDocXMLBOD
									initialize LocalBODFormattedID
									LocalBodAccountingEntity = each.Company
									if(DerivedMultipleFEG = "Y")
										LocalCrossAccountingEntity = DerivedFinanceEnterpriseGroup + DerivedDelimiter + LocalBodAccountingEntity
									else
										LocalCrossAccountingEntity = LocalBodAccountingEntity
									if(LocalCrossAccountingEntity entered)
										if(FSMInboundBODTracker not entered)
											invoke Create FSMInboundBODTracker
												assign result to NewBODTracker
												invoked.Verb 					= 1
												invoked.Noun 					= "ContactMaster"					
												invoked.BODDocumentID			= DerivedDocumentID
												invoked.BODVariationID			= DerivedVariationID
												invoked.Status					= 1
												invoked.StartDate				= system current timestamp
												invoked.FinanceEnterpriseGroup	= DerivedFinanceEnterpriseGroup
												invoked.Direction				= 1
												invoked.BODAccountingEntity		= LocalCrossAccountingEntity
												invoked.Vendor					= Vendor
												invoked.BODLocation				= VendorLocation
												invoked.Reference1				= VendorGroup
												invoked.Reference2				= VendorContact.VendorContactCode
												invoked.Reference3				= VendorContact.ContactLevel
												invoked.Reference4				= LocalTriggerFrom
												invoked.Reference5				= LocalBodAccountingEntity
												initialize invoked.Error			
												initialize invoked.ErrorMessage					
											LocalFSMInboundBODTracker	= NewBODTracker.FSMInboundBODTracker
										LocalBODFormattedID = "infor-nid:"+DerivedTenantID+":"+ LocalCrossAccountingEntity +":"+Derivedlocation+":"+DerivedDocumentID+":"+Derivedrevision+"?ContactMaster&verb=Sync&TrackerID="+ LocalFSMInboundBODTracker
										ContactMasterCleanDocXMLBOD = template.IONContactMasterAPXML_CleanDoc_ST document for this instance
										invoke SendContactMasterAPNativeLPLBOD
											resume on error
												Error            							= true
												ErrorMessage     							= error message
										if(Error)
											invoke Update FSMInboundBODTrackerRel
												invoked.Error 								= Error
												invoked.ErrorMessage 						= ErrorMessage
												invoked.Status								= 2
												invoked.CloseDate							= system current timestamp
												invoked.BODID								= LocalBODFormattedID
												invoked.BODXML								= ContactMasterCleanDocXMLBOD
										else
											invoke Update FSMInboundBODTrackerRel
												invoked.Status									= 3
												invoked.CloseDate								= system current timestamp
												invoked.BODID									= LocalBODFormattedID
												invoked.BODXML									= ContactMasterCleanDocXMLBOD	
					else
					if(DerivedAllCompanyFlag = "Y")  
						if(RestartFlag)
							if(FSMBODGeneralLedgerCompanyRel exists)
								LocalAccountingEntity = FSMInboundBODTracker.BODAccountingEntity
								if(LocalAccountingEntity entered)
									LocalFSMInboundBODTracker		= FSMInboundBODTracker
									invoke Update FSMInboundBODTrackerRel
										invoked.FinanceEnterpriseGroup	= DerivedFinanceEnterpriseGroup
										invoked.BODDocumentID			= DerivedDocumentID
										invoked.BODVariationID			= DerivedVariationID
										invoked.Status					= 1
										invoked.StartDate				= system current timestamp
										invoked.Direction				= 1
										invoked.BODAccountingEntity		= LocalAccountingEntity
										invoked.Vendor					= Vendor
										invoked.BODLocation				= VendorLocation
										invoked.Reference1				= VendorGroup
										invoked.Reference2				= VendorContact.VendorContactCode
										invoked.Reference3				= VendorContact.ContactLevel
										invoked.Reference4				= LocalTriggerFrom
										initialize invoked.Error			
										initialize invoked.ErrorMessage
									LocalbodID = "infor-nid:"+DerivedTenantID+":"+ LocalAccountingEntity+":"+Derivedlocation+":"+DerivedDocumentID+":"+Derivedrevision+"?ContactMaster&verb=Sync&TrackerID="+ LocalFSMInboundBODTracker
									invoke SendContactMasterAPNativeLPLBOD
										resume on error
											Error            							= true
											ErrorMessage     							= error message
									if(Error)
										invoke Update FSMInboundBODTrackerRel
											invoked.Error 								= Error
											invoked.ErrorMessage 						= ErrorMessage
											invoked.Status								= 2
											invoked.CloseDate							= system current timestamp
											invoked.BODID								= LocalbodID
											invoked.BODXML								= ContactMasterAPXMLBOD
									else
										invoke Update FSMInboundBODTrackerRel
											invoked.Status									= 3
											invoked.CloseDate								= system current timestamp
											invoked.BODID									= LocalbodID
											invoked.BODXML									= ContactMasterAPXMLBOD
						else
							if(FSMBODGeneralLedgerCompanyRel exists)
								for each FSMBODGeneralLedgerCompanyRel
									LocalAccountingEntity = DerivedFinanceEnterpriseGroup + DerivedDelimiter + each.AccountingEntity
									if(LocalAccountingEntity entered)
										if(FSMInboundBODTracker not entered)
											invoke Create FSMInboundBODTracker
												assign result to NewBODTracker
												invoked.Verb 					= 1
												invoked.Noun 					= "ContactMaster"					
												invoked.BODDocumentID			= DerivedDocumentID
												invoked.BODVariationID			= DerivedVariationID
												invoked.Status					= 1
												invoked.StartDate				= system current timestamp
												invoked.FinanceEnterpriseGroup	= DerivedFinanceEnterpriseGroup
												invoked.Direction				= 1
												invoked.BODAccountingEntity		= LocalAccountingEntity
												invoked.Vendor					= Vendor
												invoked.BODLocation				= VendorLocation
												invoked.Reference1				= VendorGroup
												invoked.Reference2				= VendorContact.VendorContactCode
												invoked.Reference3				= VendorContact.ContactLevel
												invoked.Reference4				= LocalTriggerFrom
												initialize invoked.Error			
												initialize invoked.ErrorMessage					
											LocalFSMInboundBODTracker	= NewBODTracker.FSMInboundBODTracker
										LocalbodID = "infor-nid:"+DerivedTenantID+":"+ LocalAccountingEntity+":"+Derivedlocation+":"+DerivedDocumentID+":"+Derivedrevision+"?ContactMaster&verb=Sync&TrackerID="+ LocalFSMInboundBODTracker
										invoke SendContactMasterAPNativeLPLBOD
											resume on error
												Error            							= true
												ErrorMessage     							= error message
										if(Error)
											invoke Update FSMInboundBODTrackerRel
												invoked.Error 								= Error
												invoked.ErrorMessage 						= ErrorMessage
												invoked.Status								= 2
												invoked.CloseDate							= system current timestamp
												invoked.BODID								= LocalbodID
												invoked.BODXML								= ContactMasterAPXMLBOD
										else
											invoke Update FSMInboundBODTrackerRel
												invoked.Status									= 3
												invoked.CloseDate								= system current timestamp
												invoked.BODID									= LocalbodID
												invoked.BODXML									= ContactMasterAPXMLBOD	
					else
						if(DerivedConfigAccountingEntity entered)
							LocalAccountingEntity = DerivedFinanceEnterpriseGroup + DerivedDelimiter + DerivedConfigAccountingEntity
						else
							LocalAccountingEntity = DerivedFinanceEnterpriseGroup + DerivedDelimiter + VendorGroup
														
						if(FSMInboundBODTracker not entered)
							invoke Create FSMInboundBODTracker
								assign result to NewBODTracker
								invoked.Verb 					= 1
								invoked.Noun 					= "ContactMaster"					
								invoked.BODDocumentID			= DerivedDocumentID
								invoked.BODVariationID			= DerivedVariationID
								invoked.Status					= 1
								invoked.StartDate				= system current timestamp
								invoked.FinanceEnterpriseGroup	= DerivedFinanceEnterpriseGroup
								invoked.Direction				= 1
								invoked.BODAccountingEntity		= LocalAccountingEntity
								invoked.Vendor					= Vendor
								invoked.BODLocation				= VendorLocation
								invoked.Reference1				= VendorGroup
								invoked.Reference2				= VendorContact.VendorContactCode
								invoked.Reference3				= VendorContact.ContactLevel
								invoked.Reference4				= LocalTriggerFrom
								initialize invoked.Error			
								initialize invoked.ErrorMessage					
							LocalFSMInboundBODTracker	= NewBODTracker.FSMInboundBODTracker
							LocalbodID = "infor-nid:"+DerivedTenantID+":"+ LocalAccountingEntity+":"+Derivedlocation+":"+DerivedDocumentID+":"+Derivedrevision+"?ContactMaster&verb=Sync&TrackerID="+ LocalFSMInboundBODTracker
						else 
							LocalFSMInboundBODTracker		= FSMInboundBODTracker
							invoke Update FSMInboundBODTrackerRel
								invoked.BODDocumentID			= DerivedDocumentID
								invoked.BODVariationID			= DerivedVariationID
								invoked.Status					= 1
								invoked.StartDate				= system current timestamp
								invoked.FinanceEnterpriseGroup	= DerivedFinanceEnterpriseGroup
								invoked.Direction				= 1
								invoked.BODAccountingEntity		= LocalAccountingEntity
								invoked.Vendor					= Vendor
								invoked.BODLocation				= VendorLocation
								invoked.Reference1				= VendorGroup
								invoked.Reference2				= VendorContact.VendorContactCode
								invoked.Reference3				= VendorContact.ContactLevel
								invoked.Reference4				= LocalTriggerFrom
								initialize invoked.Error			
								initialize invoked.ErrorMessage
							LocalbodID = "infor-nid:"+DerivedTenantID+":"+ LocalAccountingEntity+":"+Derivedlocation+":"+DerivedDocumentID+":"+Derivedrevision+"?ContactMaster&verb=Sync&TrackerID="+ LocalFSMInboundBODTracker
						invoke SendContactMasterAPNativeLPLBOD
							resume on error
								Error            							= true
								ErrorMessage     							= error message
						if(Error)
							invoke Update FSMInboundBODTrackerRel
								invoked.Error 								= Error
								invoked.ErrorMessage 						= ErrorMessage
								invoked.Status								= 2
								invoked.CloseDate							= system current timestamp
								invoked.BODID									= LocalbodID
								invoked.BODXML									= ContactMasterAPXMLBOD
						else
							invoke Update FSMInboundBODTrackerRel
								invoked.Status									= 3
								invoked.CloseDate								= system current timestamp
								invoked.BODID									= LocalbodID
								invoked.BODXML									= ContactMasterAPXMLBOD

					

		SendProcessContactMasterNativeLPLBOD is an Instance Action
			restricted
			Entrance Rules
			Action Rules
				send ion bod
					bod is ProcessContactMasterAPXMLBOD
					bod type is "Process.ContactMaster"
					accounting entity is LocalProcessAccountingEntity
					document id is DerivedDocumentID
					variation id is DerivedVariationID	

		TriggerProcessContactMasterNativeLPLBOD is an Instance Action
			default label is untranslatable
			restricted
			Entrance Rules
			Parameters
				RestartFlag is Boolean
			Action Rules
				invoke NativeLPLBODTriggerChecks FSMBODConfigurationProcessBODRel
					invoked.PrmVerb 					= 2
					invoked.PrmNoun						= "ContactMaster"
					invoked.PrmDirection				= 1
					invoked.PrmTriggerFrom				= "VendorContact"
					invoked.PrmFinanceEnterpriseGroup	= VendorGroup.FinanceEnterpriseGroup
					invoked.PrmBusinessGroup 			= VendorGroup
					invoked.PrmMainUserTemplate 		= "IONProcessContactMasterMainXML_ST" 
				NativeLPLBODTrigger = FSMBODConfigurationProcessBODRel.NativeLPLBODTrigger
				LocalBODTrigger = true
				if(VendorGroup.FinanceEnterpriseGroup.BODTrigger and NativeLPLBODTrigger)
					if(DerivedAllCompanyFlag = "Y")
						if(RestartFlag)
							if(FSMBODGeneralLedgerCompanyRel exists)
								initialize LocalBODAE
								LocalBODAE = FSMInboundBODTracker.Reference4
								LocalProcessAccountingEntity = DerivedFinanceEnterpriseGroup + DerivedDelimiter + LocalBODAE
								if( DerivedProcessConfigAccountingEntity entered)
									LocalProcessAccountingEntity= DerivedProcessConfigAccountingEntity
								else
									LocalProcessAccountingEntity= VendorGroup
								if (FSMBODCrossReferenceDetailRel.DestinationValue entered)
									LocalProcessAccountingEntity = FSMBODCrossReferenceDetailRel.DestinationValue
								
								if(LocalProcessAccountingEntity entered)
									LocalFSMInboundBODTracker		= FSMInboundBODTracker
									invoke Update FSMInboundBODTrackerRel
										invoked.FinanceEnterpriseGroup	= DerivedFinanceEnterpriseGroup
										invoked.BODDocumentID			= DerivedDocumentID
										invoked.BODVariationID			= DerivedVariationID
										invoked.Status					= 1
										invoked.StartDate				= system current timestamp
										invoked.Direction				= 1
										invoked.BODAccountingEntity		= LocalProcessAccountingEntity
										invoked.Vendor					= Vendor
										invoked.BODLocation				= VendorLocation
										invoked.Reference1				= VendorGroup
										invoked.Reference2				= VendorContact.VendorContactCode
										invoked.Reference3				= VendorContact.ContactLevel
										invoked.Reference4				= LocalBODAE 	
										initialize invoked.Error			
										initialize invoked.ErrorMessage
									LocalbodID = "infor-nid:"+DerivedTenantID+":"+ LocalProcessAccountingEntity+":"+Derivedlocation+":"+VendorContact.VendorContactCode+":"+Derivedrevision+"?ContactMaster&verb=Process&TrackerID="+ LocalFSMInboundBODTracker
									invoke SendProcessContactMasterNativeLPLBOD
										resume on error
											Error            							= true
											ErrorMessage     							= error message
									if(Error)
										invoke Update FSMInboundBODTrackerRel
											invoked.Error 								= Error
											invoked.ErrorMessage 						= ErrorMessage
											invoked.Status								= 2
											invoked.CloseDate							= system current timestamp
											invoked.BODID								= LocalbodID
											invoked.BODXML								= ProcessContactMasterAPXMLBOD
									else
										invoke Update FSMInboundBODTrackerRel
											invoked.Status									= 3
											invoked.CloseDate								= system current timestamp
											invoked.BODID									= LocalbodID
											invoked.BODXML									= ProcessContactMasterAPXMLBOD
						else
							if(FSMBODGeneralLedgerCompanyRel exists)
								for each FSMBODGeneralLedgerCompanyRel
									initialize LocalBODAE
									LocalBODAE	= each.AccountingEntity
									LocalProcessAccountingEntity = DerivedFinanceEnterpriseGroup + DerivedDelimiter + LocalBODAE
									if( DerivedProcessConfigAccountingEntity entered)
										LocalProcessAccountingEntity= DerivedProcessConfigAccountingEntity
									else
										LocalProcessAccountingEntity= VendorGroup
									if (FSMBODCrossReferenceDetailRel.DestinationValue entered)
										LocalProcessAccountingEntity = FSMBODCrossReferenceDetailRel.DestinationValue
									
									if(LocalProcessAccountingEntity entered)
										if(FSMInboundBODTracker not entered)
											invoke Create FSMInboundBODTracker
												assign result to NewBODTracker
												invoked.Verb 					= 2
												invoked.Noun 					= "ContactMaster"					
												invoked.BODDocumentID			= DerivedDocumentID
												invoked.BODVariationID			= DerivedVariationID
												invoked.Status					= 1
												invoked.StartDate				= system current timestamp
												invoked.FinanceEnterpriseGroup	= DerivedFinanceEnterpriseGroup
												invoked.Direction				= 1
												invoked.BODAccountingEntity		= LocalProcessAccountingEntity
												invoked.Vendor					= Vendor
												invoked.BODLocation				= VendorLocation
												invoked.Reference1				= VendorGroup
												invoked.Reference2				= VendorContact.VendorContactCode
												invoked.Reference3				= VendorContact.ContactLevel
												invoked.Reference4				= LocalBODAE 
												
												initialize invoked.Error			
												initialize invoked.ErrorMessage					
											LocalFSMInboundBODTracker	= NewBODTracker.FSMInboundBODTracker
										LocalbodID = "infor-nid:"+DerivedTenantID+":"+ LocalProcessAccountingEntity+":"+Derivedlocation+":"+VendorContact.VendorContactCode+":"+Derivedrevision+"?ContactMaster&verb=Process&TrackerID="+ LocalFSMInboundBODTracker
										invoke SendProcessContactMasterNativeLPLBOD
											resume on error
												Error            							= true
												ErrorMessage     							= error message
										if(Error)
											invoke Update FSMInboundBODTrackerRel
												invoked.Error 								= Error
												invoked.ErrorMessage 						= ErrorMessage
												invoked.Status								= 2
												invoked.CloseDate							= system current timestamp
												invoked.BODID								= LocalbodID
												invoked.BODXML								= ProcessContactMasterAPXMLBOD
										else
											invoke Update FSMInboundBODTrackerRel
												invoked.Status									= 3
												invoked.CloseDate								= system current timestamp
												invoked.BODID									= LocalbodID
												invoked.BODXML									= ProcessContactMasterAPXMLBOD
						
	
					else
						if(DerivedProcessConfigAccountingEntity entered)
							LocalProcessAccountingEntity = DerivedFinanceEnterpriseGroup + DerivedDelimiter + DerivedProcessConfigAccountingEntity
							
						else
							LocalProcessAccountingEntity = DerivedFinanceEnterpriseGroup + DerivedDelimiter + VendorGroup
							
							if( DerivedProcessConfigAccountingEntity entered)
								LocalProcessAccountingEntity= DerivedProcessConfigAccountingEntity
							else
								LocalProcessAccountingEntity= VendorGroup
							if (FSMBODCrossReferenceDetailRel.DestinationValue entered)
								LocalProcessAccountingEntity = FSMBODCrossReferenceDetailRel.DestinationValue						
						if(FSMInboundBODTracker not entered)
							invoke Create FSMInboundBODTracker
								assign result to NewBODTracker
								invoked.Verb 					= 2
								invoked.Noun 					= "ContactMaster"					
								invoked.BODDocumentID			= DerivedDocumentID
								invoked.BODVariationID			= DerivedVariationID
								invoked.Status					= 1
								invoked.StartDate				= system current timestamp
								invoked.FinanceEnterpriseGroup	= DerivedFinanceEnterpriseGroup
								invoked.Direction				= 1
								invoked.BODAccountingEntity		= LocalProcessAccountingEntity
								invoked.Vendor					= Vendor
								invoked.BODLocation				= VendorLocation
								invoked.Reference1				= VendorGroup
								invoked.Reference2				= VendorContact.VendorContactCode
								invoked.Reference3				= VendorContact.ContactLevel								
								initialize invoked.Error			
								initialize invoked.ErrorMessage			
										
							LocalFSMInboundBODTracker	= NewBODTracker.FSMInboundBODTracker
							LocalbodID = "infor-nid:"+DerivedTenantID+":"+ LocalProcessAccountingEntity+":"+Derivedlocation+":"+VendorContact.VendorContactCode+":"+Derivedrevision+"?ContactMaster&verb=Process&TrackerID="+ LocalFSMInboundBODTracker
						else 
							LocalFSMInboundBODTracker		= FSMInboundBODTracker
							invoke Update FSMInboundBODTrackerRel
								invoked.BODDocumentID			= DerivedDocumentID
								invoked.BODVariationID			= DerivedVariationID
								invoked.Status					= 1
								invoked.StartDate				= system current timestamp
								invoked.FinanceEnterpriseGroup	= DerivedFinanceEnterpriseGroup
								invoked.Direction				= 1
								invoked.BODAccountingEntity		= LocalProcessAccountingEntity
								invoked.Vendor					= Vendor
								invoked.BODLocation				= VendorLocation
								invoked.Reference1				= VendorGroup
								invoked.Reference2				= VendorContact.VendorContactCode
								invoked.Reference3				= VendorContact.ContactLevel				
								initialize invoked.Error			
								initialize invoked.ErrorMessage
							LocalbodID = "infor-nid:"+DerivedTenantID+":"+ LocalProcessAccountingEntity+":"+Derivedlocation+":"+VendorContact.VendorContactCode+":"+Derivedrevision+"?ContactMaster&verb=Process&TrackerID="+ LocalFSMInboundBODTracker
						invoke SendProcessContactMasterNativeLPLBOD
							resume on error
								Error            							= true
								ErrorMessage     							= error message
						if(Error)
							invoke Update FSMInboundBODTrackerRel
								invoked.Error 								= Error
								invoked.ErrorMessage 						= ErrorMessage
								invoked.Status								= 2
								invoked.CloseDate							= system current timestamp
								invoked.BODID									= LocalbodID
								invoked.BODXML									= ProcessContactMasterAPXMLBOD
						else
							invoke Update FSMInboundBODTrackerRel
								invoked.Status									= 3
								invoked.CloseDate								= system current timestamp
								invoked.BODID									= LocalbodID
								invoked.BODXML									= ProcessContactMasterAPXMLBOD

					




































































		
		Purge is a Purge Action
    		restricted
