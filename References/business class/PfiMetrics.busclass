PfiMetrics is a BusinessClass
    owned by pfi
    prefix is PfiMT
    default label is "Metrics"
	disable data area copy

    Ontology
        symbolic key is PfiMetrics

    Patterns
        implements CRUD
        disable AsOfDateProcessing
        disable Auditing
        disable EffectiveDated
        implements IncrementalReplication
            indicator field is IsReplicated
                replicate when false
                    then set to true

    Persistent Fields

        ActionDate         is TimeStamp
        ActionTaken        is a PfiActionTaken
        Comment            is a PfiComment
        Message            is Text
        AuthenticatedActor is an Actor
            as of current date
        IsReplicated is Boolean
            default label is untranslatable

    Conditions

        IsMyAction
	        default label is "ActionAssignedToMe"
            when (PfiMetrics.PfiUserProfile = actor)

    Derived Fields

        AuthActor is a DerivedField
            type is Actor
			default label is "AuthenticatedActor"
            if (AuthenticatedActor entered)
                return AuthenticatedActor
            else
                return PfiMetrics.PfiUserProfile

        AuthFirstNameAndLastNameOrActor is a DerivedField
            type is Alpha size 101
			default label is "AuthenticatedFirstNameAndLastNameOrActor"

            if (AuthenticatedActor entered)
                return AuthenticatedActor.FirstNameAndLastNameOrActor
            else
                return PfiMetrics.PfiUserProfile.FirstNameAndLastNameOrActor

        ElapsedTime is a DerivedField
            type is Decimal 10.0
            if (ActionDate != blank)
                return current timestamp - ActionDate

        ElapsedTimeAsString is a NativeField
            type is Alpha size 25

        HasProcessIndicator is a DerivedField
            type is Boolean
            default label is "ProcessIndicator"
            if (PfiProcessIndicatorRel exists)
                return true
            return false

    Relations

        PfiProcessIndicatorRel
            one-to-one relation to PfiProcessIndicator
            Field Mapping uses symbolic key
                related.PfiProcessIndicator = PfiWorkunit

    Sets

        ByWorkunitActionDateActivityUserProfileTaskQueueAssignment
            sql name is PfiMT01
            indexed
            Sort Order
                PfiWorkunit
                ActionDate
                PfiActivity
                PfiMetrics.PfiUserProfile
                PfiMetrics.PfiTask.TaskName
                PfiMetrics.PfiTask.TaskType
                PfiQueueAssignment

        ByUserProfileTaskWorkunitActivityQueueAssignment
            sql name is PfiMT02
            indexed
            Sort Order
                PfiMetrics.PfiUserProfile
                PfiMetrics.PfiTask.TaskName
                PfiMetrics.PfiTask.TaskType
                PfiWorkunit
                PfiActivity
                PfiQueueAssignment

        ByWorkunitActivityQueueAssignmentActionTakenUserProfileTask
            sql name is PfiMT03
            indexed
            Sort Order
                PfiWorkunit
                PfiActivity
                PfiQueueAssignment
                ActionTaken
                PfiMetrics.PfiUserProfile
                PfiMetrics.PfiTask.TaskName
                PfiMetrics.PfiTask.TaskType

        ByWorkunitUserProfileTaskActivityQueueAssignment
            sql name is PfiMT04
            indexed
            Sort Order
                PfiWorkunit
                PfiMetrics.PfiUserProfile
                PfiMetrics.PfiTask.TaskName
                PfiMetrics.PfiTask.TaskType
                PfiActivity
                PfiQueueAssignment

        ByUserProfileActionDateTaskWorkunitActivityQueueAssignment
            sql name is PfiMT05
            indexed
            Sort Order
                PfiMetrics.PfiUserProfile
                ActionDate
                PfiMetrics.PfiTask.TaskName
                PfiMetrics.PfiTask.TaskType
                PfiWorkunit
                PfiActivity
                PfiQueueAssignment

        ByWorkunitActivityQueueAssignmentTaskNameTaskTypeUserProfile
            sql name is PfiMT06
            indexed
            Sort Order
                PfiWorkunit
                PfiActivity
                PfiQueueAssignment
                PfiMetrics.PfiTask.TaskName
                PfiMetrics.PfiTask.TaskType
                PfiMetrics.PfiUserProfile

        ByActivityNameMetrics
            sql name is PfiMT07
            Sort Order
                PfiActivity.ActivityName
                PfiWorkunit
                PfiActivity
                PfiQueueAssignment
                PfiMetrics.PfiUserProfile
                PfiMetrics.PfiTask

        ByTask
            sql name is PfiMT08
            indexed
            Sort Order
                PfiMetrics.PfiTask
                PfiWorkunit
                PfiActivity
                PfiQueueAssignment
                PfiMetrics.PfiUserProfile

        ByActionDate
            sql name is PfiMT09
            indexed
            Sort Order
                ActionDate
                PfiWorkunit
                PfiActivity
                PfiQueueAssignment
                PfiMetrics.PfiUserProfile
                PfiMetrics.PfiTask

        ByActionTaken
            sql name is PfiMT10
            indexed
            Sort Order
                ActionTaken
                PfiWorkunit
                PfiActivity
                PfiQueueAssignment
                PfiMetrics.PfiUserProfile
                PfiMetrics.PfiTask

        ByArchived
            sql name is PfiMT11
            Sort Order
                PfiWorkunit.Archived
                PfiWorkunit
                PfiActivity
                PfiQueueAssignment
                PfiMetrics.PfiUserProfile
                PfiMetrics.PfiTask

        ByIsReplicatedUniqueID
            sql name is PfiMT12
            indexed
            Sort Order
                IsReplicated
                UniqueID

    Actions

        Create is a Create Action

        Update is an Update Action

            Exit Rules
                IsReplicated = false

        Delete is a Delete Action
