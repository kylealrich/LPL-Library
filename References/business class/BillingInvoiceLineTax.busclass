BillingInvoiceLineTax is a BusinessClass
    owned by bl
    prefix is OIT
    classic name is OEINVCTAX

    Ontology
        symbolic key is BillingInvoiceLineTax
            classic set name is OITSET1




    Patterns
        implements StaticJava
        disable AuditIndex
        implements Archivable

    Persistent Fields
		TaxCode
        TaxLevel
        ProductTaxCategory
            classic name is PROD-TAX-CAT
        TaxID
        TaxRate                   is a ChrgRate
        TaxableCurrencyAmount     is a CurrencyExchangeGroup
        	classic name for TaxableCurrencyAmount.TransactionAmount is TAX-AMT-CURR
        	classic name for TaxableCurrencyAmount.BaseAmount		 is TAX-AMT-BSE






  
  		TransactionTaxable		  is a CurrencyExchangeGroup
  			classic name for TransactionTaxable.TransactionAmount is TRAN-TAXABLE
  			classic name for TransactionTaxable.BaseAmount		  is BASE-TAXABLE
     
        TaxAccount                is a TransactionCodeBlock
            classic name for TaxAccount.AccountingUnit is TAX-ACCT-UNIT
            classic name for TaxAccount.GeneralLedgerChartAccount is TAX-ACCOUNT

	Local Fields
		LocalCurrencyTable 			is a CurrencyTable
		LocalFromCurrency			is a FromCurrency
		LocalExchangeDate			is an ExchangeDate
		
    Conditions

        IsAocTax
        	restricted
            when (BillingInvoiceLine >  blank
            and   BillingInvoiceLineTax >  blank)

        IsLineTax
        	restricted
            when (BillingInvoiceLine >  blank
            and   BillingInvoiceLineTax not entered)
	Derived Fields
		VATOutputOffsetAmount		is a DerivedField
		    type is like InternationalAmount
		    return (BillingInvoice.CustomerOrder.ProformaCashInAdvanceRequiredPercent * TaxableCurrencyAmount.TransactionAmount)
    
    	BaseVATOutputOffsetAmount	is a DerivedField
		    type is like InternationalAmount
    		return (VATOutputOffsetAmount * BillingInvoice.CurrencyRate)
			
    Relations

        OeinvclineRel
            one-to-one relation to BillingInvoiceLine
            valid when (IsLineTax)
            required
            Field Mapping uses symbolic key
                related.Company                      = Company
                related.BillingInvoice.InvoicePrefix    = BillingInvoice.InvoicePrefix
                related.BillingInvoice.InvoiceNumber = BillingInvoice.InvoiceNumber
                related.BillingInvoiceLine           = BillingInvoiceLine












        OeinvoiceRel
            one-to-one relation to BillingInvoice
            required
            Field Mapping uses symbolic key
                related.Company                      = Company
                related.BillingInvoice.InvoicePrefix    = BillingInvoice.InvoicePrefix
                related.BillingInvoice.InvoiceNumber = BillingInvoice.InvoiceNumber








    Sets

        Set2
            indexed
            Sort Order
                Company
                BillingInvoice
                TaxCode
                BillingInvoiceLine
                BillingInvoiceAddOnCharge
                TaxLevel
				BillingInvoiceLineTax
				
        Set3
            indexed
            Sort Order
                Company
                BillingInvoice
                BillingInvoiceLine
                TaxCode
                BillingInvoiceAddOnCharge
                TaxLevel
				BillingInvoiceLineTax
				
        Set4
            indexed
            Sort Order
                Company
                BillingInvoice
                TaxCode
                ProductTaxCategory
                BillingInvoiceLine
                BillingInvoiceAddOnCharge
                TaxLevel
				BillingInvoiceLineTax
				
	Actions
		Create is a Create Action
			Entrance Rules
				LocalCurrencyTable			= BillingInvoice.CurrencyTable
                LocalExchangeDate           = BillingInvoice.InvoiceDate        

		Update is an Update Action
			Entrance Rules
				LocalCurrencyTable			= BillingInvoice.CurrencyTable
                LocalExchangeDate           = BillingInvoice.InvoiceDate        

		Delete is a Delete Action
				
		Purge is a Purge Action
			restricted
