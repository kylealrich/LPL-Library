PurchaseOrderEDIOutput is a BusinessClass
	owned by po
	
	prefix is POEDI
	
	Ontology
		symbolic key is PurchaseOrderEDIOutput
	
	Patterns
		disable Auditing
		disable AuditIndex
		disable EffectiveDated 
	
	Persistent Fields
		RecordType							is AlphaUpper size 2
			States
				PurchaseOrder				value is "H"
				PurchaseOrderLine			value is "L"
				RequestingLocation			value is "LR"
				TaxDefault					value is "LT"
				PurchaseOrderAddOnCharge	value is "HA"
				PurchaseOrderLineAddOnCharge	value is "LA"
				PurchaseOrderComment			value is "HC"
				PurchaseOrderLineComment		value is "LC"
				Trailer						value is "TC"
				ProcedureInfo				value is "LP"
		PurchaseOrder
		PORelease
		POCode
		PurchaseOrderRevision
		IssueMethod							is AlphaUpper size 1
			States
				EDI		value is "E"
				XML		value is "X"
		EDINumber
		PurchaseOrderLine
		DropshipName						is a Name	 
			holds pii
		DropshipAddress						is a PostalAddressV2	
			holds pii
		Buyer
		BuyerName							is a Name	 
			holds pii
		BuyerPhoneNumber					is a TelephoneNumber 
			holds pii
		BuyerEmailAddress					is an EmailAddress 
			holds pii
		Vendor
		VendorName							is a Name	 
			holds pii
		VendorPostalAddress					is a PostalAddressV2	
			holds pii
		VendorContact						is a VendorName 
			holds pii
		VendorPurchaseFromLocation			is a VendorLocation
		FaxNumber 
			holds pii
		PurchaseOrderDate					is Date
		DefaultDeliveryDate					is Date
		Currency
		CurrencyName						is a Description
		ShipToLocation						is an InventoryLocation
		ShipToName							is a Name	 
			holds pii
		ShipToAdress						is a PostalAddressV2	
			holds pii
		ShipToPhoneNumber					is a TelephoneNumber 
			holds pii
		ShipVia								is Alpha size 12
		ShipTerm
		ShipTermDescription					is a Description
		LetterOfCredit
		FreightTerm
		FreightCode
		TermCode							is a TermsCode
		DueDays								is Numeric size 3
		DiscountDays						is Numeric size 3
		DiscountRate						is Decimal size 5.2
		Terms								is a Description
		PurchaseOrderType					is Alpha size 2
		InvoiceMethod
		RequestingLocation					is like RequestingLocation
		RequestingCompany					is like InventoryCompany
		OrderName							is a Name	 
			holds pii
		VendorAccount						is a BankAccountNumber
		ProcessLevel						is a PayablesProcessLevel
		StockWeight
		StockVolume
		TaxCode
		TaxCodeDescription					is a Description
		TotalTaxableAmount					is an InternationalAmount
		TaxAmount							is an InternationalAmount
		PrintTotal							is an InternationalAmount
		PurchaseOrderBillToName				is a Name	 
			holds pii
		PurchaseOrderBillToAddress			is a PostalAddressV2	
			holds pii
		PurchaseOrderBillToContact			is an AddressContact
		PurchaseOrderBillToPhoneNumber		is a TelephoneNumber 
			holds pii
		PurchaseOrderBillToEmailAddress		is an EmailAddressMulti 
			holds pii
		RetainageFirstPercent				is a Pct
		RetainageSecondPercent				is a Pct
		RetainageUpToPercentComplete		is a Pct
		Item
		ItemDescription1					is a Description
		ItemDescription2					is a Description
		Quantity							is like UnsignedQuantity
		ItemType
		EnteredBuyUOM						is a UnitOfMeasure
		EnteredUnitCost						is an UnsignedUnitCost
		VendorPriceUOMQuantity				is like Quantity
		VendorPriceUOM						is a UnitOfMeasure
		VendorBuyUnitCost					is an InternationalCost
		Manufacturer
		ManufacturerNumber
		HIBCCItemUPNsExists					is Boolean
		LabelerIdentificationCode
		Contract
		EarlyDeliveryDate					is Date
		LateDeliveryDate					is Date
		MSDSRequired						is Boolean
		CertificationRequired				is Boolean
		VendorItem
		VendorItemDescription				is a Description
		NameForPurchaseOrder				is a Name	 
			holds pii
		PostalAddressForPurchaseOrder		is a PostalAddressV2	
			holds pii
		HazardCode
		CostOption
		MajorPurchasingClass
		MinorPurchasingClass
		Closed								is AlphaUpper size 1
			States
				Yes				value is "Y"
				No				value is "N"
				Historical		value is "H"
		TaxableUnitCost						is an InternationalCost
		Taxable								is Boolean
		ExtendedAmount						is an InternationalAmount
		GlobalLocationNumber
		ManufacturerGlobalLocationNumber	is a GlobalLocationNumber
		CommodityCode						is a CommCodes
		ItemGTIN
		CnCode								is a ConsignCode
		Lot									is an ItemLot
		Serial								is an ItemSerialNumber
		DeliverTo
		AccrualFlag							is Boolean
		CommentTitle						is a CommentName
		CommentText
		AddOnCharge
		AddOnChargeDescription				is a Description
		AddOnChargeAmount					is a CurrencyAmount
		IssuedFlag							is Boolean
		Summary								is Boolean
		PatientProcedure
		PatientID							is a Patient
		VisitNumber
		CaseNumber
		Procedure
		ProcedureDate						is Date
		PhysicianName						is a PhysName 
			holds pii
		NurseCoordinator					is a NrsCoord
		SalesRepresentative					is a SalesRep
		OrderNumber							is an OrdNbr
		Requestor
		RequestingLocationGlobalLocationNumber	is a GlobalLocationNumber
		InventoryCompanyGlobalLocationNumber	is a GlobalLocationNumber
		BuyerGlobalLocationNumber				is a GlobalLocationNumber
		VendorGlobalLocationNumber				is a GlobalLocationNumber
		VendorPurchaseFromGlobalLocationNumber	is a GlobalLocationNumber
		ShipToGlobalLocationNumber				is a GlobalLocationNumber
		PunchoutId
		Requester
		RequesterName							is a Name	 
			holds pii
		RequesterPhoneNumber					is a TelephoneNumber 
			holds pii
		RequesterEmailAddress					is an EmailAddress 
			holds pii
		Chemical								is Boolean
		TestRequired							is Boolean
		RebuildRepair							is Boolean
		EAMWorkOrder
		InspectionRequired						is Boolean
		LegacyPO								is Boolean
		DirectPayCertificate					is Alpha size 50
		QuoteNumber								is Alpha size 30
		Confirming								is Boolean
		BlanketPO								is Boolean
		ShippingMethod							is a ShipVia
		Reference1								is a Reference
		E2GCompCode								is a Name	 
			holds pii
		ShippingNotes							is Text
		VendorShipToLocationAccount				is a VendorAccount	
		DeliveryMethod
	
	
	Local Fields
		PurchaseOrderHeaderExtrinsicCount		is Numeric size 6
		PurchaseOrderDispatchLineCount			is Numeric size 6
		PurchaseOrderHeaderCommentCount			is Numeric size 6
		PurchaseOrderLineCommentCount			is Numeric size 6
		LocalPurchaseOrderLine					is like PurchaseOrderLine
		MyResponse								is a CXML
		DispatchPOStatus						is Text
		DispatchPOMessage						is Text
		DispatchPOMessageDetail					is Text
		LocalDate								is Date
		LocalExtrinsicCount						is Numeric size 6
		LocalBPOFlag							is Boolean
		LocalBPOMapped							is a FieldName
		LocalInvoicingAllowedFlag				is Boolean
		LocalInvoicingAllowedMapped				is a FieldName
		LocalAvailableAmountFlag				is Boolean
		LocalAvailableAmountMapped				is a FieldName
		LocalLegacyOrdersFlag					is Boolean
		LocalLegacyOrdersMapped					is a FieldName
		LocalFOBFlag							is Boolean
		LocalFOBMapped							is a FieldName
		LocalShipViaFlag						is Boolean
		LocalShipViaMapped						is a FieldName
		LocalPurchaseOrderRevisionFlag			is Boolean
		LocalPurchaseOrderRevisionMapped		is a FieldName
		LocalConfirmingFlag						is Boolean
		LocalConfirmingMapped					is a FieldName
		LocalQuoteNoFlag						is Boolean
		LocalQuoteNoMapped						is a FieldName
		LocalShipTermFlag						is Boolean
		LocalShipTermMapped						is a FieldName
		LocalChemicalFlag						is Boolean
		LocalChemicalMapped						is a FieldName
		LocalVendorItemFlag						is Boolean
		LocalVendorItemMapped					is a FieldName
		LocalItemTypeFlag						is Boolean
		LocalItemTypeMapped						is a FieldName
		LocalMSDSRequiredFlag					is Boolean
		LocalMSDSRequiredMapped					is a FieldName
		LocalEAMWorkOrderFlag					is Boolean
		LocalEAMWorkOrderMapped					is a FieldName
		LocalShipToLocationFlag					is Boolean
		LocalShipToLocationMapped				is a FieldName
		LocalInspectionRequiredFlag				is Boolean
		LocalInspectionRequiredMapped			is a FieldName
		LocalTaxableFlag						is Boolean
		LocalTaxableMapped						is a FieldName
		LocalDirectPayCertificateFlag			is Boolean
		LocalDirectPayCertificateMapped			is a FieldName
		LocalTestRequiredFlag					is Boolean
		LocalTestRequiredMapped					is a FieldName
		LocalRebuildRepairFlag					is Boolean
		LocalRebuildRepairMapped				is a FieldName
		LocalE2GCompCodeFlag					is Boolean
		LocalE2GCompCodeMapped					is a FieldName
		LocalShippingNotesFlag					is Boolean
		LocalShippingNotesMapped				is a FieldName
		LocalPayloadID							is Alpha size 100
		LocalCompany							is Alpha size 4
		LocalDiscountPercent					is a Percent
		LocalComment							is RichText
		LocalCommentType						is Alpha size 1
		LocalAlphaPrintTotal					is Alpha size 20
		LocalPurchaseOrderRevision				is Alpha size 3	
		LocalISODateTime						is Alpha size 25
		LocalISOPODateTime						is Alpha size 25
		LocalISODeliveryDate					is Alpha size 25
		LocalXMLRequest							is XMLDocument
		LocalXMLResponse						is XMLDocument
		LocalErrorMessage						is Text
	
	Transient Fields
		UniquePayloadID is Alpha 40
	
	Derived Fields
	
		NowAsIsoTimeStamp is a NativeField					
			type is Alpha 25
			restricted
	
		PurchaseOrderDateInIsoFormat is a NativeField		
			type is Alpha 25
			restricted
	
		LocalDateInIsoFormat is a NativeField				
			type is Alpha 25
			restricted
	
		NowAsAribaTimeStamp is a NativeField				
			type is Alpha 25
			restricted
	
		PurchaseOrderDateInAribaFormat is a NativeField		
			type is Alpha 25
			restricted
	
		LocalDateInAribaFormat is a NativeField				
			type is Alpha 25
			restricted
	
		PayloadID is a StringField
			type is Alpha size 100
			restricted
			LocalISODateTime
			"."
			UniquePayloadID
			"@"
			BuyingOrganizationRel.EmailDomainName
	
		DerivedCXMLVersion is a StringField
			type is Alpha 100
			restricted
			"SYSTEM_http://xml.cXML.org/schemas/cXML/"
			PurchaseOrderDispatchVendorRel.CxmlVersion
			"/cXML.dtd"
	
		DerivedCXMLVersion2 is a StringField
			type is Alpha 100
			restricted
			"SYSTEM_http://xml.cXML.org/schemas/cXML/"
			PurchaseOrderDispatchVendorRel2.CxmlVersion
			"/cXML.dtd"
	
	
		DerivedCompany is a StringField
			type is Alpha size 4
			restricted
			LocalCompany
	
		DerivedPrintTotal is a StringField
			type is Alpha size 20
			restricted
			LocalAlphaPrintTotal
	
		DerivedPurchaseOrderRevision is a StringField
			type is Alpha size 3
			restricted
			LocalPurchaseOrderRevision
			
		AribaOrderRequest is a DerivedField
    		type is Boolean
    		return config.AribaOrderRequest

			
	
	Rule Blocks
		SetLocalISODateTime
			if (AribaEnabled)
				LocalISODateTime = NowAsAribaTimeStamp
			else
				LocalISODateTime = NowAsIsoTimeStamp
	
		SetLocalISOPODateTime
			if (AribaEnabled)
				LocalISOPODateTime = PurchaseOrderDateInAribaFormat
			else
				LocalISOPODateTime = PurchaseOrderDateInIsoFormat
	
		SetLocalISODeliveryDate
			if (AribaEnabled)
				LocalISODeliveryDate = LocalDateInAribaFormat
			else
				LocalISODeliveryDate = LocalDateInIsoFormat
				
		SerializeCXMLRequest
			invoke ParseXML CXMLSerializer
				invoked.MyCXMLRequest 				= "1"
				LocalXMLRequest						= result.ParsedXML
		
		SerializeCXMLResponse
			invoke ParseXML CXMLSerializer
				invoked.MyCXMLRequest				= MyResponse
				LocalXMLResponse					= result.ParsedXML
	
	Relations
	
		BuyingOrganizationRel
			one-to-one relation to BuyingOrganization
			Field Mapping uses symbolic key
				related.BuyingOrganization	= Company.VendorGroup
		
		PurchaseOrderDispatchVendorRel
			one-to-one relation to PurchaseOrderDispatchVendor
			Field Mapping uses Set1
				related.Vendor							= Vendor
				related.PurchaseFromLocation			= VendorPurchaseFromLocation
	
		PurchaseOrderDispatchVendorRel2
			one-to-one relation to PurchaseOrderDispatchVendor
			Field Mapping uses Set1
				related.Vendor							= Vendor
				related.PurchaseFromLocation			= blank
	
		PurchaseOrderEDIOutputRel
			one-to-many relation to PurchaseOrderEDIOutput
			Field Mapping uses ByPORev
				related.Company					= Company
				related.PurchaseOrder			= PurchaseOrder
				related.PurchaseOrderRevision	= PurchaseOrderRevision
	
		PurchaseOrderEDIOutputHeaderCommentsRel
			one-to-many relation to PurchaseOrderEDIOutput
			Field Mapping uses ByPORev
				related.Company					= Company 
				related.PurchaseOrder			= PurchaseOrder
				related.PurchaseOrderRevision	= PurchaseOrderRevision
				related.RecordType				= RecordType.PurchaseOrderComment

		PurchaseOrderIncoTermCommentsRel
			one-to-many relation to PurchaseOrderComment
			Field Mapping uses ByCommentType
				related.Company					= Company 
				related.PurchaseOrder			= PurchaseOrder
				related.CommentType  			= "M"

		PurchaseOrderEDIOutputLineCommentsRel
			one-to-many relation to PurchaseOrderEDIOutput
			Field Mapping uses ByPORev
				related.Company					= Company 
				related.PurchaseOrder			= PurchaseOrder
				related.PurchaseOrderRevision	= PurchaseOrderRevision
				related.RecordType				= RecordType.PurchaseOrderLineComment
				related.PurchaseOrderLine 		= LocalPurchaseOrderLine


				
	
		PurchaseOrderEDIOutputLineRel
			one-to-many relation to PurchaseOrderEDIOutput
			Field Mapping uses ByPORev
				related.Company					= Company 
				related.PurchaseOrder			= PurchaseOrder
				related.PurchaseOrderRevision	= PurchaseOrderRevision
				related.RecordType				= RecordType.PurchaseOrderLine
					
		ProcurementFieldMappingRel
			one-to-many relation to ProcurementFieldMapping
			Field Mapping uses symbolic key
				related.ProcurementGroup				= Company.ProcurementGroup
	
		PurchasingVendorRel
			one-to-one relation to PurchasingVendor
			Field Mapping uses symbolic key
				related.VendorGroup	= Company.VendorGroup
				related.Vendor			= Vendor
	
		PurchaseFromLocationRel
			one-to-one relation to PurchaseFromLocation
			Field Mapping uses symbolic key
				related.VendorGroup				= Company.VendorGroup
				related.Vendor					= PurchaseOrder.Vendor
				related.PurchaseFromLocation	= PurchaseOrder.PurchaseFromLocation
	
		PurchaseOrderRevisionRel
			one-to-one relation to PurchaseOrderRevision
			Field Mapping uses symbolic key
				related.Company				= Company
				related.PurchaseOrder			= PurchaseOrder
				related.PurchaseOrderRevision	= PurchaseOrderRevision
	
		PurchaseOrderSuccessRevisionsRel
			one-to-many relation to PurchaseOrderRevision
			Field Mapping uses symbolic key
				related.Company				= Company
				related.PurchaseOrder		= PurchaseOrder
			Instance Selection
				where	(related.TransmissionStatus	=	1)
				
        CXMLConfigurationRel
        	one-to-many relation to CXMLConfiguration
        	Field Mapping uses symbolic key
        		related.FinanceEnterpriseGroup 	= actor.context.FinanceEnterpriseGroup
			Instance Selection
				where (related.Default)
	
	
	Conditions
	
		DispatchXMLPurchaseOrder
			restricted
			when (IssueMethod.XML
			and	RecordType.PurchaseOrder)
			
		DispatchPurchaseOrder
			restricted
			when (DispatchXMLPurchaseOrder
			and  not AribaOrderRequest) 

		DispatchAribaPurchaseOrder
			restricted
			when (DispatchXMLPurchaseOrder
			and  AribaOrderRequest)
	
		AribaEnabled
			restricted
			when (AribaEnabledVendor
			or	AribaEnabledVendorLocation)
	
		AribaEnabledVendor
			restricted
			when (VendorPurchaseFromLocation not entered
			and	(Company.ProcurementGroup.AribaEnabled
			and	(PurchasingVendorRel.AribaEnabled.Integrated
			or	PurchasingVendorRel.AribaEnabled.Flipper
			or	PurchasingVendorRel.AribaEnabled.Light)))
	
		AribaEnabledVendorLocation
			restricted
			when (Company.ProcurementGroup.AribaEnabled
			and	(PurchaseFromLocationRel.AribaEnabled.Integrated
			or	PurchaseFromLocationRel.AribaEnabled.Flipper
			or	PurchaseFromLocationRel.AribaEnabled.Light))
	
		SuppressedPO
			restricted
			when (PurchaseOrder.SuppressPOCost)
			
		AribaEnabledLightVendor
			restricted
			when (VendorPurchaseFromLocation not entered
			and	Company.ProcurementGroup.AribaEnabled
			and	PurchasingVendorRel.AribaEnabled.Light)
	
		AribaEnabledLightVendorLocation
			restricted
			when (Company.ProcurementGroup.AribaEnabled
			and	PurchaseFromLocationRel.AribaEnabled.Light)

	Sets
	
        ByPORev
            indexed
            allow duplicates
            Sort Order
                Company
                PurchaseOrder
                PurchaseOrderRevision
                RecordType
                PurchaseOrderLine
                
	
	Field Rules
		PORelease
			force default to PurchaseOrder.PORelease
	
		POCode
			force default to PurchaseOrder.POCode
	
		PurchaseOrderRevision
			force default to PurchaseOrder.PurchaseOrderRevision
	
		EDINumber
			force default to PurchaseOrder.DisplayEDINumber
	
		BuyerName
			force default to Buyer.Name
	
		BuyerPhoneNumber
			force default to Buyer.UseForWorkPhone.ContactDetail.Telephone
	
		BuyerEmailAddress
			force default to Buyer.EmailAddress
	
		VendorName
			force default to Vendor.VendorName
	
		VendorPostalAddress
			force default to Vendor.VendorAddress
	
		VendorContact
			force default to Vendor.ContactName
	
		CurrencyName
			force default to Currency.Description
	
		ShipToName
			if (PurchaseOrder.DropshipName entered)
				default to PurchaseOrder.DropshipName
			default to ShipToLocation.Name
	
		ShipToAdress
			if (PurchaseOrder.DropshipAddress entered)
				default to PurchaseOrder.DropshipAddress
			default to ShipToLocation.PostalAddressForPurchaseOrder
	
		ShipToPhoneNumber
			if (PurchaseOrder.DropshipPhoneNumber entered)
				default to PurchaseOrder.DropshipPhoneNumber
			default to ShipToLocation.PurchaseOrderBillToPhoneNumber
	
		ShipTermDescription
			force default to ShipTerm.Description
	
		Terms
			force default to TermCode.Description
	
		CnCode
			force default to PurchaseOrderLine.CnCode
	
	
		PurchaseOrderType
			if (CnCode entered)
				default to "CN"
	
			if (PurchaseOrder.IsDropship)
				default to "DS"

			if (PurchaseOrder.DeliveryMethod entered)
				default to "RO"
	
			if (PurchaseOrder.BlanketOrStandingContract entered)
				if (PurchaseOrder.BlanketOrStandingContract.AgreementType.Blanket)
					if (PurchaseOrderRevision entered)
						default to "CR"
					else
						default to "RL"
				else
					if (PurchaseOrder.BlanketOrStandingContract.AgreementType.Standing)
						if (PurchaseOrderRevision entered)
							default to "CP"
						else
							default to "ST"
			else
				if (PurchaseOrderRevision entered)
					default to "CP"
	
			default to "SA"
	
		OrderName
			force default to PurchaseOrder.BlanketOrStandingContract.Name
	
		DueDays
			force default to TermCode.FirstNetDays
	
		DiscountDays
			force default to TermCode.TermsDiscountArray.TermsDiscountGroup[1].DaysToCalcDiscount
	
		DiscountRate
			force default to TermCode.TermsDiscountArray.TermsDiscountGroup[1].DiscountPercent
	
		VendorAccount
			force default to Vendor.BankAccountNumber
	
		VendorShipToLocationAccount
			force default to PurchaseOrder.DerivedPOAccountNumber

		AddOnChargeDescription
			force default to AddOnCharge.Description
	
		TaxCodeDescription
			force default to TaxCode.Description
	
		ItemDescription1
			force default to PurchaseOrderLine.Description
	
		ItemDescription2
			force default to Item.Description2
	
		HIBCCItemUPNsExists
			force default to Item.HIBCCItemUPNsExists
	
		VendorItemDescription
			force default to VendorItem.VendorItemDescription
	
		LabelerIdentificationCode
			force default to VendorItem.LabelerIdentificationCode
	
		NameForPurchaseOrder
			force default to ShipToLocation.NameForPurchaseOrder
	
		PostalAddressForPurchaseOrder
			force default to ShipToLocation.PostalAddressForPurchaseOrder
	
		HazardCode
			force default to Item.HazardCode
	
		GlobalLocationNumber
			force default to ShipToLocation.GlobalLocationNumber
	
		ManufacturerGlobalLocationNumber
			force default to Manufacturer.GlobalLocationNumber
	
	
		BuyerGlobalLocationNumber
			force default to Buyer.GlobalLocationNumber

        InventoryCompanyGlobalLocationNumber
            force default to Company.InventoryCompanyRel.Company.GlobalLocationNumber
	
		VendorGlobalLocationNumber
			force default to Vendor.GlobalLocationNumber
	
		VendorPurchaseFromGlobalLocationNumber
			force default to VendorPurchaseFromLocation.GlobalLocationNumber
	
		ShipToGlobalLocationNumber
			force default to ShipToLocation.GlobalLocationNumber
	
		PunchoutId
			force default to PurchaseOrderLine.PunchoutId
	
		RequesterName
			force default to Requester.Name
	
		RequesterPhoneNumber
			force default to Requester.UseForWorkPhone.ContactDetail.Telephone
	
		RequesterEmailAddress
			force default to Requester.EmailAddress

		DeliveryMethod
			force default to PurchaseOrder.DeliveryMethod
	
	Actions
	
		Create is a Create Action
		Update is an Update Action
		Delete is a Delete Action
	
		UniquePayloadID is an Instance Action
			restricted
	
		DispatchPO is an Instance Action
			valid when (DispatchPurchaseOrder)
			Action Rules
				include SetLocalISODateTime
				include SetLocalISOPODateTime	
				invoke UniquePayloadID	PurchaseOrderEDIOutput
				LocalPayloadID = PayloadID
	
				invoke Create CXML

					if (PurchaseOrderDispatchVendorRel exists)
						invoked.CXMLDocType		= DerivedCXMLVersion
					else
						invoked.CXMLDocType		= DerivedCXMLVersion2
						
					invoked.CXML				= "1"
					invoked.CXML0				= LocalPayloadID
					invoked.CXML1				= LocalISODateTime

				invoke Update PurchaseOrderRevisionRel
					invoked.TransmissionPayloadID = LocalPayloadID
	
				invoke Create CXMLHeader
					invoked.CXML				= "1"
					invoked.CXMLHeader			= "1"
	
				invoke Create CXMLHeaderFrom
					invoked.CXML						= "1"
					invoked.CXMLHeader					= "1"
					invoked.CXMLHeaderFrom				= "1"
	
				if	(PurchaseOrderDispatchVendorRel exists)
					if (PurchaseOrderDispatchVendorRel.FromDunsNumber entered)
						invoke Create CXMLHeaderFromCredential
							invoked.CXML						= "1"
							invoked.CXMLHeader					= "1"
							invoked.CXMLHeaderFrom				= "1"
							invoked.CXMLHeaderFromCredential	= "1"
							invoked.CXMLHeaderFromCredential0	= "DUNS"
							invoked.Identity					= PurchaseOrderDispatchVendorRel.FromDunsNumber
					else
						if (PurchaseOrderDispatchVendorRel.FromNetworkID entered)
							invoke Create CXMLHeaderFromCredential
								invoked.CXML						= "1"
								invoked.CXMLHeader					= "1"
								invoked.CXMLHeaderFrom				= "1"
								invoked.CXMLHeaderFromCredential	= "1"
								invoked.CXMLHeaderFromCredential0	= "NetworkID"
								if (AribaEnabled)
									invoked.CXMLHeaderFromCredential0 = "NetworkId"
								invoked.Identity					= PurchaseOrderDispatchVendorRel.FromNetworkID
	
							if (AribaEnabled)
								invoke Create CXMLHeaderFromCredential
									invoked.CXML						= "1"
									invoked.CXMLHeader					= "1"
									invoked.CXMLHeaderFrom				= "1"
									invoked.CXMLHeaderFromCredential	= "2"
									invoked.CXMLHeaderFromCredential0	= "SystemID"
									invoked.Identity					= PurchaseOrderDispatchVendorRel.SystemID
				else
					if (PurchaseOrderDispatchVendorRel2.FromDunsNumber entered)
						invoke Create CXMLHeaderFromCredential
							invoked.CXML						= "1"
							invoked.CXMLHeader					= "1"
							invoked.CXMLHeaderFrom				= "1"
							invoked.CXMLHeaderFromCredential	= "1"
							invoked.CXMLHeaderFromCredential0	= "DUNS"
							invoked.Identity					= PurchaseOrderDispatchVendorRel2.FromDunsNumber
					else
						if (PurchaseOrderDispatchVendorRel2.FromNetworkID entered)
							invoke Create CXMLHeaderFromCredential
								invoked.CXML						= "1"
								invoked.CXMLHeader					= "1"
								invoked.CXMLHeaderFrom				= "1"
								invoked.CXMLHeaderFromCredential	= "1"
								invoked.CXMLHeaderFromCredential0	= "NetworkID"
								if (AribaEnabled)
									invoked.CXMLHeaderFromCredential0 = "NetworkId"
								invoked.Identity					= PurchaseOrderDispatchVendorRel2.FromNetworkID
	
							if (AribaEnabled)
								invoke Create CXMLHeaderFromCredential
									invoked.CXML						= "1"
									invoked.CXMLHeader					= "1"
									invoked.CXMLHeaderFrom				= "1"
									invoked.CXMLHeaderFromCredential	= "2"
									invoked.CXMLHeaderFromCredential0	= "SystemID"
									invoked.Identity					= PurchaseOrderDispatchVendorRel2.SystemID
	
				invoke Create CXMLHeaderTo
					invoked.CXML					= "1"
					invoked.CXMLHeader				= "1"
					invoked.CXMLHeaderTo			= "1"
	
				if	(PurchaseOrderDispatchVendorRel exists)
					if (PurchaseOrderDispatchVendorRel.ToDunsNumber entered)
						invoke Create CXMLHeaderToCredential
							invoked.CXML					= "1"
							invoked.CXMLHeader				= "1"
							invoked.CXMLHeaderTo			= "1"
							invoked.CXMLHeaderToCredential	= "1"
							invoked.CXMLHeaderToCredential0	= "DUNS"
							invoked.Identity				= PurchaseOrderDispatchVendorRel.ToDunsNumber
					else
						if(AribaEnabledLightVendor 
						or AribaEnabledLightVendorLocation)
							invoke Create CXMLHeaderToCredential
								invoked.CXML					= "1"
								invoked.CXMLHeader				= "1"
								invoked.CXMLHeaderTo			= "1"
								invoked.CXMLHeaderToCredential	= "1"
								invoked.CXMLHeaderToCredential0	= "PrivateID"
								if	(VendorPurchaseFromLocation entered)
									invoked.Identity			= Vendor + "-" + VendorPurchaseFromLocation
								else
									invoked.Identity			= Vendor
	
							invoke Create CXMLHeaderToCorrespondent
								invoked.CXML						= "1"
								invoked.CXMLHeader					= "1"
								invoked.CXMLHeaderTo				= "1"
								invoked.CXMLHeaderToCorrespondent	= "1"
	
							invoke Create CXMLHeaderToCorrespondentContact
								invoked.CXML								= "1"
								invoked.CXMLHeader							= "1"
								invoked.CXMLHeaderTo						= "1"
								invoked.CXMLHeaderToCorrespondent			= "1"
								invoked.CXMLHeaderToCorrespondentContact	= "1"
								invoked.Name0								= "en"
								invoked.Name								= Vendor.VendorName
								if (VendorPurchaseFromLocation entered)
									invoked.Name					= VendorPurchaseFromLocation.VendorName
									
							invoke Create CXMLHeaderToCorrespondentContactPostalAddress
								invoked.CXML											= "1"
								invoked.CXMLHeader										= "1"
								invoked.CXMLHeaderTo									= "1"
								invoked.CXMLHeaderToCorrespondent						= "1"
								invoked.CXMLHeaderToCorrespondentContact 				= "1"
								invoked.CXMLHeaderToCorrespondentContactPostalAddress 	= "1"
	
							invoke Create CXMLHeaderToCorrespondentContactPostalAddressStreet
								invoked.CXML												= "1"
								invoked.CXMLHeader											= "1"
								invoked.CXMLHeaderTo										= "1"
								invoked.CXMLHeaderToCorrespondent							= "1"
								invoked.CXMLHeaderToCorrespondentContact 					= "1"
								invoked.CXMLHeaderToCorrespondentContactPostalAddress 		= "1"
								invoked.CXMLHeaderToCorrespondentContactPostalAddressStreet = "1"
								invoked.Street						= (Vendor.CurrentAddressRel.PostalAddress.DeliveryAddress.AddressLine1
																	+ " "
																	+ Vendor.CurrentAddressRel.PostalAddress.DeliveryAddress.AddressLine2
																	+ " "
																	+ Vendor.CurrentAddressRel.PostalAddress.DeliveryAddress.AddressLine3
																	+ " "
																	+ Vendor.CurrentAddressRel.PostalAddress.DeliveryAddress.AddressLine4)
								if (VendorPurchaseFromLocation entered)
									invoked.Street					= (VendorPurchaseFromLocation.CurrentAddressRel.PostalAddress.DeliveryAddress.AddressLine1
																	+ " "
																	+ VendorPurchaseFromLocation.CurrentAddressRel.PostalAddress.DeliveryAddress.AddressLine2
																	+ " "
																	+ VendorPurchaseFromLocation.CurrentAddressRel.PostalAddress.DeliveryAddress.AddressLine3
																	+ " "
																	+ VendorPurchaseFromLocation.CurrentAddressRel.PostalAddress.DeliveryAddress.AddressLine4)
	
							invoke Create CXMLHeaderToCorrespondentContactPostalAddressCity
								invoked.CXML												= "1"
								invoked.CXMLHeader											= "1"
								invoked.CXMLHeaderTo										= "1"
								invoked.CXMLHeaderToCorrespondent							= "1"
								invoked.CXMLHeaderToCorrespondentContact					= "1"
								invoked.CXMLHeaderToCorrespondentContactPostalAddress		= "1"
								invoked.CXMLHeaderToCorrespondentContactPostalAddressCity	= "1"
								invoked.City						= Vendor.CurrentAddressRel.PostalAddress.Municipality
								if (VendorPurchaseFromLocation entered)
									invoked.City						= VendorPurchaseFromLocation.CurrentAddressRel.PostalAddress.Municipality
	
							invoke Create CXMLHeaderToCorrespondentContactPostalAddressState
								invoked.CXML												= "1"
								invoked.CXMLHeader											= "1"
								invoked.CXMLHeaderTo										= "1"
								invoked.CXMLHeaderToCorrespondent							= "1"
								invoked.CXMLHeaderToCorrespondentContact 					= "1"
								invoked.CXMLHeaderToCorrespondentContactPostalAddress		= "1"
								invoked.CXMLHeaderToCorrespondentContactPostalAddressState	= "1"
								invoked.State						= Vendor.CurrentAddressRel.PostalAddress.StateProvince
								if (VendorPurchaseFromLocation entered)
									invoked.State						= VendorPurchaseFromLocation.CurrentAddressRel.PostalAddress.StateProvince
	
							invoke Create CXMLHeaderToCorrespondentContactPostalAddressPostalCode
								invoked.CXML					= "1"
								invoked.CXMLHeader				= "1"
								invoked.CXMLHeaderTo					= "1"
								invoked.CXMLHeaderToCorrespondent	= "1"
								invoked.CXMLHeaderToCorrespondentContact = "1"
								invoked.CXMLHeaderToCorrespondentContactPostalAddress = "1"
								invoked.CXMLHeaderToCorrespondentContactPostalAddressPostalCode = "1"
								invoked.PostalCode						= Vendor.CurrentAddressRel.PostalAddress.PostalCode
								if (VendorPurchaseFromLocation entered)
									invoked.PostalCode					= VendorPurchaseFromLocation.CurrentAddressRel.PostalAddress.PostalCode
	
							invoke Create CXMLHeaderToCorrespondentContactPostalAddressCountry
								invoked.CXML					= "1"
								invoked.CXMLHeader				= "1"
								invoked.CXMLHeaderTo					= "1"
								invoked.CXMLHeaderToCorrespondent	= "1"
								invoked.CXMLHeaderToCorrespondentContact = "1"
								invoked.CXMLHeaderToCorrespondentContactPostalAddress = "1"
								invoked.CXMLHeaderToCorrespondentContactPostalAddressCountry = "1"
								invoked.Country						= Vendor.CurrentAddressRel.PostalAddress.Country.Name
								invoked.Country0					= Vendor.CurrentAddressRel.PostalAddress.Country.IsoCountryCode
								if (VendorPurchaseFromLocation entered)
									invoked.Country						= VendorPurchaseFromLocation.CurrentAddressRel.PostalAddress.Country.Name
									invoked.Country0					= VendorPurchaseFromLocation.CurrentAddressRel.PostalAddress.Country.IsoCountryCode
	
							invoke Create CXMLHeaderToCorrespondentContactEmail
								invoked.CXML					= "1"
								invoked.CXMLHeader				= "1"
								invoked.CXMLHeaderTo					= "1"
								invoked.CXMLHeaderToCorrespondent	= "1"
								invoked.CXMLHeaderToCorrespondentContact = "1"
								invoked.CXMLHeaderToCorrespondentContactEmail = "1"
								invoked.Email						= Vendor.EmailAddress
								invoked.Email0						= "routing"
								if (VendorPurchaseFromLocation	entered)
									invoked.Email					= VendorPurchaseFromLocation.EmailAddress
						else
							invoke Create CXMLHeaderToCredential
								invoked.CXML					= "1"
								invoked.CXMLHeader				= "1"
								invoked.CXMLHeaderTo					= "1"
								invoked.CXMLHeaderToCredential	= "1"
								invoked.CXMLHeaderToCredential0	= "NetworkID"
								if (AribaEnabled)
									invoked.CXMLHeaderToCredential0 = "NetworkId"
								invoked.Identity					= PurchaseOrderDispatchVendorRel.ToNetworkID
	
				else
					if (PurchaseOrderDispatchVendorRel2.ToDunsNumber entered)
						invoke Create CXMLHeaderToCredential
							invoked.CXML					= "1"
							invoked.CXMLHeader				= "1"
							invoked.CXMLHeaderTo					= "1"
							invoked.CXMLHeaderToCredential	= "1"
							invoked.CXMLHeaderToCredential0	= "DUNS"
							invoked.Identity					= PurchaseOrderDispatchVendorRel2.ToDunsNumber
					else
						if (AribaEnabledLightVendor 
						or	AribaEnabledLightVendorLocation)
							invoke Create CXMLHeaderToCredential
								invoked.CXML					= "1"
								invoked.CXMLHeader				= "1"
								invoked.CXMLHeaderTo					= "1"
								invoked.CXMLHeaderToCredential	= "1"
								invoked.CXMLHeaderToCredential0	= "PrivateID"
								if	(VendorPurchaseFromLocation entered)
									invoked.Identity				= Vendor + "-" + VendorPurchaseFromLocation
								else
									invoked.Identity				= Vendor
	
							invoke Create CXMLHeaderToCorrespondent
								invoked.CXML					= "1"
								invoked.CXMLHeader				= "1"
								invoked.CXMLHeaderTo					= "1"
								invoked.CXMLHeaderToCorrespondent	= "1"
	
							invoke Create CXMLHeaderToCorrespondentContact
								invoked.CXML					= "1"
								invoked.CXMLHeader				= "1"
								invoked.CXMLHeaderTo					= "1"
								invoked.CXMLHeaderToCorrespondent	= "1"
								invoked.CXMLHeaderToCorrespondentContact = "1"
								invoked.Name0						= "en"
								invoked.Name						= Vendor.VendorName
								if (VendorPurchaseFromLocation entered)
									invoked.Name						= VendorPurchaseFromLocation.VendorName
	
							invoke Create CXMLHeaderToCorrespondentContactPostalAddress
								invoked.CXML					= "1"
								invoked.CXMLHeader				= "1"
								invoked.CXMLHeaderTo					= "1"
								invoked.CXMLHeaderToCorrespondent	= "1"
								invoked.CXMLHeaderToCorrespondentContact = "1"
								invoked.CXMLHeaderToCorrespondentContactPostalAddress = "1"
	
							invoke Create CXMLHeaderToCorrespondentContactPostalAddressStreet
								invoked.CXML					= "1"
								invoked.CXMLHeader				= "1"
								invoked.CXMLHeaderTo					= "1"
								invoked.CXMLHeaderToCorrespondent	= "1"
								invoked.CXMLHeaderToCorrespondentContact = "1"
								invoked.CXMLHeaderToCorrespondentContactPostalAddress = "1"
								invoked.CXMLHeaderToCorrespondentContactPostalAddressStreet = "1"
								invoked.Street						= (Vendor.CurrentAddressRel.PostalAddress.DeliveryAddress.AddressLine1
																	+ " "
																	+ Vendor.CurrentAddressRel.PostalAddress.DeliveryAddress.AddressLine2
																	+ " "
																	+ Vendor.CurrentAddressRel.PostalAddress.DeliveryAddress.AddressLine3
																	+ " "
																	+ Vendor.CurrentAddressRel.PostalAddress.DeliveryAddress.AddressLine4)
								if (VendorPurchaseFromLocation entered)
									invoked.Street					= (VendorPurchaseFromLocation.CurrentAddressRel.PostalAddress.DeliveryAddress.AddressLine1
																	+ " "
																	+ VendorPurchaseFromLocation.CurrentAddressRel.PostalAddress.DeliveryAddress.AddressLine2
																	+ " "
																	+ VendorPurchaseFromLocation.CurrentAddressRel.PostalAddress.DeliveryAddress.AddressLine3
																	+ " "
																	+ VendorPurchaseFromLocation.CurrentAddressRel.PostalAddress.DeliveryAddress.AddressLine4)
	
							invoke Create CXMLHeaderToCorrespondentContactPostalAddressCity
								invoked.CXML					= "1"
								invoked.CXMLHeader				= "1"
								invoked.CXMLHeaderTo					= "1"
								invoked.CXMLHeaderToCorrespondent	= "1"
								invoked.CXMLHeaderToCorrespondentContact = "1"
								invoked.CXMLHeaderToCorrespondentContactPostalAddress = "1"
								invoked.CXMLHeaderToCorrespondentContactPostalAddressCity = "1"
								invoked.City						= Vendor.CurrentAddressRel.PostalAddress.Municipality
								if (VendorPurchaseFromLocation entered)
									invoked.City						= VendorPurchaseFromLocation.CurrentAddressRel.PostalAddress.Municipality
	
							invoke Create CXMLHeaderToCorrespondentContactPostalAddressState
								invoked.CXML					= "1"
								invoked.CXMLHeader				= "1"
								invoked.CXMLHeaderTo					= "1"
								invoked.CXMLHeaderToCorrespondent	= "1"
								invoked.CXMLHeaderToCorrespondentContact = "1"
								invoked.CXMLHeaderToCorrespondentContactPostalAddress = "1"
								invoked.CXMLHeaderToCorrespondentContactPostalAddressState = "1"
								invoked.State						= Vendor.CurrentAddressRel.PostalAddress.StateProvince
								if (VendorPurchaseFromLocation entered)
									invoked.State						= VendorPurchaseFromLocation.CurrentAddressRel.PostalAddress.StateProvince
	
							invoke Create CXMLHeaderToCorrespondentContactPostalAddressPostalCode
								invoked.CXML					= "1"
								invoked.CXMLHeader				= "1"
								invoked.CXMLHeaderTo					= "1"
								invoked.CXMLHeaderToCorrespondent	= "1"
								invoked.CXMLHeaderToCorrespondentContact = "1"
								invoked.CXMLHeaderToCorrespondentContactPostalAddress = "1"
								invoked.CXMLHeaderToCorrespondentContactPostalAddressPostalCode = "1"
								invoked.PostalCode						= Vendor.CurrentAddressRel.PostalAddress.PostalCode
								if (VendorPurchaseFromLocation entered)
									invoked.PostalCode					= VendorPurchaseFromLocation.CurrentAddressRel.PostalAddress.PostalCode
	
							invoke Create CXMLHeaderToCorrespondentContactPostalAddressCountry
								invoked.CXML					= "1"
								invoked.CXMLHeader				= "1"
								invoked.CXMLHeaderTo					= "1"
								invoked.CXMLHeaderToCorrespondent	= "1"
								invoked.CXMLHeaderToCorrespondentContact = "1"
								invoked.CXMLHeaderToCorrespondentContactPostalAddress = "1"
								invoked.CXMLHeaderToCorrespondentContactPostalAddressCountry = "1"
								invoked.Country						= Vendor.CurrentAddressRel.PostalAddress.Country.Name
								invoked.Country0					= Vendor.CurrentAddressRel.PostalAddress.Country.IsoCountryCode
								if (VendorPurchaseFromLocation entered)
									invoked.Country						= VendorPurchaseFromLocation.CurrentAddressRel.PostalAddress.Country.Name
									invoked.Country0					= VendorPurchaseFromLocation.CurrentAddressRel.PostalAddress.Country.IsoCountryCode
	
							invoke Create CXMLHeaderToCorrespondentContactEmail
								invoked.CXML					= "1"
								invoked.CXMLHeader				= "1"
								invoked.CXMLHeaderTo					= "1"
								invoked.CXMLHeaderToCorrespondent	= "1"
								invoked.CXMLHeaderToCorrespondentContact = "1"
								invoked.CXMLHeaderToCorrespondentContactEmail = "1"
								invoked.Email						= Vendor.EmailAddress
								invoked.Email0						= "routing"
								if (VendorPurchaseFromLocation	entered)
									invoked.Email					= VendorPurchaseFromLocation.EmailAddress
						else
							invoke Create CXMLHeaderToCredential
								invoked.CXML					= "1"
								invoked.CXMLHeader				= "1"
								invoked.CXMLHeaderTo					= "1"
								invoked.CXMLHeaderToCredential	= "1"
								invoked.CXMLHeaderToCredential0	= "NetworkID"
								if (AribaEnabled)
									invoked.CXMLHeaderToCredential0 = "NetworkId"
								invoked.Identity					= PurchaseOrderDispatchVendorRel2.ToNetworkID
	
				invoke Create CXMLHeaderSender
					invoked.CXML									= "1"
					invoked.CXMLHeader								= "1"
					invoked.CXMLHeaderSender						= "1"
	
				if	(PurchaseOrderDispatchVendorRel exists)
					if (PurchaseOrderDispatchVendorRel.SenderDunsNumber entered)
						invoke Create CXMLHeaderSenderCredential
							invoked.CXML							= "1"
							invoked.CXMLHeader						= "1"
							invoked.CXMLHeaderSender				= "1"
							invoked.CXMLHeaderSenderCredential		= "1"
							invoked.CXMLHeaderSenderCredential0 	= "DUNS"
							invoked.Identity					= PurchaseOrderDispatchVendorRel.SenderDunsNumber
							invoked.SharedSecret				= PurchaseOrderDispatchVendorRel.SharedSecret
					else
						if (PurchaseOrderDispatchVendorRel.SenderNetworkID entered)
							invoke Create CXMLHeaderSenderCredential
								invoked.CXML						= "1"
								invoked.CXMLHeader					= "1"
								invoked.CXMLHeaderSender			= "1"
								invoked.CXMLHeaderSenderCredential	= "1"
								invoked.CXMLHeaderSenderCredential0	= "NetworkID"
								if (AribaEnabled)
									invoked.CXMLHeaderSenderCredential0 = "NetworkId"
								invoked.Identity					= PurchaseOrderDispatchVendorRel.SenderNetworkID
								invoked.SharedSecret				= PurchaseOrderDispatchVendorRel.SharedSecret
				else
					if (PurchaseOrderDispatchVendorRel2.SenderDunsNumber entered)
						invoke Create CXMLHeaderSenderCredential
							invoked.CXML						= "1"
							invoked.CXMLHeader					= "1"
							invoked.CXMLHeaderSender			= "1"
							invoked.CXMLHeaderSenderCredential	= "1"
							invoked.CXMLHeaderSenderCredential0 = "DUNS"
							invoked.Identity					= PurchaseOrderDispatchVendorRel2.SenderDunsNumber
							invoked.SharedSecret				= PurchaseOrderDispatchVendorRel2.SharedSecret
					else
						if (PurchaseOrderDispatchVendorRel2.SenderNetworkID entered)
							invoke Create CXMLHeaderSenderCredential
								invoked.CXML					= "1"
								invoked.CXMLHeader					= "1"
								invoked.CXMLHeaderSender			= "1"
								invoked.CXMLHeaderSenderCredential	= "1"
								invoked.CXMLHeaderSenderCredential0 = "NetworkID"
								if (AribaEnabled)
									invoked.CXMLHeaderSenderCredential0 = "NetworkId"
	
								invoked.Identity					= PurchaseOrderDispatchVendorRel2.SenderNetworkID
								invoked.SharedSecret				= PurchaseOrderDispatchVendorRel2.SharedSecret
	
				invoke Create CXMLHeaderSenderUserAgent
					invoked.CXML						= "1"
					invoked.CXMLHeader					= "1"
					invoked.CXMLHeaderSender			= "1"
					invoked.CXMLHeaderSenderUserAgent	= "1"
					invoked.UserAgent					= BuyingOrganizationRel.OrganizationName
	
				if	(PurchaseOrderDispatchVendorRel exists)
					invoke Create CXMLRequest
						invoked.CXML					= "1"
						invoked.CXMLRequest			= "1"
						invoked.CXMLRequest0				= PurchaseOrderDispatchVendorRel.DeploymentMode
				else
					invoke Create CXMLRequest
						invoked.CXML					= "1"
						invoked.CXMLRequest			= "1"
						invoked.CXMLRequest0				= PurchaseOrderDispatchVendorRel2.DeploymentMode
						
				invoke Create CXMLRequestOrderRequest
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
	
				LocalDate										=	PurchaseOrderDate
				LocalCompany									=	Company
				LocalAlphaPrintTotal							=	PrintTotal
				if (SuppressedPO)
					LocalAlphaPrintTotal						=	PurchaseOrder.EDIOutputOrderAmount
	
				LocalPurchaseOrderRevision						=	PurchaseOrderRevision
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeader
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader0	= LocalISOPODateTime
	
					if (BlanketPO)
						invoked.CXMLRequestOrderRequestOrderRequestHeader5	= LocalISOPODateTime
	
					if (AribaEnabled or CXMLConfigurationRel.FormatOrderID)
						invoked.CXMLRequestOrderRequestOrderRequestHeader1	= DerivedCompany + "-" + PurchaseOrder
					else
						invoked.CXMLRequestOrderRequestOrderRequestHeader1	= PurchaseOrder
	
					invoked.CXMLRequestOrderRequestOrderRequestHeader3	= PurchaseOrderRevision
	
					if	(PurchaseOrderSuccessRevisionsRel exists)
						invoked.CXMLRequestOrderRequestOrderRequestHeader4	= "update"
					else
						invoked.CXMLRequestOrderRequestOrderRequestHeader4	= "new"
	
					if (BlanketPO)
						invoked.CXMLRequestOrderRequestOrderRequestHeader2	= "blanket"
					else
						invoked.CXMLRequestOrderRequestOrderRequestHeader2	= "regular"
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderTotal
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderTotal = "1"
					invoked.Money0								= Currency
					invoked.Money								= PrintTotal
					if (SuppressedPO)
						invoked.Money							= PurchaseOrder.EDIOutputOrderAmount
	
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderShipTo
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipTo = "1"
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderShipToAddress
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipTo = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddress0 = ShipToAdress.Country.IsoCountryCode
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddress1 = ShipToLocation
					invoked.Name0								= "en"
					invoked.Name								= ShipToName
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPostalAddress
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipTo = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPostalAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPostalAddress0 = "default"
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPostalAddressDeliverTo
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipTo = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPostalAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPostalAddressDeliverTo = "1"
					invoked.DeliverTo							= ShipToName
	
				if (not AribaEnabled)
					invoke Create CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPostalAddressDeliverTo
						invoked.CXML								= "1"
						invoked.CXMLRequest						= "1"
						invoked.CXMLRequestOrderRequest			= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderShipTo = "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddress = "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPostalAddress = "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPostalAddressDeliverTo = "2"
						invoked.DeliverTo							= (RequesterName + " " + RequesterPhoneNumber)
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPostalAddressStreet
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipTo = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPostalAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPostalAddressStreet = "1"
					invoked.Street =	(ShipToAdress.DeliveryAddress.AddressLine1 + " " +
										ShipToAdress.DeliveryAddress.AddressLine2 + " " +
										ShipToAdress.DeliveryAddress.AddressLine3 + " " +
										ShipToAdress.DeliveryAddress.AddressLine4)
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPostalAddressCity
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipTo = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPostalAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPostalAddressCity = "1"
					invoked.City								= ShipToAdress.Municipality
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPostalAddressState
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipTo = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPostalAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPostalAddressState = "1"
					invoked.State								= ShipToAdress.StateProvince
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPostalAddressPostalCode
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipTo = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPostalAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPostalAddressPostalCode = "1"
					invoked.PostalCode							= ShipToAdress.PostalCode
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPostalAddressCountry
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipTo = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPostalAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPostalAddressCountry = "1"
					invoked.Country0							= ShipToAdress.Country.IsoCountryCode
					invoked.Country								= ShipToAdress.Country.Name
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderShipToAddressEmail
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipTo = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddressEmail = "1"
					invoked.Email								= BuyerEmailAddress
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPhone
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipTo = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPhone = "1"
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPhoneTelephoneNumber
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipTo = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPhone = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderShipToAddressPhoneTelephoneNumber = "1"
					invoked.CountryCode0						= ShipToAdress.Country.IsoCountryCode
					invoked.CountryCode							= BuyerPhoneNumber.InternationalPrefix
					invoked.AreaOrCityCode						= " "
					invoked.Number								= BuyerPhoneNumber.SubscriberNumber
					invoked.Extension							= BuyerPhoneNumber.Extension
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderBillTo
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillTo = "1"
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderBillToAddress
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillTo = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddress0 = PurchaseOrderBillToAddress.Country.IsoCountryCode
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddress1 = PurchaseOrderBillToContact
					invoked.Name0								= "en"
					invoked.Name								= PurchaseOrderBillToName
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderBillToAddressPostalAddress
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillTo = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddressPostalAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddressPostalAddress0 = "default"
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderBillToAddressPostalAddressDeliverTo
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillTo = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddressPostalAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddressPostalAddressDeliverTo = "1"
					invoked.DeliverTo							= ShipToName
	
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderBillToAddressPostalAddressStreet
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillTo = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddressPostalAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddressPostalAddressStreet = "1"
					invoked.Street =	(PurchaseOrderBillToAddress.DeliveryAddress.AddressLine1	+ " " +
										PurchaseOrderBillToAddress.DeliveryAddress.AddressLine2	+ " " +
										PurchaseOrderBillToAddress.DeliveryAddress.AddressLine3	+ " " +
										PurchaseOrderBillToAddress.DeliveryAddress.AddressLine4)
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderBillToAddressPostalAddressCity
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillTo = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddressPostalAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddressPostalAddressCity = "1"
					invoked.City								= PurchaseOrderBillToAddress.Municipality
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderBillToAddressPostalAddressState
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillTo = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddressPostalAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddressPostalAddressState = "1"
					invoked.State								= PurchaseOrderBillToAddress.StateProvince
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderBillToAddressPostalAddressPostalCode
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillTo = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddressPostalAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddressPostalAddressPostalCode = "1"
					invoked.PostalCode							= PurchaseOrderBillToAddress.PostalCode
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderBillToAddressPostalAddressCountry
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillTo = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddressPostalAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddressPostalAddressCountry = "1"
					invoked.Country0							= PurchaseOrderBillToAddress.Country.IsoCountryCode
					invoked.Country							= PurchaseOrderBillToAddress.Country.Name
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderBillToAddressEmail
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillTo = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddressEmail = "1"
					invoked.Email								= ShipToLocation.PurchaseOrderBillToEmailAddress
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderBillToAddressPhone
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillTo = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddressPhone = "1"
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderBillToAddressPhoneTelephoneNumber
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillTo = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddress = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddressPhone = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderBillToAddressPhoneTelephoneNumber = "1"
					invoked.CountryCode0						= PurchaseOrderBillToAddress.Country.IsoCountryCode
					invoked.CountryCode						= ShipToLocation.PurchaseOrderBillToPhoneNumber.InternationalPrefix
					invoked.AreaOrCityCode						= " "
					invoked.Number								= ShipToLocation.PurchaseOrderBillToPhoneNumber.SubscriberNumber
					invoked.Extension							= ShipToLocation.PurchaseOrderBillToPhoneNumber.Extension
	
				if (TermCode entered)
					invoke Create CXMLRequestOrderRequestOrderRequestHeaderPaymentTerm
						invoked.CXML								= "1"
						invoked.CXMLRequest						= "1"
						invoked.CXMLRequestOrderRequest			= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderPaymentTerm	= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderPaymentTerm0	= DueDays
	
					if (DiscountRate > 0)
						invoke Create CXMLRequestOrderRequestOrderRequestHeaderPaymentTerm
							invoked.CXML								= "1"
							invoked.CXMLRequest						= "1"
							invoked.CXMLRequestOrderRequest			= "1"
							invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
							invoked.CXMLRequestOrderRequestOrderRequestHeaderPaymentTerm	= "2"
							invoked.CXMLRequestOrderRequestOrderRequestHeaderPaymentTerm0	= DiscountDays

						invoke Create CXMLRequestOrderRequestOrderRequestHeaderPaymentTermDiscount
							invoked.CXML								= "1"
							invoked.CXMLRequest						= "1"
							invoked.CXMLRequestOrderRequest			= "1"
							invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
							invoked.CXMLRequestOrderRequestOrderRequestHeaderPaymentTerm	= "2"
							invoked.CXMLRequestOrderRequestOrderRequestHeaderPaymentTermDiscount	= "1"
							LocalDiscountPercent						= DiscountRate * 100
							invoked.DiscountPercent0						= LocalDiscountPercent
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderContact
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderContact	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderContact0	= "purchasingAgent"
					invoked.Name								= BuyerName
					invoked.Name0								= "en"
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderContactEmail
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderContact = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderContactEmail = "1"
					invoked.Email								= BuyerEmailAddress
		
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderContactPhone
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderContact = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderContactPhone = "1"
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderContactPhoneTelephoneNumber
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderContact = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderContactPhone = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderContactPhoneTelephoneNumber = "1"
					invoked.CountryCode0						= PurchaseOrderBillToAddress.Country.IsoCountryCode
					invoked.CountryCode							= Buyer.UseForWorkPhone.ContactDetail.Telephone.InternationalPrefix
					invoked.AreaOrCityCode						= " "
					invoked.Number								= Buyer.UseForWorkPhone.ContactDetail.Telephone.SubscriberNumber
					invoked.Extension							= Buyer.UseForWorkPhone.ContactDetail.Telephone.Extension
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderContactURL
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderContact = "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderContactURL = "1"
					invoked.URL								= " "

				initialize LocalComment
				PurchaseOrderHeaderCommentCount = 0
				for each PurchaseOrderEDIOutputHeaderCommentsRel
					PurchaseOrderHeaderCommentCount = PurchaseOrderHeaderCommentCount + 1
					LocalComment = LocalComment + "Comment" + PurchaseOrderHeaderCommentCount + ":" + each.CommentText
	
				invoke Create CXMLRequestOrderRequestOrderRequestHeaderComments
					invoked.CXML								= "1"
					invoked.CXMLRequest						= "1"
					invoked.CXMLRequestOrderRequest			= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
					invoked.CXMLRequestOrderRequestOrderRequestHeaderComments	= "1"
					invoked.Comments0							= "en"
					invoked.Comments							= LocalComment					

				initialize LocalComment
				initialize LocalCommentType
				for each PurchaseOrderIncoTermCommentsRel
					if (each.CommentType = "M")
						LocalComment = each.CommentText
						LocalCommentType = each.CommentType	

				if  (LocalCommentType = "M") 
					invoke Create CXMLRequestOrderRequestOrderRequestHeaderTermsOfDelivery
						invoked.CXML							= "1"
						invoked.CXMLRequest						= "1"
						invoked.CXMLRequestOrderRequest			= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderTermsOfDelivery = "1"

					invoke Create CXMLRequestOrderRequestOrderRequestHeaderTermsOfDeliveryTermsOfDeliveryCode
						invoked.CXML								= "1"
						invoked.CXMLRequest						= "1"
						invoked.CXMLRequestOrderRequest			= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderTermsOfDelivery = "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderTermsOfDeliveryTermsOfDeliveryCode = "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderTermsOfDeliveryTermsOfDeliveryCode0 = FreightTerm
						
					invoke Create CXMLRequestOrderRequestOrderRequestHeaderTermsOfDeliveryShippingPaymentMethod
						invoked.CXML								= "1"
						invoked.CXMLRequest						= "1"
						invoked.CXMLRequestOrderRequest			= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderTermsOfDelivery = "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderTermsOfDeliveryShippingPaymentMethod = "1"
						if (ShipTermDescription entered)
							invoked.CXMLRequestOrderRequestOrderRequestHeaderTermsOfDeliveryShippingPaymentMethod0 = ShipTermDescription
						else
							invoked.CXMLRequestOrderRequestOrderRequestHeaderTermsOfDeliveryShippingPaymentMethod0 = "Other"
						
					invoke Create CXMLRequestOrderRequestOrderRequestHeaderTermsOfDeliveryTransportTerms
						invoked.CXML								= "1"
						invoked.CXMLRequest						= "1"
						invoked.CXMLRequestOrderRequest			= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderTermsOfDelivery = "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderTermsOfDeliveryTransportTerms = "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderTermsOfDeliveryTransportTerms0 = " "
												
					invoke Create CXMLRequestOrderRequestOrderRequestHeaderTermsOfDeliveryComments
						invoked.CXML								= "1"
						invoked.CXMLRequest						= "1"
						invoked.CXMLRequestOrderRequest			= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderTermsOfDelivery = "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderTermsOfDeliveryComments = "1"						
						invoked.CXMLRequestOrderRequestOrderRequestHeaderTermsOfDeliveryComments0 = "en-US"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderTermsOfDeliveryComments1 = "TermsOfDelivery"
						invoked.Comments  = LocalComment
	
				for each ProcurementFieldMappingRel
					if (each.FromField.BPO)
						LocalBPOFlag							= true
						LocalBPOMapped							= each.ToField
					else
					if (each.FromField.InvoicingAllowed)
						LocalInvoicingAllowedFlag				= true
						LocalInvoicingAllowedMapped			= each.ToField
					else
					if (each.FromField.AvailableAmount)
						LocalAvailableAmountFlag				= true
						LocalAvailableAmountMapped				= each.ToField
					else
					if (each.FromField.LegacyOrders)
						LocalLegacyOrdersFlag					= true
						LocalLegacyOrdersMapped				= each.ToField
					else
					if (each.FromField.FOB)
						LocalFOBFlag							= true
						LocalFOBMapped							= each.ToField
					else
					if (each.FromField.ShipVia)
						LocalShipViaFlag						= true
						LocalShipViaMapped						= each.ToField
					else
					if (each.FromField.PurchaseOrderRevision)
						LocalPurchaseOrderRevisionFlag			= true
						LocalPurchaseOrderRevisionMapped		= each.ToField
					else
					if (each.FromField.QuoteNo)
						LocalQuoteNoFlag						= true
						LocalQuoteNoMapped						= each.ToField
					else
					if (each.FromField.Confirming)
						LocalConfirmingFlag					= true
						LocalConfirmingMapped					= each.ToField
					else
					if (each.FromField.InvoicingAllowed)
						LocalShipTermFlag						= true
						LocalShipTermMapped					= each.ToField
					else
					if (each.FromField.AvailableAmount)
						LocalAvailableAmountFlag				= true
						LocalAvailableAmountMapped				= each.ToField
					else
					if (each.FromField.ShipTerm)
						LocalShipTermFlag						= true
						LocalShipTermMapped					= each.ToField
					else
					if (each.FromField.ShippingNotes)
						LocalShippingNotesFlag					= true
						LocalShippingNotesMapped				= each.ToField
		
				PurchaseOrderHeaderExtrinsicCount = 1
				if (AribaEnabled)
					invoke Create CXMLRequestOrderRequestOrderRequestHeaderExtrinsic
						invoked.CXML								= "1"
						invoked.CXMLRequest						= "1"
						invoked.CXMLRequestOrderRequest			= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderExtrinsic	= PurchaseOrderHeaderExtrinsicCount
						invoked.Extrinsic							= FreightTerm
						invoked.Extrinsic0							= LocalFOBMapped
						PurchaseOrderHeaderExtrinsicCount = PurchaseOrderHeaderExtrinsicCount + 1
	
					invoke Create CXMLRequestOrderRequestOrderRequestHeaderExtrinsic
						invoked.CXML								= "1"
						invoked.CXMLRequest						= "1"
						invoked.CXMLRequestOrderRequest			= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderExtrinsic	= PurchaseOrderHeaderExtrinsicCount
						invoked.Extrinsic							= ShippingMethod
						invoked.Extrinsic0							= LocalShipViaMapped
						PurchaseOrderHeaderExtrinsicCount = PurchaseOrderHeaderExtrinsicCount + 1
	
					invoke Create CXMLRequestOrderRequestOrderRequestHeaderExtrinsic
						invoked.CXML								= "1"
						invoked.CXMLRequest						= "1"
						invoked.CXMLRequestOrderRequest			= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderExtrinsic	= PurchaseOrderHeaderExtrinsicCount
						invoked.Extrinsic							= DerivedPurchaseOrderRevision
						invoked.Extrinsic0							= LocalPurchaseOrderRevisionMapped
						PurchaseOrderHeaderExtrinsicCount = PurchaseOrderHeaderExtrinsicCount + 1
	
					invoke Create CXMLRequestOrderRequestOrderRequestHeaderExtrinsic
						invoked.CXML								= "1"
						invoked.CXMLRequest						= "1"
						invoked.CXMLRequestOrderRequest			= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderExtrinsic	= PurchaseOrderHeaderExtrinsicCount
						invoked.Extrinsic0							= LocalConfirmingMapped
						if (Confirming)
							invoked.Extrinsic						= "Confirming PO"
						else
							invoked.Extrinsic						= "New Order"
						PurchaseOrderHeaderExtrinsicCount = PurchaseOrderHeaderExtrinsicCount + 1
	
					invoke Create CXMLRequestOrderRequestOrderRequestHeaderExtrinsic
						invoked.CXML								= "1"
						invoked.CXMLRequest						= "1"
						invoked.CXMLRequestOrderRequest			= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderExtrinsic	= PurchaseOrderHeaderExtrinsicCount
						invoked.Extrinsic							= QuoteNumber
						invoked.Extrinsic0							= LocalQuoteNoMapped
						PurchaseOrderHeaderExtrinsicCount = PurchaseOrderHeaderExtrinsicCount + 1
	
					invoke Create CXMLRequestOrderRequestOrderRequestHeaderExtrinsic
						invoked.CXML								= "1"
						invoked.CXMLRequest						= "1"
						invoked.CXMLRequestOrderRequest			= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderExtrinsic	= PurchaseOrderHeaderExtrinsicCount
						invoked.Extrinsic							= ShippingNotes
						invoked.Extrinsic0							= LocalShippingNotesMapped
						PurchaseOrderHeaderExtrinsicCount = PurchaseOrderHeaderExtrinsicCount + 1
	
				if (BlanketPO
				and AribaEnabled)
					invoke Create CXMLRequestOrderRequestOrderRequestHeaderExtrinsic
						invoked.CXML								= "1"
						invoked.CXMLRequest						= "1"
						invoked.CXMLRequestOrderRequest			= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderExtrinsic	= PurchaseOrderHeaderExtrinsicCount
						invoked.Extrinsic							= "Yes"
						invoked.Extrinsic0							= LocalInvoicingAllowedMapped
						PurchaseOrderHeaderExtrinsicCount = PurchaseOrderHeaderExtrinsicCount + 1
	
					invoke Create CXMLRequestOrderRequestOrderRequestHeaderExtrinsic
						invoked.CXML								= "1"
						invoked.CXMLRequest						= "1"
						invoked.CXMLRequestOrderRequest			= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderExtrinsic	= PurchaseOrderHeaderExtrinsicCount
						invoked.Extrinsic							= DerivedPrintTotal
						invoked.Extrinsic0							= LocalAvailableAmountMapped
						PurchaseOrderHeaderExtrinsicCount = PurchaseOrderHeaderExtrinsicCount + 1
	
					invoke Create CXMLRequestOrderRequestOrderRequestHeaderExtrinsic
						invoked.CXML								= "1"
						invoked.CXMLRequest						= "1"
						invoked.CXMLRequestOrderRequest			= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderExtrinsic	= PurchaseOrderHeaderExtrinsicCount
						invoked.Extrinsic							= "Yes"
						invoked.Extrinsic0							= LocalBPOMapped
						PurchaseOrderHeaderExtrinsicCount = PurchaseOrderHeaderExtrinsicCount + 1
	
				if (LegacyPO
				and AribaEnabled)
					invoke Create CXMLRequestOrderRequestOrderRequestHeaderExtrinsic
						invoked.CXML								= "1"
						invoked.CXMLRequest						= "1"
						invoked.CXMLRequestOrderRequest			= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeader	= "1"
						invoked.CXMLRequestOrderRequestOrderRequestHeaderExtrinsic	= PurchaseOrderHeaderExtrinsicCount

						invoked.Extrinsic0							= LocalLegacyOrdersMapped
						PurchaseOrderHeaderExtrinsicCount = PurchaseOrderHeaderExtrinsicCount + 1
	
	
				for each ProcurementFieldMappingRel
	
					if (each.FromField.Chemical)
						LocalChemicalFlag								= true
						LocalChemicalMapped							= each.ToField
					else
					if (each.FromField.VendorItem)
						LocalVendorItemFlag							= true
						LocalVendorItemMapped							= each.ToField
					else
					if (each.FromField.EAMWorkOrderNumber)
						LocalEAMWorkOrderFlag							= true
						LocalEAMWorkOrderMapped						= each.ToField
					else
					if (each.FromField.ShipToLocation)
						LocalShipToLocationFlag						= true
						LocalShipToLocationMapped						= each.ToField
					else
					if (each.FromField.ItemType)
						LocalItemTypeFlag								= true
						LocalItemTypeMapped							= each.ToField
					else
					if (each.FromField.InspectionRequired)
						LocalInspectionRequiredFlag					= true
						LocalInspectionRequiredMapped					= each.ToField
					else
					if (each.FromField.MSDSRequired)
						LocalMSDSRequiredFlag							= true
						LocalMSDSRequiredMapped						= each.ToField
					else
					if (each.FromField.Taxable)
						LocalTaxableFlag								= true
						LocalTaxableMapped								= each.ToField
					else
					if (each.FromField.DirectPayCertificate)
						LocalDirectPayCertificateFlag					= true
						LocalDirectPayCertificateMapped				= each.ToField
					else
					if (each.FromField.TestRequired)
						LocalTestRequiredFlag							= true
						LocalTestRequiredMapped						= each.ToField
					else
					if (each.FromField.RebuildRepair)
						LocalRebuildRepairFlag							= true
						LocalRebuildRepairMapped						= each.ToField
					if (each.FromField.E2GCompCode)
						LocalE2GCompCodeFlag							= true
						LocalE2GCompCodeMapped							= each.ToField
	

				PurchaseOrderDispatchLineCount = 0
				for each PurchaseOrderEDIOutputLineRel
					PurchaseOrderDispatchLineCount = PurchaseOrderDispatchLineCount + 1
					LocalDate										= each.EarlyDeliveryDate
					LocalPurchaseOrderLine							= each.PurchaseOrderLine
					include SetLocalISODeliveryDate
	
					invoke Create CXMLRequestOrderRequestItemOut
						invoked.CXML								= "1"
						invoked.CXMLRequest						= "1"
						invoked.CXMLRequestOrderRequest			= "1"
						invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
						invoked.CXMLRequestOrderRequestItemOut0	= each.Quantity
						invoked.CXMLRequestOrderRequestItemOut1	= LocalISODeliveryDate
						invoked.CXMLRequestOrderRequestItemOut2	= each.PurchaseOrderLine
	
					invoke Create CXMLRequestOrderRequestItemOutItemID
						invoked.CXML								= "1"
						invoked.CXMLRequest						= "1"
						invoked.CXMLRequestOrderRequest			= "1"
						invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
						invoked.CXMLRequestOrderRequestItemOutItemID = "1"
						invoked.SupplierPartID						= each.VendorItem
						invoked.SupplierPartAuxiliaryID			= each.PunchoutId
	
					if (BlanketPO)
	
						invoke Create CXMLRequestOrderRequestItemOutBlanketItemDetail
							invoked.CXML								= "1"
							invoked.CXMLRequest						= "1"
							invoked.CXMLRequestOrderRequest			= "1"
							invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
							invoked.CXMLRequestOrderRequestItemOutBlanketItemDetail = "1"
	
						invoke Create CXMLRequestOrderRequestItemOutBlanketItemDetailDescription
							invoked.CXML								= "1"
							invoked.CXMLRequest						= "1"
							invoked.CXMLRequestOrderRequest			= "1"
							invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
							invoked.CXMLRequestOrderRequestItemOutBlanketItemDetail = "1"
							invoked.CXMLRequestOrderRequestItemOutBlanketItemDetailDescription = "1"
							invoked.Description0						= "en"
							invoked.Description						= each.ItemDescription1
	
						invoke Create CXMLRequestOrderRequestItemOutBlanketItemDetailUnitPrice
							invoked.CXML								= "1"
							invoked.CXMLRequest						= "1"
							invoked.CXMLRequestOrderRequest			= "1"
							invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
							invoked.CXMLRequestOrderRequestItemOutBlanketItemDetail = "1"
							invoked.CXMLRequestOrderRequestItemOutBlanketItemDetailUnitPrice = "1"
							invoked.Money0								= Currency
							invoked.Money								= each.EnteredUnitCost
							if (SuppressedPO)
								invoked.Money							= each.PurchaseOrderLine.EDIOutputUnitCost
	
						invoke Create CXMLRequestOrderRequestItemOutBlanketItemDetailUnitOfMeasure
							invoked.CXML								= "1"
							invoked.CXMLRequest						= "1"
							invoked.CXMLRequestOrderRequest			= "1"
							invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
							invoked.CXMLRequestOrderRequestItemOutBlanketItemDetail = "1"
							invoked.CXMLRequestOrderRequestItemOutBlanketItemDetailUnitOfMeasure = "1"
							invoked.UnitOfMeasure						= each.EnteredBuyUOM
	
						invoke Create CXMLRequestOrderRequestItemOutBlanketItemDetailClassification
							invoked.CXML								= "1"
							invoked.CXMLRequest						= "1"
							invoked.CXMLRequestOrderRequest			= "1"
							invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
							invoked.CXMLRequestOrderRequestItemOutBlanketItemDetail = "1"
							invoked.CXMLRequestOrderRequestItemOutBlanketItemDetailClassification = "1"
							invoked.Classification						= "\"none\""
							if (AribaEnabled)
								invoked.Classification						= " "
	
						LocalExtrinsicCount	= 1
						if (LocalChemicalFlag
						and AribaEnabled)
							invoke Create CXMLRequestOrderRequestItemOutBlanketItemDetailExtrinsic
								invoked.CXML								= "1"
								invoked.CXMLRequest						= "1"
								invoked.CXMLRequestOrderRequest			= "1"
								invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
								invoked.CXMLRequestOrderRequestItemOutBlanketItemDetail = "1"
								invoked.CXMLRequestOrderRequestItemOutBlanketItemDetailExtrinsic = LocalExtrinsicCount
								if (each.Chemical)
									invoked.Extrinsic						= "Y"
								else
									invoked.Extrinsic						= "N"
								invoked.Extrinsic0							=	LocalChemicalMapped
								LocalExtrinsicCount						= LocalExtrinsicCount + 1
	
						if (LocalVendorItemFlag
						and AribaEnabled)
							invoke Create CXMLRequestOrderRequestItemOutBlanketItemDetailExtrinsic
								invoked.CXML								= "1"
								invoked.CXMLRequest						= "1"
								invoked.CXMLRequestOrderRequest			= "1"
								invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
								invoked.CXMLRequestOrderRequestItemOutBlanketItemDetail = "1"
								invoked.CXMLRequestOrderRequestItemOutBlanketItemDetailExtrinsic = LocalExtrinsicCount
								invoked.Extrinsic							=	each.VendorItem
								invoked.Extrinsic0							=	LocalVendorItemMapped
								LocalExtrinsicCount						= LocalExtrinsicCount + 1
	
						if (LocalEAMWorkOrderFlag
						and AribaEnabled)
							invoke Create CXMLRequestOrderRequestItemOutBlanketItemDetailExtrinsic
								invoked.CXML								= "1"
								invoked.CXMLRequest						= "1"
								invoked.CXMLRequestOrderRequest			= "1"
								invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
								invoked.CXMLRequestOrderRequestItemOutBlanketItemDetail = "1"
								invoked.CXMLRequestOrderRequestItemOutBlanketItemDetailExtrinsic = LocalExtrinsicCount
								invoked.Extrinsic							=	each.EAMWorkOrder
								invoked.Extrinsic0							=	LocalEAMWorkOrderMapped
								LocalExtrinsicCount						= LocalExtrinsicCount + 1
	
						if (LocalShipToLocationFlag
						and AribaEnabled)
							invoke Create CXMLRequestOrderRequestItemOutBlanketItemDetailExtrinsic
								invoked.CXML								= "1"
								invoked.CXMLRequest						= "1"
								invoked.CXMLRequestOrderRequest			= "1"
								invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
								invoked.CXMLRequestOrderRequestItemOutBlanketItemDetail = "1"
								invoked.CXMLRequestOrderRequestItemOutBlanketItemDetailExtrinsic = LocalExtrinsicCount
								invoked.Extrinsic							=	each.ShipToLocation
								invoked.Extrinsic0							=	LocalShipToLocationMapped
								LocalExtrinsicCount						= LocalExtrinsicCount + 1
	
						if (LocalItemTypeFlag
						and AribaEnabled)
							invoke Create CXMLRequestOrderRequestItemOutBlanketItemDetailExtrinsic
								invoked.CXML								= "1"
								invoked.CXMLRequest						= "1"
								invoked.CXMLRequestOrderRequest			= "1"
								invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
								invoked.CXMLRequestOrderRequestItemOutBlanketItemDetail = "1"
								invoked.CXMLRequestOrderRequestItemOutBlanketItemDetailExtrinsic = LocalExtrinsicCount
								if (each.ItemType = "I"
								or	each.ItemType = "N"
								or	each.ItemType = "X")
									invoked.Extrinsic						= "MATERIAL"
								else
									invoked.Extrinsic						= "SERVICE"
								invoked.Extrinsic0							=	LocalItemTypeMapped
								LocalExtrinsicCount						= LocalExtrinsicCount + 1
	
						if (LocalInspectionRequiredFlag
						and AribaEnabled)
							invoke Create CXMLRequestOrderRequestItemOutBlanketItemDetailExtrinsic
								invoked.CXML								= "1"
								invoked.CXMLRequest						= "1"
								invoked.CXMLRequestOrderRequest			= "1"
								invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
								invoked.CXMLRequestOrderRequestItemOutBlanketItemDetail = "1"
								invoked.CXMLRequestOrderRequestItemOutBlanketItemDetailExtrinsic = LocalExtrinsicCount
								if (each.InspectionRequired)
									invoked.Extrinsic						= "1"
								else
									invoked.Extrinsic						= "0"
								invoked.Extrinsic0							=	LocalInspectionRequiredMapped
								LocalExtrinsicCount						= LocalExtrinsicCount + 1
	
						if (LocalMSDSRequiredFlag
						and AribaEnabled)
							invoke Create CXMLRequestOrderRequestItemOutBlanketItemDetailExtrinsic
								invoked.CXML								= "1"
								invoked.CXMLRequest						= "1"
								invoked.CXMLRequestOrderRequest			= "1"
								invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
								invoked.CXMLRequestOrderRequestItemOutBlanketItemDetail = "1"
								invoked.CXMLRequestOrderRequestItemOutBlanketItemDetailExtrinsic = LocalExtrinsicCount
								if (each.MSDSRequired)
									invoked.Extrinsic						= "Y"
								else
									invoked.Extrinsic						= "N"
								invoked.Extrinsic0							=	LocalMSDSRequiredMapped
								LocalExtrinsicCount						= LocalExtrinsicCount + 1
	
						if (LocalTaxableFlag
						and AribaEnabled)
							invoke Create CXMLRequestOrderRequestItemOutBlanketItemDetailExtrinsic
								invoked.CXML								= "1"
								invoked.CXMLRequest						= "1"
								invoked.CXMLRequestOrderRequest			= "1"
								invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
								invoked.CXMLRequestOrderRequestItemOutBlanketItemDetail = "1"
								invoked.CXMLRequestOrderRequestItemOutBlanketItemDetailExtrinsic = LocalExtrinsicCount
								if (each.Taxable)
									invoked.Extrinsic						= "1"
								else
									invoked.Extrinsic						= "0"
								invoked.Extrinsic0							=	LocalTaxableMapped
								LocalExtrinsicCount						= LocalExtrinsicCount + 1
	
						if (LocalDirectPayCertificateFlag
						and AribaEnabled)
							invoke Create CXMLRequestOrderRequestItemOutBlanketItemDetailExtrinsic
								invoked.CXML								= "1"
								invoked.CXMLRequest						= "1"
								invoked.CXMLRequestOrderRequest			= "1"
								invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
								invoked.CXMLRequestOrderRequestItemOutBlanketItemDetail = "1"
								invoked.CXMLRequestOrderRequestItemOutBlanketItemDetailExtrinsic = LocalExtrinsicCount
								invoked.Extrinsic							=	each.DirectPayCertificate
								invoked.Extrinsic0							=	LocalDirectPayCertificateMapped
								LocalExtrinsicCount						= LocalExtrinsicCount + 1
	
						if (LocalTestRequiredFlag
						and AribaEnabled)
							invoke Create CXMLRequestOrderRequestItemOutBlanketItemDetailExtrinsic
								invoked.CXML								= "1"
								invoked.CXMLRequest						= "1"
								invoked.CXMLRequestOrderRequest			= "1"
								invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
								invoked.CXMLRequestOrderRequestItemOutBlanketItemDetail = "1"
								invoked.CXMLRequestOrderRequestItemOutBlanketItemDetailExtrinsic = LocalExtrinsicCount
								if (each.TestRequired)
									invoked.Extrinsic						= "1"
								else
									invoked.Extrinsic						= "0"
								invoked.Extrinsic0							=	LocalTestRequiredMapped
								LocalExtrinsicCount = LocalExtrinsicCount + 1
	
						if (LocalRebuildRepairFlag
						and AribaEnabled)
							invoke Create CXMLRequestOrderRequestItemOutBlanketItemDetailExtrinsic
								invoked.CXML								= "1"
								invoked.CXMLRequest						= "1"
								invoked.CXMLRequestOrderRequest			= "1"
								invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
								invoked.CXMLRequestOrderRequestItemOutBlanketItemDetail = "1"
								invoked.CXMLRequestOrderRequestItemOutBlanketItemDetailExtrinsic = LocalExtrinsicCount
								if (each.RebuildRepair)
									invoked.Extrinsic						= "YES"
								else
									invoked.Extrinsic						= "NO"
								invoked.Extrinsic0							= LocalRebuildRepairMapped
								LocalExtrinsicCount						= LocalExtrinsicCount + 1
	
						if (LocalE2GCompCodeFlag
						and each.E2GCompCode entered
						and AribaEnabled)
							invoke Create CXMLRequestOrderRequestItemOutBlanketItemDetailExtrinsic
								invoked.CXML								= "1"
								invoked.CXMLRequest						= "1"
								invoked.CXMLRequestOrderRequest			= "1"
								invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
								invoked.CXMLRequestOrderRequestItemOutBlanketItemDetail = "1"
								invoked.CXMLRequestOrderRequestItemOutBlanketItemDetailExtrinsic = LocalExtrinsicCount
								invoked.Extrinsic							= each.E2GCompCode
								invoked.Extrinsic0							= LocalE2GCompCodeMapped
								LocalExtrinsicCount						= LocalExtrinsicCount + 1
	
					else
						invoke Create CXMLRequestOrderRequestItemOutItemDetail
							invoked.CXML								= "1"
							invoked.CXMLRequest						= "1"
							invoked.CXMLRequestOrderRequest			= "1"
							invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
							invoked.CXMLRequestOrderRequestItemOutItemDetail = "1"
	
						invoke Create CXMLRequestOrderRequestItemOutItemDetailUnitPrice
							invoked.CXML								= "1"
							invoked.CXMLRequest						= "1"
							invoked.CXMLRequestOrderRequest			= "1"
							invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
							invoked.CXMLRequestOrderRequestItemOutItemDetail = "1"
							invoked.CXMLRequestOrderRequestItemOutItemDetailUnitPrice = "1"
							invoked.Money0								= Currency
							invoked.Money								= each.EnteredUnitCost
							if (SuppressedPO)
								invoked.Money							= each.PurchaseOrderLine.EDIOutputUnitCost
	
						invoke Create CXMLRequestOrderRequestItemOutItemDetailDescription
							invoked.CXML								= "1"
							invoked.CXMLRequest						= "1"
							invoked.CXMLRequestOrderRequest			= "1"
							invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
							invoked.CXMLRequestOrderRequestItemOutItemDetail = "1"
							invoked.CXMLRequestOrderRequestItemOutItemDetailDescription = "1"
							invoked.Description0						= "en"
							invoked.Description						= each.ItemDescription1
	
						invoke Create CXMLRequestOrderRequestItemOutItemDetailUnitOfMeasure
							invoked.CXML								= "1"
							invoked.CXMLRequest						= "1"
							invoked.CXMLRequestOrderRequest			= "1"
							invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
							invoked.CXMLRequestOrderRequestItemOutItemDetail = "1"
							invoked.CXMLRequestOrderRequestItemOutItemDetailUnitOfMeasure = "1"
							invoked.UnitOfMeasure						= each.EnteredBuyUOM
	
						invoke Create CXMLRequestOrderRequestItemOutItemDetailClassification
							invoked.CXML								= "1"
							invoked.CXMLRequest						= "1"
							invoked.CXMLRequestOrderRequest			= "1"
							invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
							invoked.CXMLRequestOrderRequestItemOutItemDetail = "1"
							invoked.CXMLRequestOrderRequestItemOutItemDetailClassification = "1"
							invoked.Classification						= "\"none\""
							if (AribaEnabled)
								invoked.Classification						= " "
	
						invoke Create CXMLRequestOrderRequestItemOutItemDetailManufacturerPartID
							invoked.CXML								= "1"
							invoked.CXMLRequest						= "1"
							invoked.CXMLRequestOrderRequest			= "1"
							invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
							invoked.CXMLRequestOrderRequestItemOutItemDetail = "1"
							invoked.CXMLRequestOrderRequestItemOutItemDetailManufacturerPartID = "1"
							invoked.ManufacturerPartID					= each.ManufacturerNumber
	
						invoke Create CXMLRequestOrderRequestItemOutItemDetailManufacturerName
							invoked.CXML								= "1"
							invoked.CXMLRequest						= "1"
							invoked.CXMLRequestOrderRequest			= "1"
							invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
							invoked.CXMLRequestOrderRequestItemOutItemDetail = "1"
							invoked.CXMLRequestOrderRequestItemOutItemDetailManufacturerName = "1"
							invoked.ManufacturerName					= each.Manufacturer
	
						invoke Create CXMLRequestOrderRequestItemOutItemDetailURL
							invoked.CXML								= "1"
							invoked.CXMLRequest						= "1"
							invoked.CXMLRequestOrderRequest			= "1"
							invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
							invoked.CXMLRequestOrderRequestItemOutItemDetail = "1"
							invoked.CXMLRequestOrderRequestItemOutItemDetailURL = "1"
							invoked.URL								= " "
	
						if (not AribaEnabled)
							invoke Create CXMLRequestOrderRequestItemOutItemDetailExtrinsic
								invoked.CXML								= "1"
								invoked.CXMLRequest						= "1"
								invoked.CXMLRequestOrderRequest			= "1"
								invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
								invoked.CXMLRequestOrderRequestItemOutItemDetail = "1"
								invoked.CXMLRequestOrderRequestItemOutItemDetailExtrinsic = "1"
								invoked.Extrinsic							=	"\"none\""
	
						LocalExtrinsicCount	= 1
						if (LocalChemicalFlag
						and AribaEnabled)
							invoke Create CXMLRequestOrderRequestItemOutItemDetailExtrinsic
								invoked.CXML								= "1"
								invoked.CXMLRequest						= "1"
								invoked.CXMLRequestOrderRequest			= "1"
								invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
								invoked.CXMLRequestOrderRequestItemOutItemDetail = "1"
								invoked.CXMLRequestOrderRequestItemOutItemDetailExtrinsic = LocalExtrinsicCount
								if (each.Chemical)
									invoked.Extrinsic						= "Y"
								else
									invoked.Extrinsic						= "N"
								invoked.Extrinsic0							=	LocalChemicalMapped
								LocalExtrinsicCount				= LocalExtrinsicCount + 1
	
						if (LocalVendorItemFlag
						and AribaEnabled)
	
							invoke Create CXMLRequestOrderRequestItemOutItemDetailExtrinsic
								invoked.CXML								= "1"
								invoked.CXMLRequest						= "1"
								invoked.CXMLRequestOrderRequest			= "1"
								invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
								invoked.CXMLRequestOrderRequestItemOutItemDetail = "1"
								invoked.CXMLRequestOrderRequestItemOutItemDetailExtrinsic = LocalExtrinsicCount
								invoked.Extrinsic							=	each.VendorItem
								invoked.Extrinsic0							=	LocalVendorItemMapped
								LocalExtrinsicCount = LocalExtrinsicCount + 1
	
						if (LocalEAMWorkOrderFlag
						and AribaEnabled)
	
							invoke Create CXMLRequestOrderRequestItemOutItemDetailExtrinsic
								invoked.CXML								= "1"
								invoked.CXMLRequest						= "1"
								invoked.CXMLRequestOrderRequest			= "1"
								invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
								invoked.CXMLRequestOrderRequestItemOutItemDetail = "1"
								invoked.CXMLRequestOrderRequestItemOutItemDetailExtrinsic = LocalExtrinsicCount
								invoked.Extrinsic							=	each.EAMWorkOrder
								invoked.Extrinsic0							=	LocalEAMWorkOrderMapped
								LocalExtrinsicCount = LocalExtrinsicCount + 1
	
						if (LocalShipToLocationFlag
						and AribaEnabled)
	
							invoke Create CXMLRequestOrderRequestItemOutItemDetailExtrinsic
								invoked.CXML								= "1"
								invoked.CXMLRequest						= "1"
								invoked.CXMLRequestOrderRequest			= "1"
								invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
								invoked.CXMLRequestOrderRequestItemOutItemDetail = "1"
								invoked.CXMLRequestOrderRequestItemOutItemDetailExtrinsic = LocalExtrinsicCount
								invoked.Extrinsic							=	each.ShipToLocation
								invoked.Extrinsic0							=	LocalShipToLocationMapped
								LocalExtrinsicCount = LocalExtrinsicCount + 1
	
						if (LocalItemTypeFlag
						and AribaEnabled)
	
							invoke Create CXMLRequestOrderRequestItemOutItemDetailExtrinsic
								invoked.CXML								= "1"
								invoked.CXMLRequest						= "1"
								invoked.CXMLRequestOrderRequest			= "1"
								invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
								invoked.CXMLRequestOrderRequestItemOutItemDetail = "1"
								invoked.CXMLRequestOrderRequestItemOutItemDetailExtrinsic = LocalExtrinsicCount
								if (each.ItemType = "I"
								or	each.ItemType = "N"
								or	each.ItemType = "X")
									invoked.Extrinsic						= "MATERIAL"
								else
									invoked.Extrinsic						= "SERVICE"
								invoked.Extrinsic0							=	LocalItemTypeMapped
								LocalExtrinsicCount = LocalExtrinsicCount + 1
	
						if (LocalInspectionRequiredFlag
						and AribaEnabled)
	
							invoke Create CXMLRequestOrderRequestItemOutItemDetailExtrinsic
								invoked.CXML								= "1"
								invoked.CXMLRequest						= "1"
								invoked.CXMLRequestOrderRequest			= "1"
								invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
								invoked.CXMLRequestOrderRequestItemOutItemDetail = "1"
								invoked.CXMLRequestOrderRequestItemOutItemDetailExtrinsic = LocalExtrinsicCount
								if (each.InspectionRequired)
									invoked.Extrinsic						= "1"
								else
									invoked.Extrinsic						= "0"
								invoked.Extrinsic0							=	LocalInspectionRequiredMapped
								LocalExtrinsicCount						= LocalExtrinsicCount + 1
	
						if (LocalMSDSRequiredFlag
						and AribaEnabled)
	
							invoke Create CXMLRequestOrderRequestItemOutItemDetailExtrinsic
								invoked.CXML								= "1"
								invoked.CXMLRequest						= "1"
								invoked.CXMLRequestOrderRequest			= "1"
								invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
								invoked.CXMLRequestOrderRequestItemOutItemDetail = "1"
								invoked.CXMLRequestOrderRequestItemOutItemDetailExtrinsic = LocalExtrinsicCount
								if (each.MSDSRequired)
									invoked.Extrinsic						= "Y"
								else
									invoked.Extrinsic						= "N"
								invoked.Extrinsic0							=	LocalMSDSRequiredMapped
								LocalExtrinsicCount						= LocalExtrinsicCount + 1
	
						if (LocalTaxableFlag
						and AribaEnabled)
	
							invoke Create CXMLRequestOrderRequestItemOutItemDetailExtrinsic
								invoked.CXML								= "1"
								invoked.CXMLRequest						= "1"
								invoked.CXMLRequestOrderRequest			= "1"
								invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
								invoked.CXMLRequestOrderRequestItemOutItemDetail = "1"
								invoked.CXMLRequestOrderRequestItemOutItemDetailExtrinsic = LocalExtrinsicCount
								if (each.Taxable)
									invoked.Extrinsic						= "1"
								else
									invoked.Extrinsic						= "0"
								invoked.Extrinsic0							=	LocalTaxableMapped
								LocalExtrinsicCount				= LocalExtrinsicCount + 1
	
						if (LocalDirectPayCertificateFlag
						and AribaEnabled)
	
							invoke Create CXMLRequestOrderRequestItemOutItemDetailExtrinsic
								invoked.CXML								= "1"
								invoked.CXMLRequest						= "1"
								invoked.CXMLRequestOrderRequest			= "1"
								invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
								invoked.CXMLRequestOrderRequestItemOutItemDetail = "1"
								invoked.CXMLRequestOrderRequestItemOutItemDetailExtrinsic = LocalExtrinsicCount
								invoked.Extrinsic							=	each.DirectPayCertificate
								invoked.Extrinsic0							=	LocalDirectPayCertificateMapped
								LocalExtrinsicCount = LocalExtrinsicCount + 1
	
						if (LocalTestRequiredFlag
						and AribaEnabled)
	
							invoke Create CXMLRequestOrderRequestItemOutItemDetailExtrinsic
								invoked.CXML								= "1"
								invoked.CXMLRequest						= "1"
								invoked.CXMLRequestOrderRequest			= "1"
								invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
								invoked.CXMLRequestOrderRequestItemOutItemDetail = "1"
								invoked.CXMLRequestOrderRequestItemOutItemDetailExtrinsic = LocalExtrinsicCount

								if (each.TestRequired)
									invoked.Extrinsic						= "1"
								else
									invoked.Extrinsic						= "0"
								invoked.Extrinsic0							=	LocalTestRequiredMapped
								LocalExtrinsicCount = LocalExtrinsicCount + 1
	
						if (LocalRebuildRepairFlag
						and AribaEnabled)
	
							invoke Create CXMLRequestOrderRequestItemOutItemDetailExtrinsic
								invoked.CXML								= "1"
								invoked.CXMLRequest						= "1"
								invoked.CXMLRequestOrderRequest			= "1"
								invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
								invoked.CXMLRequestOrderRequestItemOutItemDetail = "1"
								invoked.CXMLRequestOrderRequestItemOutItemDetailExtrinsic = LocalExtrinsicCount
								if (each.RebuildRepair)
									invoked.Extrinsic						= "YES"
								else
									invoked.Extrinsic						= "NO"
								invoked.Extrinsic0							=	LocalRebuildRepairMapped
								LocalExtrinsicCount				= LocalExtrinsicCount + 1
	
						if (each.E2GCompCode entered
						and AribaEnabled)
							invoke Create CXMLRequestOrderRequestItemOutItemDetailExtrinsic
								invoked.CXML								= "1"
								invoked.CXMLRequest						= "1"
								invoked.CXMLRequestOrderRequest			= "1"
								invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
								invoked.CXMLRequestOrderRequestItemOutItemDetail = "1"
								invoked.CXMLRequestOrderRequestItemOutItemDetailExtrinsic = LocalExtrinsicCount
								invoked.Extrinsic							= each.E2GCompCode
								invoked.Extrinsic0							= LocalE2GCompCodeMapped
								LocalExtrinsicCount						= LocalExtrinsicCount + 1
	
					if (AribaEnabled)
						invoke Create CXMLRequestOrderRequestItemOutShipTo
							invoked.CXML								= "1"
							invoked.CXMLRequest						= "1"
							invoked.CXMLRequestOrderRequest			= "1"
							invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
							invoked.CXMLRequestOrderRequestItemOutShipTo = "1"
		
						invoke Create CXMLRequestOrderRequestItemOutShipToAddress
							invoked.CXML								= "1"
							invoked.CXMLRequest						= "1"
							invoked.CXMLRequestOrderRequest			= "1"
							invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
							invoked.CXMLRequestOrderRequestItemOutShipTo = "1"
							invoked.CXMLRequestOrderRequestItemOutShipToAddress = "1"
							invoked.Name0								= "en"
							invoked.Name								= each.ShipToName
		
						invoke Create CXMLRequestOrderRequestItemOutShipToAddressPostalAddress
							invoked.CXML								= "1"
							invoked.CXMLRequest						= "1"
							invoked.CXMLRequestOrderRequest			= "1"
							invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
							invoked.CXMLRequestOrderRequestItemOutShipTo = "1"
							invoked.CXMLRequestOrderRequestItemOutShipToAddress = "1"
							invoked.CXMLRequestOrderRequestItemOutShipToAddressPostalAddress = "1"
							invoked.CXMLRequestOrderRequestItemOutShipToAddressPostalAddress0 = "default"
		
						invoke Create CXMLRequestOrderRequestItemOutShipToAddressPostalAddressStreet
							invoked.CXML								= "1"
							invoked.CXMLRequest						= "1"
							invoked.CXMLRequestOrderRequest			= "1"
							invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
							invoked.CXMLRequestOrderRequestItemOutShipTo = "1"
							invoked.CXMLRequestOrderRequestItemOutShipToAddress = "1"
							invoked.CXMLRequestOrderRequestItemOutShipToAddressPostalAddress = "1"
							invoked.CXMLRequestOrderRequestItemOutShipToAddressPostalAddressStreet = "1"
							invoked.Street =	(each.ShipToAdress.DeliveryAddress.AddressLine1 + " " +
												each.ShipToAdress.DeliveryAddress.AddressLine2 + " " +
												each.ShipToAdress.DeliveryAddress.AddressLine3 + " " +
												each.ShipToAdress.DeliveryAddress.AddressLine4)
		
						invoke Create CXMLRequestOrderRequestItemOutShipToAddressPostalAddressCity
							invoked.CXML								= "1"
							invoked.CXMLRequest						= "1"
							invoked.CXMLRequestOrderRequest			= "1"
							invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
							invoked.CXMLRequestOrderRequestItemOutShipTo = "1"
							invoked.CXMLRequestOrderRequestItemOutShipToAddress = "1"
							invoked.CXMLRequestOrderRequestItemOutShipToAddressPostalAddress = "1"
							invoked.CXMLRequestOrderRequestItemOutShipToAddressPostalAddressCity = "1"
							invoked.City								= each.ShipToAdress.Municipality
		
						invoke Create CXMLRequestOrderRequestItemOutShipToAddressPostalAddressState
							invoked.CXML								= "1"
							invoked.CXMLRequest						= "1"
							invoked.CXMLRequestOrderRequest			= "1"
							invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
							invoked.CXMLRequestOrderRequestItemOutShipTo = "1"
							invoked.CXMLRequestOrderRequestItemOutShipToAddress = "1"
							invoked.CXMLRequestOrderRequestItemOutShipToAddressPostalAddress = "1"
							invoked.CXMLRequestOrderRequestItemOutShipToAddressPostalAddressState = "1"
							invoked.State								= each.ShipToAdress.StateProvince
		
						invoke Create CXMLRequestOrderRequestItemOutShipToAddressPostalAddressPostalCode
							invoked.CXML								= "1"
							invoked.CXMLRequest						= "1"
							invoked.CXMLRequestOrderRequest			= "1"
							invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
							invoked.CXMLRequestOrderRequestItemOutShipTo = "1"
							invoked.CXMLRequestOrderRequestItemOutShipToAddress = "1"
							invoked.CXMLRequestOrderRequestItemOutShipToAddressPostalAddress = "1"
							invoked.CXMLRequestOrderRequestItemOutShipToAddressPostalAddressPostalCode = "1"
							invoked.PostalCode							= each.ShipToAdress.PostalCode
		
						invoke Create CXMLRequestOrderRequestItemOutShipToAddressPostalAddressCountry
							invoked.CXML								= "1"
							invoked.CXMLRequest						= "1"
							invoked.CXMLRequestOrderRequest			= "1"
							invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
							invoked.CXMLRequestOrderRequestItemOutShipTo = "1"
							invoked.CXMLRequestOrderRequestItemOutShipToAddress = "1"
							invoked.CXMLRequestOrderRequestItemOutShipToAddressPostalAddress = "1"
							invoked.CXMLRequestOrderRequestItemOutShipToAddressPostalAddressCountry = "1"
							invoked.Country0							= each.ShipToAdress.Country.IsoCountryCode
							invoked.Country								= each.ShipToAdress.Country.Name
	
					initialize LocalComment
					PurchaseOrderLineCommentCount = 0
					LocalPurchaseOrderLine = each.PurchaseOrderLine
	
					for each PurchaseOrderEDIOutputLineCommentsRel
						PurchaseOrderLineCommentCount = PurchaseOrderLineCommentCount + 1
						LocalComment = LocalComment + "Comment" + PurchaseOrderLineCommentCount + ": " + each.CommentText
	
					invoke Create CXMLRequestOrderRequestItemOutComments
						invoked.CXML								= "1"
						invoked.CXMLRequest						= "1"
						invoked.CXMLRequestOrderRequest			= "1"
						invoked.CXMLRequestOrderRequestItemOut		= PurchaseOrderDispatchLineCount
						invoked.CXMLRequestOrderRequestItemOutComments	= "1"
						invoked.Comments0							= "en"
						invoked.Comments							= LocalComment

				include SerializeCXMLRequest
			
				invoke Dispatch PurchaseOrderDispatch
					PURCHASEORDERDISPATCHWSITIMEOUT		= "120"
					if	(PurchaseOrderDispatchVendorRel exists)
						PURCHASEORDERDISPATCHWSIWSDL			= PurchaseOrderDispatchVendorRel.PostToServer
						PURCHASEORDERDISPATCHWSIENDPOINT		= PurchaseOrderDispatchVendorRel.PostToServer
					else
						PURCHASEORDERDISPATCHWSIWSDL			= PurchaseOrderDispatchVendorRel2.PostToServer
						PURCHASEORDERDISPATCHWSIENDPOINT		= PurchaseOrderDispatchVendorRel2.PostToServer
		
					invoked.Request			= "1"
					MyResponse					= result.Response
					
				include SerializeCXMLResponse
	
				for each(Response) MyResponse.CXMLResponse set
					DispatchPOStatus = each(Response).Status0
					DispatchPOMessage = each(Response).Status1
					DispatchPOMessageDetail = each(Response).Status
	
				invoke Update PurchaseOrderRevisionRel
					invoked.TransmissionDate		= current timestamp
					invoked.TransmissionMessage		=	DispatchPOMessage
					invoked.TransmissionMessageDetail		=	DispatchPOMessageDetail
					if (DispatchPOStatus = "200" or DispatchPOStatus = "201" or DispatchPOStatus = "203")
						invoked.TransmissionStatus		= "1"
					else
						invoked.TransmissionStatus		= "2"
					
				invoke CreateCXMLRouterRecord
					resume on error		
	
				invoke Delete PurchaseOrderEDIOutputRel
	
		DispatchPurchaseOrders is a Set Action
			Parameters
				PrmCompany is a Company
					default label is "Company"
				ProcessByProcurementGroup is Boolean
	
			Sort Order
				Company
				PurchaseOrder
				PurchaseOrderRevision
				PurchaseOrderLine
				RecordType
				AddOnCharge
				PurchaseOrderEDIOutput
	
			Parameter Rules
				PrmCompany
					if (!ProcessByProcurementGroup)
						required
							"CompanyRequiredIfProcessByProcurementGroupNotSelected"
				ProcessByProcurementGroup
						initial value is false
						default to false
	
			Instance Selection
				where	(IssueMethod.XML
				and	RecordType.PurchaseOrder)
	
			Action Rules
				Instance Rules
					if (PrmCompany entered
					and Company		=	PrmCompany)
						if (AribaOrderRequest)
							invoke DispatchAribaPO
								resume on error
									LocalErrorMessage += error message	
						else							
							invoke	DispatchPO
								resume on error
					else
						if (ProcessByProcurementGroup)
							if (AribaOrderRequest)
								invoke DispatchAribaPO
									resume on error
										LocalErrorMessage += error message
							else
								invoke	DispatchPO
									resume on error

					if (LocalErrorMessage != "")
						invoke CreateCXMLErrorRecord
							resume on error
								
		DispatchAribaPO is an Instance Action
			default label is "DispatchP\O"

			valid when (DispatchAribaPurchaseOrder)
			Action Rules					
				invoke CreateOrderRequest OutboundCXMLOrderRequest
					invoked.Company						= Company
					invoked.PurchaseOrder				= PurchaseOrder
					invoked.PurchaseOrderRevision		= PurchaseOrderRevision
					invoked.RecordType					= RecordType
					invoked.VendorGroup					= Company.VendorGroup
					invoked.Vendor						= Vendor
					invoked.PurchaseFromLocation 		= VendorPurchaseFromLocation
					
		CreateCXMLRouterRecord is an Instance Action
			restricted
			Action Rules					
				invoke Create CXMLRouter
					invoked.RunGroup			= PurchaseOrderDispatchVendorRel.FromNetworkID
					invoked.Data				= LocalXMLRequest
					invoked.Status				= "Order Request: " + Company + "-" + PurchaseOrder
					if (PurchaseOrderDispatchVendorRel exists)
                		invoked.WSIEndpoint   	= PurchaseOrderDispatchVendorRel.PostToServer
            		else
                		invoked.WSIEndpoint    	= PurchaseOrderDispatchVendorRel2.PostToServer
					invoked.ResponseXML			= LocalXMLResponse
					
		CreateCXMLErrorRecord is an Instance Action
			restricted
			Action Rules
				invoke Create OutboundCXMLOrderRequest
					invoked.ProcessStatus				= 1
					invoked.StatusMessage				= "ERROR: " + LocalErrorMessage
					invoked.Company						= Company
					invoked.PurchaseOrder				= PurchaseOrder
					invoked.PurchaseOrderRevision		= PurchaseOrderRevision
					invoked.RecordType					= RecordType
					invoked.VendorGroup					= Company.VendorGroup
					invoked.Vendor						= Vendor
					invoked.PurchaseFromLocation 		= VendorPurchaseFromLocation
