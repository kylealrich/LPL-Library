DunningLetterFileGeneration is a BusinessTask
	owned by ar

	Patterns
		implements ManualTransaction
		implements StaticJava
			Reports
				DunningLetterFileGenerationReport
				CreditBalanceReport
				DunningLetter

	Parameters
		Company					is a ReceivableCompany
		CompanyGroup			is a GeneralLedgerCompanyGroup
		PrintOption				is AlphaUpper size 1
			States
				No	value is "N"
				Yes	value is "Y"
		CsvOption				is AlphaUpper size 1
			States
				Yes					value is "Y"
				No					value is "N"
				Collection			value is "C"
				ExcludeCollection	value is "E"
		UpdateOption			is AlphaUpper size 1
			States
				No	value is "N"
				Yes	value is "Y"
		ReportOption            is AlphaUpper size 1
            States
                CustomerNumber    value is "N"
                CustomerBillTo    value is "B"
		LetterFormat			is AlphaUpper size 2
			States
				Standard	value is "00"
				Sweden		value is "01"
		FileName				is AlphaUpper size 50
		CompanyCollectionID		is AlphaUpper size 20
		IncludeCustomerTaxID	is AlphaUpper size 1
			States
				Yes	value is "Y"
				No	value is "N"
		IDMPrinter

	Parameter Rules
		CompanyGroup
			constraint (Company not entered)
				"BothCompanyAndCompanyGroupCannotBeEntered"
			constraint (CompanyGroup.GeneralLedgerCompanyGroupMembersRel exists)
				"CompanyGroup<CompanyGroup>ContainsNoCompanies"
		PrintOption
			initial value is "N"
			default to "N"
		CsvOption
			initial value is "Y"
			default to "Y"
		UpdateOption
			initial value is "N"
			default to "N"
		LetterFormat
			initial value is "00"
			default to "00"
		IncludeCustomerTaxID
			initial value is "N"
			default to "N"
		IDMPrinter
			initial value is Company.UserDefaultPrinter
		ReportOption
			initial value is "N"
			default to "N"
			

	Actions
		DunningLetterFileGeneration is a Set Action
			allow unlimited concurrency

