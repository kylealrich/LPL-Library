AllocationLineSourceValue is a BusinessClass
	owned by Allocations
	
	prefix is ALSV
	
	Ontology
		symbolic key is AllocationLineSourceValue
		
	
	Patterns
        disable Auditing
        disable EffectiveDated
	
	Persistent Fields
		FinanceAddress
		ComputedAmount						is an InternationalAmount
			precision is AllocationRun.Currency.NumberOfDecimals 
		TransactionAmount					is an InternationalAmount
			precision is AllocationRun.Currency.NumberOfDecimals 
			default label is "SourceAmountInTransactionCurrency"
		CurrencyAmount						is a FinanceCurrencyAmount
		JournalCurrency						is a Currency
			default label is "SourceCurrency" 
		JournalAmount						is an InternationalAmount	
			precision is JournalCurrency.NumberOfDecimals	
			default label is "SourceAmount" 	
		CurrencyExchangeRate
			default label is "CurrencyRate"
		ErrorMessage						is Alpha 150
		FromOriginalSource					is Boolean
		
	Context Fields
		AccountingEntityContext 			is an AccountingEntity
		
	Local Fields
		LastAccountingEntity  				is like AccountingEntity
		AmountToSplit					is an InternationalAmount
		TotalTempAmount						is an InternationalAmount
		CurrentSplitAmount					is an InternationalAmount
		LocalCalculatedAmountlsDone			is Boolean
		LocalCalculatedAmount				is an InternationalAmount
		LocalWeightPercent					is Percent size 10.6	
		LocalWeight							is a InternationalAmount

	Transient Fields
		TransientAccountingUnit			is like AccountingUnit
			default label is "<actor.context.FinanceEnterpriseGroup.AccountingUnitLabel>"
			derive value from DerivedAccountingUnitForDetailList
		TransientAccount				is like GeneralLedgerChartAccount
			default label is "<actor.context.FinanceEnterpriseGroup.AccountLabel>"
			derive value from DerivedAccountForDetailList
		TransientProject				is like Project
			default label is "<actor.context.FinanceEnterpriseGroup.ProjectLabel>"
			derive value from DerivedProjectForDetailList
		TransientFinanceDimension1		is like FinanceDimension1
			default label is "<actor.context.FinanceEnterpriseGroup.FinanceDimension1Label>"
			derive value from DerivedFinanceDimension1ForDetailList
		TransientFinanceDimension2		is like FinanceDimension2
			default label is "<actor.context.FinanceEnterpriseGroup.FinanceDimension2Label>"
			derive value from DerivedFinanceDimension2ForDetailList
		TransientFinanceDimension3		is like FinanceDimension3
			default label is "<actor.context.FinanceEnterpriseGroup.FinanceDimension3Label>"
			derive value from DerivedFinanceDimension3ForDetailList
		TransientFinanceDimension4		is like FinanceDimension4
			default label is "<actor.context.FinanceEnterpriseGroup.FinanceDimension4Label>"
			derive value from DerivedFinanceDimension4ForDetailList
		TransientFinanceDimension5		is like FinanceDimension5
			default label is "<actor.context.FinanceEnterpriseGroup.FinanceDimension5Label>"
			derive value from DerivedFinanceDimension5ForDetailList
		TransientFinanceDimension6		is like FinanceDimension6
			default label is "<actor.context.FinanceEnterpriseGroup.FinanceDimension6Label>"
			derive value from DerivedFinanceDimension6ForDetailList
		TransientFinanceDimension7		is like FinanceDimension7
			default label is "<actor.context.FinanceEnterpriseGroup.FinanceDimension7Label>"
			derive value from DerivedFinanceDimension7ForDetailList
		TransientFinanceDimension8		is like FinanceDimension8
			default label is "<actor.context.FinanceEnterpriseGroup.FinanceDimension8Label>"
			derive value from DerivedFinanceDimension8ForDetailList
		TransientFinanceDimension9		is like FinanceDimension9
			default label is "<actor.context.FinanceEnterpriseGroup.FinanceDimension9Label>"
			derive value from DerivedFinanceDimension9ForDetailList
		TransientFinanceDimension10		is like FinanceDimension10
			default label is "<actor.context.FinanceEnterpriseGroup.FinanceDimension10Label>"
			derive value from DerivedFinanceDimension10ForDetailList

			
		
	Rule Blocks
		ComputeCalculateAmount
			if (!LocalCalculatedAmountlsDone)
				AmountToSplit = AllocableAmount
				
				if (ToAllocationLineTempOverrideByAccountingEntityRel exists)
					for each ToAllocationLineTempOverrideByAccountingEntityRel
						LastAccountingEntity	 	= each.AccountingEntity
						CurrentSplitAmount		 	= AmountToSplit * each.WeightPercent
						TotalTempAmount			   	+= CurrentSplitAmount
						
						if (each.AccountingEntity = AccountingEntityContext)
							LocalCalculatedAmount	= CurrentSplitAmount
							LocalWeightPercent 		= each.WeightPercent
							LocalWeight				= each.Weight 
					
					if (not AllocationLine.IncludeLineWeight and LastAccountingEntity = AccountingEntityContext)
						LocalCalculatedAmount 		= LocalCalculatedAmount + (AmountToSplit - TotalTempAmount)     
				else
					if (AllocationLineOverrideRel not exists
					and AllocationLineWeightRel not exists)
						LocalWeightPercent			= 100%
						LocalCalculatedAmount 		= AmountToSplit
					                                     
				LocalCalculatedAmountlsDone			= true

	Derived Fields
		CalculatedAmount					is a DerivedField
			type is like InternationalAmount
				precision is AllocationRun.Currency.NumberOfDecimals 
			include ComputeCalculateAmount
			return LocalCalculatedAmount		  



		DerivedCurrencyLabelForDetailList is a DerivedField
			type is MessageField
			restricted
			if (AllocationLineReportRel.ComputeAndBypassSourceBalance)
				return AllocationCurrencyMessage
			else
				return SourceCurrencyMessage

		DerivedCurrencyLabel is a DerivedField
			type is MessageField
			restricted
			if (AllocationLine.ComputeAndBypassSourceBalance)
				return AllocationCurrencyMessage
			else
				return SourceCurrencyMessage

		AllocationCurrencyMessage is a MessageField
			restricted
			"AllocationCurrency"
			
		
		SourceCurrencyMessage is a MessageField
			restricted
			"TransactionCurrency"

		WeightPercent						is a DerivedField
			type is Percent size 10.6
			default label is "SplitPercentage"
			include ComputeCalculateAmount
			return LocalWeightPercent
			
		Weight 								is a DerivedField
			type is like InternationalAmount
			include ComputeCalculateAmount
			return LocalWeight		  
			
		AllocableAmount						is a DerivedField
			type is like InternationalAmount
				precision is AllocationRun.Currency.NumberOfDecimals 
			if (ComputedAmount entered)
				return ComputedAmount
			else 
				return (TransactionAmount * AllocationLine.SourcePercentage)

		DetailedAddressLabel is a DerivedField
			type is Alpha size 20
			if (IsFirstAllocationLineSourceValue)
				return "Detailed Source:"
				
		DerivedAccountingUnit is a DerivedField
			type is Alpha size 25
            if (AllocationLine.SourceAccountingUnitGroup entered
            and not AllocationLine.ProcessAccountingUnitPostingBalance
            and not AllocationLine.ProcessAllPostingBalance)
                return AllocationLine.SourceAccountingUnitGroup
            else
			if (FinanceAddress.AccountingUnit entered)
				return FinanceAddress.AccountingUnit
			else
				return AllocationLine.AccountingUnitStructure.AccountingUnitTopNodeGroup.DimensionNode

        DerivedAccount  is a DerivedField
            type is Alpha size 25
            if (AllocationLine.SourceAccountGroup entered
            and not AllocationLine.ProcessAccountPostingBalance
            and not AllocationLine.ProcessAllPostingBalance)
                return AllocationLine.SourceAccountGroup
            return FinanceAddress.GeneralLedgerChartAccount

        DerivedProject  is a DerivedField
            type is Alpha size 25
            if (AllocationLine.SourceProjectGroup entered
            and not AllocationLine.ProcessProjectPostingBalance
            and not AllocationLine.ProcessAllPostingBalance)
                return AllocationLine.SourceProjectGroup
            return FinanceAddress.Project

        DerivedFinanceDimension1  is a DerivedField
            type is Alpha size 25
            if (AllocationLine.SourceFinanceDimension1Group entered
            and not AllocationLine.ProcessDimension1PostingBalance
            and not AllocationLine.ProcessAllPostingBalance)
                return AllocationLine.SourceFinanceDimension1Group
            return FinanceAddress.FinanceDimension1
        
        DerivedFinanceDimension2  is a DerivedField
            type is Alpha size 25
            if (AllocationLine.SourceFinanceDimension2Group entered
            and not AllocationLine.ProcessDimension2PostingBalance
            and not AllocationLine.ProcessAllPostingBalance)
                return AllocationLine.SourceFinanceDimension2Group
            return FinanceAddress.FinanceDimension2

        DerivedFinanceDimension3  is a DerivedField
            type is Alpha size 25
            if (AllocationLine.SourceFinanceDimension3Group entered
            and not AllocationLine.ProcessDimension3PostingBalance
            and not AllocationLine.ProcessAllPostingBalance)
                return AllocationLine.SourceFinanceDimension3Group
            return FinanceAddress.FinanceDimension3

        DerivedFinanceDimension4  is a DerivedField
            type is Alpha size 25
            if (AllocationLine.SourceFinanceDimension4Group entered
            and not AllocationLine.ProcessDimension4PostingBalance
            and not AllocationLine.ProcessAllPostingBalance)
                return AllocationLine.SourceFinanceDimension4Group
            return FinanceAddress.FinanceDimension4

        DerivedFinanceDimension5  is a DerivedField
            type is Alpha size 25
            if (AllocationLine.SourceFinanceDimension5Group entered
            and not AllocationLine.ProcessDimension5PostingBalance
            and not AllocationLine.ProcessAllPostingBalance)
                return AllocationLine.SourceFinanceDimension5Group
            return FinanceAddress.FinanceDimension5

        DerivedFinanceDimension6  is a DerivedField
            type is Alpha size 25
            if (AllocationLine.SourceFinanceDimension6Group entered
            and not AllocationLine.ProcessDimension6PostingBalance
            and not AllocationLine.ProcessAllPostingBalance)
                return AllocationLine.SourceFinanceDimension6Group
            return FinanceAddress.FinanceDimension6

        DerivedFinanceDimension7  is a DerivedField
            type is Alpha size 25
            if (AllocationLine.SourceFinanceDimension1Group entered
            and not AllocationLine.ProcessDimension7PostingBalance
            and not AllocationLine.ProcessAllPostingBalance)
                return AllocationLine.SourceFinanceDimension7Group
            return FinanceAddress.FinanceDimension7

        DerivedFinanceDimension8  is a DerivedField
            type is Alpha size 25
            if (AllocationLine.SourceFinanceDimension8Group entered
            and not AllocationLine.ProcessDimension8PostingBalance
            and not AllocationLine.ProcessAllPostingBalance)
                return AllocationLine.SourceFinanceDimension8Group
            return FinanceAddress.FinanceDimension8

        DerivedFinanceDimension9  is a DerivedField
            type is Alpha size 25
            if (AllocationLine.SourceFinanceDimension9Group entered
            and not AllocationLine.ProcessDimension9PostingBalance
            and not AllocationLine.ProcessAllPostingBalance)
                return AllocationLine.SourceFinanceDimension9Group
            return FinanceAddress.FinanceDimension9

        DerivedFinanceDimension10  is a DerivedField
            type is Alpha size 25
            if (AllocationLine.SourceFinanceDimension10Group entered
            and not AllocationLine.ProcessDimension1PostingBalance
            and not AllocationLine.ProcessAllPostingBalance)
                return AllocationLine.SourceFinanceDimension10Group
            return FinanceAddress.FinanceDimension10


		AllocableAmountForDetailList			is a DerivedField
			type is like InternationalAmount
				precision is AllocationRun.Currency.NumberOfDecimals 
			default label is "AllocableAmount"
			if (ComputedAmount entered)
				return ComputedAmount
			else 
				return (TransactionAmount * AllocationLineReportRel.SourcePercentage)

		AllocableFunctionalAmount	is a DerivedField
			type is like InternationalAmount
				precision is CurrencyAmount.FunctionalAmount.ToCurrency.NumberOfDecimals
			return (CurrencyAmount.FunctionalAmount.EnteredCurrencyAmount * AllocationLineReportRel.SourcePercentage)

		AllocableAlternateAmount	is a DerivedField
			type is like InternationalAmount
				precision is FinanceAddress.AccountingEntity.AlternateCurrency.NumberOfDecimals
			return (CurrencyAmount.AlternateAmount.EnteredCurrencyAmount * AllocationLineReportRel.SourcePercentage)

		AllocableAlternateAmount2	is a DerivedField
			type is like InternationalAmount
				precision is FinanceAddress.AccountingEntity.AlternateCurrency2.NumberOfDecimals
			return (CurrencyAmount.AlternateAmount2.EnteredCurrencyAmount * AllocationLineReportRel.SourcePercentage)

		AllocableAlternateAmount3	is a DerivedField
			type is like InternationalAmount
				precision is FinanceAddress.AccountingEntity.AlternateCurrency3.NumberOfDecimals
			return (CurrencyAmount.AlternateAmount3.EnteredCurrencyAmount * AllocationLineReportRel.SourcePercentage)

		AllocableProjectAmount		is a DerivedField
			type is like InternationalAmount
				precision is FinanceAddress.Project.Currency.NumberOfDecimals
			return (CurrencyAmount.ProjectAmount.EnteredCurrencyAmount * AllocationLineReportRel.SourcePercentage)

		AllocableReportAmount1		is a DerivedField
			type is like InternationalAmount
				precision is FinanceEnterpriseGroup.ReportCurrencyOne.NumberOfDecimals
			return (CurrencyAmount.ReportAmount1.EnteredCurrencyAmount * AllocationLineReportRel.SourcePercentage)

		AllocableReportAmount2		is a DerivedField
			type is like InternationalAmount
				precision is FinanceEnterpriseGroup.ReportCurrencyTwo.NumberOfDecimals
			return (CurrencyAmount.ReportAmount2.EnteredCurrencyAmount * AllocationLineReportRel.SourcePercentage)

		AllocableReportAmount3		is a DerivedField
			type is like InternationalAmount
				precision is FinanceEnterpriseGroup.ReportCurrencyThree.NumberOfDecimals
			return (CurrencyAmount.ReportAmount3.EnteredCurrencyAmount * AllocationLineReportRel.SourcePercentage)
		
		AllocableReportAmount4		is a DerivedField
			type is like InternationalAmount
				precision is FinanceEnterpriseGroup.ReportCurrencyFour.NumberOfDecimals
			return (CurrencyAmount.ReportAmount4.EnteredCurrencyAmount * AllocationLineReportRel.SourcePercentage)

		AllocableReportAmount5		is a DerivedField
			type is like InternationalAmount
				precision is FinanceEnterpriseGroup.ReportCurrencyFive.NumberOfDecimals
			return (CurrencyAmount.ReportAmount5.EnteredCurrencyAmount * AllocationLineReportRel.SourcePercentage)


		DerivedAccountingUnitForDetailList is a DerivedField
			type is Alpha size 25
			restricted
            if (AllocationLineReportRel.SourceAccountingUnitGroup entered
            and not AllocationLineReportRel.ProcessAccountingUnitPostingBalance
            and not AllocationLineReportRel.ProcessAllPostingBalance)
                return AllocationLineReportRel.SourceAccountingUnitGroup
            else
			if (FinanceAddress.AccountingUnit entered)
				return FinanceAddress.AccountingUnit
			else
				return AllocationLineReportRel.AccountingUnitStructure.AccountingUnitTopNodeGroup.DimensionNode

        DerivedAccountForDetailList  is a DerivedField
            type is Alpha size 25
			restricted
            if (AllocationLineReportRel.SourceAccountGroup entered
            and not AllocationLineReportRel.ProcessAccountPostingBalance
            and not AllocationLineReportRel.ProcessAllPostingBalance)
                return AllocationLineReportRel.SourceAccountGroup
            return FinanceAddress.GeneralLedgerChartAccount

        DerivedProjectForDetailList  is a DerivedField
            type is Alpha size 25
			restricted
            if (AllocationLineReportRel.SourceProjectGroup entered
            and not AllocationLineReportRel.ProcessProjectPostingBalance
            and not AllocationLineReportRel.ProcessAllPostingBalance)
                return AllocationLineReportRel.SourceProjectGroup
            return FinanceAddress.Project

        DerivedFinanceDimension1ForDetailList  is a DerivedField
            type is Alpha size 25
			restricted
            if (AllocationLineReportRel.SourceFinanceDimension1Group entered
            and not AllocationLineReportRel.ProcessDimension1PostingBalance
            and not AllocationLineReportRel.ProcessAllPostingBalance)
                return AllocationLineReportRel.SourceFinanceDimension1Group
            return FinanceAddress.FinanceDimension1
        
        DerivedFinanceDimension2ForDetailList  is a DerivedField
            type is Alpha size 25
			restricted
            if (AllocationLineReportRel.SourceFinanceDimension2Group entered
            and not AllocationLineReportRel.ProcessDimension2PostingBalance
            and not AllocationLineReportRel.ProcessAllPostingBalance)
                return AllocationLineReportRel.SourceFinanceDimension2Group
            return FinanceAddress.FinanceDimension2

        DerivedFinanceDimension3ForDetailList  is a DerivedField
            type is Alpha size 25
			restricted
            if (AllocationLineReportRel.SourceFinanceDimension3Group entered
            and not AllocationLineReportRel.ProcessDimension3PostingBalance
            and not AllocationLineReportRel.ProcessAllPostingBalance)
                return AllocationLineReportRel.SourceFinanceDimension3Group
            return FinanceAddress.FinanceDimension3

        DerivedFinanceDimension4ForDetailList  is a DerivedField
            type is Alpha size 25
			restricted
            if (AllocationLineReportRel.SourceFinanceDimension4Group entered
            and not AllocationLineReportRel.ProcessDimension4PostingBalance
            and not AllocationLineReportRel.ProcessAllPostingBalance)
                return AllocationLineReportRel.SourceFinanceDimension4Group
            return FinanceAddress.FinanceDimension4

        DerivedFinanceDimension5ForDetailList  is a DerivedField
            type is Alpha size 25
			restricted
            if (AllocationLineReportRel.SourceFinanceDimension5Group entered
            and not AllocationLineReportRel.ProcessDimension5PostingBalance
            and not AllocationLineReportRel.ProcessAllPostingBalance)
                return AllocationLineReportRel.SourceFinanceDimension5Group
            return FinanceAddress.FinanceDimension5

        DerivedFinanceDimension6ForDetailList  is a DerivedField
            type is Alpha size 25
			restricted
            if (AllocationLineReportRel.SourceFinanceDimension6Group entered
            and not AllocationLineReportRel.ProcessDimension6PostingBalance
            and not AllocationLineReportRel.ProcessAllPostingBalance)
                return AllocationLineReportRel.SourceFinanceDimension6Group
            return FinanceAddress.FinanceDimension6

        DerivedFinanceDimension7ForDetailList  is a DerivedField
            type is Alpha size 25
			restricted
            if (AllocationLineReportRel.SourceFinanceDimension1Group entered
            and not AllocationLineReportRel.ProcessDimension7PostingBalance
            and not AllocationLineReportRel.ProcessAllPostingBalance)
                return AllocationLineReportRel.SourceFinanceDimension7Group
            return FinanceAddress.FinanceDimension7

        DerivedFinanceDimension8ForDetailList  is a DerivedField
            type is Alpha size 25
			restricted
            if (AllocationLineReportRel.SourceFinanceDimension8Group entered
            and not AllocationLineReportRel.ProcessDimension8PostingBalance
            and not AllocationLineReportRel.ProcessAllPostingBalance)
                return AllocationLineReportRel.SourceFinanceDimension8Group
            return FinanceAddress.FinanceDimension8

        DerivedFinanceDimension9ForDetailList  is a DerivedField
            type is Alpha size 25
			restricted
            if (AllocationLineReportRel.SourceFinanceDimension9Group entered
            and not AllocationLineReportRel.ProcessDimension9PostingBalance
            and not AllocationLineReportRel.ProcessAllPostingBalance)
                return AllocationLineReportRel.SourceFinanceDimension9Group
            return FinanceAddress.FinanceDimension9

        DerivedFinanceDimension10ForDetailList  is a DerivedField
            type is Alpha size 25
			restricted
            if (AllocationLineReportRel.SourceFinanceDimension10Group entered
            and not AllocationLineReportRel.ProcessDimension1PostingBalance
            and not AllocationLineReportRel.ProcessAllPostingBalance)
                return AllocationLineReportRel.SourceFinanceDimension10Group
            return FinanceAddress.FinanceDimension10

	Field Rules
		CurrencyExchangeRate
			default to 1
						
	Conditions
		ErrorExists
			restricted
			when (ErrorMessage entered)
			
		IsFirstAllocationLineSourceValue
			restricted
			when (AllocationLineSourceValue = AllocationLine.FirstAllocationLineSourceValue)
		
		ComputeAndBypassSourceBalance
			restricted
			when (AllocationLine.ComputeAndBypassSourceBalance)

		CurrencyAmountsEntered
			restricted
			when (CurrencyAmount.FunctionalAmount.EnteredCurrencyAmount entered or CurrencyAmount.AlternateAmount.EnteredCurrencyAmount entered
			or    CurrencyAmount.AlternateAmount2.EnteredCurrencyAmount entered or CurrencyAmount.AlternateAmount3.EnteredCurrencyAmount entered
			or	  CurrencyAmount.ProjectAmount.EnteredCurrencyAmount entered or CurrencyAmount.ReportAmount1.EnteredCurrencyAmount entered
			or	  CurrencyAmount.ReportAmount2.EnteredCurrencyAmount entered or CurrencyAmount.ReportAmount3.EnteredCurrencyAmount entered
			or 	  CurrencyAmount.ReportAmount4.EnteredCurrencyAmount entered or CurrencyAmount.ReportAmount5.EnteredCurrencyAmount entered)

	Sets
		ByAllocationLine
            indexed
            duplicates
            Sort Order
            	FinanceEnterpriseGroup
            	AllocationSourceSystem
            	AllocationControl
            	AllocationLine
            	AllocationRun
            	
        ByAllocationRun
            indexed
            duplicates
            Sort Order
            	FinanceEnterpriseGroup


            	AllocationRun
            	
  		ByAlternate
  			indexed
  			Sort Order
				FinanceEnterpriseGroup		
				AllocationSourceSystem		
				AllocationControl			
				Allocation					
				AllocationLine				
				AllocationRun				
				GeneralLedgerCalendarPeriod 
				AllocationLineSourceValue   	  			
            	
    Relations
    	ToAllocationLineTempOverrideByAccountingEntityRel
    		one-to-many relation to AllocationLineTempOverride
    		Field Mapping uses symbolic key
    			related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
    			related.AllocationSourceSystem	= AllocationSourceSystem
    			related.AllocationControl		= AllocationControl
    			related.Allocation				= Allocation
    			related.AllocationLine			= AllocationLine
    			related.AllocationRun			= AllocationRun
    		Instance Selection
    			where (related.Direction.To	
    			and    (related.GeneralLedgerCalendarPeriod = GeneralLedgerCalendarPeriod))
    			
    	AllocationLineOverrideRel
    		one-to-many relation to AllocationLineOverride
    		Field Mapping uses symbolic key
    			related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
    			related.AllocationSourceSystem	= AllocationSourceSystem
    			related.AllocationControl		= AllocationControl
    			related.Allocation				= Allocation
    			related.AllocationLine			= AllocationLine
    		Instance Selection
    			where (related.Direction.To)
    			
		AllocationLineWeightRel
			one-to-many relation to AllocationLineOverride
    		Field Mapping uses symbolic key
    			related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
    			related.AllocationSourceSystem	= AllocationSourceSystem
    			related.AllocationControl		= AllocationControl
    			related.Allocation				= Allocation
    			related.AllocationLine			= AllocationLine

		AllocationLineTempOverrideRel
            one-to-many relation to AllocationLineTempOverride
            Field Mapping uses symbolic key
    			related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
    			related.AllocationSourceSystem	= AllocationSourceSystem
    			related.AllocationControl		= AllocationControl
    			related.Allocation				= Allocation
    			related.AllocationLine			= AllocationLine
    			related.AllocationRun			= AllocationRun

		AllocationLineReportRel
			one-to-one relation to AllocationLineReport
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup								= FinanceEnterpriseGroup
				related.AllocationRun										= AllocationRun
				related.AllocationLineReport.AllocationSourceSystem			= AllocationSourceSystem
				related.AllocationLineReport.AllocationControl				= AllocationControl
				related.AllocationLineReport.Allocation						= Allocation
				related.AllocationLineReport.AllocationLine					= AllocationLine				
    			
	Actions
		Create is a Create Action
			restricted
			
		Delete is a Delete Action
			restricted

    	DeleteAllForRun is a Set Action
    		restricted
    		Parameters
    			PrmEnterpriseGroup		is a FinanceEnterpriseGroup
    				default label is "FinanceEnterpriseGroup"
    			PrmAllocationRun		is a AllocationRun
    				default label is "AllocationRun"
			Sort Order
				FinanceEnterpriseGroup				
				AllocationRun
    		Instance Selection
				where (FinanceEnterpriseGroup	= PrmEnterpriseGroup
				and    AllocationRun			= PrmAllocationRun)
			Action Rules
				Instance Rules
					invoke Delete
		
    	UpdateAmounts is an Instance Action
    		restricted
    		default label is untranslatable
    		Parameters
                PrmComputedAmount						is an InternationalAmount
					precision is AllocationRun.Currency.NumberOfDecimals 
				PrmTransactionAmount					is an InternationalAmount
					precision is AllocationRun.Currency.NumberOfDecimals 
					default label is "SourceAmountInTransactionCurrency" 
				PrmJournalAmount						is an InternationalAmount	
					precision is JournalCurrency.NumberOfDecimals	
					default label is "SourceAmount"
				PrmCurrencyAmount						is a FinanceCurrencyAmount 
					default label is "CurrencyAmount"
			Action Rules
                TransactionAmount		+= PrmTransactionAmount
				ComputedAmount			+= PrmComputedAmount
				JournalAmount			+= PrmJournalAmount
				CurrencyAmount.FunctionalAmount.EnteredCurrencyAmount	+= PrmCurrencyAmount.FunctionalAmount.EnteredCurrencyAmount
				CurrencyAmount.ProjectAmount.EnteredCurrencyAmount		+= PrmCurrencyAmount.ProjectAmount.EnteredCurrencyAmount
				CurrencyAmount.AlternateAmount.EnteredCurrencyAmount	+= PrmCurrencyAmount.AlternateAmount.EnteredCurrencyAmount
				CurrencyAmount.AlternateAmount2.EnteredCurrencyAmount	+= PrmCurrencyAmount.AlternateAmount2.EnteredCurrencyAmount
				CurrencyAmount.AlternateAmount3.EnteredCurrencyAmount	+= PrmCurrencyAmount.AlternateAmount3.EnteredCurrencyAmount
				CurrencyAmount.ReportAmount1.EnteredCurrencyAmount		+= PrmCurrencyAmount.ReportAmount1.EnteredCurrencyAmount
				CurrencyAmount.ReportAmount2.EnteredCurrencyAmount		+= PrmCurrencyAmount.ReportAmount2.EnteredCurrencyAmount
				CurrencyAmount.ReportAmount3.EnteredCurrencyAmount		+= PrmCurrencyAmount.ReportAmount3.EnteredCurrencyAmount
				CurrencyAmount.ReportAmount4.EnteredCurrencyAmount		+= PrmCurrencyAmount.ReportAmount4.EnteredCurrencyAmount
				CurrencyAmount.ReportAmount5.EnteredCurrencyAmount		+= PrmCurrencyAmount.ReportAmount5.EnteredCurrencyAmount
        
#ifdef module truecost   
    	ComputeOriginalSourceValue is a Set Action
    		restricted
    		Parameters
    			PrmFinanceEnterpriseGroup		is a FinanceEnterpriseGroup
    			PrmTrueCostAllocationRun		is a TrueCostAllocationRun

			Sort Order is ByAllocationRun

    		Instance Selection
				where (FinanceEnterpriseGroup	= PrmFinanceEnterpriseGroup
				and    AllocationRun			= PrmTrueCostAllocationRun
				and	   FromOriginalSource)

			Local Fields
				LocalTotalCosted				is a TotalAmount

			Action Rules
				Set Rules
					Exit Rules
						invoke Update PrmTrueCostAllocationRun
							invoked.TotalCosted = LocalTotalCosted

				Instance Rules
					LocalTotalCosted			+= TransactionAmount * AllocationLine.SourcePercentage

#endif
