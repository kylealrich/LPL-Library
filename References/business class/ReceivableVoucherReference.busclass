ReceivableVoucherReference is a BusinessTask
    owned by ar

    Parameters
        Company                 	is a ReceivableCompany
        CompanyGroup				is a GeneralLedgerCompanyGroup
        YearOption					is Numeric 1 
			States
				CurrentYear	  value is 1
				PreviousYear  value is 2

    Parameter Rules
        Company
			constraint (CompanyGroup not entered)
				"CompanyGroupMustNotBeEntered"	      
				
			if (Company not entered
			and CompanyGroup not entered)
				required				  

			if (Company entered)
				constraint (Company.VoucherReference)
					"ReceivableCompanyIsNotConfiguredForVoucherReferenceNumber"
		
		CompanyGroup
			constraint (CompanyGroup.GeneralLedgerCompanyGroupMembersRel exists)
				"CompanyGroup<CompanyGroup>ContainsNoCompanies"
				
		YearOption
			required
			
    Actions
    	ReceivableVoucherReference is an Instance Action
    		Action Rules
    			if (Company entered)
       	    		invoke AssignVoucherReferenceNumber Company 
       	    			invoked.PrmYearOption 	 = YearOption

				if (CompanyGroup entered)
       	    		for each CompanyGroup.GeneralLedgerCompanyGroupMembersRel
       	    			Company = each.Company
       	    			if (Company.VoucherReference)
       	    				invoke AssignVoucherReferenceNumber Company 
       	    					invoked.PrmYearOption = YearOption
       		
