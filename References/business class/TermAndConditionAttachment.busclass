TermAndConditionAttachment is a BusinessClass
    owned by procurement
    prefix is TCAT

	Patterns
		implements Resequence on DisplayOrder
			new sequence field is NewDisplayOrder
			set is ByDisplayOrder

    Ontology
    	symbolic key is TermAndConditionAttachment

    Persistent Fields
		Attachment
		AttachmentReference is a Description
		DisplayOrder

	Transient Fields
		NewDisplayOrder			is a DisplayOrder

    Field Rules
    	Attachment
    		required

	Conditions
		TermAndConditionUpdateExists
			restricted
			when (TermAndConditionUpdateRel exists)
		HasAttachment
			restricted
			when (Attachment entered)

	Relations
		TermAndConditionUpdateRel
			one-to-many relation to TermAndConditionUpdate
			Field Mapping uses symbolic key
				related.ProcurementGroup 			= ProcurementGroup
				related.Article						= Article
				related.TermAndCondition			= TermAndCondition
			Instance Selection
				where (related.AttachmentToDelete = TermAndConditionAttachment
				and	   related.Status.Draft
				and	   related.SpecificRequestType.DeleteAttachment)

 	Sets
 		ByDisplayOrder
 			duplicates
 			Sort Order
				ProcurementGroup
                Article
                TermAndCondition
				DisplayOrder
 				TermAndConditionAttachment
		
	Actions
		Create is a Create Action
			valid when (TermAndCondition.AllowDescriptionUpdate)
			Field Rules
	 			DisplayOrder
	 				autosequence using TermAndCondition.LastAttachmentDisplayOrder

		Update is an Update Action

		UpdateDisplayOrder is an Update Action
			restricted

		Delete is a Delete Action
			valid when (TermAndCondition.AllowDescriptionUpdate)
		
		DeleteFromRequest is a Delete Action
			restricted
