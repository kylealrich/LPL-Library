AllocationSnapshotDetail is a BusinessClass
    owned by Allocations
    prefix is ALCSD

    Ontology
    	symbolic key is AllocationSnapshotDetail
    	
    Patterns
 		implements AnalyticCube
 			disable continuous update
 			dynamically calculate totals
 			write to base level only
 		disable EffectiveDated

	Persistent Fields
		FinanceCodeBlock				is a TransactionCodeBlock
		CurrencyCode					is a FromCurrency
		TransactionAmount				is a CurrencyAmount
        UnitsAmount
		ReportCurrencyAmount			is a FinanceCurrencyAmount
		System							is a GeneralLedgerSystemCode
		EntityYearPeriod				is a GeneralLedgerCalendarPeriod 

	Dimensions
		AllocationSnapshot
		CurrencyCode.Currency
			dimension name is Currency
		FinanceCodeBlock.ToAccountingEntity
			dimension name is AccountingEntity
		FinanceCodeBlock.AccountingUnit
			dimension name is AccountingUnit
		FinanceCodeBlock.GeneralLedgerChartAccount
			dimension name is ChartAccount
		FinanceCodeBlock.Project
			dimension name is Project
		FinanceCodeBlock.FinanceDimension1
			dimension name is FinanceDimension1
		FinanceCodeBlock.FinanceDimension2
			dimension name is FinanceDimension2
		FinanceCodeBlock.FinanceDimension3
			dimension name is FinanceDimension3
		FinanceCodeBlock.FinanceDimension4
			dimension name is FinanceDimension4
		FinanceCodeBlock.FinanceDimension5
			dimension name is FinanceDimension5
		FinanceCodeBlock.FinanceDimension6
			dimension name is FinanceDimension6
		FinanceCodeBlock.FinanceDimension7
			dimension name is FinanceDimension7
		FinanceCodeBlock.FinanceDimension8
			dimension name is FinanceDimension8
		FinanceCodeBlock.FinanceDimension9
			dimension name is FinanceDimension9
		FinanceCodeBlock.FinanceDimension10
			dimension name is FinanceDimension10
		EntityYearPeriod
	    	dimension name is CalendarPeriod
	    System
	    	dimension name is System
	    FinanceCodeBlock.Ledger
	    	dimension name is Ledger

	Measures
	    TransactionAmount
		UnitsAmount
	    ReportCurrencyAmount.FunctionalAmount.EnteredCurrencyAmount
	    	measure name is FunctionalAmount
	    ReportCurrencyAmount.AlternateAmount.EnteredCurrencyAmount
	    	measure name is AlternateAmount
	    ReportCurrencyAmount.AlternateAmount2.EnteredCurrencyAmount
	    	measure name is AlternateAmount2
	    ReportCurrencyAmount.AlternateAmount3.EnteredCurrencyAmount
	    	measure name is AlternateAmount3
	    ReportCurrencyAmount.ProjectAmount.EnteredCurrencyAmount
	    	measure name is ProjectAmount
	    ReportCurrencyAmount.ReportAmount1.EnteredCurrencyAmount
	    	measure name is ReportAmount1
	    ReportCurrencyAmount.ReportAmount2.EnteredCurrencyAmount
	    	measure name is ReportAmount2
	    ReportCurrencyAmount.ReportAmount3.EnteredCurrencyAmount
	    	measure name is ReportAmount3
	    ReportCurrencyAmount.ReportAmount4.EnteredCurrencyAmount
	    	measure name is ReportAmount4
	    ReportCurrencyAmount.ReportAmount5.EnteredCurrencyAmount
	    	measure name is ReportAmount5
	    	
	Local Fields
#ifdef module truecost	
		LocalDimensionCode						is a DriverDimensionCode
		LocalTrueCostResourceUtilizationDriver 	is like TrueCostResourceUtilizationDriver
#endif 
		LocalAllocationRun						is a AllocationRun
		
	Relations	

#ifdef module truecost
		TrueCostResourceUnitCostDetailsRel
			one-to-one relation to TrueCostResourceUnitCostDetails
			Field Mapping uses symbolic key
				related.TrueCostConfiguration						= FinanceEnterpriseGroup
				related.AllocationRun								= LocalAllocationRun
				related.TrueCostResourceUtilizationDriver			= LocalTrueCostResourceUtilizationDriver
				related.TrueCostResourceUnitCostDetails				= LocalDimensionCode.GetDimensionCode	
#endif
		
	Conditions
		AccountingUnitUsed
			restricted
			when (FinanceEnterpriseGroup.AccountingUnitLabel entered)
		Dimension1Used
			restricted
			when (FinanceEnterpriseGroup.FinanceDimension1Label entered)
		Dimension2Used
			restricted
			when (FinanceEnterpriseGroup.FinanceDimension2Label entered)
		Dimension3Used
			restricted
			when (FinanceEnterpriseGroup.FinanceDimension3Label entered)
		Dimension4Used
			restricted
			when (FinanceEnterpriseGroup.FinanceDimension4Label entered)
		Dimension5Used
			restricted
			when (FinanceEnterpriseGroup.FinanceDimension5Label entered)
		Dimension6Used
			restricted
			when (FinanceEnterpriseGroup.FinanceDimension6Label entered)
		Dimension7Used
			restricted
			when (FinanceEnterpriseGroup.FinanceDimension7Label entered)
		Dimension8Used
			restricted
			when (FinanceEnterpriseGroup.FinanceDimension8Label entered)
		Dimension9Used
			restricted
			when (FinanceEnterpriseGroup.FinanceDimension9Label entered)
		Dimension10Used
			restricted
			when (FinanceEnterpriseGroup.FinanceDimension10Label entered)

		AlternateCurrencyExists
			restricted
			when (FinanceCodeBlock.ToAccountingEntity.AlternateCurrencyEntered)
		AlternateCurrency2Exists
			restricted
			when (FinanceCodeBlock.ToAccountingEntity.AlternateCurrency2Entered)
		AlternateCurrency3Exists
			restricted
			when (FinanceCodeBlock.ToAccountingEntity.AlternateCurrency3Entered)			
		ReportCurrencyOneExists
			restricted
			when (FinanceEnterpriseGroup.ReportCurrencyOneEntered)
		ReportCurrencyTwoExists
			restricted
			when (FinanceEnterpriseGroup.ReportCurrencyTwoEntered)
		ReportCurrencyThreeExists
			restricted
			when (FinanceEnterpriseGroup.ReportCurrencyThreeEntered)
		ReportCurrencyFourExists
			restricted
			when (FinanceEnterpriseGroup.ReportCurrencyFourEntered)
		ReportCurrencyFiveExists
			restricted
			when (FinanceEnterpriseGroup.ReportCurrencyFiveEntered)
		UnitsAmountExists
			restricted
			when (UnitsAmount entered)
		ProjectExists
        	restricted
        	when (FinanceCodeBlock.Project entered)
	
	Actions
		Create is an Action


			bypass field rules

		Update is an Action

		Delete is an Action
		
#ifdef module truecost		
		GenerateDirectCostForUnitCost is a Set Action
			restricted
			Parameters
				PrmTrueCostConfiguration				is a TrueCostConfiguration
				PrmTrueCostAllocationRun				is an AllocationRun
				PrmAllocationSnapshot					is an AllocationSnapshot
				PrmAllocationSourceSystem				is an AllocationSourceSystem
				PrmTrueCostResourceUtilizationDriver	is a TrueCostResourceUtilizationDriver
			Instance Selection
				where  (FinanceEnterpriseGroup		= PrmTrueCostConfiguration
				and     AllocationSnapshot			= PrmAllocationSnapshot
				and     AllocationSourceSystem		= PrmAllocationSourceSystem
				and   ((PrmTrueCostConfiguration.CostObjectDimension.Type.Dimension1  and FinanceCodeBlock.FinanceDimension1  entered)
				or     (PrmTrueCostConfiguration.CostObjectDimension.Type.Dimension2  and FinanceCodeBlock.FinanceDimension2  entered)
				or     (PrmTrueCostConfiguration.CostObjectDimension.Type.Dimension3  and FinanceCodeBlock.FinanceDimension3  entered)
				or     (PrmTrueCostConfiguration.CostObjectDimension.Type.Dimension4  and FinanceCodeBlock.FinanceDimension4  entered)
				or     (PrmTrueCostConfiguration.CostObjectDimension.Type.Dimension5  and FinanceCodeBlock.FinanceDimension5  entered)
				or     (PrmTrueCostConfiguration.CostObjectDimension.Type.Dimension6  and FinanceCodeBlock.FinanceDimension6  entered)
				or     (PrmTrueCostConfiguration.CostObjectDimension.Type.Dimension7  and FinanceCodeBlock.FinanceDimension7  entered)
				or     (PrmTrueCostConfiguration.CostObjectDimension.Type.Dimension8  and FinanceCodeBlock.FinanceDimension8  entered)
				or     (PrmTrueCostConfiguration.CostObjectDimension.Type.Dimension9  and FinanceCodeBlock.FinanceDimension9  entered)
				or     (PrmTrueCostConfiguration.CostObjectDimension.Type.Dimension10 and FinanceCodeBlock.FinanceDimension10 entered)))
			Action Rules
				Instance Rules
					initialize LocalDimensionCode
					LocalDimensionCode.FinanceCodeBlock 					= FinanceCodeBlock
					LocalDimensionCode.TrueCostConfiguration 				= PrmTrueCostConfiguration
					LocalDimensionCode.TrueCostResourceUtilizationDriver	= PrmTrueCostResourceUtilizationDriver
					LocalAllocationRun										= PrmTrueCostAllocationRun
					LocalTrueCostResourceUtilizationDriver					= PrmTrueCostResourceUtilizationDriver
					if(TrueCostResourceUnitCostDetailsRel exists)
						increment TrueCostResourceUnitCostDetailsRel.DirectCost by TransactionAmount
					
#endif

