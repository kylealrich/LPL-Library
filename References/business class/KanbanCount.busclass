KanbanCount is a BusinessClass
    prefix is MSCKC

    Ontology
        symbolic key is KanbanCount


    Persistent Fields
        MobileSupplyChainUpload
        TimeSubmitted                   is TimeStamp
        TimeStarted                     is TimeStamp
        CountedBy                       is an Actor
        Status                          is Numeric size 1
            States
                InProgress              value is 1
                Cancelled		        value is 7
                ProcessedWithErrors     value is 8
                Completed               value is 9
        Requisition
        ItemsProcessed                  is Numeric size 6
        Notes                           is Text
    
    Derived Fields

        DerivedRequisitionStatus is a DerivedField
            type is MessageField
            default label is "Status"
            if (Requisition entered)
                return Requisition.DerivedStatusMessage
            else
                return blank
        
        DerivedDuration is a DerivedField
            type is Numeric size 6
            return TimeSubmitted - TimeStarted

    Actions
        Create is a Create Action
            restricted
            Exit Rules

        Update is an Update Action
            restricted

        Delete is a Delete Action
            restricted
        
        Reprocess is an Instance Action
            valid when (Status.ProcessedWithErrors)
            Action Rules
                invoke ProcessKanbanCount KanbanCountLine
                    invoked.PrmCompany              = Company
                    invoked.PrmInventoryLocation    = InventoryLocation
                    invoked.PrmKanbanCount          = KanbanCount
    
    Sets
        ByTimeSubmitted
            Sort Order
                TimeSubmitted descending
                Company
                InventoryLocation
                KanbanCount
