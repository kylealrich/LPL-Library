PayablesAccrualCodeDetail is a BusinessClass
    owned by ap
    prefix is ACR
    classic name is APACCRCODE

    Ontology
        symbolic key is PayablesAccrualCodeDetail
            classic set name is ACRSET0
            classic name for PayablesAccrualCode is ACCR-CODE

    Patterns
        implements StaticJava
        disable AuditIndex

	Attach Rules
		constraint (Active)
			"AccrualCodeDetailIsNotActive"
			
    Persistent Fields

        Active
            classic name is ACTIVITY-FLAG
        DistributionAccount is a FinanceCodeBlockFull
            classic name for DistributionAccount.AccountingUnit is APA-ACCT-UNIT
            classic name for DistributionAccount.GeneralLedgerChartAccount is APA-ACCOUNT

	Field Rules
		DistributionAccount
			required
			constraint (DistributionAccount.ToAccountingEntity = Company.AccountingEntity)		
				"AccountingEntity<DistributionAccount.ToAccountingEntity>MustEqualAccountingEntity<Company.AccountingEntity>OnGlobalLedgerCompany"
		

	Relations
		ReconciledPayablesInvoicesRel				
			one-to-many relation to PayablesInvoice
			Field Mapping uses Set10
				related.Company				= Company
			Instance Selection
				where (related.ReconciliationDate entered
				and    related.AccrualCode	= PayablesAccrualCode)
		
		UnreconciledPayablesInvoicesRel				
			one-to-many relation to PayablesInvoice
			Field Mapping uses Set10
				related.Company				= Company
				related.ReconciliationDate  = blank
				related.AccrualCode			= PayablesAccrualCode	

    Sets

		Set1
			indexed
			Sort Order
				VendorGroup
				Company
				PayablesAccrualCode

        Set2
            indexed
            Sort Order
            	VendorGroup
                PayablesAccrualCode
                Company

		ByCompany
            Sort Order
            	Company
            	VendorGroup
                PayablesAccrualCode
		
	Actions
		Create is a Create Action
				
		Update is an Update Action
						
		Delete is a Delete Action
			Entrance Rules
				constraint (!Active)
					"CannotDelete,InvoiceAccrualCodeDetailIsActive"                 
				constraint (ReconciledPayablesInvoicesRel not exists)			
					"CannotDelete,InvoiceAccrualCodeUsedInPayablesInvoice"		
				constraint (UnreconciledPayablesInvoicesRel not exists)			
					"CannotDelete,InvoiceAccrualCodeUsedOnPayablesInvoice"		
				
		SetAsActive is an Instance Action
			restricted
			Action Rules
				Active = true

