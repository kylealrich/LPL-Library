CompanyAgingReport is a BusinessTask
    owned by ar

    Patterns
        implements ManualTransaction
        implements StaticJava
            is report for ApplicationAdministrator, FinancialsProcessor, FinancialsViewer, ReceivablesManager, ReceivablesAdministrator, ReceivablesSpecialist, CreditAndCollectionSpecialist, Receivables
                category is "Aging"
                report name is "CompanyAging"
                Description
                    Create a transaction aging report for a company.
            Reports
                CompanyAgingReportReport
                CompanyAgingErrorReport

    Parameters
    	FinanceEnterpriseGroup
        Company                 is a ReceivableCompany 
        CompanyGroup            is a GeneralLedgerCompanyGroup
        TransDate               is Date
        FutureApps              is AlphaUpper size 1
            States
                No  value is "N"
                Yes value is "Y"
        Customer                 
        CudName                 is AlphaUpper size 30

        CreditAnlyst            is a CreditAnalyst
        MajClass                is a CustomerMajorClass
        		context of FinanceEnterpriseGroup
        MinClass                is a CustomerMinorClass
        		context of FinanceEnterpriseGroup
        Balance                 is Numeric size 14
        PastDueOnly             is AlphaUpper size 1
            States
                No  value is "N"
                Yes value is "Y"
        RiskCd                  is AlphaUpper size 1
        Activity                is a Project
        	context of FinanceEnterpriseGroup

        ProcessLevel            is a ReceivableProcessLevel
        ProcessLevelGroup       is a ReceivableProcessLevelReportHeader                 
        FrTransUser1            is AlphaUpper size 10
        ToTransUser1            is AlphaUpper size 10
        FrSalesman              is a SalesRepresentative
        ToSalesman              is a SalesRepresentative
        ExemptFinChrgFl         is AlphaUpper size 1
            States
                DoNotOmitFinanceCharges value is "N"
                OmitFinanceCharges      value is "Y"
        AroBillTo               is a CustomerBillTo
        IncludeInvoices         is AlphaUpper size 1
            States
                IncludeInvoices value is "Y"
                ExcludeInvoices value is "N"
        IncludeCredits          is AlphaUpper size 1
            States
                IncludeCredits value is "Y"
                ExcludeCredits value is "N"
        IncludeDebits           is AlphaUpper size 1
            States
                IncludeDebits value is "Y"
                ExcludeDebits value is "N"
        IncludePayments         is AlphaUpper size 1
            States
                IncludePayments value is "Y"
                ExcludePayments value is "N"
        TransOpenAmt            is Numeric size 13
        PaymentOpenAmt          is Numeric size 13
        PastDueDaysFr           is Numeric size 4
        PastDueDaysTo           is Numeric size 4
        PastTranDaysFr          is Numeric size 4
        PastTranDaysTo          is Numeric size 4
        AgeCurrent              is Numeric size 3
        AgePeriods1             is Numeric size 3
        AgePeriods2             is Numeric size 3
        AgePeriods3             is Numeric size 3
        AgePeriods4             is Numeric size 3

        FutureDays				is Numeric size 3
        AgePeriods5             is Numeric size 3
        AgePeriods6             is Numeric size 3
        AgePeriods7             is Numeric size 3
        
        AcoAgeType              is AlphaUpper size 1
            States
                AgeByDueDate         value is "D"
                AgeByTransactionDate value is "T"
        AgeAgePymnt             is AlphaUpper size 1
            States
                AgedToLastDebitColumn value is "L"
                NotAgedCurrentColumn  value is "N"
                    default label is "Not Aged - Current Column"
                AgedRespectiveToDate  value is "R"
        AgeAgeCredits           is AlphaUpper size 1
            States
                AgedToLastDebitColumn value is "L"
                NotAgedCurrentColumn  value is "N"
                    default label is "Not Aged - Current Column"
                AgedRespectiveToDate  value is "R"
        AgeAgeDisputes          is AlphaUpper size 1
            States
                NotAgedCurrentColumn value is "N"
                    default label is "Not Aged - Current Column"
                AgedRespectiveToDate value is "Y"
        NaSumm                  is AlphaUpper size 1
            States
                DoNotPrintNatAcctSummary    value is "N"
                PrintNationalAccountSummary value is "Y"
        PmntAvgFl               is AlphaUpper size 1
            States
                DaysBeyondTermsDbt       value is "D"
                    default label is "Days Beyond Terms (DBT)"
                InvoicePaymentAverageIpa value is "I"
                    default label is "Invoice Payment Average (IPA)"
        PeriodOf                is AlphaUpper size 1
            States
                CurrentPeriod value is "P"
                Audit         value is "A"
        XGainLoss               is AlphaUpper size 1
            States
                No  value is "N"
                Yes value is "Y"
        ExpandedOpt             is AlphaUpper size 1
            States
                NoExpandedCustomerHeading value is "N"
                ExpandedCustomerHeading   value is "Y"
        DetailOption            is AlphaUpper size 1
            States
                CondensedSummary value is "C"
                DetailPrinted    value is "Y"
                ExpandedSummary  value is "E"
                AllRelatedDetail value is "A"
        ReportOption            is AlphaUpper size 1
            States
            	InvoiceType 		   value is "I"
                CreditAnalyst          value is "A"
                Customer               value is "C"
                ProcessLevel           value is "P"
                SalesRepresentative    value is "S"
                Project                value is "M"
                CustomerBillTo         value is "B"
                    default label is "Customer/Bill To"
                PaymentRNACode         value is "R"
                RNAAccountSort         value is "N"
        SortOption              is AlphaUpper size 1
            States
                AlphanumByCustSearchName value is "A"
                NumericByCustomer        value is "N"
        AcoCurrDisplay          is AlphaUpper size 1
            States
                Functional  value is "B"
                Transaction value is "T"
        CsvFileOpt              is AlphaUpper size 1
            States
                CreateACsvExportFile value is "Y"
                    default label is "Create A CSV Export File"
                DoNotCreateCsvFile   value is "N"
                    default label is "Do Not Create CSV File"
        AmtsOpt                 is AlphaUpper size 1
            States
                TruncateAmounts      value is "Y"
                DoNotTruncateAmounts value is "N"
        TransSort               is AlphaUpper size 1
            States
                OpenAmtDescending value is "O"
                DueDate           value is "D"
                TranDate          value is "T"
        FormOpt                 is AlphaUpper size 1
            States
                Standard value is "1"
                Expanded value is "2"


		InvoiceTypeCode         is an AR251InvoiceTypeCodeArray
			context of FinanceEnterpriseGroup
		IncludeOrExcludeFlag	is an AR251IncludeOrExcludeFlagArray
        StatementCycleCode		is a OpenItemStatementCycle
        FinanceChargeCycle		
        DunningCycle
        Territory1				is a Territory
        Territory2				is a Territory
        Territory3				is a Territory
       	PercentCredLimit		is Numeric size 3 
        TermsCode
        	context of FinanceEnterpriseGroup

        FrmPaymentPostDate		is Date 
        ToPaymentPostDate		is Date
        FrmPaymentBatch			is a ReceivablePaymentHeader
        ToPaymentBatch			is a ReceivablePaymentHeader
        FrmPaymentRange			is an InternationalAmount
        ToPaymentRange			is an InternationalAmount

	
    Parameter Rules
        FutureApps
        	initial value is "Y"
            default to "Y"
        PastDueOnly
        	initial value is "N"
            default to "N"
        ExemptFinChrgFl
        	initial value is "N"
            default to "N"
        IncludeInvoices
        	initial value is "Y"
            default to "Y"
        IncludeCredits
        	initial value is "Y"
            default to "Y"
        IncludeDebits
        	initial value is "Y"
            default to "Y"
        IncludePayments
        	initial value is "Y"
            default to "Y"
        NaSumm
        	initial value is "N"
            default to "N"
        PmntAvgFl
        	initial value is "I"
            default to "I"
        XGainLoss
        	initial value is "N"
            default to "N"
        ExpandedOpt
        	initial value is "N"
            default to "N"
        DetailOption
        	initial value is "Y"
            default to "Y"
        ReportOption
        	initial value is "C"
            default to "C"
        SortOption
        	initial value is "N"
            default to "N"
            required
        AcoCurrDisplay
        	initial value is "B"
            default to "B"
        CsvFileOpt
        	initial value is "Y"
            default to "Y"
        AmtsOpt
        	initial value is "N"
            default to "N"
        FormOpt
        	initial value is "1"
            default to "1"
        Company                                         
        	if (Company not entered)                                  

        		constraint (CreditAnlyst not entered)
					"CompanyIsRequiredIf_\CreditAnalystEntered"
               
                constraint (Customer not entered)
					"CompanyIsRequiredIf_\CustomerEntered"

                constraint (Territory1 not entered
                and        Territory2 not entered
                and        Territory3 not entered)
                    "CompanyIsRequiredIf_\TerritoryEntered"

                constraint (StatementCycleCode not entered)
                    "CompanyIsRequiredIf_\Statement_\Cycle_\CodeEntered"

                constraint (FinanceChargeCycle not entered)
                    "CompanyIsRequiredIf_\Finance_\Charge_\Cycle_\CodeEntered"

                constraint (DunningCycle not entered)
                    "CompanyIsRequiredIf_\Dunning_\Cycle_\CodeEntered"
                
                constraint (FrSalesman not entered
                and        ToSalesman not entered)
                    "CompanyIsRequiredIf_\Sales_\RepresentativeEntered"
                
                constraint (FrmPaymentBatch not entered
                and        ToPaymentBatch not entered)
                    "CompanyIsRequiredIf_\Receivable_\Payment_\BatchEntered"

            if (Company entered)                                
                constraint (CompanyGroup not entered)
                    "CannotEnterBothCompanyAndCompanyGroup"

        AgePeriods1                                       
            if (AgePeriods2 entered
            or AgePeriods3 entered
            or AgePeriods4 entered)
                required
                    "AgingPeriods1To4AreRequired"
                    
            constraint (AgePeriods1 < AgePeriods2
			and		AgePeriods1 < AgePeriods3
			and		AgePeriods1 < AgePeriods4)
				"AgingDaysMustBeInAscendingOrder"

			constraint (AgePeriods1 >= 1)
				"AgingDaysMustBeInAscendingOrder"

            if (AgePeriods5 entered
            or AgePeriods6 entered
            or AgePeriods7 entered)
                required
                    "AgingPeriods1To7AreRequired"

                constraint (AgePeriods1 < AgePeriods5
			    and		AgePeriods1 < AgePeriods6
			    and		AgePeriods1 < AgePeriods7)
				    "AgingDaysMustBeInAscendingOrder"
        
        AgePeriods2                                     
            constraint (AgePeriods2 < AgePeriods3
			and		AgePeriods2 < AgePeriods4)
				"AgingDaysMustBeInAscendingOrder"

			constraint (AgePeriods2 >= 1)
				"AgingDaysMustBeInAscendingOrder"

            if (AgePeriods5 entered
            or AgePeriods6 entered
            or AgePeriods7 entered)
                required
                    "AgingPeriods1To7AreRequired"

                constraint (AgePeriods2 < AgePeriods5
			    and		AgePeriods2 < AgePeriods6
			    and		AgePeriods2 < AgePeriods7)
				    "AgingDaysMustBeInAscendingOrder"

        AgePeriods3                                     
            constraint (AgePeriods3 < AgePeriods4)
				"AgingDaysMustBeInAscendingOrder"

			constraint (AgePeriods3 >= 1)
				"AgingDaysMustBeInAscendingOrder"

            if (AgePeriods5 entered
            or AgePeriods6 entered
            or AgePeriods7 entered)
                required
                    "AgingPeriods1To7AreRequired"

                constraint (AgePeriods3 < AgePeriods5
			    and		AgePeriods3 < AgePeriods6
			    and		AgePeriods3 < AgePeriods7)
				    "AgingDaysMustBeInAscendingOrder"

        AgePeriods4                                     
            constraint (AgePeriods4 >= 1)
				"AgingDaysMustBeInAscendingOrder"

            if (AgePeriods5 entered
            or AgePeriods6 entered
            or AgePeriods7 entered)
                required
                    "AgingPeriods1To7AreRequired"

                constraint (AgePeriods4 < AgePeriods5
			    and		AgePeriods4 < AgePeriods6
			    and		AgePeriods4 < AgePeriods7)
				    "AgingDaysMustBeInAscendingOrder"

        AgePeriods5                                     
            if (FutureDays entered)
                constraint (AgePeriods5 entered)
                    "AllAgingPeriodsMustBeEnteredIfFutureDaysEntered"
                
                constraint (AgePeriods5 < AgePeriods6
			    and		AgePeriods5 < AgePeriods7)
				    "AgingDaysMustBeInAscendingOrder"

        AgePeriods6                                     
            if (FutureDays entered)
                constraint (AgePeriods6 entered)
                    "AllAgingPeriodsMustBeEnteredIfFutureDaysEntered"
                
                constraint (AgePeriods6 < AgePeriods7)
				    "AgingDaysMustBeInAscendingOrder"

        AgePeriods7                                     
            if (FutureDays entered)
                constraint (AgePeriods7 entered)
                    "AllAgingPeriodsMustBeEnteredIfFutureDaysEntered" 

        FutureDays                                      
            if (AgePeriods5 entered
            or AgePeriods6 entered
            or AgePeriods7 entered)
				required
					"FutureDaysMustBeEnteredIfPeriods5To7Entered"
            
            constraint (FutureDays >= 1)
				"FutureDayShouldHaveAValueGreaterThanZero"

            if (FutureDays entered)
                constraint(AgePeriods1 entered
                and AgePeriods2 entered
                and AgePeriods3 entered
                and AgePeriods4 entered
                and AgePeriods5 entered
                and AgePeriods6 entered
                and AgePeriods6 entered)
                    "AllAgingPeriodsMustBeEnteredWhenFutureDaysEntered"

        ProcessLevelGroup                                           
            if (ProcessLevelGroup entered)
                constraint (ProcessLevel not entered)
                    "CannotEnterBothProcessLevelAndProcessLevelGroup"
        
        CompanyGroup                                                
            if (ProcessLevel entered
            or ProcessLevelGroup entered)
                constraint (Company entered)
					"CannotEnterCompanyGroupWhenProcessLevelOrProcessLevelGroupEntered"

    Actions
        CompanyAgingReport is a Set Action
            allow unlimited concurrency
