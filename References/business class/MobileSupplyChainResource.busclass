MobileSupplyChainResource is a BusinessClass
	owned by mscm
	
	prefix is MSRES
	
	Ontology
		symbolic key is MobileSupplyChainResource
			
	Patterns
	
	Persistent Fields
		Active							is Boolean
		GlobalLocationAccess			is Boolean
		DefaultDeliverToLocation		is a MSCMResourceCompanyAndLocation
		DefaultReceivingShipToLocation	is a MSCMResourceCompanyAndLocation
		DefaultStockLocation			is a MSCMResourceCompanyAndLocation
		
	Local Fields
		LocalHandheldAccessRetrieved						is Boolean
		LocalDockLoggingHandheldAccess                      is Boolean
		LocalInventoryTransfersHandheldAccess               is Boolean
		LocalInTransitTransferReceivingHandheldAccess		is Boolean
		LocalIssuesAndReturnsHandheldAccess		            is Boolean
		LocalInventoryAdjustmentsHandheldAccess		        is Boolean
		LocalBinTransferHandheldAccess		                is Boolean
		LocalDeliveryHandheldAccess		                    is Boolean
		LocalPOReceivingHandheldAccess		                is Boolean
		LocalPOReceivingPutawayHandheldAccess		        is Boolean
		LocalPOReceivingInspectionHandheldAccess		    is Boolean
		LocalMiscellaneousReceiptsHandheldAccess		    is Boolean
		LocalPickingHandheldAccess		                    is Boolean
		LocalParCountHandheldAccess		                    is Boolean
		LocalParCountMaxAddQtyHandheldAccess		        is Boolean
		LocalParCountEditParLevelHandheldAccess		        is Boolean
		LocalPickForParHandheldAccess		                is Boolean
		LocalKanbanHandheldAccess		                    is Boolean
		LocalInventoryReplenishmentHandheldAccess		    is Boolean
		LocalCycleCountHandheldAccess		                is Boolean
		LocalParCycleCountHandheldAccess		            is Boolean

	Rule Blocks
		RetrieveHandheldAccess
			if (not LocalHandheldAccessRetrieved)
				for each MobileSupplyChainSecurityRel
					if (each.DockLogging)
						LocalDockLoggingHandheldAccess = true

					if (each.InventoryTransfers)
						LocalInventoryTransfersHandheldAccess = true

					if (each.InTransitTransferReceiving)
						LocalInTransitTransferReceivingHandheldAccess = true

					if (each.IssuesAndReturns)
						LocalIssuesAndReturnsHandheldAccess = true

					if (each.InventoryAdjustments)
						LocalInventoryAdjustmentsHandheldAccess = true

					if (each.BinTransfer)
						LocalBinTransferHandheldAccess = true

					if (each.Delivery)
						LocalDeliveryHandheldAccess = true

					if (each.POReceiving)
						LocalPOReceivingHandheldAccess = true

					if (each.POReceivingPutaway)
						LocalPOReceivingPutawayHandheldAccess = true

					if (each.POReceivingInspection)
						LocalPOReceivingInspectionHandheldAccess = true

					if (each.MiscellaneousReceipts)
						LocalMiscellaneousReceiptsHandheldAccess = true

					if (each.Picking)
						LocalPickingHandheldAccess = true

					if (each.ParCount)
						LocalParCountHandheldAccess = true

					if (each.ParCountMaxAddQty)
						LocalParCountMaxAddQtyHandheldAccess = true

					if (each.ParCountEditParLevel)
						LocalParCountEditParLevelHandheldAccess = true

					if (each.PickForPar)
						LocalPickForParHandheldAccess = true

					if (each.Kanban)
						LocalKanbanHandheldAccess = true

					if (each.InventoryReplenishment)
						LocalInventoryReplenishmentHandheldAccess = true

					if (each.CycleCount)
						LocalCycleCountHandheldAccess = true

					if (each.ParCycleCount)
						LocalParCycleCountHandheldAccess = true
						
				LocalHandheldAccessRetrieved = true


	Derived Fields
		DerivedActor is a DerivedField
			type is like Actor
			return MobileSupplyChainResource.Employee.agent(Actor).Actor
	
		DerivedDefaultLabelTemplate is a DerivedField
			type is like LabelTemplate
			restricted
			return first DefaultLabelTemplateRel.LabelTemplate

		DerivedLoggedInUserDockLoggingHandheldAccess is a DerivedField
			type is Boolean
			include RetrieveHandheldAccess
			return LocalDockLoggingHandheldAccess
			
		DerivedLoggedInUserInventoryTransfersHandheldAccess is a DerivedField
			type is Boolean
			include RetrieveHandheldAccess
			return LocalInventoryTransfersHandheldAccess
			
		DerivedLoggedInUserInTransitTransferReceivingHandheldAccess is a DerivedField
			type is Boolean
			include RetrieveHandheldAccess
			return LocalInTransitTransferReceivingHandheldAccess
			
		DerivedLoggedInUserIssuesAndReturnsHandheldAccess is a DerivedField
			type is Boolean
			include RetrieveHandheldAccess
			return LocalIssuesAndReturnsHandheldAccess
			
		DerivedLoggedInUserInventoryAdjustmentsHandheldAccess is a DerivedField
			type is Boolean
			include RetrieveHandheldAccess
			return LocalInventoryAdjustmentsHandheldAccess
			
		DerivedLoggedInUserBinTransferHandheldAccess is a DerivedField
			type is Boolean
			include RetrieveHandheldAccess
			return LocalBinTransferHandheldAccess
			
		DerivedLoggedInUserDeliveryHandheldAccess is a DerivedField
			type is Boolean
			include RetrieveHandheldAccess
			return LocalDeliveryHandheldAccess
			
		DerivedLoggedInUserPOReceivingHandheldAccess is a DerivedField
			type is Boolean
			include RetrieveHandheldAccess
			return LocalPOReceivingHandheldAccess
			
		DerivedLoggedInUserPOReceivingPutawayHandheldAccess is a DerivedField
			type is Boolean
			include RetrieveHandheldAccess
			return LocalPOReceivingPutawayHandheldAccess
			
		DerivedLoggedInUserPOReceivingInspectionHandheldAccess is a DerivedField
			type is Boolean
			include RetrieveHandheldAccess
			return LocalPOReceivingInspectionHandheldAccess
			
		DerivedLoggedInUserMiscellaneousReceiptsHandheldAccess is a DerivedField
			type is Boolean
			include RetrieveHandheldAccess
			return LocalMiscellaneousReceiptsHandheldAccess
			
		DerivedLoggedInUserPickingHandheldAccess is a DerivedField
			type is Boolean
			include RetrieveHandheldAccess
			return LocalPickingHandheldAccess
			
		DerivedLoggedInUserParCountHandheldAccess is a DerivedField
			type is Boolean
			include RetrieveHandheldAccess
			return LocalParCountHandheldAccess
			
		DerivedLoggedInUserParCountMaxAddQtyHandheldAccess is a DerivedField
			type is Boolean
			include RetrieveHandheldAccess
			return LocalParCountMaxAddQtyHandheldAccess
			
		DerivedLoggedInUserParCountEditParLevelHandheldAccess is a DerivedField
			type is Boolean
			include RetrieveHandheldAccess
			return LocalParCountEditParLevelHandheldAccess
			
		DerivedLoggedInUserPickForParHandheldAccess is a DerivedField
			type is Boolean
			include RetrieveHandheldAccess
			return LocalPickForParHandheldAccess
			
		DerivedLoggedInUserKanbanHandheldAccess is a DerivedField
			type is Boolean
			include RetrieveHandheldAccess
			return LocalKanbanHandheldAccess
			
		DerivedLoggedInUserInventoryReplenishmentHandheldAccess is a DerivedField
			type is Boolean
			include RetrieveHandheldAccess
			return LocalInventoryReplenishmentHandheldAccess
			
		DerivedLoggedInUserCycleCountHandheldAccess is a DerivedField
			type is Boolean
			include RetrieveHandheldAccess
			return LocalCycleCountHandheldAccess
			
		DerivedLoggedInUserParCycleCountHandheldAccess is a DerivedField
			type is Boolean
			include RetrieveHandheldAccess
			return LocalParCycleCountHandheldAccess

	Field Rules
		Active
			initial value is true
				
		DefaultDeliverToLocation
			constraint (DefaultDeliverToLocation.MobileSupplyChainLocation.IsDeliveryTo)
            	"Company_-_LocationIsNotTaggedAsDeliveryTo"	
		
		DefaultReceivingShipToLocation
			constraint (DefaultReceivingShipToLocation.MobileSupplyChainLocation.IsReceivingShipTo)
            	"Company_-_LocationIsNotTaggedAsReceivingShipTo"	
		
		DefaultStockLocation
			constraint (DefaultStockLocation.MobileSupplyChainLocation.IsInventoryLocation)
            	"Company_-_LocationIsNotAStockLocation"			
	Conditions
		RecordExists
			restricted
			when (MobileSupplyChainResource exists)

		HasGlobalLocationAccess
			restricted
			when (GlobalLocationAccess)
		
		HasLocationAccess
			when (GlobalLocationAccess
			or	  MobileSupplyChainResourceAccessRel exists)
		
		HasRequestingAccess
			when (MobileSupplyChainResourceParLocationRel exists)
		
		HasInventoryAccess
			when (MobileSupplyChainResourceStockLocationRel exists)
		
		HasReceivingAccess
			when (MobileSupplyChainResourceReceivingShipToRel exists)

		HasDeliveryAccess
			when (MobileSupplyChainResourceDeliveryToLocationRel exists)
		
		CurrentMobileSupplyChainResource
			when (HROrganization	=	actor.agent(Employee).HROrganization 
				and	MobileSupplyChainResource	=	actor.agent(Employee).Employee)
		
		MobileSupplyChainEnabled
			restricted
			when (MobileSupplyChainConfigurationRel.MobileSupplyChainEnabled)
	
	Relations
		MobileSupplyChainResourceAccessPrinterRel is a MobileSupplyChainResourceAccessPrinter set
		
		MobileSupplyChainResourceAccessRel
			one-to-many relation to MobileSupplyChainResourceAccess
			Field Mapping uses symbolic key
				related.HROrganization			= HROrganization
				related.MobileSupplyChainResource			= MobileSupplyChainResource
				
		MobileSupplyChainResourceParLocationLocationAccessRel
			one-to-many relation to MobileSupplyChainResourceParLocation
			Field Mapping uses symbolic key
				related.HROrganization		= HROrganization
				related.MobileSupplyChainResource		= MobileSupplyChainResource
			Instance Selection
				where (!related.HasLocationAccess)	
		
		MobileSupplyChainResourceParLocationRel 
			one-to-many relation to MobileSupplyChainLocation   
			Field Mapping uses symbolic key
			Instance Selection
				where (related.Company.FinanceEnterpriseGroup	= MobileSupplyChainResource.FinanceEnterpriseGroup
				and		related.IsAccessibleParLocation)
		
		MobileSupplyChainResourceStockLocationRel
			one-to-many relation to MobileSupplyChainLocation 
			Field Mapping uses symbolic key
			Instance Selection
				where (related.Company.FinanceEnterpriseGroup	= MobileSupplyChainResource.FinanceEnterpriseGroup
				and		related.IsAccessibleStockLocation)
		
		MobileSupplyChainResourceReceivingShipToRel
			one-to-many relation to MobileSupplyChainLocation   
			Field Mapping uses symbolic key
			Instance Selection
				where (related.Company.FinanceEnterpriseGroup	= MobileSupplyChainResource.FinanceEnterpriseGroup
				and	   related.IsAccessibleReceivingShipToLocation)

		MobileSupplyChainResourceDeliveryToLocationRel
			one-to-many relation to MobileSupplyChainLocation   
			Field Mapping uses symbolic key
			Instance Selection
				where (related.Company.FinanceEnterpriseGroup	= MobileSupplyChainResource.FinanceEnterpriseGroup
				and	   related.IsAccessibleDeliveryToLocation)


		MobileSupplyChainConfigurationRel
            one-to-one relation to MobileSupplyChainConfiguration
            Field Mapping uses symbolic key
                related.MobileSupplyChainConfiguration = MobileSupplyChainResource.FinanceEnterpriseGroup 
	
		DefaultLabelTemplateRel
			one-to-many relation to LabelTemplate
			Field Mapping uses symbolic key
				related.MobileSupplyChainConfiguration = MobileSupplyChainResource.FinanceEnterpriseGroup
			Instance Selection	
				where (related.Default
				and    related.LabelType.Employee)	
		MobileSupplyChainSecurityRel
			one-to-many relation to MobileSupplyChainSecurity
			Field Mapping uses symbolic key
			Instance Selection	
				where (related.ActorRoleExists)
	Actions
		Create is a Create Action
		
		Update is an Update Action

			Exit Rules
    			if (GlobalLocationAccess changed and !GlobalLocationAccess)
    				constraint (!MobileSupplyChainResourceParLocationLocationAccessRel exists)
						"CannotDeleteCompany/LocationAccess.MyParFormIsSet"

		Delete is a Delete Action

		PrintEmployee is an Instance Action
            Parameters
				PrmMobileSupplyChainPrinter      		is a MobileSupplyChainPrinter
					default label is "MobileSupplyChainPrinter"
				PrmNumberOfCopies						is Unsigned Decimal 2.0
					default label is "NumberOfCopies"
				PrmMobileSupplyChainConfiguration		is a MobileSupplyChainConfiguration
					default label is "MobileSupplyChainConfiguration"
				PrmLabelTemplate  						is a LabelTemplate
					default label is "LabelTemplate"
				PrmTransactionType						is a MobileSupplyChainPrintingTransactionType
					default label is "LabelTransactionType"
            Parameter Rules
				PrmMobileSupplyChainPrinter
					required
					constraint (PrmMobileSupplyChainPrinter.PrinterType.Label)
						"PrinterShouldOnlyBeLabelPrinter"
				PrmLabelTemplate
					initial value is DerivedDefaultLabelTemplate
					default to DerivedDefaultLabelTemplate
					required
					constraint (PrmLabelTemplate.LabelType.Employee)
						"LabelTypeShouldBeEmployee"
            Local Fields
                LocalErrorOccured   is Boolean
                LocalErrorMessage   is Text
			Action Rules			
                invoke Create MobileSupplyChainPrinterJob
		        	invoked.FinanceEnterpriseGroup          = PrmMobileSupplyChainConfiguration
		            invoked.MobileSupplyChainPrinter 		= PrmMobileSupplyChainPrinter
                    invoked.TransactionType                 = MobileSupplyChainPrintingTransactionType.LabelManagement
                    invoked.NumberOfCopies 					= PrmNumberOfCopies
					invoked.PrintDataFile 					= PrmLabelTemplate
