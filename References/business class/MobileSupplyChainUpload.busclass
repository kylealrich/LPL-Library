MobileSupplyChainUpload is a BusinessClass
    owned by mscm
    prefix is MSUP

    Ontology
        symbolic key is MobileSupplyChainUpload

    Persistent Fields
        Type        is AlphaUpper size 3
            States
                ParCount                value is "PC"
                Kanban                  value is "KB"
                PickForPar              value is "PFP"
                CycleCount              value is "CC"
                DockLog                 value is "DL"
                MiscellaneousReceipt    value is "MR"
                Picking                 value is "EP"
                POReceiving             value is "PO"
                ParCycleCount           value is "PCC"
                InventoryAdjustments    value is "IA"
                InventoryIssues         value is "II"
                InventoryTransfer       value is "IT"
                IntransitReceiving      value is "IR"
                InventoryReplenishment  value is "IRE"
                ReceivingTransfer       value is "RT"
                DeliveryEvent           value is "DE"
        Status      is Numeric size 1
            States
                Open            value is 0
                InProgress      value is 1
                UploadComplete  value is 9
        XML         is XMLDocument

    Local Fields
		ParCompany                      is an InventoryCompany
        LocationInventoryLocation       is an InventoryLocation

        ParLevelUpdateUploadView        is an ParLevelUpdateUpload view
        ParLevelUpdateUpload

        MobileSupplyChainParCountView   is an MobileSupplyChainParCount view
        MobileSupplyChainParCount

        CycleCountUploadView            is an CycleCountUpload view
        LocalCycleCountUpload           is an CycleCountUpload

        KanbanCountView                 is an KanbanCount view
        LocalKanbanCount                is an KanbanCount

        KanbanCountLineView             is an KanbanCountLine view
        LocalKanbanCountLine            is an KanbanCountLine

        ParCycleCountView               is an ParCycleCount view
        LocalParCycleCount              is an ParCycleCount

        ErrorOccured                    is Boolean
        ErrorMessage                    is Text

        LocalFromCompany                is like InventoryCompany
        LocalFromLocation               is like InventoryLocation
        LocalPickForParTicket           is like PickForParTicket
        LocalItem                       is like Item
        LocalTransactionUOM             is like UnitOfMeasure
        LocalBin                        is like Bin
        LocalKanbanBinId                is like MobileSupplyChainBinID
        
        LocalWarehouseShipment          is like WarehouseShipment
        LocalWarehouseShipmentLine      is like WarehouseShipmentLine
        LocalSerial                     is like ItemSerialNumber
        LocalLot                        is like ItemLot
        LocalSublot                     is like Sublot
        LocalPickedDetailQuantity       is like Quantity
        LocalPickedDetailUOM            is like UnitOfMeasure
        LocalPurchaseOrderLine          is like PurchaseOrderLine
        LocalPONumber                   is like PurchaseOrder
        LocalDecimalQuantity            is like Quantity

        MobileSupplyChainInventoryTransactionView               is an MobileSupplyChainInventoryTransaction view
        MobileSupplyChainInventoryTransactionLineView           is an MobileSupplyChainInventoryTransactionLine view
        MobileSupplyChainInventoryTransactionLineDetailView     is an MobileSupplyChainInventoryTransactionLineDetail view
        LocalMobileSupplyChainInventoryTransaction              is a MobileSupplyChainInventoryTransaction
        LocalMobileSupplyChainInventoryTransactionLine          is a MobileSupplyChainInventoryTransactionLine

        PurchaseOrderReceiptLineView                            is a PurchaseOrderReceiptLine view
        MobileSupplyChainPurchaseOrderReceiptView               is a MobileSupplyChainPurchaseOrderReceipt view
        MobileSupplyChainPurchaseOrderReceiptLineView           is a MobileSupplyChainPurchaseOrderReceiptLine view
        LocalPurchaseOrderReceiptCompany                        is a PurchasingCompany
        LocalPurchaseOrderReceipt                               is like PurchaseOrderReceipt
        LocalPurchaseOrderReceiptLine                           is like PurchaseOrderReceiptLine
        
        MobileSupplyChainInventoryReplenishmentView             is an MobileSupplyChainInventoryReplenishment view
        LocalMobileSupplyChainInventoryReplenishment            is a MobileSupplyChainInventoryReplenishment

        LocalMobileSupplyChainPurchaseOrderReceipt              is a MobileSupplyChainPurchaseOrderReceipt
        LocalMobileSupplyChainPurchaseOrderReceiptLine          is a MobileSupplyChainPurchaseOrderReceiptLine
        LocalPurchaseOrderForInspection                         is like PurchaseOrder
        LocalPurchaseOrderReceiptInspection                     is like POReceiptAdjustmentAndInspection
        LocalPurchaseOrderReceiptInspectionLine                 is like POReceiptAdjustmentAndInspectionLine

        LocalTransferReceipt            is like MobileSupplyChainInventoryTransaction
        LocalLineNumber                 is Numeric size 6
        LocalDetailSequence             is Numeric size 6

        LocalMobileSupplyChainDeliveryEvent                     is a MobileSupplyChainDeliveryEvent
        MobileSupplyChainDeliveryEventView                      is a MobileSupplyChainDeliveryEvent view
        LocalMobileSupplyChainDeliveryLine                      is like MobileSupplyChainDeliveryLine
        LocalMobileSupplyChainDeliveryEventLine                 is like MobileSupplyChainDeliveryEventLine
        MobileSupplyChainDeliveryEventLineView                  is a MobileSupplyChainDeliveryEventLine view
        LocalMobileSupplyChainDeliveryTicket                    is a MobileSupplyChainDeliveryTicket
        LocalMobileSupplyChainDeliveryUnit                      is like MobileSupplyChainDeliveryUnit
        LocalTimeSubmitted                                      is TimeStamp
        LocalTimeStarted                                        is TimeStamp
        LocalEventCompany                                       is like InventoryCompany
        LocalEventLocation                                      is like MobileSupplyChainLocation
        LocalDeliveryCompany                                    is a MobileSupplyChainCompany
        LocalDeliveryLocation                                   is a MobileSupplyChainLocation 
        LocalPerformedAction                                    is a PerformedAction  
        LocalFirstName                                          is a Name
        LocalLastName                                           is a Name
        LocalEmployeeID                                         is a EmployeeID
        LocalSignature                                          is BinaryDocument
        LocalPackageCount                                       is a PackageCount
    Derived Fields
        DerivedRoundTo is a DerivedField
    		type is like Quantity
    		restricted
            initialize LocalDecimalQuantity
            LocalDecimalQuantity = PurchaseOrderLineRel.DerivedNumberOfDecimalsQuantity

    		if (LocalDecimalQuantity = 0)
    			return 1
            else    
    		if (LocalDecimalQuantity = 1)
    			return .1
            else
    		if (LocalDecimalQuantity = 2)
    			return .01
            else
    		if (LocalDecimalQuantity = 3)
    			return .001
            else
    		if (LocalDecimalQuantity = 4)
    			return .0001

    Field Rules
        Type
            required

        XML
            required

    Rule Blocks
        CreateEvent
            if (LocalMobileSupplyChainDeliveryEvent not entered)
                invoke CreateEvent MobileSupplyChainDeliveryTicketRel
                    invoked.PrmEventCompanyLocation.MobileSupplyChainCompany        = LocalEventCompany
                    invoked.PrmEventCompanyLocation.MobileSupplyChainLocation       = LocalEventLocation
                    invoked.PrmPerformedAction                                      = LocalPerformedAction
                    invoked.PrmTimeSubmitted                                        = LocalTimeSubmitted
                    invoked.PrmEmployeeID                                           = LocalEmployeeID
                    invoked.PrmFirstName                                            = LocalFirstName
                    invoked.PrmLastName                                             = LocalLastName
                    invoked.PrmSignature                                            = LocalSignature
                    invoked.PrmPackageCount                                         = LocalPackageCount
                
                LocalMobileSupplyChainDeliveryEvent = MobileSupplyChainDeliveryTicketRel.TransientMobileSupplyChainDeliveryEvent
            
                if (LocalEventAttachmentXML entered)
                    invoke CreateEventAttachment LocalMobileSupplyChainDeliveryEvent
                        invoked.PrmAttachmentXML         = LocalEventAttachmentXML
    Relations
        PickForParTicketRel
            one-to-one relation to PickForParTicket
            Field Mapping uses symbolic key
                related.Company                 = LocalFromCompany
                related.InventoryLocation       = LocalFromLocation
                related.PickForParTicket        = LocalPickForParTicket
            
        PickForParTicketLineRel
            one-to-one relation to PickForParTicketLine
            Field Mapping uses ByItem
                related.Company                 = LocalFromCompany
                related.InventoryLocation       = LocalFromLocation
                related.PickForParTicket        = LocalPickForParTicket
                related.Item                    = LocalItem
                related.Bin                     = LocalBin
                related.TransactionUOM          = LocalTransactionUOM
        
        CycleCountUploadRel
            one-to-one relation to CycleCountUpload
            Field Mapping uses symbolic key
                related.Company                 = LocalFromCompany
                related.CycleCountUpload        = LocalCycleCountUpload

        MSMCKanbanCountLineRel
            one-to-one relation to KanbanCountLine
            Field Mapping uses symbolic key
                related.Company                 = LocalFromCompany
                related.InventoryLocation       = LocalFromLocation
                related.KanbanCount             = LocalKanbanCount
                related.KanbanCountLine         = LocalKanbanCountLine
        
        KanbanItemBinRel
            one-to-one relation to KanbanItemBin
            Field Mapping uses ByCompanyBinId
                related.Company                 = LocalFromCompany
                related.BinID                   = LocalKanbanBinId
        
        MobileSupplyChainConfigurationRel
            one-to-one relation to MobileSupplyChainConfiguration
            Field Mapping uses symbolic key
                related.MobileSupplyChainConfiguration = FinanceEnterpriseGroup

        WarehouseShipmentRel
            one-to-one relation to WarehouseShipment
            Field Mapping uses symbolic key
                related.Company                 = LocalFromCompany
                related.InventoryLocation       = LocalFromLocation
                related.WarehouseShipment       = LocalWarehouseShipment

        WarehouseShipmentLineRel
            one-to-one relation to WarehouseShipmentLine
            Field Mapping uses symbolic key
                related.Company                 = LocalFromCompany
                related.InventoryLocation       = LocalFromLocation
                related.WarehouseShipment       = LocalWarehouseShipment
                related.WarehouseShipmentLine   = LocalWarehouseShipmentLine
                
        WarehouseShipmentLineDetailRel
            one-to-many relation to WarehouseShipmentLineDetail
            Field Mapping uses symbolic key
                related.Company                 = LocalFromCompany
                related.InventoryLocation       = LocalFromLocation
                related.WarehouseShipment       = LocalWarehouseShipment
                related.WarehouseShipmentLine   = LocalWarehouseShipmentLine
        
        MobileSupplyChainInventoryTransactionRel
            one-to-one relation to MobileSupplyChainInventoryTransaction
            Field Mapping uses symbolic key
                related.Company                                 = LocalFromCompany
                related.InventoryLocation                       = LocalFromLocation
                related.MobileSupplyChainInventoryTransaction   = LocalMobileSupplyChainInventoryTransaction

        PurchaseOrderReceiptRel
            one-to-one relation to PurchaseOrderReceipt
            Field Mapping uses symbolic key
                related.Company                                 = LocalPurchaseOrderReceiptCompany
                related.PurchaseOrderReceipt                    = LocalPurchaseOrderReceipt

		PurchaseOrderLineRel
			one-to-one relation to PurchaseOrderLine
			Field Mapping uses symbolic key
                related.Company                                 = LocalPurchaseOrderReceiptCompany
                related.PurchaseOrder                           = LocalPONumber
                related.PurchaseOrderLine                       = LocalLineNumber

        MobileSupplyChainInventoryReplenishmentRel
            one-to-one relation to MobileSupplyChainInventoryReplenishment
            Field Mapping uses symbolic key
                related.Company                                     = LocalFromCompany
                related.InventoryLocation                           = LocalFromLocation
                related.MobileSupplyChainInventoryReplenishment     = LocalMobileSupplyChainInventoryReplenishment 
        
        MobileSupplyChainPurchaseOrderReceiptRel
            one-to-one relation to MobileSupplyChainPurchaseOrderReceipt
            Field Mapping uses symbolic key
                related.Company                                 = LocalPurchaseOrderReceiptCompany
                related.MobileSupplyChainPurchaseOrderReceipt   = LocalMobileSupplyChainPurchaseOrderReceipt

        InventoryIntransitReceivingRel
            one-to-one relation to InventoryTransaction
            Field Mapping uses symbolic key
                related.Company                                 = LocalFromCompany
                related.InventoryLocation                       = LocalFromLocation
                related.InventoryTransaction                    = LocalTransferReceipt

        MSCMInventoryTransactionLineRel
            one-to-one relation to MobileSupplyChainInventoryTransactionLine
            Field Mapping uses symbolic key
                related.Company                                         = LocalFromCompany
                related.InventoryLocation                               = LocalFromLocation
                related.MobileSupplyChainInventoryTransaction           = LocalMobileSupplyChainInventoryTransaction
                related.MobileSupplyChainInventoryTransactionLine       = LocalLineNumber

        ItemLocationRel
            one-to-one relation to ItemLocation
            Field Mapping uses symbolic key
                related.Company                                         = LocalFromCompany
                related.InventoryLocation                               = LocalFromLocation
                related.Item                                            = LocalItem
        
        InventoryTransactionBinTrackedLinesRel
            one-to-many relation to InventoryTransactionLine
            Field Mapping uses symbolic key
                related.Company                                         = LocalFromCompany
                related.InventoryLocation                               = LocalFromLocation
                related.InventoryTransaction                            = LocalTransferReceipt
            Instance Selection
                where (related.IsItemLocationBinTracked)

        MobileSupplyChainDeliveryTicketRel
            one-to-one relation to MobileSupplyChainDeliveryTicket
            Field Mapping uses symbolic key
                related.Company                                         = LocalDeliveryCompany
                related.MobileSupplyChainLocation                       = LocalDeliveryLocation
                related.MobileSupplyChainDeliveryTicket                 = LocalMobileSupplyChainDeliveryTicket

        MobileSupplyChainDeliveryUnitRel
            one-to-one relation to MobileSupplyChainDeliveryUnit
            Field Mapping uses symbolic key
                related.Company                                         = LocalDeliveryCompany
                related.MobileSupplyChainLocation                       = LocalDeliveryLocation
                related.MobileSupplyChainDeliveryTicket                 = LocalMobileSupplyChainDeliveryTicket
                related.MobileSupplyChainDeliveryUnit                   = LocalMobileSupplyChainDeliveryUnit
        MobileSupplyChainDeliveryLineRel
            one-to-one relation to  MobileSupplyChainDeliveryLine
            Field Mapping uses symbolic key
                related.Company                                         = LocalDeliveryCompany
                related.MobileSupplyChainLocation                       = LocalDeliveryLocation
                related.MobileSupplyChainDeliveryTicket                 = LocalMobileSupplyChainDeliveryTicket
                related.MobileSupplyChainDeliveryUnit                   = LocalMobileSupplyChainDeliveryUnit
                related.MobileSupplyChainDeliveryLine                   = LocalMobileSupplyChainDeliveryLine

        DeliveryLinesPerUnitRel
            one-to-many relation to  MobileSupplyChainDeliveryLine
            Field Mapping uses symbolic key
                related.Company                                 = LocalDeliveryCompany
                related.MobileSupplyChainLocation               = LocalDeliveryLocation
                related.MobileSupplyChainDeliveryTicket         = LocalMobileSupplyChainDeliveryTicket
                related.MobileSupplyChainDeliveryUnit           = LocalMobileSupplyChainDeliveryUnit

    Actions
        Create is a Create Action
            valid when (actor.context.FinanceEnterpriseGroup.ShowMobileSupplyChain)
            Local Fields
                AsyncId is an AsyncActionRequest
            
            Exit Rules
                if (Type.ParCount)
                    invoke ProcessParCountHeader in background
                        assign async action request id to AsyncId

                    invoke ProcessParLevelUpdate ParLevelUpdateLineUpload
                        assign async action request id to AsyncId
                        run after AsyncId
                        invoked.PrmFinanceEnterpriseGroup   = FinanceEnterpriseGroup
                        invoked.PrmMobileSupplyChainUpload               = MobileSupplyChainUpload

                    invoke ProcessParCount MobileSupplyChainParCountLine
                        run after AsyncId
                        invoked.PrmFinanceEnterpriseGroup   = FinanceEnterpriseGroup
                        invoked.PrmMobileSupplyChainUpload               = MobileSupplyChainUpload

                else
                if (Type.PickForPar)
                    invoke ProcessPickForPar in background

                else
                if(Type.CycleCount)
                    invoke ProcessCycleCount in background
                
                else
                if(Type.Kanban)
                    invoke ProcessKanbanCount in background

                else
                if (Type.DockLog)
                    invoke ProcessDockLog in background
                
                else
                if (Type.MiscellaneousReceipt)
                    invoke CreateMiscellaneousReceipt in background

                else
                if (Type.ParCycleCount)
                    invoke ProcessParCycleCount in background
                
                else
                if (Type.InventoryAdjustments)
                    invoke CreateInventoryAdjustments in background  

                else
                if (Type.InventoryIssues)
                    invoke CreateIssuesAndReturns in background     

                else
                if (Type.InventoryTransfer)
                    invoke CreateInventoryTransfer in background   
                else
                if  (Type.ReceivingTransfer)
                    invoke CreateReceivingTransfer in background
                else
                if (Type.Picking)
                    invoke ProcessShipment in background
                
                else
                if (Type.POReceiving)
                    invoke CreatePurchaseOrderReceipt in background
                
                else
                if (Type.InventoryReplenishment)
                    invoke CreateInventoryReplenishment in background
                else
                if (Type.DeliveryEvent)
                    invoke CreateDeliveryEvent in background

        Update is an Update Action
            restricted

        Delete is a Delete Action
            restricted

        CreateMiscellaneousReceipt is an Instance Action
            restricted
            Local Fields
                MiscellaneousReceiptView        is a MiscellaneousReceipt view
                LocalMiscellanousReceipt        is a MiscellaneousReceipt
                LocalDeliverToCompanyLocation   is like DeliverToCompanyLocation
                LocalReceivingCompany           is a MobileSupplyChainCompany
                LocalReceivingLocation          is a MobileSupplyChainLocation
                LocalNoteCode                   is like DeliveryNoteCode
                LocalRejectDelivery             is Boolean
                LocalVendor                     is like MobileSupplyChainVendor
                LocalPurchaseOrder              is a MiscellaneousReceiptPurchaseOrder
                LocalTimeStarted                is TimeStamp
                LocalLabelPrinter               is an MobileSupplyChainPrinter
                LocalDocumentPrinter            is an MobileSupplyChainPrinter
                LocalPackingSlipNumber          is like PackingSlipNumber
                LocalCarrierTrackingNumber      is like CarrierTrackingNumber
                LocalDeliveryNote               is like DeliveryNote
                LocalPrintFlag                  is Boolean
                LocalCarrier                    is like MobileSupplyChainVendor
                LocalCarrierCount               is like TransactionCounter
                LocalCarrierCounter             is like TransactionCounter
                LocalTrackingNumberCount        is like TransactionCounter
                LocalTrackingNumberCounter      is like TransactionCounter
                LocalTimeSubmitted              is TimeStamp
                LocalCarrierXML                 is XMLDocument
            Action Rules
                Status                                          = Status.InProgress

                LocalReceivingCompany                           = XML select "/MiscellaneousReceivingTransaction/ReceivingCompany"
                LocalReceivingLocation                          = XML select "/MiscellaneousReceivingTransaction/ReceivingLocation"
                LocalVendor                                     = XML select "/MiscellaneousReceivingTransaction/Vendor"
                LocalRejectDelivery                             = XML select "/MiscellaneousReceivingTransaction/RejectDelivery"
                LocalPrintFlag                                  = XML select "/MiscellaneousReceivingTransaction/Print"
                LocalPurchaseOrder                              = XML select "/MiscellaneousReceivingTransaction/PurchasingOrderNumber"
                LocalTimeStarted                                = XML select "/MiscellaneousReceivingTransaction/TimeStarted"
                LocalNoteCode                                   = XML select "/MiscellaneousReceivingTransaction/DeliveryNotes/Code"
                LocalDeliveryNote                               = XML select "/MiscellaneousReceivingTransaction/DeliveryNotes/Note"
                LocalPackingSlipNumber                          = XML select "/MiscellaneousReceivingTransaction/PackingSlipNumber"
                LocalDeliverToCompanyLocation.DeliverToCompany  = XML select "/MiscellaneousReceivingTransaction/DeliverToCompany"
                LocalDeliverToCompanyLocation.DeliverToLocation = XML select "/MiscellaneousReceivingTransaction/DeliverToLocation"
                LocalLabelPrinter                               = XML select "/MiscellaneousReceivingTransaction/Printer/Label"
                LocalDocumentPrinter                            = XML select "/MiscellaneousReceivingTransaction/Printer/Report"
                LocalCarrierCount                               = XML select "count (/MiscellaneousReceivingTransaction/Carrier)"
                LocalTimeSubmitted                              = XML select "/MiscellaneousReceivingTransaction/TimeSubmitted"
                if (LocalCarrierCount >= 1)
                    LocalCarrierCounter = 1

                    invoke Create MiscellaneousReceipt
                        assign result to MiscellaneousReceiptView
                        invoked.Company                             = LocalReceivingCompany
                        invoked.MobileSupplyChainLocation           = LocalReceivingLocation
                        invoked.DeliverToCompanyLocation            = LocalDeliverToCompanyLocation
                        invoked.Supplier                            = LocalVendor
                        invoked.ReceivedBy                          = actor
                        invoked.TimeStarted                         = LocalTimeStarted
                        invoked.PurchaseOrder                       = LocalPurchaseOrder
                        invoked.PackingSlipNumber                   = LocalPackingSlipNumber
                        invoked.RejectDelivery                      = LocalRejectDelivery
                        invoked.DeliveryNoteCode                    = LocalNoteCode
                        invoked.DeliveryNote                        = LocalDeliveryNote
                        invoked.ReportPrinter                       = LocalDocumentPrinter
                        invoked.LabelPrinter                        = LocalLabelPrinter
                        invoked.TimeSubmitted                       = MobileSupplyChainUpload.create stamp.timestamp
                    LocalMiscellanousReceipt    = MiscellaneousReceiptView.MiscellaneousReceipt
                    LocalReceivingCompany       = MiscellaneousReceiptView.Company 
                    LocalReceivingLocation      = MiscellaneousReceiptView.MobileSupplyChainLocation

                    while (LocalCarrierCounter <= LocalCarrierCount)
                        LocalCarrierXML             = XML select "/MiscellaneousReceivingTransaction/Carrier[<LocalCarrierCounter>]"
                        LocalCarrier                = LocalCarrierXML select "/Carrier/ID"
                        LocalTrackingNumberCount    = LocalCarrierXML select "count (/Carrier/TrackingList/TrackingNumber)" 

                        if (LocalTrackingNumberCount >= 1)    
                            LocalTrackingNumberCounter = 1               
                            while (LocalTrackingNumberCounter <= LocalTrackingNumberCount)
                                LocalCarrierTrackingNumber = LocalCarrierXML select "/Carrier/TrackingList/TrackingNumber[<LocalTrackingNumberCounter>]"
                                invoke Create MiscellaneousReceiptLine
                                    invoked.Company                         = LocalReceivingCompany
                                    invoked.MobileSupplyChainLocation       = LocalReceivingLocation
                                    invoked.MiscellaneousReceipt            = LocalMiscellanousReceipt
                                    invoked.VendorCarrier                   = LocalCarrier
                                    invoked.CarrierTrackingNumber           = LocalCarrierTrackingNumber
                                LocalTrackingNumberCounter += 1
                        LocalCarrierCounter += 1

            Exit Rules
                if (LocalPrintFlag)
                    invoke ReleaseAndPrint LocalMiscellanousReceipt
                else
                    invoke Release LocalMiscellanousReceipt

                Status = Status.UploadComplete

        CreateDockLog is an Instance Action 
            restricted

        ProcessDockLog is an Instance Action
            restricted
            Local Fields
                DockLogView                             is a DockLog view
                LocalRADLocation                        is a MobileSupplyChainLocation
                LocalRADCompany                         is a MobileSupplyChainCompany
                LocalDockLog                            is a DockLog
                Carrier                                 is like Vendor
                LineTrackingNumber                      is like TrackingNumber
                TrackingNumberSize                      is Numeric size 4
                TrackingNumberCounter                   is Numeric size 4
                TimeStarted                             is TimeStamp
                ReportPrinterID                         is like MobileSupplyChainPrinter
                LocalTimeSubmitted                      is TimeStamp
            Action Rules
                Status = Status.InProgress

                LocalRADCompany     = XML select "/DockLogTransaction/Company"
                LocalRADLocation    = XML select "/DockLogTransaction/Location"
                Carrier             = XML select "/DockLogTransaction/CarrierId"
                TimeStarted         = XML select "/DockLogTransaction/TimeStarted"
                TrackingNumberSize  = XML select "count (/DockLogTransaction/TrackingList/TrackingNumber)"
                ReportPrinterID     = XML select "/DockLogTransaction/Printer/Report"
                LocalTimeSubmitted  = XML select "/DockLogTransaction/TimeSubmitted"
                

                invoke Create DockLog
                    assign result to DockLogView
                    invoked.Company                         = LocalRADCompany
                    invoked.MobileSupplyChainLocation       = LocalRADLocation
                    invoked.Carrier                         = Carrier
                    invoked.DockLoggedBy                    = actor
                    invoked.TotalCount                      = TrackingNumberSize
                    invoked.TimeSubmitted                   = LocalTimeSubmitted
                    invoked.TimeStarted                     = TimeStarted
                LocalDockLog                        = DockLogView.DockLog
                LocalRADCompany                     = DockLogView.Company 
                LocalRADLocation                    = DockLogView.MobileSupplyChainLocation

                TrackingNumberCounter = 1

                while (TrackingNumberCounter <= TrackingNumberSize)
                    LineTrackingNumber                      = XML select "/DockLogTransaction/TrackingList/TrackingNumber[<TrackingNumberCounter>]"
                    invoke Create DockLogLine
                        invoked.Company                         = LocalRADCompany
                        invoked.MobileSupplyChainLocation       = LocalRADLocation
                        invoked.DockLog                         = LocalDockLog
                        invoked.TrackingNumber                  = LineTrackingNumber
                    TrackingNumberCounter += 1
                    

            Exit Rules
                invoke Release LocalDockLog
                    invoked.PrmMobileSupplyChainPrinter  = ReportPrinterID
                    
                Status = Status.UploadComplete

        ProcessPickForPar is an Instance Action
            restricted
            Local Fields
                FromCompany             is like InventoryCompany
                FromLocation            is like InventoryLocation
                PickForParTicket        is like PickForParTicket
                EarliestTimestamp       is TimeStamp

                PickForParSize          is Numeric size 6
                PickForParCounter       is Numeric size 6

                PickForParLineSize      is Numeric size 6
                PickForParLineCounter   is Numeric size 6

                Item                    is like Item
                Bin                     is like Bin
                TransactionUOM          is like UnitOfMeasure
                PulledQuantity          is like Quantity
                AdditionalQuantity      is like Quantity
                LineTimeStamp           is TimeStamp

                ReportPrinterID         is like MobileSupplyChainPrinter

            Action Rules
                Status              = Status.InProgress

                FromCompany         = XML select "/PFPTransactions/Company"
                FromLocation        = XML select "/PFPTransactions/InventoryLocation"
                ReportPrinterID     = XML select "/PFPTransactions/Printer/Report"

				PickForParSize      = XML select "count (/PFPTransactions/PickForPar)"   

                if (PickForParSize >= 1)
                    PickForParCounter       = 1

                    while (PickForParCounter <= PickForParSize)
                        PickForParTicket        = XML select "/PFPTransactions/PickForPar[<PickForParCounter>]/PickForParList/PickForParTicket"
                        LocalFromCompany        = FromCompany
                        LocalFromLocation       = FromLocation
                        LocalPickForParTicket   = PickForParTicket
                    
                        invoke TransitionToInProgress PickForParTicketRel
                            invoked.PrmMobileSupplyChainUpload       = MobileSupplyChainUpload

                        PickForParLineSize = XML select "count (/PFPTransactions/PickForPar[<PickForParCounter>]/PickForParList/Line)"

                        PickForParLineCounter = 1
                        initialize EarliestTimestamp
                        while (PickForParLineCounter <= PickForParLineSize)
                            Item                    = XML select "/PFPTransactions/PickForPar[<PickForParCounter>]/PickForParList/Line[<PickForParLineCounter>]/Item"
                            Bin                     = XML select "/PFPTransactions/PickForPar[<PickForParCounter>]/PickForParList/Line[<PickForParLineCounter>]/Bin"
                            TransactionUOM          = XML select "/PFPTransactions/PickForPar[<PickForParCounter>]/PickForParList/Line[<PickForParLineCounter>]/UOM"
                            PulledQuantity          = XML select "/PFPTransactions/PickForPar[<PickForParCounter>]/PickForParList/Line[<PickForParLineCounter>]/Quantity"
                            AdditionalQuantity      = XML select "/PFPTransactions/PickForPar[<PickForParCounter>]/PickForParList/Line[<PickForParLineCounter>]/AdditionalQuantity"
                            LineTimeStamp           = XML select "/PFPTransactions/PickForPar[<PickForParCounter>]/PickForParList/TimeStarted"
                            LocalItem               = Item
                            LocalBin                = Bin
                            LocalTransactionUOM     = TransactionUOM
                            
                            if (EarliestTimestamp not entered or EarliestTimestamp > LineTimeStamp)
                                EarliestTimestamp = LineTimeStamp
                            
                            invoke PickForPar PickForParTicketLineRel
                                invoked.PrmMobileSupplyChainUpload               = MobileSupplyChainUpload
                                invoked.PrmPulledQuantity           = PulledQuantity
                                invoked.PrmAdditionalQuantity       = AdditionalQuantity
                                invoked.PrmTimeStamp                = LineTimeStamp

                            PickForParLineCounter += 1

                        invoke Update PickForParTicketRel
                            invoked.MobileSupplyChainPrinter     = ReportPrinterID
                            invoked.TimeStarted     = EarliestTimestamp

                        PickForParCounter += 1
                    
            Exit Rules 
                Status = Status.UploadComplete
                invoke ProcessPulledQuantities PickForParTicketLine
                    invoked.PrmMobileSupplyChainUpload    = MobileSupplyChainUpload


        ProcessParCountHeader is an Instance Action
            restricted
            Local Fields
                LocalTimeSubmitted          is TimeStamp
                Item                        is like Item
                Printer                     is like MobileSupplyChainPrinter
                LineTimeStamp               is TimeStamp

                ParUpdateSize               is Numeric size 6
                ParUpdateCounter            is Numeric size 6

                ParUpdateLineSize           is Numeric size 6
                ParUpdateLineCounter        is Numeric size 6
                NewPar                      is like Quantity

                ParCountSize                is Numeric size 6
                ParCountCounter             is Numeric size 6

                ParCountLineSize            is Numeric size 6
                ParCountLineCounter         is Numeric size 6
                AdditionalQuantity          is like Quantity
                Count                       is like Quantity
                LocalTransactionUOM         is like UnitOfMeasure

            Action Rules
                Status          = Status.InProgress

                ParCompany                  = XML select "/ParTransactions/Company"
                ParUpdateSize               = XML select "count (/ParTransactions/ParUpdate/ParUpdateList/Location)"
                LocalTimeSubmitted          = XML select "/ParTransactions/TimeSubmitted"
                if (ParUpdateSize >= 1)
                    ParUpdateCounter = 1
                    while (ParUpdateCounter <= ParUpdateSize)
                        LocationInventoryLocation   = XML select "/ParTransactions/ParUpdate/ParUpdateList[<ParUpdateCounter>]/Location"
                        Printer                     = XML select "/ParTransactions/ParUpdate/ParUpdateList[<ParUpdateCounter>]/Printer/Label"
                        LineTimeStamp               = XML select "/ParTransactions/ParUpdate/ParUpdateList[<ParUpdateCounter>]/TimeStarted"
                            
                        invoke Create ParLevelUpdateUpload
                            assign result to ParLevelUpdateUploadView
                            invoked.Company                          = ParCompany
                            invoked.InventoryLocation                = LocationInventoryLocation
                            invoked.MobileSupplyChainPrinter         = Printer
                            invoked.CountedBy                        = actor
                            invoked.MobileSupplyChainUpload          = MobileSupplyChainUpload
                            invoked.TimeSubmitted                    = LocalTimeSubmitted
                            invoked.TimeStarted                      = LineTimeStamp
    
                        ParLevelUpdateUpload = ParLevelUpdateUploadView.ParLevelUpdateUpload

                        ParUpdateLineSize = XML select "count (/ParTransactions/ParUpdate/ParUpdateList[<ParUpdateCounter>]/Line)"

                        ParUpdateLineCounter = 1
                        
                        while (ParUpdateLineCounter <= ParUpdateLineSize)
                            Item                    = XML select "/ParTransactions/ParUpdate/ParUpdateList[<ParUpdateCounter>]/Line[<ParUpdateLineCounter>]/Item"
                            NewPar                  = XML select "/ParTransactions/ParUpdate/ParUpdateList[<ParUpdateCounter>]/Line[<ParUpdateLineCounter>]/NewPar"                            
                            
                            invoke Create ParLevelUpdateLineUpload
                                invoked.Company                     = ParCompany
                                invoked.InventoryLocation           = LocationInventoryLocation
                                invoked.ParLevelUpdateUpload        = ParLevelUpdateUpload
                                invoked.Item                        = Item
                                invoked.NewPar                      = NewPar
                                invoked.CountTime                   = LineTimeStamp
                                invoked.Status                      = ParLevelUpdateLineUpload.Status.NotStarted
                            ParUpdateLineCounter += 1


                        ParUpdateCounter += 1

                ParCountSize = XML select "count (/ParTransactions/ParCount/ParCountList/Location)"
                if (ParCountSize >= 1)
                    ParCountCounter = 1
                    while (ParCountCounter <= ParCountSize)
                        LocationInventoryLocation   = XML select "/ParTransactions/ParCount/ParCountList[<ParCountCounter>]/Location"
                        LineTimeStamp               = XML select "/ParTransactions/ParCount/ParCountList[<ParCountCounter>]/TimeStarted"
                        ParCountLineSize            = XML select "count (/ParTransactions/ParCount/ParCountList[<ParCountCounter>]/Line)"

                        invoke Create MobileSupplyChainParCount
                            assign result to MobileSupplyChainParCountView
                            invoked.Company                     = ParCompany
                            invoked.InventoryLocation           = LocationInventoryLocation
                            invoked.CountedBy          		    = actor
                            invoked.MobileSupplyChainUpload     = MobileSupplyChainUpload
                            invoked.Status                      = MobileSupplyChainParCount.Status.Received
                            invoked.TimeSubmitted               = LocalTimeSubmitted
                            invoked.TimeStarted                 = LineTimeStamp


                        MobileSupplyChainParCount = MobileSupplyChainParCountView.MobileSupplyChainParCount
                        

                        ParCountLineCounter = 1
                        while (ParCountLineCounter <= ParCountLineSize)
                            Item                    = XML select "/ParTransactions/ParCount/ParCountList[<ParCountCounter>]/Line[<ParCountLineCounter>]/Item"
                            Count                   = XML select "/ParTransactions/ParCount/ParCountList[<ParCountCounter>]/Line[<ParCountLineCounter>]/Quantity"                            
                            AdditionalQuantity      = XML select "/ParTransactions/ParCount/ParCountList[<ParCountCounter>]/Line[<ParCountLineCounter>]/AdditionalQuantity"  
                            LocalTransactionUOM     = XML select "/ParTransactions/ParCount/ParCountList[<ParCountCounter>]/Line[<ParCountLineCounter>]/Uom"                        
                            
                            invoke Create MobileSupplyChainParCountLine
                                invoked.Company         	            = ParCompany
                                invoked.InventoryLocation               = LocationInventoryLocation
                                invoked.MobileSupplyChainParCount		= MobileSupplyChainParCount
                                invoked.Item				            = Item
                                invoked.Count				            = Count
                                invoked.AdditionalQuantity	            = AdditionalQuantity
                                invoked.Status                          = MobileSupplyChainParCountLine.Status.NotStarted
                                invoked.TransactionUOM                  = LocalTransactionUOM
                            ParCountLineCounter += 1

                        ParCountCounter += 1
            Exit Rules
                Status = Status.UploadComplete

        ProcessCycleCount is an Instance Action
            restricted
            Local Fields
                FromCompany             is like InventoryCompany
                FromLocation            is like InventoryLocation
                LocalSelectId           is like PhysicalInventorySelect   

                LocalItem               is like Item
                LocalTimeStarted        is TimeStamp
                LocalTimeSubmitted      is TimeStamp
                CountFormSize           is Numeric size 6
                CountFormCounter        is Numeric size 6 

                CycleCountLineSize      is Numeric size 6
                CycleCountLineCounter   is Numeric size 6 

                LocationItemSize        is Numeric size 6
                LocationItemCounter     is Numeric size 6       

                LocalCount              is like Quantity

                LocalFreezePage         is Numeric size 4
                LocalFreezeLine         is like PhysicalInventoryFreezeLine

            Action Rules
                Status              = Status.InProgress

                FromCompany         = XML select "/CycleCountTransaction/Company"
                CountFormSize       = XML select "count (/CycleCountTransaction/CountUpdate/CountForm/SelectId)"
                LocalFromCompany    = FromCompany
                LocalTimeSubmitted  = XML select "/CycleCountTransaction/TimeSubmitted"
                if (CountFormSize >= 1)
                    CountFormCounter = 1
                    while(CountFormCounter <= CountFormSize)
                        LocalSelectId       = XML select "/CycleCountTransaction/CountUpdate/CountForm[<CountFormCounter>]/SelectId"
                        LocalTimeStarted    = XML select "/CycleCountTransaction/CountUpdate/CountForm[<CountFormCounter>]/TimeStarted"

                        invoke Create CycleCountUpload
                            assign result to CycleCountUploadView
                            invoked.Company                 = FromCompany
                            invoked.SelectId                = LocalSelectId
                            invoked.CountedBy          		= actor
                            invoked.Status                  = CycleCountUpload.Status.InProgress
                            invoked.MobileSupplyChainUpload = MobileSupplyChainUpload
                            invoked.TimeSubmitted           = LocalTimeSubmitted
                            invoked.TimeStarted             = LocalTimeStarted

                        LocalCycleCountUpload = CycleCountUploadView.CycleCountUpload

                        LocationItemSize    = XML select "count (/CycleCountTransaction/CountUpdate/CountForm[<CountFormCounter>]/LocationItems)"
                        
                        LocationItemCounter = 1
                        while (LocationItemCounter <= LocationItemSize)
                            FromLocation        = XML select "/CycleCountTransaction/CountUpdate/CountForm[<CountFormCounter>]/LocationItems[<LocationItemCounter>]/Location"

                            CycleCountLineSize  = XML select "count (/CycleCountTransaction/CountUpdate/CountForm[<CountFormCounter>]/LocationItems[<LocationItemCounter>]/CountItem)"

                            CycleCountLineCounter    = 1
                            while (CycleCountLineCounter <= CycleCountLineSize)

                                LocalItem               = XML select "/CycleCountTransaction/CountUpdate/CountForm[<CountFormCounter>]/LocationItems[<LocationItemCounter>]/CountItem[<CycleCountLineCounter>]/Item"
                                LocalCount              = XML select "/CycleCountTransaction/CountUpdate/CountForm[<CountFormCounter>]/LocationItems[<LocationItemCounter>]/CountItem[<CycleCountLineCounter>]/Quantity"
                                LocalFreezePage         = XML select "/CycleCountTransaction/CountUpdate/CountForm[<CountFormCounter>]/LocationItems[<LocationItemCounter>]/CountItem[<CycleCountLineCounter>]/FreezePage"
                                LocalFreezeLine         = XML select "/CycleCountTransaction/CountUpdate/CountForm[<CountFormCounter>]/LocationItems[<LocationItemCounter>]/CountItem[<CycleCountLineCounter>]/FreezeLine"

                                invoke Create CycleCountLineUpload
                                    invoked.Company                 = FromCompany
                                    invoked.CycleCountUpload        = LocalCycleCountUpload
                                    invoked.InventoryLocation       = FromLocation
                                    invoked.Item                    = LocalItem
                                    invoked.EnteredCount            = LocalCount
                                    invoked.FreezePage              = LocalFreezePage
                                    invoked.FreezeLine              = LocalFreezeLine
                                    invoked.Status                  = CycleCountLineUpload.Status.InProgress
                                
                                CycleCountLineCounter += 1
                            
                            LocationItemCounter += 1

                        CountFormCounter += 1

            Exit Rules
                invoke ProcessCycleCount CycleCountLineUpload
                    invoked.PrmInventoryCompany                     = LocalFromCompany
                    invoked.PrmMobileSupplyChainUpload              = MobileSupplyChainUpload
        
        ProcessKanbanCount is an Instance Action
            restricted
            Local Fields
                FromCompany                 is like InventoryCompany
                FromLocation                is like InventoryLocation

                LocalTimeStarted            is TimeStamp
                LocalTimeSubmitted          is TimeStamp
                KanbanCountSize             is Numeric size 6
                KanbanCountCounter          is Numeric size 6

                KanbanCountLineSize         is Numeric size 6
                KanbanCountLineCounter      is Numeric size 6

                KanbanCountItemSize         is Numeric size 6
                KanbanCountItemCounter      is Numeric size 6
                LocalRequested              is like Quantity
                LocalTotalRequest           is like Quantity
            
            Action Rules
                Status = Status.InProgress

                FromCompany             = XML select "/KanbanCountTransaction/Company"
                LocalFromCompany        = FromCompany

                KanbanCountSize         = XML select "count (/KanbanCountTransaction/KanbanCount/KanbanCountList/Location)"
                LocalTimeSubmitted      = XML select "/KanbanCountTransaction/TimeSubmitted"
                if (KanbanCountSize >= 1)
                    KanbanCountCounter = 1
                
                    while(KanbanCountCounter <= KanbanCountSize)
                        initialize LocalFromLocation
                        FromLocation            = XML select "/KanbanCountTransaction/KanbanCount/KanbanCountList[<KanbanCountCounter>]/Location"
                        LocalFromLocation       = FromLocation
                        LocalTimeStarted        = XML select "/KanbanCountTransaction/KanbanCount/KanbanCountList[<KanbanCountCounter>]/TimeStarted"

                        KanbanCountLineSize     = XML select "count (/KanbanCountTransaction/KanbanCount/KanbanCountList[<KanbanCountCounter>]/Line/Item)"
                        
                        invoke Create KanbanCount
                            assign result to KanbanCountView
                            invoked.Company                     = FromCompany
                            invoked.InventoryLocation           = FromLocation
                            invoked.CountedBy          		    = actor
                            invoked.MobileSupplyChainUpload     = MobileSupplyChainUpload
                            invoked.Status                      = KanbanCount.Status.InProgress
                            invoked.TimeSubmitted               = LocalTimeSubmitted
                            invoked.TimeStarted                 = LocalTimeStarted

                        LocalKanbanCount        = KanbanCountView.KanbanCount
                        KanbanCountLineCounter  = 1

                        while(KanbanCountLineCounter <= KanbanCountLineSize)
                            initialize LocalTotalRequest
                            initialize LocalKanbanCountLine

                            LocalItem               = XML select "/KanbanCountTransaction/KanbanCount/KanbanCountList[<KanbanCountCounter>]/Line[<KanbanCountLineCounter>]/Item"

                            KanbanCountItemSize     = XML select "count (/KanbanCountTransaction/KanbanCount/KanbanCountList[<KanbanCountCounter>]/Line[<KanbanCountLineCounter>]/Bin/Id)"
                            KanbanCountItemCounter  = 1

                            while(KanbanCountItemCounter <= KanbanCountItemSize)
                                initialize LocalKanbanBinId
                                LocalKanbanBinId    = XML select "/KanbanCountTransaction/KanbanCount/KanbanCountList[<KanbanCountCounter>]/Line[<KanbanCountLineCounter>]/Bin[<KanbanCountItemCounter>]/Id"

                                LocalRequested      = XML select "/KanbanCountTransaction/KanbanCount/KanbanCountList[<KanbanCountCounter>]/Line[<KanbanCountLineCounter>]/Bin[<KanbanCountItemCounter>]/Quantity"

                                if(LocalRequested entered)
                                    if(LocalKanbanCountLine not entered)
                                        invoke Create KanbanCountLine
                                            assign result to KanbanCountLineView
                                            invoked.Company         	= FromCompany
                                            invoked.InventoryLocation   = FromLocation
                                            invoked.KanbanCount		    = LocalKanbanCount
                                            invoked.Item				= LocalItem
                                            invoked.Status              = KanbanCountLine.Status.InProgress

                                        LocalKanbanCountLine = KanbanCountLineView.KanbanCountLine

                                    if(LocalKanbanCountLine entered)
                                        invoke Create KanbanCountBin
                                            invoked.Company         	= FromCompany
                                            invoked.InventoryLocation   = FromLocation
                                            invoked.KanbanCountLine     = LocalKanbanCountLine
                                            invoked.KanbanCount         = LocalKanbanCount
                                            invoked.BinID			    = LocalKanbanBinId
                                            invoked.Requested	        = LocalRequested

                                        invoke UpdateScanActivity KanbanItemBinRel
                                            invoked.PrmItemTimeStamp    = LocalTimeStarted
                                        
                                        LocalTotalRequest += LocalRequested
                                
                                KanbanCountItemCounter += 1

                            invoke Update MSMCKanbanCountLineRel
                                invoked.Requested                       = LocalTotalRequest

                            KanbanCountLineCounter += 1
                        
                        KanbanCountCounter += 1
            
            Exit Rules
                invoke ProcessKanbanCount KanbanCountLine
                    invoked.PrmFinanceEnterpriseGroup   = FinanceEnterpriseGroup
                    invoked.PrmMobileSupplyChainUpload               = MobileSupplyChainUpload

        ProcessParCycleCount is an Instance Action
            restricted
            Local Fields
                LocalFromCompany            is like InventoryCompany
                LocalFromLocation           is like InventoryLocation
                
                LocalTimeStarted            is TimeStamp
                LocalTimeSubmitted          is TimeStamp
                ParCycleCountListSize       is Numeric size 6
                ParCycleCountListCounter    is Numeric size 6

                ParCycleCountLineSize       is Numeric size 6
                ParCycleCountLineCounter    is Numeric size 6

                LocalItem                   is like Item
                LocalCount                  is like Quantity
                LocalExpiredQuantity        is like Quantity
            
            Action Rules
                Status                  = Status.InProgress

                LocalFromCompany        = XML select "/ParCycleTransactions/Company"
                LocalTimeSubmitted      = XML select "/ParCycleTransactions/TimeSubmitted"
                ParCycleCountListSize   = XML select "count (/ParCycleTransactions/ParCycleCount/ParCycleCountList/Location)"

                if (ParCycleCountListSize >= 1)
                    ParCycleCountListCounter = 1

                    while (ParCycleCountListCounter <= ParCycleCountListSize)
                        LocalTimeStarted    = XML select "/ParCycleTransactions/ParCycleCount/ParCycleCountList[<ParCycleCountListCounter>]/TimeStarted"
                        LocalFromLocation   = XML select "/ParCycleTransactions/ParCycleCount/ParCycleCountList[<ParCycleCountListCounter>]/Location"
        
                        invoke Create ParCycleCount
                            assign result to ParCycleCountView
                            invoked.Company                 = LocalFromCompany
                            invoked.InventoryLocation       = LocalFromLocation
                            invoked.TimeSubmitted           = LocalTimeSubmitted
                            invoked.TimeStarted             = LocalTimeStarted

                        LocalParCycleCount       = ParCycleCountView.ParCycleCount
                        ParCycleCountLineSize    = XML select "count (/ParCycleTransactions/ParCycleCount/ParCycleCountList[<ParCycleCountListCounter>]/Line)"
                        ParCycleCountLineCounter = 1

                        while (ParCycleCountLineCounter <= ParCycleCountLineSize)
                            LocalItem                = XML select "/ParCycleTransactions/ParCycleCount/ParCycleCountList[<ParCycleCountListCounter>]/Line[<ParCycleCountLineCounter>]/Item"
                            LocalCount               = XML select "/ParCycleTransactions/ParCycleCount/ParCycleCountList[<ParCycleCountListCounter>]/Line[<ParCycleCountLineCounter>]/Quantity"
                            LocalExpiredQuantity     = XML select "/ParCycleTransactions/ParCycleCount/ParCycleCountList[<ParCycleCountListCounter>]/Line[<ParCycleCountLineCounter>]/ExpiredQuantity"
 
                            invoke Create ParCycleCountLine
                                invoked.Company                     = LocalFromCompany
                                invoked.InventoryLocation           = LocalFromLocation
                                invoked.ParCycleCount               = LocalParCycleCount
                                invoked.Item                        = LocalItem
                                invoked.Count                       = LocalCount
                                invoked.ExpiredQuantity             = LocalExpiredQuantity
                                    
                            ParCycleCountLineCounter += 1

                        ParCycleCountListCounter += 1
            Exit Rules
                Status = Status.UploadComplete

        CreateInventoryAdjustments is an Instance Action
            restricted
            Local Fields

                LocalReportPrinter                                   is a MobileSupplyChainPrinter
                LocalTimeSubmitted                                   is TimeStamp
                LocalTimeStarted                                     is TimeStamp

                LocalLineSize                                        is Numeric size 6
                LocalLineCounter                                     is Numeric size 6
                LocalItem                                            is like Item
                LocalTransactionUom                                  is like UnitOfMeasure
                LocalAdjustedQuantity                                is like Quantity
                LocalItemGTIN                                        is like ItemGTIN

                LocalDetailSize                                      is Numeric size 6
                LocalDetailCounter                                   is Numeric size 6
                LocalDetailQuantity                                  is like Quantity
                LocalLot                                             is like ItemLot
                LocalLotExpirationDate                               is Date
                LocalManufacturingDate                               is Date
                LocalShelfLife                                       is Numeric size 4 
                LocalSerial                                          is like ItemSerialNumber
                LocalGTIN                                            is like ItemGTIN
                LocalUDIManufacturingDate                            is Date
                LocalUDIExpirationDate                               is Date
                LocalBin                                             is like Bin

                LocalHeaderError                                     is Boolean
                LocalHeaderErrorMessage                              is Text

            Action Rules
                Status                          = Status.InProgress

                LocalFromCompany                = XML select "/InventoryAdjustmentTransaction/Company"
                LocalFromLocation               = XML select "/InventoryAdjustmentTransaction/InventoryLocation"
                LocalReportPrinter              = XML select "/InventoryAdjustmentTransaction/Printer/Report"
                LocalTimeSubmitted              = XML select "/InventoryAdjustmentTransaction/TimeSubmitted"
                LocalTimeStarted                = XML select "/InventoryAdjustmentTransaction/Transaction/TimeStarted"

                invoke Create MobileSupplyChainInventoryTransaction
                    assign result to MobileSupplyChainInventoryTransactionView
                    invoked.Company                                     = LocalFromCompany
                    invoked.InventoryLocation                           = LocalFromLocation
                    invoked.InventoryDocumentType                       = InventoryDocumentType.Adjustment          
                    invoked.TimeSubmitted                               = LocalTimeSubmitted
                    invoked.TimeStarted                                 = LocalTimeStarted
                    invoked.MobileSupplyChainPrinter                    = LocalReportPrinter

                LocalMobileSupplyChainInventoryTransaction = MobileSupplyChainInventoryTransactionView.MobileSupplyChainInventoryTransaction
                LocalLineSize                              = XML select "count (/InventoryAdjustmentTransaction/Transaction/Line)"      
                LocalLineCounter                           = 1

                if (LocalLineSize >= 1)
                    while(LocalLineCounter <= LocalLineSize)
                        LocalItem                       =      XML select "/InventoryAdjustmentTransaction/Transaction/Line[<LocalLineCounter>]/Item"  
                        LocalAdjustedQuantity           =      XML select "/InventoryAdjustmentTransaction/Transaction/Line[<LocalLineCounter>]/AdjustedQuantity"   
                        LocalTransactionUom             =      XML select "/InventoryAdjustmentTransaction/Transaction/Line[<LocalLineCounter>]/Uom"
                        LocalBin                        =      XML select "/InventoryAdjustmentTransaction/Transaction/Line[<LocalLineCounter>]/Detail/Bin"
                        LocalItemGTIN                   =      XML select "/InventoryAdjustmentTransaction/Transaction/Line[<LocalLineCounter>]/ItemGTIN"
                        
                        invoke Create MobileSupplyChainInventoryTransactionLine
                            assign result to MobileSupplyChainInventoryTransactionLineView    
        
                            invoked.MobileSupplyChainInventoryTransaction       =      LocalMobileSupplyChainInventoryTransaction 
                            invoked.MobileSupplyChainInventoryTransactionLine   =      LocalLineCounter
                            invoked.Company                                     =      LocalFromCompany
                            invoked.InventoryLocation                           =      LocalFromLocation
                            invoked.Item                                        =      LocalItem
                            invoked.Quantity                                    =      LocalAdjustedQuantity
                            invoked.TransactionUOM                              =      LocalTransactionUom
                            invoked.MobileSupplyChainUpload                     =      MobileSupplyChainUpload
                            invoked.ItemGTIN                                    =      LocalItemGTIN
                        
                        LocalDetailSize                                = XML select "count (InventoryAdjustmentTransaction/Transaction/Line[<LocalLineCounter>]/Detail)"
                        LocalMobileSupplyChainInventoryTransactionLine = MobileSupplyChainInventoryTransactionLineView.MobileSupplyChainInventoryTransactionLine

                        if (LocalDetailSize >= 1)
                            LocalDetailCounter = 1

                            while (LocalDetailCounter <= LocalDetailSize)
                                
                                LocalBin                = XML select "/InventoryAdjustmentTransaction/Transaction/Line[<LocalLineCounter>]/Detail[<LocalDetailCounter>]/Bin"
                                LocalLot                = XML select "/InventoryAdjustmentTransaction/Transaction/Line[<LocalLineCounter>]/Detail[<LocalDetailCounter>]/Lot"
                                LocalSerial             = XML select "/InventoryAdjustmentTransaction/Transaction/Line[<LocalLineCounter>]/Detail[<LocalDetailCounter>]/Serial"
                                LocalDetailQuantity     = XML select "/InventoryAdjustmentTransaction/Transaction/Line[<LocalLineCounter>]/Detail[<LocalDetailCounter>]/Quantity"
                                LocalGTIN               = XML select "/InventoryAdjustmentTransaction/Transaction/Line[<LocalLineCounter>]/Detail[<LocalDetailCounter>]/UdiGtin"
                                LocalUDIManufacturingDate  = XML select "/InventoryAdjustmentTransaction/Transaction/Line[<LocalLineCounter>]/Detail[<LocalDetailCounter>]/ManufacturingDate"
                                LocalUDIExpirationDate     = XML select "/InventoryAdjustmentTransaction/Transaction/Line[<LocalLineCounter>]/Detail[<LocalDetailCounter>]/ExpiryDate"
                                LocalLotExpirationDate     = XML select "/InventoryAdjustmentTransaction/Transaction/Line[<LocalLineCounter>]/Detail[<LocalDetailCounter>]/LotExpiryDate"
                                LocalManufacturingDate     = XML select "/InventoryAdjustmentTransaction/Transaction/Line[<LocalLineCounter>]/Detail[<LocalDetailCounter>]/LotManufacturingDate"
                                LocalShelfLife             = XML select "/InventoryAdjustmentTransaction/Transaction/Line[<LocalLineCounter>]/Detail[<LocalDetailCounter>]/ShelfLife"

                                invoke Create MobileSupplyChainInventoryTransactionLineDetail
                                    invoked.MobileSupplyChainInventoryTransaction                    = LocalMobileSupplyChainInventoryTransaction
                                    invoked.MobileSupplyChainInventoryTransactionLine                = LocalMobileSupplyChainInventoryTransactionLine
                                    invoked.MobileSupplyChainInventoryTransactionLineDetail          = LocalDetailCounter
                                    invoked.Company                                                  = LocalFromCompany
                                    invoked.InventoryLocation                                        = LocalFromLocation
                                    invoked.Quantity                                                 = LocalDetailQuantity
                                    invoked.UnitOfMeasure                                            = LocalTransactionUom
                                    invoked.Item                                                     = LocalItem
                                    invoked.Bin                                                      = LocalBin
                                    invoked.Lot                                                      = LocalLot
                                    invoked.Serial                                                   = LocalSerial
                                    invoked.GTIN                                                     = LocalGTIN
                                    invoked.UDIManufacturingDate                                     = LocalUDIManufacturingDate
                                    invoked.UDIExpirationDate                                        = LocalUDIExpirationDate
                                    invoked.LotExpirationDate                                        = LocalLotExpirationDate
                                    invoked.ManufacturingDate                                        = LocalManufacturingDate
                                    invoked.ShelfLife                                                = LocalShelfLife

                                LocalDetailCounter += 1            

                        LocalLineCounter   +=1     

                invoke ProcessTransaction MobileSupplyChainInventoryTransactionLine
                    invoked.PrmMobileSupplyChainUpload = MobileSupplyChainUpload

            Exit Rules      
                Status = Status.UploadComplete
        
        CreateIssuesAndReturns is an Instance Action
            restricted
            Local Fields

                LocalRequestingLocation         is like InventoryLocation
                LocalDocumentPrinter            is a MobileSupplyChainPrinter
                LocalFirstName                  is a Name
                LocalLastName                   is a Name
                LocalTimeSubmitted              is TimeStamp
                LocalTimeStarted                is TimeStamp

                LocalLineSize                   is Numeric size 6
                LocalLineCount                  is Numeric size 6
                LocalTransactionCount           is Numeric size 6
                LocalTransactionSize            is Numeric size 6
                LocalItem                       is like Item
                LocalTransactionUOM             is like UnitOfMeasure
                LocalIssuedQuantity             is like Quantity
                LocalItemGTIN                   is like ItemGTIN

                LocalDetailSize                 is Numeric size 6
                LocalDetailCount                is Numeric size 6
                LocalDetailQuantity             is like Quantity
                LocalLot                        is like ItemLot
                LocalLotExpirationDate          is Date
                LocalManufacturingDate          is Date
                LocalShelfLife                  is Numeric size 4
                LocalSerial                     is like ItemSerialNumber
                LocalGTIN                       is like ItemGTIN
                LocalUDIExpirationDate          is Date
                LocalUDIManufacturingDate       is Date
                LocalBin                        is like Bin
 
                LocalHeaderError                is Boolean
                LocalHeaderErrorMessage         is Text
 
            Action Rules
                Status = Status.InProgress
 
                LocalFromCompany                = XML select "/InventoryIssuesTransaction/Company"
                LocalFromLocation               = XML select "/InventoryIssuesTransaction/InventoryLocation"
                LocalTransactionSize            = XML select "count (/InventoryIssuesTransaction/TransactionList/Transaction)"
                LocalTimeSubmitted              = XML select "/InventoryIssuesTransaction/TimeSubmitted"
                LocalTimeStarted                = XML select "/InventoryIssuesTransaction/TransactionList/Transaction/TimeStarted"
                LocalDocumentPrinter            = XML select "/InventoryIssuesTransaction/Printer/Report"
 
                if (LocalTransactionSize >= 1)
                    LocalTransactionCount = 1

                    while (LocalTransactionCount <= LocalTransactionSize)
                        LocalRequestingLocation                 = XML select "/InventoryIssuesTransaction/TransactionList/Transaction[<LocalTransactionCount>]/RequestingLocation"
                        LocalFirstName                          = XML select "/InventoryIssuesTransaction/TransactionList/Transaction[<LocalTransactionCount>]/DeliveredFirstName"
                        LocalLastName                           = XML select "/InventoryIssuesTransaction/TransactionList/Transaction[<LocalTransactionCount>]/DeliveredLastName"
                        LocalLineSize                           = XML select "count (/InventoryIssuesTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line)"
 
                        invoke Create MobileSupplyChainInventoryTransaction
                            assign result to MobileSupplyChainInventoryTransactionView
                            invoked.Company                                                 = LocalFromCompany
                            invoked.InventoryLocation                                       = LocalFromLocation
                            invoked.FromToCompanyLocation.FromToCompany                     = LocalFromCompany
                            invoked.FromToCompanyLocation.RequestingLocation                = LocalRequestingLocation
                            invoked.InventoryDocumentType                                   = InventoryDocumentType.InventoryIssue
                            invoked.TimeSubmitted                                           = LocalTimeSubmitted
                            invoked.TimeStarted                                             = LocalTimeStarted
                            invoked.IssuedTo.FirstName                                      = LocalFirstName
                            invoked.IssuedTo.LastName                                       = LocalLastName
                            invoked.MobileSupplyChainPrinter                                = LocalDocumentPrinter
 
                        LocalMobileSupplyChainInventoryTransaction        = MobileSupplyChainInventoryTransactionView.MobileSupplyChainInventoryTransaction              
                        
                        if (LocalLineSize >= 1)
                            LocalLineCount = 1

                            while (LocalLineCount <= LocalLineSize)
                                LocalItem                       = XML select "/InventoryIssuesTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/Item"
                                LocalIssuedQuantity             = XML select "/InventoryIssuesTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/IssuedQuantity"
                                LocalTransactionUOM             = XML select "/InventoryIssuesTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/Uom"
                                LocalItemGTIN                   = XML select "/InventoryIssuesTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/ItemGTIN"

                                invoke Create MobileSupplyChainInventoryTransactionLine
                                    assign result to MobileSupplyChainInventoryTransactionLineView
                                    invoked.MobileSupplyChainInventoryTransaction       =      LocalMobileSupplyChainInventoryTransaction
                                    invoked.MobileSupplyChainInventoryTransactionLine   =      LocalLineCount
                                    invoked.Company                                     =      LocalFromCompany
                                    invoked.InventoryLocation                           =      LocalFromLocation
                                    invoked.Item                                        =      LocalItem
                                    invoked.Quantity                                    =      LocalIssuedQuantity
                                    invoked.TransactionUOM                              =      LocalTransactionUOM
                                    invoked.MobileSupplyChainUpload                     =      MobileSupplyChainUpload
                                    invoked.ItemGTIN                                    =      LocalItemGTIN 
 
                                LocalMobileSupplyChainInventoryTransactionLine = MobileSupplyChainInventoryTransactionLineView.MobileSupplyChainInventoryTransactionLine
                                LocalDetailSize                                = XML select "count (/InventoryIssuesTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/Detail)"
 
                                if (LocalDetailSize >= 1)
                                    LocalDetailCount = 1

                                    while(LocalDetailCount <= LocalDetailSize)
                                        LocalDetailQuantity         = XML select "/InventoryIssuesTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/Detail[<LocalDetailCount>]/Quantity"
                                        LocalLot                    = XML select "/InventoryIssuesTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/Detail[<LocalDetailCount>]/Lot"
                                        LocalLotExpirationDate      = XML select "/InventoryIssuesTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/Detail[<LocalDetailCount>]/LotExpiryDate"
                                        LocalManufacturingDate      = XML select "/InventoryIssuesTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/Detail[<LocalDetailCount>]/LotManufacturingDate"
                                        LocalShelfLife              = XML select "/InventoryIssuesTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/Detail[<LocalDetailCount>]/ShelfLife"
                                        LocalSerial                 = XML select "/InventoryIssuesTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/Detail[<LocalDetailCount>]/Serial"
                                        LocalBin                    = XML select "/InventoryIssuesTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/Detail[<LocalDetailCount>]/Bin"
                                        LocalGTIN                   = XML select "/InventoryIssuesTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/Detail[<LocalDetailCount>]/UdiGtin"
                                        LocalUDIManufacturingDate   = XML select "/InventoryIssuesTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/Detail[<LocalDetailCount>]/ManufacturingDate"
                                        LocalUDIExpirationDate      = XML select "/InventoryIssuesTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/Detail[<LocalDetailCount>]/ExpiryDate"             
                                     
                                        invoke Create MobileSupplyChainInventoryTransactionLineDetail
                                            invoked.MobileSupplyChainInventoryTransaction                       = LocalMobileSupplyChainInventoryTransaction
                                            invoked.MobileSupplyChainInventoryTransactionLine                   = LocalMobileSupplyChainInventoryTransactionLine
                                            invoked.MobileSupplyChainInventoryTransactionLineDetail             = LocalDetailCount
                                            invoked.Company                                                     = LocalFromCompany
                                            invoked.InventoryLocation                                           = LocalFromLocation
                                            invoked.Item                                                        = LocalItem
                                            invoked.Quantity                                                    = LocalDetailQuantity
                                            invoked.UnitOfMeasure                                               = LocalTransactionUOM
                                            invoked.Bin                                                         = LocalBin
                                            invoked.Lot                                                         = LocalLot
                                            invoked.Serial                                                      = LocalSerial
                                            invoked.GTIN                                                        = LocalGTIN
                                            invoked.UDIManufacturingDate                                        = LocalUDIManufacturingDate
                                            invoked.UDIExpirationDate                                           = LocalUDIExpirationDate
                                            invoked.ShelfLife                                                   = LocalShelfLife
                                            invoked.ManufacturingDate                                           = LocalManufacturingDate
                                            invoked.LotExpirationDate                                           = LocalLotExpirationDate
                                           
                                        LocalDetailCount +=1

                                LocalLineCount +=1      

                        
                        invoke ProcessTransaction MobileSupplyChainInventoryTransactionLine
                            invoked.PrmMobileSupplyChainUpload = MobileSupplyChainUpload
 
                        LocalTransactionCount += 1

                       
            Exit Rules
                Status = Status.UploadComplete       

        CreateInventoryTransfer is an Instance Action
            restricted
            Local Fields

                LocalToCompany                                          is like InventoryCompany
                LocalToLocation                                         is like InventoryLocation
                LocalReportPrinter                                      is a MobileSupplyChainPrinter
                IsInTransit                                             is Boolean
                EstimatedDeliveryDate                                   is Date
                LocalTimeSubmitted                                      is TimeStamp
                LocalTimeStarted                                        is TimeStamp
                LocalComment                                            is like Reference

                LocalLineSize                                           is Numeric size 6 
                LocalLineCounter                                        is Numeric size 6
                TransactionSize                                         is Numeric size 6
                Item                                                    is like Item
                LocalTransactionUOM                                     is like UnitOfMeasure
                LocalTransferQuantity                                   is like Quantity
                LocalToBin                                              is like Bin
                LocalItemGTIN                                           is like ItemGTIN

                LocalDetailSize                                         is Numeric size 6
                LocalDetailCounter                                      is Numeric size 6
                LocalDetailQuantity                                     is like Quantity
                LocalLot                                                is like ItemLot
                LocalLotExpirationDate                                  is Date
                LocalManufacturingDate                                  is Date
                LocalShelfLife                                          is Numeric size 4
                LocalSerial                                             is like ItemSerialNumber
                LocalFromBin                                            is like Bin

                LocalGTIN                                               is like ItemGTIN
                LocalUDIManufacturingDate                               is Date
                LocalUDIExpirationDate                                  is Date

            Action Rules
                initialize LocalFromCompany
                initialize LocalFromLocation

                Status = Status.InProgress

                LocalFromCompany            = XML select "/InventoryTransferTransaction/Company"
                LocalFromLocation           = XML select "/InventoryTransferTransaction/InventoryLocation"
                LocalToCompany              = XML select "/InventoryTransferTransaction/ToCompany"
                LocalToLocation             = XML select "/InventoryTransferTransaction/ToInventoryLocation"
                LocalReportPrinter          = XML select "/InventoryTransferTransaction/Printer/Report"
                LocalTimeSubmitted          = XML select "/InventoryTransferTransaction/TimeSubmitted"
                IsInTransit                 = XML select "/InventoryTransferTransaction/IsInTransit"
                EstimatedDeliveryDate       = XML select "/InventoryTransferTransaction/EstimatedDeliveryDate"
                LocalComment                = XML select "/InventoryTransferTransaction/Note"
                LocalTimeStarted            = XML select "/InventoryTransferTransaction/Transaction/TimeStarted"

                invoke Create MobileSupplyChainInventoryTransaction
                    assign result to MobileSupplyChainInventoryTransactionView
                    invoked.Company                                     = LocalFromCompany
                    invoked.InventoryLocation                           = LocalFromLocation
                    invoked.FromToCompanyLocation.FromToCompany         = LocalToCompany
                    invoked.FromToCompanyLocation.FromToLocation        = LocalToLocation
                    invoked.InventoryDocumentType                       = InventoryDocumentType.InventoryTransfer    
                    invoked.TimeSubmitted                               = LocalTimeSubmitted
                    invoked.MobileSupplyChainInventoryTransaction       = LocalMobileSupplyChainInventoryTransaction
                    invoked.TimeStarted                                 = LocalTimeStarted
                    invoked.IsInTransit                                 = IsInTransit
                    invoked.EstimatedDeliveryDate                       = EstimatedDeliveryDate
                    invoked.MobileSupplyChainPrinter                    = LocalReportPrinter
                    invoked.Reference                                   = LocalComment

                LocalMobileSupplyChainInventoryTransaction = MobileSupplyChainInventoryTransactionView.MobileSupplyChainInventoryTransaction
                LocalLineSize                              = XML select "count (/InventoryTransferTransaction/Transaction/Line)"      

                if (LocalLineSize >= 1)
                    LocalLineCounter = 1

                    while(LocalLineCounter <= LocalLineSize)
                        LocalItem                       =      XML select "/InventoryTransferTransaction/Transaction/Line[<LocalLineCounter>]/Item"  
                        LocalTransferQuantity           =      XML select "/InventoryTransferTransaction/Transaction/Line[<LocalLineCounter>]/TransferQuantity"   
                        LocalTransactionUOM             =      XML select "/InventoryTransferTransaction/Transaction/Line[<LocalLineCounter>]/Uom"
                        LocalToBin                      =      XML select "/InventoryTransferTransaction/Transaction/Line[<LocalLineCounter>]/ToBin"
                        LocalItemGTIN                   =      XML select "/InventoryTransferTransaction/Transaction/Line[<LocalLineCounter>]/ItemGTIN"
                        
                        invoke Create MobileSupplyChainInventoryTransactionLine
                            assign result to MobileSupplyChainInventoryTransactionLineView
                            invoked.MobileSupplyChainInventoryTransaction       =      LocalMobileSupplyChainInventoryTransaction
                            invoked.MobileSupplyChainInventoryTransactionLine   =      LocalLineCounter
                            invoked.Company                                     =      LocalFromCompany
                            invoked.InventoryLocation                           =      LocalFromLocation
                            invoked.Item                                        =      LocalItem
                            invoked.Quantity                                    =      LocalTransferQuantity
                            invoked.TransactionUOM                              =      LocalTransactionUOM
                            invoked.FromToCompanyLocationBin.FromToCompany      =      LocalToCompany
                            invoked.FromToCompanyLocationBin.FromToLocation     =      LocalToLocation
                            invoked.FromToCompanyLocationBin.FromToBin          =      LocalToBin
                            invoked.MobileSupplyChainUpload                     =      MobileSupplyChainUpload
                            invoked.ItemGTIN                                    =      LocalItemGTIN
                        
                        LocalMobileSupplyChainInventoryTransactionLine = MobileSupplyChainInventoryTransactionLineView.MobileSupplyChainInventoryTransactionLine
                        LocalDetailSize                                = XML select "count (/InventoryTransferTransaction/Transaction/Line[<LocalLineCounter>]/Detail)"

                        if (LocalDetailSize >= 1)
                            LocalDetailCounter = 1

                            while(LocalDetailCounter <= LocalDetailSize)
                                LocalFromBin                = XML select "/InventoryTransferTransaction/Transaction/Line[<LocalLineCounter>]/Detail[<LocalDetailCounter>]/FromBin"
                                LocalLot                    = XML select "/InventoryTransferTransaction/Transaction/Line[<LocalLineCounter>]/Detail[<LocalDetailCounter>]/Lot"
                                LocalSerial                 = XML select "/InventoryTransferTransaction/Transaction/Line[<LocalLineCounter>]/Detail[<LocalDetailCounter>]/Serial"
                                LocalDetailQuantity         = XML select "/InventoryTransferTransaction/Transaction/Line[<LocalLineCounter>]/Detail[<LocalDetailCounter>]/Quantity"
                                
                                LocalGTIN                   = XML select "/InventoryTransferTransaction/Transaction/Line[<LocalLineCounter>]/Detail[<LocalDetailCounter>]/UdiGtin"
                                LocalUDIManufacturingDate   = XML select "/InventoryTransferTransaction/Transaction/Line[<LocalLineCounter>]/Detail[<LocalDetailCounter>]/ManufacturingDate"
                                LocalUDIExpirationDate      = XML select "/InventoryTransferTransaction/Transaction/Line[<LocalLineCounter>]/Detail[<LocalDetailCounter>]/ExpiryDate"
                                LocalManufacturingDate      = XML select "/InventoryTransferTransaction/Transaction/Line[<LocalLineCounter>]/Detail[<LocalDetailCounter>]/LotManufacturingDate"
                                LocalLotExpirationDate      = XML select "/InventoryTransferTransaction/Transaction/Line[<LocalLineCounter>]/Detail[<LocalDetailCounter>]/LotExpiryDate"
                                LocalShelfLife              = XML select "/InventoryTransferTransaction/Transaction/Line[<LocalLineCounter>]/Detail[<LocalDetailCounter>]/ShelfLife"
                                
                                invoke Create MobileSupplyChainInventoryTransactionLineDetail
                                    invoked.MobileSupplyChainInventoryTransaction                    = LocalMobileSupplyChainInventoryTransaction
                                    invoked.MobileSupplyChainInventoryTransactionLine                = LocalMobileSupplyChainInventoryTransactionLine
                                    invoked.MobileSupplyChainInventoryTransactionLineDetail          = LocalDetailCounter
                                    invoked.Company                                                  = LocalFromCompany
                                    invoked.InventoryLocation                                        = LocalFromLocation
                                    invoked.Item                                                     = LocalItem
                                    invoked.Quantity                                                 = LocalDetailQuantity
                                    invoked.Bin                                                      = LocalFromBin
                                    invoked.Lot                                                      = LocalLot
                                    invoked.Serial                                                   = LocalSerial
                                    invoked.UnitOfMeasure                                            = LocalTransactionUOM
                                    invoked.GTIN                                                     = LocalGTIN
                                    invoked.UDIManufacturingDate                                     = LocalUDIManufacturingDate
                                    invoked.UDIExpirationDate                                        = LocalUDIExpirationDate
                                    invoked.ManufacturingDate                                        = LocalManufacturingDate
                                    invoked.LotExpirationDate                                        = LocalLotExpirationDate
                                    invoked.ShelfLife                                                = LocalShelfLife

                                LocalDetailCounter += 1            

                        LocalLineCounter   +=1     
                
                invoke ProcessTransaction MobileSupplyChainInventoryTransactionLine
                    invoked.PrmMobileSupplyChainUpload = MobileSupplyChainUpload

            Exit Rules
                Status = Status.UploadComplete
        
        ProcessShipment is an Instance Action
            restricted
            Local Fields
                LocalShipmentSize               is Numeric size 6
                LocalShipmentCounter            is Numeric size 6

                LocalShipmentLineSize           is Numeric size 6
                LocalShipmentLineCounter        is Numeric size 6

                LocalShipmentDetailSize         is Numeric size 6
                LocalShipmentDetailCounter      is Numeric size 6

                LocalLabelPrinter               is an MobileSupplyChainPrinter
                LocalDocumentPrinter            is an MobileSupplyChainPrinter

                LocalTimeStarted                is TimeStamp
                LocalTimeSubmitted              is TimeStamp
                LocalIsRelease                  is Boolean
                LocalIsFullyPicked              is Boolean
                LocalIsSkippedScan              is Boolean
                LocalShortPickFlag              is AlphaUpper size 1
                LocalPickedLineQuantity         is like Quantity
                LocalLineUOM                    is like UnitOfMeasure
                LocalGTIN                       is like ItemGTIN
                LocalExpiryDate                 is Date
                LocalManufacturingDate          is Date
                LocalTrackingNumber             is like TrackingNumber

                LocalShipmentXML                             is XMLDocument
                LocalLineXML                                 is XMLDocument
                LocalLineDetailXML                           is XMLDocument
            Action Rules
                Status                      = Status.InProgress

                LocalLabelPrinter           = XML select "/WarehouseShipmentTransaction/Printer/Label"
                LocalDocumentPrinter        = XML select "/WarehouseShipmentTransaction/Printer/Report"
                LocalTimeSubmitted          = XML select "/WarehouseShipmentTransaction/TimeSubmitted"
                LocalTimeStarted            = XML select "/WarehouseShipmentTransaction/TimeStarted"

				LocalShipmentSize           = XML select "count (/WarehouseShipmentTransaction/Picking/WarehouseShipmentList/WarehouseShipment)"

                if (LocalShipmentSize >= 1)
                    LocalShipmentCounter = 1

                    while (LocalShipmentCounter <= LocalShipmentSize)
                        initialize LocalWarehouseShipment
                        initialize LocalFromCompany
                        initialize LocalFromLocation

                        LocalShipmentXML            = XML select "/WarehouseShipmentTransaction/Picking/WarehouseShipmentList[<LocalShipmentCounter>]"    
                        LocalFromCompany            = LocalShipmentXML select "/WarehouseShipmentList/Company"
                        LocalFromLocation           = LocalShipmentXML select "/WarehouseShipmentList/Location"
                        LocalWarehouseShipment      = LocalShipmentXML select "/WarehouseShipmentList/WarehouseShipment"
                        LocalIsRelease              = LocalShipmentXML select "/WarehouseShipmentList/Release"
                        LocalIsFullyPicked          = LocalShipmentXML select "/WarehouseShipmentList/IsFullyPicked"

                        invoke Update WarehouseShipmentRel
                            invoked.IsFullyPicked               = LocalIsFullyPicked
                            invoked.PickedBy                    = actor
                            invoked.MobileLastTimeSubmitted     = LocalTimeSubmitted
                            invoked.MobileTimeStarted           = LocalTimeStarted
                            invoked.MSCMReportPrinter           = LocalDocumentPrinter
                            invoked.MSCMLabelPrinter            = LocalLabelPrinter

                        LocalShipmentLineSize       = XML select "count (/WarehouseShipmentTransaction/Picking/WarehouseShipmentList[<LocalShipmentCounter>]/Line)"

                        if (LocalShipmentLineSize >= 1)
                            LocalShipmentLineCounter = 1
                            
                            while (LocalShipmentLineCounter <= LocalShipmentLineSize)
                                initialize LocalWarehouseShipmentLine

                                LocalLineXML                = LocalShipmentXML select "/WarehouseShipmentList/Line[<LocalShipmentLineCounter>]"
                                LocalWarehouseShipmentLine  = LocalLineXML select "/Line/WarehouseShipmentLine" 
                                LocalIsSkippedScan          = LocalLineXML select "/Line/SkipScanned"
                                LocalPickedLineQuantity     = LocalLineXML select "/Line/PickedQuantity"
                                LocalLineUOM                = LocalLineXML select "/Line/PickedUom"
                                LocalShortPickFlag          = LocalLineXML select "/Line/ShortPickAction"

                                if (LocalShortPickFlag entered)
                                    invoke MSCMUpdateSavedShipmentLine WarehouseShipmentLineRel
                                        invoked.PrmPickQuantity                 = LocalPickedLineQuantity
                                        invoked.PrmPickQuantityUOM              = LocalLineUOM
                                        invoked.PrmShortPick                    = LocalShortPickFlag
                                        
                                if (LocalPickedLineQuantity > 0)
                                    LocalShipmentDetailSize         = XML select "count (/WarehouseShipmentTransaction/Picking/WarehouseShipmentList[<LocalShipmentCounter>]/Line[<LocalShipmentLineCounter>]/Detail)"
                                    LocalShipmentDetailCounter      = 1

                                    if (WarehouseShipmentLineRel.IsUDITracked)
                                        invoke Delete WarehouseShipmentLineRel.InventoryUDIDetailsRel
                                        invoke SystemDelete WarehouseShipmentLineRel.WarehouseShipmentLineDetailRel
                                    
                                    else
                                    if (WarehouseShipmentLineDetailRel exists)
                                        invoke Delete WarehouseShipmentLineRel.WarehouseShipmentLineDetailRel
                                    
                                    invoke Delete WarehouseShipmentLineRel.MobileSupplyChainShipmentDetailTrackingRel

                                    while (LocalShipmentDetailCounter <= LocalShipmentDetailSize)
                                        initialize LocalBin
                                        initialize LocalSerial
                                        initialize LocalLot
                                        initialize LocalSublot
                                        initialize LocalTrackingNumber
                                        initialize LocalPickedDetailQuantity
                                        initialize LocalPickedDetailUOM
                                        
                                        LocalLineDetailXML              = LocalLineXML select "/Line/Detail[<LocalShipmentDetailCounter>]"
                                        LocalBin                        = LocalLineDetailXML select "/Detail/Bin"
                                        LocalSerial                     = LocalLineDetailXML select "/Detail/Serial"
                                        LocalLot                        = LocalLineDetailXML select "/Detail/Lot"
                                        LocalSublot                     = LocalLineDetailXML select "/Detail/SubLot"
                                        LocalGTIN                       = LocalLineDetailXML select "/Detail/UdiGtin"
                                        LocalManufacturingDate          = LocalLineDetailXML select "/Detail/ManufacturingDate"
                                        LocalExpiryDate                 = LocalLineDetailXML select "/Detail/UdiExpiryDate"
                                        LocalTrackingNumber             = LocalLineDetailXML select "/Detail/TrackingNumber"
                                        LocalPickedDetailQuantity       = LocalLineDetailXML select "/Detail/Quantity"
                                        LocalPickedDetailUOM            = LocalLineDetailXML select "/Detail/Uom"

                                        if (WarehouseShipmentLineRel.IsUDITracked)
                                            invoke Create InventoryUDIDetail
                                                invoked.Company                                         = LocalFromCompany
                                                invoked.InventoryLocation                               = LocalFromLocation
                                                invoked.InventoryUDIDetail.InventoryTransactionType     = WarehouseShipmentRel.DemandDocumentType
                                                invoked.InventoryUDIDetail.TransactionSystemCode        = WarehouseShipmentRel.WarehouseDemand.DemandSystemCode
                                                invoked.InventoryUDIDetail.DocumentNumberNumeric        = WarehouseShipmentRel.WarehouseDemand.DemandDocument
                                                invoked.InventoryUDIDetail.WarehouseShipment            = LocalWarehouseShipment
                                                invoked.InventoryUDIDetail.LineNumber                   = LocalWarehouseShipmentLine
                                                invoked.Item                                            = WarehouseShipmentLineRel.Item
                                                invoked.SourceDocumentAlpha                             = WarehouseShipmentRel.WarehouseDemand.DemandDocument
                                                invoked.GTIN                                            = LocalGTIN
                                                invoked.ManufacturingDate                               = LocalManufacturingDate
                                                invoked.ExpirationDate                                  = LocalExpiryDate
                                                invoked.Bin                                             = LocalBin
                                                invoked.Lot                                             = LocalLot
                                                invoked.SerialNumber                                    = LocalSerial
                                                invoked.UOM                                             = LocalPickedDetailUOM
                                                invoked.Quantity                                        = LocalPickedDetailQuantity
                                                invoked.TransientTrackingNumber                         = LocalTrackingNumber
                                            
                                        else
                                        if (WarehouseShipmentLineRel.IsDetailRequired)
                                            invoke Create WarehouseShipmentLineDetail
                                                invoked.Company                                         = LocalFromCompany
                                                invoked.InventoryLocation                               = LocalFromLocation
                                                invoked.WarehouseShipment                               = LocalWarehouseShipment
                                                invoked.WarehouseShipmentLine                           = LocalWarehouseShipmentLine
                                                invoked.WarehouseShipmentLineDetail.Bin                 = LocalBin
                                                invoked.WarehouseShipmentLineDetail.Lot                 = LocalLot
                                                invoked.WarehouseShipmentLineDetail.Sublot              = LocalSublot
                                                invoked.WarehouseShipmentLineDetail.Serial              = LocalSerial
                                                invoked.WarehouseShipmentLineDetail.UnitOfMeasure       = LocalPickedDetailUOM
                                                invoked.Quantity                                        = LocalPickedDetailQuantity
                                                invoked.TransientTrackingNumber                         = LocalTrackingNumber
                                                
                                        else                                                    
                                            invoke Create MobileSupplyChainShipmentDetailTracking
                                                invoked.Company                                         = LocalFromCompany
                                                invoked.InventoryLocation                               = LocalFromLocation
                                                invoked.WarehouseShipment                               = LocalWarehouseShipment
                                                invoked.WarehouseShipmentLine                           = LocalWarehouseShipmentLine
                                                invoked.TrackingNumber                                  = LocalTrackingNumber
                                                invoked.Quantity                                        = LocalPickedDetailQuantity
                                                invoked.UnitOfMeasure                                   = LocalPickedDetailUOM

                                        LocalShipmentDetailCounter += 1
                                else
                                    if (WarehouseShipmentLineRel.IsUDITracked)
                                        invoke Delete WarehouseShipmentLineRel.InventoryUDIDetailsRel
                                        invoke SystemDelete WarehouseShipmentLineRel.WarehouseShipmentLineDetailRel
                                    
                                    else
                                    if (WarehouseShipmentLineDetailRel exists)
                                        invoke Delete WarehouseShipmentLineRel.WarehouseShipmentLineDetailRel
                                    
                                    invoke Delete WarehouseShipmentLineRel.MobileSupplyChainShipmentDetailTrackingRel
                                
                                LocalShipmentLineCounter += 1
                        
                        if (LocalIsRelease)
                            invoke ReleaseAndPrint WarehouseShipmentLine
                                invoked.PrmCompany                  = LocalFromCompany
                                invoked.PrmInventoryLocation        = LocalFromLocation
                                invoked.PrmWarehouseShipment		= LocalWarehouseShipment

                        LocalShipmentCounter += 1
            
            Exit Rules
                Status = Status.UploadComplete

        CreateInventoryReplenishment is an Instance Action
            restricted
            Local Fields
                LocalTimeSubmitted                              is TimeStamp
                LocalInventoryReplenishmentSize                 is Numeric size 6
                LocalInventoryReplenishmentCounter              is Numeric size 6

                LocalQuantity                                   is like Quantity
                LocalTimeStarted                                is TimeStamp
                LocalTimestamp                                  is TimeStamp
                LocalInventoryReplenishmentLineSize             is Numeric size 6
                LocalInventoryReplenishmentLineCounter          is Numeric size 6
                LocalTransactionUOM                             is like UnitOfMeasure

            Action Rules
                Status  = Status.InProgress

                LocalFromCompany                    = XML select "/InventoryReplenishmentTransactions/Company"
                LocalTimeStarted                    = XML select "/InventoryReplenishmentTransactions/TimeStarted"
                LocalTimeSubmitted                  = XML select "/InventoryReplenishmentTransactions/TimeSubmitted"
                LocalInventoryReplenishmentSize     = XML select "count (/InventoryReplenishmentTransactions/InventoryReplenishment/InventoryReplenishmentList/Location)"

                if (LocalInventoryReplenishmentSize >= 1)
                    LocalInventoryReplenishmentCounter = 1

                    while (LocalInventoryReplenishmentCounter <= LocalInventoryReplenishmentSize) 
                        LocalFromLocation                       = XML select "/InventoryReplenishmentTransactions/InventoryReplenishment/InventoryReplenishmentList[<LocalInventoryReplenishmentCounter>]/Location"
                        LocalInventoryReplenishmentLineSize     = XML select "count (/InventoryReplenishmentTransactions/InventoryReplenishment/InventoryReplenishmentList[<LocalInventoryReplenishmentCounter>]/Line)"

                        invoke Create MobileSupplyChainInventoryReplenishment
                            resume on error
                                ErrorOccured        = true
                                ErrorMessage        = error message
                            assign result to MobileSupplyChainInventoryReplenishmentView
                            invoked.Company                     = LocalFromCompany
                            invoked.InventoryLocation           = LocalFromLocation
                            invoked.Status                      = MobileSupplyChainInventoryReplenishment.Status.InProgress
                            invoked.TimeSubmitted               = LocalTimeSubmitted
                            invoked.TimeStarted                 = LocalTimeStarted
                            invoked.Notes                       = ErrorMessage

                        LocalMobileSupplyChainInventoryReplenishment = MobileSupplyChainInventoryReplenishmentView.MobileSupplyChainInventoryReplenishment

                        if (not ErrorOccured)
                            LocalInventoryReplenishmentLineCounter = 1

                            while (LocalInventoryReplenishmentLineCounter <= LocalInventoryReplenishmentLineSize)
                                LocalItem                   = XML select "/InventoryReplenishmentTransactions/InventoryReplenishment/InventoryReplenishmentList[<LocalInventoryReplenishmentCounter>]/Line[<LocalInventoryReplenishmentLineCounter>]/Item"
                                LocalQuantity               = XML select "/InventoryReplenishmentTransactions/InventoryReplenishment/InventoryReplenishmentList[<LocalInventoryReplenishmentCounter>]/Line[<LocalInventoryReplenishmentLineCounter>]/Quantity"
                                LocalTransactionUOM         = ItemLocationRel.DerivedDefaultTransactionUOM

                                invoke Create MobileSupplyChainInventoryReplenishmentLine
                                    resume on error
                                        ErrorOccured        = true
                                        ErrorMessage        = error message
                                    invoked.Company                                             = LocalFromCompany
                                    invoked.InventoryLocation                                   = LocalFromLocation
                                    invoked.MobileSupplyChainInventoryReplenishment             = LocalMobileSupplyChainInventoryReplenishment
                                    invoked.MobileSupplyChainInventoryReplenishmentLine         = LocalInventoryReplenishmentLineCounter
                                    invoked.Item                                                = LocalItem
                                    invoked.Quantity                                            = LocalQuantity
                                    invoked.TransactionUOM                                      = LocalTransactionUOM
                                    invoked.Notes                                               = ErrorMessage

                                LocalInventoryReplenishmentLineCounter += 1

                        invoke ProcessInventoryReplenishment MobileSupplyChainInventoryReplenishmentRel
                        LocalInventoryReplenishmentCounter += 1

            Exit Rules
                Status = Status.UploadComplete

        CreatePurchaseOrderReceipt is an Instance Action
            restricted
            Local Fields

                LocalReportPrinter                           is like MobileSupplyChainPrinter
                LocalLabelPrinter                            is like MobileSupplyChainPrinter
                LocalPurchaseOrderCompany                    is a PurchasingCompany
                LocalPurchaseOrder                           is like PurchaseOrder
                LocalShipToLocation                          is like MobileSupplyChainLocation
                LocalTimeStarted                             is TimeStamp
                LocalTimeSubmitted                           is TimeStamp
                LocalCarrier                                 is like MobileSupplyChainVendor
                LocalCarrierTrackingNumber                   is like TrackingNumber
                LocalBillOfLading                            is like BillOfLading
                LocalReferenceNumber                         is like ReferenceNumber
                LocalReleaseFlag                             is Boolean


                LocalPurchaseOrderLine                       is like PurchaseOrderLine
                LocalLineCount                               is Numeric size 4
                LocalLineCounter                             is Numeric size 4
                LocalReceivedQuantity                        is like Quantity
                LocalReceivingCompany                        is like PurchasingCompany
                LocalReceivingLocation                       is like MobileSupplyChainLocation
                LocalReceivedUOM                             is like UnitOfMeasure
                LocalCancelBackorder                         is Boolean
                LocalInspectionRequired                      is Boolean
                LocalMSDSRequired                            is Boolean
                LocalMSDSVersion                             is like MSDSVersion
                LocalMSDSDocument                            is like MSDSDocument                
                LocalItem                                    is an Item
                LocalCatchWeightQuantity                     is like Quantity 
                LocalTemperatureScale                        is like TemperatureScale
                LocalAcceptedQuantity                        is like Quantity
                LocalRejectedQuantity                        is like Quantity
                LocalStorageType                             is like TemperatureControlledStorageType
                LocalPackageCondition                        is like PackageCondition
                LocalTemperature                             is Numeric size 3
                LocalTemperatureExpirationDate               is Date
                LocalImageCount                              is Numeric size 4
                LocalImageCounter                            is Numeric size 4
                LocalImage                                   is BinaryDocument
                LocalCommentText                             is like CommentText


                LocalLineDetailSequence                      is like SequenceNumber
                LocalLineDetailBin                           is like Bin
                LocalLineDetailLot                           is like ItemLot
                LocalLineDetailSublot                        is like Sublot
                LocalLineDetailSerial                        is like ItemSerialNumber
                LocalTrackingNumber                          is like TrackingNumber
                LocalLineDetailReceivedQuantity              is like Quantity
                LocalLineDetailHold                          is Boolean   
                LocalLineDetailCount                         is Numeric size 4
                LocalLineDetailCounter                       is Numeric size 4
                LocalLineDetailLotExpirationDate             is Date
                LocalLineDetailManufacturingDate             is Date
                LocalGTIN                                    is like ItemGTIN
                LocalUDIExpirationDate                       is Date
                LocalUDIManufacturingDate                    is Date
                LocalCatchWeightMultiplier                   is like Quantity
                LocalCatchWeightSum                          is like Quantity
                LocalDetailCatchWeight                       is like Quantity
                LocalShelfLife                               is Numeric size 4

                LocalLineXML                                 is XMLDocument
                LocalLineDetailXML                           is XMLDocument
                LocalInspectionImageXML                      is XMLDocument
            Action Rules
                Status                             = Status.InProgress

                LocalPurchaseOrderReceiptCompany   = XML select "/PurchaseOrderReceivingTransaction/PurchaseOrderDetails/PurchaseOrderCompany"
                LocalPurchaseOrder                 = XML select "/PurchaseOrderReceivingTransaction/PurchaseOrderDetails/PurchaseOrderNumber"
                LocalShipToLocation                = XML select "/PurchaseOrderReceivingTransaction/PurchaseOrderDetails/ShipToLocation"
                LocalReportPrinter                 = XML select "/PurchaseOrderReceivingTransaction/Printer/Report"
                LocalLabelPrinter                  = XML select "/PurchaseOrderReceivingTransaction/Printer/Label"
                LocalTimeStarted                   = XML select "/PurchaseOrderReceivingTransaction/PurchaseOrderDetails/TimeStarted"
                LocalTimeSubmitted                 = XML select "/PurchaseOrderReceivingTransaction/PurchaseOrderDetails/TimeSubmitted"
                LocalCarrier                       = XML select "/PurchaseOrderReceivingTransaction/PurchaseOrderDetails/Carrier"
                LocalCarrierTrackingNumber         = XML select "/PurchaseOrderReceivingTransaction/PurchaseOrderDetails/CarrierTrackingNumber"
                LocalBillOfLading                  = XML select "/PurchaseOrderReceivingTransaction/PurchaseOrderDetails/BillOfLading"
                LocalReferenceNumber               = XML select "/PurchaseOrderReceivingTransaction/PurchaseOrderDetails/ReferenceNumber"
                LocalReleaseFlag                   = XML select "/PurchaseOrderReceivingTransaction/PurchaseOrderDetails/Release"
                LocalPurchaseOrderReceipt          = XML select "/PurchaseOrderReceivingTransaction/PurchaseOrderDetails/PurchaseOrderReceipt"
                LocalTimeStarted                   = XML select "/PurchaseOrderReceivingTransaction/PurchaseOrderDetails/TimeStarted"
                LocalLineCount                     = XML select "count (/PurchaseOrderReceivingTransaction/PurchaseOrderDetails/PurchaseOrderLine/Line)"

                invoke Create MobileSupplyChainPurchaseOrderReceipt
                    assign result to MobileSupplyChainPurchaseOrderReceiptView
                    invoked.Company                  = LocalPurchaseOrderReceiptCompany
                    invoked.PurchaseOrder            = LocalPurchaseOrder
                    invoked.ShipToLocation           = LocalShipToLocation
                    invoked.PurchaseOrderLocation    = LocalShipToLocation
                    invoked.Carrier                  = LocalCarrier
                    invoked.CarrierTrackingNumber    = LocalCarrierTrackingNumber
                    invoked.BillOfLading             = LocalBillOfLading
                    invoked.ReferenceNumber          = LocalReferenceNumber
                    invoked.TimeStarted              = LocalTimeStarted
                    invoked.TimeSubmitted            = LocalTimeSubmitted
                    invoked.LabelPrinter             = LocalLabelPrinter
                    invoked.ReportPrinter            = LocalReportPrinter
                    invoked.PurchaseOrderReceipt     = LocalPurchaseOrderReceipt
                    invoked.MobileSupplyChainUpload  = MobileSupplyChainUpload

                LocalMobileSupplyChainPurchaseOrderReceipt = MobileSupplyChainPurchaseOrderReceiptView.MobileSupplyChainPurchaseOrderReceipt

                if (PurchaseOrderReceiptRel.PurchaseOrderReceiptLinesRel exists)
                    invoke Delete PurchaseOrderReceiptRel.POReceiptLineTemplate set

                LocalLineCounter = 1

                if (LocalLineCounter >= 1)
                    while (LocalLineCounter <= LocalLineCount)
                        LocalLineXML                   = XML select "/PurchaseOrderReceivingTransaction/PurchaseOrderDetails/PurchaseOrderLine/Line[<LocalLineCounter>]"
                        LocalPurchaseOrderLine         = LocalLineXML select "/Line/PurchaseOrderLineNumber"                      
                        LocalItem                      = LocalLineXML select "/Line/Item" 
                        LocalReceivedQuantity          = LocalLineXML select "/Line/ReceivedQuantity"
                        LocalCatchWeightQuantity       = LocalLineXML select "/Line/CatchWeight"
                        LocalReceivedUOM               = LocalLineXML select "/Line/Uom"
                        LocalCancelBackorder           = LocalLineXML select "/Line/CancelBackorder"
                        LocalInspectionRequired        = LocalLineXML select "/Line/InspectionRequired"
                        LocalMSDSRequired              = LocalLineXML select "/Line/MSDSRequired"
                        LocalMSDSVersion               = LocalLineXML select "/Line/MSDSVersion"
                        LocalMSDSDocument              = LocalLineXML select "/Line/MSDSDocument"
                        LocalReceivingCompany          = LocalLineXML select "/Line/ReceivingCompany"
                        LocalReceivingLocation         = LocalLineXML select "/Line/ReceivingLocation"
                        LocalTemperatureScale          = LocalLineXML select "/Line/InspectionDetails/TemperatureScale"  
                        LocalAcceptedQuantity          = LocalLineXML select "/Line/InspectionDetails/AcceptedQuantity"    
                        LocalRejectedQuantity          = LocalLineXML select "/Line/InspectionDetails/RejectedQuantity"   
                        LocalStorageType               = LocalLineXML select "/Line/InspectionDetails/StorageType"   
                        LocalPackageCondition          = LocalLineXML select "/Line/InspectionDetails/PackageCondition"   
                        LocalTemperature               = LocalLineXML select "/Line/InspectionDetails/Temperature"   
                        LocalTemperatureExpirationDate = LocalLineXML select "/Line/InspectionDetails/TemperatureExpirationDate"
                        LocalCommentText               = LocalLineXML select "/Line/InspectionDetails/Comment"
                        LocalInspectionImageXML        = LocalLineXML select "/Line/Image"     
                        LocalLineDetailCount           = LocalLineXML select "count (/Line/Detail)"
                        LocalImageCount                = LocalLineXML select "count (/Line/Image/Data)"

                        invoke Create MobileSupplyChainPurchaseOrderReceiptLine
                            assign result to MobileSupplyChainPurchaseOrderReceiptLineView
                            invoked.MobileSupplyChainPurchaseOrderReceipt = LocalMobileSupplyChainPurchaseOrderReceipt
                            invoked.PurchaseOrderReceiptLine              = LocalPurchaseOrderLine                           
                            invoked.Company                               = LocalReceivingCompany
                            invoked.ShipToLocation                        = LocalReceivingLocation
                            invoked.PurchaseOrderLine                     = LocalPurchaseOrderLine
                            invoked.EnteredReceivedQuantity               = LocalReceivedQuantity
                            invoked.CatchWeightQuantity                   = LocalCatchWeightQuantity
                            invoked.ReceivedUOM                           = LocalReceivedUOM
                            invoked.CancelBackorder                       = LocalCancelBackorder
                            invoked.InspectionRequired                    = LocalInspectionRequired
                            invoked.MSDSRequired                          = LocalMSDSRequired
                            invoked.MSDSVersion                           = LocalMSDSVersion
                            invoked.MSDSDocument                          = LocalMSDSDocument
                            invoked.Item                                  = LocalItem
                            invoked.TemperatureScale                      = LocalTemperatureScale
                            invoked.Temperature                           = LocalTemperature
                            invoked.AcceptedQuantity                      = LocalAcceptedQuantity
                            invoked.RejectedQuantity                      = LocalRejectedQuantity
                            invoked.StorageType                           = LocalStorageType
                            invoked.PackageCondition                      = LocalPackageCondition
                            invoked.TemperatureExpirationDate             = LocalTemperatureExpirationDate
                            invoked.CommentText                           = LocalCommentText
                            if (LocalInspectionImageXML entered)
                                invoked.InspectionImageXML                    = LocalInspectionImageXML

                        LocalMobileSupplyChainPurchaseOrderReceiptLine = MobileSupplyChainPurchaseOrderReceiptLineView.MobileSupplyChainPurchaseOrderReceiptLine
                        LocalLineDetailCounter = 1
                        
                        if (LocalLineDetailCount >= 1)
                            
                            initialize LocalCatchWeightMultiplier
                            initialize LocalCatchWeightSum
                            initialize LocalDetailCatchWeight
                            initialize LocalPONumber
                            initialize LocalLineNumber
                            
                            LocalPONumber   = LocalPurchaseOrder
                            LocalLineNumber = LocalPurchaseOrderLine

                            LocalCatchWeightMultiplier = LocalCatchWeightQuantity / LocalReceivedQuantity

                            while (LocalLineDetailCounter <= LocalLineDetailCount)
                                LocalLineDetailXML               = LocalLineXML select "/Line/Detail[<LocalLineDetailCounter>]"
                                LocalLineDetailSequence          = LocalLineDetailXML select "/Detail/Sequence"                                    
                                LocalLineDetailReceivedQuantity  = LocalLineDetailXML select "/Detail/ReceivedQuantity"
                                LocalTrackingNumber              = LocalLineDetailXML select "/Detail/TrackingNumber"
                                LocalLineDetailBin               = LocalLineDetailXML select "/Detail/Bin"
                                LocalLineDetailLot               = LocalLineDetailXML select "/Detail/Lot"
                                LocalLineDetailSublot            = LocalLineDetailXML select "/Detail/Sublot"
                                LocalLineDetailSerial            = LocalLineDetailXML select "/Detail/Serial"
                                LocalLineDetailHold              = LocalLineDetailXML select "/Detail/Hold"
                                LocalLineDetailLotExpirationDate = LocalLineDetailXML select "/Detail/ExpirationDate"
                                LocalLineDetailManufacturingDate = LocalLineDetailXML select "/Detail/LotManufacturingDate"
                                LocalShelfLife                   = LocalLineDetailXML select "/Detail/ShelfLife"
                                LocalGTIN                        = LocalLineDetailXML select "/Detail/UdiGtin"
                                LocalUDIExpirationDate           = LocalLineDetailXML select "/Detail/UdiExpirationDate"
                                LocalUDIManufacturingDate        = LocalLineDetailXML select "/Detail/ManufacturingDate"

                                if (LocalCatchWeightQuantity entered)
                                    if (LocalLineDetailCounter = LocalLineDetailCount)
                                        LocalDetailCatchWeight           = LocalCatchWeightQuantity - LocalCatchWeightSum
                                        round LocalDetailCatchWeight to nearest DerivedRoundTo
                                    else
                                        LocalDetailCatchWeight           = LocalCatchWeightMultiplier * LocalLineDetailReceivedQuantity
                                        round LocalDetailCatchWeight to nearest DerivedRoundTo
                                        LocalCatchWeightSum              += LocalDetailCatchWeight

                                invoke Create MobileSupplyChainPurchaseOrderReceiptLineDetail
                                    invoked.MobileSupplyChainPurchaseOrderReceipt                          = LocalMobileSupplyChainPurchaseOrderReceipt
                                    invoked.MobileSupplyChainPurchaseOrderReceiptLine                      = LocalMobileSupplyChainPurchaseOrderReceiptLine
                                    invoked.Company                                                        = LocalPurchaseOrderReceiptCompany
                                    invoked.Quantity                                                       = LocalLineDetailReceivedQuantity
                                    invoked.Lot                                                            = LocalLineDetailLot
                                    invoked.Sublot                                                         = LocalLineDetailSublot
                                    invoked.Serial                                                         = LocalLineDetailSerial
                                    invoked.Bin                                                            = LocalLineDetailBin
                                    invoked.LotExpirationDate                                              = LocalLineDetailLotExpirationDate
                                    invoked.ManufacturingDate                                              = LocalLineDetailManufacturingDate
                                    invoked.ShelfLife                                                      = LocalShelfLife
                                    invoked.Item                                                           = LocalItem
                                    invoked.GTIN                                                           = LocalGTIN
                                    invoked.UDIExpirationDate                                              = LocalUDIExpirationDate
                                    invoked.UDIManufacturingDate                                           = LocalUDIManufacturingDate
                                    invoked.TrackingNumber                                                 = LocalTrackingNumber
                                    invoked.SequenceNumber                                                 = LocalLineDetailSequence      
                                    invoked.CatchWeight                                                    = LocalDetailCatchWeight 

                                LocalLineDetailCounter += 1

                        LocalLineCounter += 1

                if (LocalReleaseFlag 
                and MobileSupplyChainPurchaseOrderReceiptRel.ErrorMessage not entered)
                    invoke ReleaseReceipt MobileSupplyChainPurchaseOrderReceiptRel

            Exit Rules
                Status = Status.UploadComplete

        CreateReceivingTransfer is an Instance Action
            restricted
            Local Fields
                LocalReportPrinter              is a MobileSupplyChainPrinter
                LocalTransactionCount           is Numeric size 6
                LocalTransactionSize            is Numeric size 6
                LocalTimeSubmitted              is TimeStamp
                LocalTimeStarted                is TimeStamp
                LocalLineSize                   is Numeric size 6
                LocalLineCount                  is Numeric size 6
                LocalDetailSize                 is Numeric size 6
                LocalDetailCount                is Numeric size 6
                LocalLineQuantity               is like Quantity
                LocalTransactionUOM             is like UnitOfMeasure
                LocalIsRelease                  is Boolean
                LocalBin                        is like Bin
                LocalSerial                     is like ItemSerialNumber
                LocalLot                        is like ItemLot
                LocalDetailQuantity             is like Quantity
                LocalUdiGtin                    is like ItemGTIN
                LocalManufacturingDate          is Date
                LocalLotExpirationDate          is Date

            Action Rules
                Status = Status.InProgress

                LocalReportPrinter      = XML select "/InventoryReceivingTransferTransaction/Printer/Report"
                LocalTimeSubmitted      = XML select "/InventoryReceivingTransferTransaction/TimeSubmitted"
                LocalTransactionSize   = XML select "count(/InventoryReceivingTransferTransaction/TransactionList/Transaction)"

                if (LocalTransactionSize >= 1)
                    LocalTransactionCount = 1

                    while (LocalTransactionCount <= LocalTransactionSize)
                        LocalTimeStarted        = XML select "/InventoryReceivingTransferTransaction/TransactionList/Transaction[<LocalTransactionCount>]/TimeStarted"
                        LocalTransferReceipt    = XML select "/InventoryReceivingTransferTransaction/TransactionList/Transaction[<LocalTransactionCount>]/TransferReceipt"
                        LocalIsRelease          = XML select "/InventoryReceivingTransferTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Release"
                        LocalFromLocation       = XML select "/InventoryReceivingTransferTransaction/TransactionList/Transaction[<LocalTransactionCount>]/InventoryLocation"
                        LocalFromCompany        = XML select "/InventoryReceivingTransferTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Company"
                        
                        invoke Create MobileSupplyChainInventoryTransaction
                            assign result to MobileSupplyChainInventoryTransactionView
                            invoked.Company                                 = LocalFromCompany
                            invoked.InventoryLocation                       = LocalFromLocation
                            invoked.InventoryDocumentType                   = InventoryDocumentType.ReceivingTransfer
                            invoked.TimeSubmitted                           = LocalTimeSubmitted
                            invoked.TimeStarted                             = LocalTimeStarted
                            invoked.MobileSupplyChainPrinter                = LocalReportPrinter
                            invoked.OriginatingIntransitRec                 = LocalTransferReceipt
                            invoked.FromToCompanyLocation                   = InventoryIntransitReceivingRel.FromToCompanyLocation
                            invoked.IsRelease                               = LocalIsRelease
                            if (not LocalIsRelease)
                                invoked.IsPendingTransferReceipt            = true

                        LocalMobileSupplyChainInventoryTransaction  = MobileSupplyChainInventoryTransactionView.MobileSupplyChainInventoryTransaction
    
                        invoke UpdateLinesToMultipleBins MobileSupplyChainInventoryTransactionRel
                    
                        LocalLineSize = XML select "count (/InventoryReceivingTransferTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line)"

                        if (LocalLineSize >= 1)
                            LocalLineCount = 1

                            while (LocalLineCount <= LocalLineSize)
                                LocalItem               = XML select "/InventoryReceivingTransferTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/Item"
                                LocalLineQuantity       = XML select "/InventoryReceivingTransferTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/ReceivedQuantity"
                                LocalTransactionUOM     = XML select "/InventoryReceivingTransferTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/Uom"
                                LocalLineNumber         = XML select "/InventoryReceivingTransferTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/LineNumber"
                        
                                invoke Create MobileSupplyChainInventoryTransactionLine
                                    assign result to MobileSupplyChainInventoryTransactionLineView
                                    invoked.MobileSupplyChainInventoryTransaction           = LocalMobileSupplyChainInventoryTransaction
                                    invoked.MobileSupplyChainInventoryTransactionLine       = LocalLineNumber
                                    invoked.Company                                         = LocalFromCompany
                                    invoked.InventoryLocation                               = LocalFromLocation
                                    invoked.Item                                            = LocalItem
                                    invoked.Quantity                                        = LocalLineQuantity
                                    invoked.TransactionUOM                                  = LocalTransactionUOM
                                    invoked.MobileSupplyChainUpload                         = MobileSupplyChainUpload

                                LocalMobileSupplyChainInventoryTransactionLine = MSCMInventoryTransactionLineRel.MobileSupplyChainInventoryTransactionLine
                                LocalDetailSize                                = XML select "count (/InventoryReceivingTransferTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/Detail)"
                                
                                if (ItemLocationRel.BinTracked
                                and ItemLocationRel.IsNotLotTracked
                                and ItemLocationRel.IsNotSerialTracked)
                                    invoke DeleteReceivingLineDetails MSCMInventoryTransactionLineRel

                                if (LocalDetailSize >= 1)
                                    LocalDetailCount = 1

                                    while (LocalDetailCount <= LocalDetailSize)
                                        LocalDetailSequence             = XML select "/InventoryReceivingTransferTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/Detail[<LocalDetailCount>]/Sequence"
                                        LocalDetailQuantity             = XML select "/InventoryReceivingTransferTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/Detail[<LocalDetailCount>]/Quantity"
                                        LocalBin                        = XML select "/InventoryReceivingTransferTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/Detail[<LocalDetailCount>]/Bin"
                                        LocalLot                        = XML select "/InventoryReceivingTransferTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/Detail[<LocalDetailCount>]/Lot"
                                        LocalSerial                     = XML select "/InventoryReceivingTransferTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/Detail[<LocalDetailCount>]/Serial"
                                        LocalUdiGtin                    = XML select "/InventoryReceivingTransferTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/Detail[<LocalDetailCount>]/UdiGtin"
                                        LocalManufacturingDate          = XML select "/InventoryReceivingTransferTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/Detail[<LocalDetailCount>]/ManufacturingDate"
                                        LocalLotExpirationDate          = XML select "/InventoryReceivingTransferTransaction/TransactionList/Transaction[<LocalTransactionCount>]/Line[<LocalLineCount>]/Detail[<LocalDetailCount>]/ExpiryDate"
                                        
                                        invoke Create MobileSupplyChainInventoryTransactionLineDetail
                                            assign result to MobileSupplyChainInventoryTransactionLineDetailView
                                            invoked.MobileSupplyChainInventoryTransaction                   = LocalMobileSupplyChainInventoryTransaction
                                            invoked.MobileSupplyChainInventoryTransactionLine               = LocalMobileSupplyChainInventoryTransactionLine
                                            invoked.MobileSupplyChainInventoryTransactionLineDetail         = LocalDetailCount
                                            invoked.Company                                                 = LocalFromCompany
                                            invoked.InventoryLocation                                       = LocalFromLocation
                                            invoked.Item                                                    = LocalItem
                                            invoked.Quantity                                                = LocalDetailQuantity
                                            invoked.UnitOfMeasure                                           = LocalTransactionUOM
                                            invoked.Bin                                                     = LocalBin
                                            invoked.Lot                                                     = LocalLot
                                            invoked.Serial                                                  = LocalSerial
                                            invoked.GTIN                                                    = LocalUdiGtin
                                            invoked.UDIManufacturingDate                                    = LocalManufacturingDate
                                            invoked.UDIExpirationDate                                       = LocalLotExpirationDate

                                        LocalDetailCount += 1
                                LocalLineCount += 1
                        LocalTransactionCount += 1

  
                invoke ProcessTransaction MobileSupplyChainInventoryTransactionLine
                    invoked.PrmMobileSupplyChainUpload  = MobileSupplyChainUpload

            Exit Rules
                Status = Status.UploadComplete

        CreateDeliveryEvent is an Instance Action
            restricted
            Local Fields
                LocalEventCounter           is Numeric size 6
                LocalEventSize              is Numeric size 6
                LocalEventDetailCounter     is Numeric size 6
                LocalEventDetailSize        is Numeric size 6
                LocalDeliveryNoteCode       is a DeliveryNoteCode
                LocalDeliveryNote           is a DeliveryNote
                LocalUnitCounter            is Numeric size 6
                LocalUnitSize               is Numeric size 6
                LocalLineCounter            is Numeric size 6
                LocalLineSize               is Numeric size 6
                LocalEventXML               is XMLDocument
                LocalEventDetailXML         is XMLDocument
                LocalUnitXML                is XMLDocument
                LocalLineXML                is XMLDocument
                LocalCommitCounter          is Numeric size 6
                LocalSkipUpdateStatus       is Boolean
                LocalDeliverByUnit          is Boolean
                LocalEventAttachmentXML     is XMLDocument
            Action Rules
                invoke Update
                    invoked.Status = Status.InProgress

                LocalEventSize = XML select "count (/DeliveryTransaction/Events/Event)"

                if (LocalEventSize >= 1)
                    LocalEventCounter = 1

                    while (LocalEventCounter <= LocalEventSize)
                        initialize LocalFirstName
                        initialize LocalLastName
                        initialize LocalEmployeeID
                        initialize LocalSignature
                        initialize LocalPackageCount
                        initialize LocalEventAttachmentXML

                        LocalEventXML               = XML select "/DeliveryTransaction/Events/Event[<LocalEventCounter>]"
                        LocalEventCompany           = LocalEventXML select "/Event/EventCompany"
                        LocalEventLocation          = LocalEventXML select "/Event/EventLocation"
                        LocalPerformedAction        = LocalEventXML select "/Event/Action"
                        LocalTimeStarted            = LocalEventXML select "/Event/TimeStarted"
                        LocalTimeSubmitted          = LocalEventXML select "/Event/TimeSubmitted"
                        LocalFirstName              = LocalEventXML select "/Event/FirstName"
                        LocalLastName               = LocalEventXML select "/Event/LastName"
                        LocalEmployeeID             = LocalEventXML select "/Event/Employee"
                        LocalSignature              = LocalEventXML select "/Event/Signature"
                        LocalPackageCount           = LocalEventXML select "/Event/PackageCount"
                        LocalEventDetailSize        = LocalEventXML select "count (/Event/EventDetails/EventDetail)"
                        LocalEventAttachmentXML     = LocalEventXML select "/Event/Images"

                        if (LocalEventDetailSize >= 1)
                            LocalEventDetailCounter = 1

                            while (LocalEventDetailCounter <= LocalEventDetailSize)
                                initialize LocalMobileSupplyChainDeliveryEvent

                                LocalEventDetailXML                         = LocalEventXML select "/Event/EventDetails/EventDetail[<LocalEventDetailCounter>]"
                                LocalDeliveryCompany                        = LocalEventDetailXML select "/EventDetail/DeliveryCompany"
                                LocalDeliveryLocation                       = LocalEventDetailXML select "/EventDetail/DeliveryLocation"
                                LocalMobileSupplyChainDeliveryTicket        = LocalEventDetailXML select "/EventDetail/DeliveryTicket"

                                LocalUnitSize                               = LocalEventDetailXML select "count (/EventDetail/Units/Unit)"

                                if (LocalUnitSize >= 1)
                                    LocalUnitCounter = 1

                                    while (LocalUnitCounter <= LocalUnitSize)
                                        initialize LocalDeliveryNoteCode
                                        initialize LocalDeliveryNote

                                        LocalUnitXML                            = LocalEventDetailXML select "/EventDetail/Units/Unit[<LocalUnitCounter>]"
                                        LocalMobileSupplyChainDeliveryUnit      = LocalUnitXML select "/Unit/DeliveryUnit"
                                        LocalDeliverByUnit                      = LocalUnitXML select "/Unit/DeliverByUnit"
                                        LocalLineSize                           = LocalUnitXML select "/Unit/LineCount"
                                        LocalDeliveryNoteCode                   = LocalUnitXML select "/Unit/DeliveryNoteCode"
                                        LocalDeliveryNote                       = LocalUnitXML select "/Unit/DeliveryNote"

                                        if (not MobileSupplyChainDeliveryUnitRel.Status.Delivered)
                                            
                                            if (LocalDeliverByUnit)
                                                include CreateEvent

                                                invoke CreateEventLinesByUnit MobileSupplyChainDeliveryUnitRel
                                                    invoked.PrmMobileSupplyChainDeliveryEvent   = LocalMobileSupplyChainDeliveryEvent
                                                    invoked.PrmDeliveryNoteCode                 = LocalDeliveryNoteCode
                                                    invoked.PrmDeliveryNote                     = LocalDeliveryNote

                                            else
                                                LocalLineCounter = 1

                                                while (LocalLineCounter <= LocalLineSize)
                                                    initialize LocalDeliveryNoteCode
                                                    initialize LocalDeliveryNote

                                                    LocalLineXML                            = LocalUnitXML select "/Unit/Lines/Line[<LocalLineCounter>]"
                                                    LocalMobileSupplyChainDeliveryLine      = LocalLineXML select "/Line/DeliveryLine"
                                                    LocalDeliveryNoteCode                   = LocalLineXML select "/Line/DeliveryNoteCode"
                                                    LocalDeliveryNote                       = LocalLineXML select "/Line/DeliveryNote"

                                                    if (not MobileSupplyChainDeliveryLineRel.IsDelivered)
                                                        include CreateEvent
                                                        
                                                        invoke CreateEventLine MobileSupplyChainDeliveryLineRel
                                                            invoked.PrmMobileSupplyChainDeliveryEvent = LocalMobileSupplyChainDeliveryEvent
                                                            invoked.PrmDeliveryNoteCode = LocalDeliveryNoteCode
                                                            invoked.PrmDeliveryNote     = LocalDeliveryNote

                                                    LocalLineCounter += 1

                                            invoke UpdateStatus MobileSupplyChainDeliveryUnitRel
                                        LocalUnitCounter += 1

                                    invoke UpdateStatus MobileSupplyChainDeliveryTicketRel
                                LocalEventDetailCounter += 1

                            
                        LocalCommitCounter +=1

                        if (LocalCommitCounter >= 20)
                            commit transaction
                            initialize LocalCommitCounter

                        LocalEventCounter += 1

            Exit Rules
                Status = Status.UploadComplete
