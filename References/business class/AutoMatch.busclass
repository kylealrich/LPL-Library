AutoMatch is a BusinessTask
    owned by ma

    Parameters
    	PrmFinanceEnterpriseGroup		is a FinanceEnterpriseGroup
        PrmCompany                 		is a PayablesCompany
        PrmCompanyGroup            		is a GeneralLedgerCompanyGroup
        PrmMatchPoint              		is AlphaUpper size 1
            States
                RuleGroup1 value is "1"
                RuleGroup2 value is "2"
                RuleGroup3 value is "3"

		PrmVendorRange					is a VendorNumberRange
        PrmInvoiceProcess          		is Numeric size 1
            States
                ExcludePrepayInvoices     value is 0
                IncludePrepayInvoices     value is 1
                PrepayInvoicesOnly        value is 2
                ExcludeServiceAndDropShip value is 3
        PrmPrepaymentInvoiceMatchRule      is a MatchRule
            context of PrmFinanceEnterpriseGroup
        PrmPrepaymentDetailMatchRule       is a MatchRule
            context of PrmFinanceEnterpriseGroup
        PrmDateType                		is AlphaRight size 1
            States
                DueDate     value is "D"
                InvoiceDate value is "I"
        PrmRunDate             	    	is Date
        PrmUseSystemDate				is Boolean
        PrmDaysBeforeRunDate           	is Numeric size 3
        PrmDaysAfterRunDate            	is Numeric size 3
		PrmExcludeVendors				is a AP146VendorArray
		PrmSkipDays            	    	is Numeric 3
		PrmSkipDate                		is AlphaRight size 1
			States
				InvoiceDate 			value is "I"
				ReceiptOfInvoiceDate    value is "R"
		PrmSummarize					is Numeric 1
			States
				DoNotSummarize			value is 0
				Summarize				value is 1
		PrmSkipOnlyIfNoReceipt			is Boolean			

    Parameter Rules
    	PrmFinanceEnterpriseGroup
			default to actor.context.FinanceEnterpriseGroup
		PrmCompany
			if (PrmCompanyGroup not entered)
				required
					"CompanyOrCompanyGroupRequired"

		PrmCompanyGroup
			if (PrmCompany entered)
				cannot be entered
					"CannotEnterCompanyGroupIfCompanyEntered"

        PrmMatchPoint
        	default to PrmMatchPoint.RuleGroup1
            required
        PrmInvoiceProcess
        	initial value is 0
            default to 0
        PrmDateType
        	initial value is "D"
            default to "D"
		PrmSkipDate
			if (PrmSkipDays entered)
				required
				    "SkipDateRequiredIfSkipDaysEntered"
				    
    Actions

		AutoMatch is an Instance Action
			run in background
			Action Rules
				invoke AutoMatch PayablesInvoice
					invoked.PrmFinanceEnterpriseGroup		= PrmFinanceEnterpriseGroup
			        invoked.PrmCompany						= PrmCompany
			        invoked.PrmCompanyGroup					= PrmCompanyGroup
			        invoked.PrmMatchPoint					= PrmMatchPoint

					invoked.PrmVendorRange					= PrmVendorRange
			        invoked.PrmInvoiceProcess				= PrmInvoiceProcess
			        invoked.PrmPrepaymentInvoiceMatchRule	= PrmPrepaymentInvoiceMatchRule
        			invoked.PrmPrepaymentDetailMatchRule	= PrmPrepaymentDetailMatchRule
			        invoked.PrmDateType						= PrmDateType
			        invoked.PrmRunDate						= PrmRunDate
			        invoked.PrmUseSystemDate				= PrmUseSystemDate
			        invoked.PrmDaysBeforeRunDate			= PrmDaysBeforeRunDate
			        invoked.PrmDaysAfterRunDate				= PrmDaysAfterRunDate
			        invoked.PrmExcludeVendors				= PrmExcludeVendors
			        invoked.PrmSkipDays						= PrmSkipDays
			        invoked.PrmSkipDate						= PrmSkipDate
			        invoked.PrmSummarize					= PrmSummarize
					invoked.PrmSkipOnlyIfNoReceipt			= PrmSkipOnlyIfNoReceipt
            
