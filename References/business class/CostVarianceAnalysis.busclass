CostVarianceAnalysis is a BusinessTask
    owned by ma

    Patterns
        implements ManualTransaction
        implements StaticJava
            is report for InventoryManager, PurchasingManager, Buyer, SupplyManagementProcessor, ApplicationAdministrator, SupplyManagementViewer, Purchasing
                category is "Analysis"
                module is po
                report name is "CostVariance"
			    Description
                    View the purchase orders for a company.
                    Compare the invoice unit cost to the purchase order cost or the standard cost and report the variances.
            Reports
				CostVarianceAnalysisReport
                CostVarianceAnalysisErrorReport

    Parameters
        Company                 is a PayablesCompany
        CompanyGroup            is a GeneralLedgerCompanyGroup
        VendorGroup
        Vendor
        	context of VendorGroup
        LocationCode            is a VendorLocation
        	context of VendorGroup
        FrUpdateDate            is Date
        ToUpdateDate            is Date
        FrPoDate                is Date
        ToPoDate                is Date
        FrInvoiceDate           is Date
        ToInvoiceDate           is Date
        ReportOpt               is AlphaUpper size 1
            States
                ExcludeAoc value is "E"
                    default label is "Exclude AOC"
                IncludeAoc value is "I"
                    default label is "Include AOC"
                OnlyAoc    value is "O"
                    default label is "Only AOC"
        IncludeArchive          is AlphaUpper size 1
            States
                IncludeArchive value is "Y"
                ExcludeArchive value is "N"
        CostOption              is AlphaUpper size 1
            States
                PurchaseOrderCost value is "P"
                StandardCost      value is "S"
        BuyerGrp                is a BuyerGroup
        	context of VendorGroup
        BuyerCode               is a Buyer
        	context of VendorGroup
        Location                is an InventoryLocation
        PurchMajcl              is a MajorPurchasingClass
        	context of VendorGroup
        PurchMincl              is a MinorPurchasingClass
        	context of VendorGroup
        Item
        	context of VendorGroup
        ItemType                is a MA278ItemTypeArray
        PoCodeSelect            is AlphaUpper size 1
            States
                IncludeAllPoCodes      value is "A"
                    default label is "Include All PO Codes"
                ExcludeSelectedPoCodes value is "E"
                    default label is "Exclude Selected PO Codes"
                IncludeSelectedPoCodes value is "I"
                    default label is "Include Selected PO Codes"
        PoCode                  is a MA278PoCodeArray
        	context of VendorGroup
        ManufCodeSelect         is AlphaUpper size 1
            States
                IncludeAllManufacturers      value is "A"
                ExcludeSelectedManufacturers value is "E"
                IncludeSelectedManufacturers value is "I"
        ManufCode               is a MA278ManufCodeArray
        	context of VendorGroup
        ReportSeq               is AlphaUpper size 1
            States
                Vendor value is "1"
                Buyer  value is "2"
                Item   value is "3"
        SummaryOption           is AlphaUpper size 1
            States
                Yes value is "Y"
                No  value is "N"
        PrintVendorItem         is AlphaUpper size 1
            States
                Yes value is "Y"
                No  value is "N"
        PrintGtin               is AlphaUpper size 1
            States
                Yes value is "Y"
                No  value is "N"
        PrintUnspsc             is AlphaUpper size 1
            States
                Yes value is "Y"
                No  value is "N"
        PrintCommCode           is AlphaUpper size 1
            States
                Yes value is "Y"
                No  value is "N"
        CostVarSortOption       is AlphaUpper size 1
            States
                Yes value is "Y"
                No  value is "N"
        CostVarPct              is Numeric size 3
        

		MainSelection			is AlphaUpper size 1
        	States
        		ReceivedDate		value is "R"
        		P\ODate				value is "P"
        		InvoiceDate			value is "I"
        
        CompanySelection		is AlphaUpper size 1
        	States
        		CompanyGroup	value is "G"
        		Company 		value is "C"
        		 
        BuyerSelection			is AlphaUpper size 1
        	States
        		BuyerGroup		value is "B"
        		Buyer			value is "C"

    Parameter Rules

    	CompanySelection
    		initial value is "G"
            default to "G"
        BuyerSelection
        	initial value is "B"
            default to "B"
        MainSelection
        	initial value is "R"
            default to "R"

		VendorGroup
			default to Company.VendorGroup
			if (Vendor entered)
				required
        ReportOpt
        	initial value is "E"
            default to "E"
        IncludeArchive
        	initial value is "N"
            default to "N"
        CostOption
        	initial value is "P"
            default to "P"
        PoCodeSelect
        	required
        	initial value is "A"
        ManufCodeSelect
        	initial value is "A"
            default to "A"
        ReportSeq
        	initial value is "1"
            default to "1"
        SummaryOption
        	initial value is "Y"
            default to "Y"
        PrintVendorItem
        	initial value is "N"
            default to "N"
        PrintGtin
        	initial value is "N"
            default to "N"
        PrintUnspsc
        	initial value is "N"
            default to "N"
        PrintCommCode
        	initial value is "N"
            default to "N"
        CostVarSortOption
        	initial value is "N"
            default to "N"

    Actions
        CostVarianceAnalysis is a Set Action
            allow unlimited concurrency
