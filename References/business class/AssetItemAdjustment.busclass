AssetItemAdjustment is a BusinessClass
    owned by am
    prefix is AIA
    classic name is AMASTITADJ

    Ontology
        symbolic key is AssetItemAdjustment
            classic set name is AIASET1
            classic name for AssetAdjustment is PROCESS-SEQ
            classic name for AssetItem is SEQ-NUMBER

    Patterns
        implements ContextualParent
        implements StaticJava
        disable AuditIndex

    Persistent Fields

        ItemNumber                  is an AssetItemNumber
            classic name is ITEM-NBR
        ToItemNumber                is an AssetItemNumber
            classic name is TO-ITEM-NBR
        Description
        ToDescription               is a Description
        PurchaseDate                is Date
        ToPurchaseDate              is Date
            classic name is TO-PURCH-DATE
        ItemQuantity
        ToItemQuantity              is an ItemQuantity
            classic name is TO-IT-QUANTITY
        BaseItemCost                is an InternationalAmount
            classic name is ITEM-COST-BASE
                precision is Asset.BaseNumberOfDecimals
        ToBaseItemCost              is an InternationalAmount
            classic name is TO-IT-CST-BASE
        BaseItemTax                 is an InternationalAmount
            classic name is ITEM-TAX-BASE
                precision is Asset.BaseNumberOfDecimals
        ToBaseItemTax               is an InternationalAmount
            classic name is TO-IT-TAX-BASE
        TransactionItemCost         is an InternationalAmount
            classic name is ITEM-COST-TRAN
                precision is Asset.TransactionNumberOfDecimals
        ToTransactionItemCost       is an InternationalAmount
            classic name is TO-IT-CST-TRAN
        TransactionItemTax          is an InternationalAmount
            classic name is ITEM-TAX-TRAN
                precision is Asset.TransactionNumberOfDecimals
        ToTransactionItemTax        is an InternationalAmount
            classic name is TO-IT-TAX-TRAN
        BaseNumberOfDecimals
            classic name is BASE-ND
        TransactionNumberOfDecimals is a CurrencyNumberOfDecimals
            classic name is TRAN-ND
        PONumber
            classic name is PO-NBR
        ToPONumber                  is AlphaUpper size 14
            classic name is TO-PO-NBR
        PORelease
        ToPORelease                 is a PORelease
        POCode                      is AlphaUpper size 4
        ToPOCode                    is AlphaUpper size 4
        Vendor						is like Vendor
        ToVendor                    is like Vendor
        VendorName
        ToVendorName                is a VendorName 
        	holds pii
        Invoice
        ToInvoice                   is an Invoice
        Suffix
        PayablesInvoice				is like PayablesInvoice
        ToPayablesInvoice          	is like PayablesInvoice
        DistributionSequence
            classic name is DIST-SEQ-NBR
        ModelNumber
        ToModelNumber               is a ModelNumber
            classic name is TO-MODEL-NBR
        SerialNumber
        ToSerialNumber              is a SerialNumber
            classic name is TO-SERIAL-NBR
        AssetProject				is a FinanceCodeBlockProjectOnly
		ToAssetProject				is a FinanceCodeBlockProjectOnly
        LocationDetail              is like AssetLocationDetail
            classic name is ITEM-LOC-DTL
        ToLocationDetail            is like AssetLocationDetail
            classic name is TO-ITM-LOC-DTL
        BarCode                     is like AssetBarCode
        ToBarCode                   is like AssetBarCode
        InventoryDate               is TimeStamp
            classic name is INV-DATE
        ToInventoryDate             is TimeStamp
            classic name is TO-INV-DATE
        ItemCondition
            classic name is INV-ITEM-COND
        ToItemCondition             is an ItemCondition
            classic name is TO-INV-IT-COND
		GeographicalLatitude                is a GISCoordinate
        ToGeographicalLatitude              is a GISCoordinate
        GeographicalLongitude               is a GISCoordinate
        ToGeographicalLongitude             is a GISCoordinate
        GeographicalAltitude                is a GISCoordinate
        ToGeographicalAltitude              is a GISCoordinate
		AssetItemReferenceFields
		ToAssetItemReferenceFields          is a AssetItemReferenceFields
		InvoiceCompany       	  			is a PayablesCompany
		ToInvoiceCompany       				is a PayablesCompany
		PurchaseOrderLine		   			is like PurchaseOrderLine
		ToPurchaseOrderLine                 is like PurchaseOrderLine

	Local Fields
	 	LocalBarCode				is a BarCode
	 	BypassActiveCodeBlockEdit

	Conditions

		IsItemNumberAdjusted
			when ((!(ItemNumber not entered and ToItemNumber not entered))
			and (ItemNumber != ToItemNumber))
		IsDiscriptionAdjusted
			when ((!(Description not entered and ToDescription not entered))
			and (Description != ToDescription))

		IsPurchaseDateAdjusted
			when ((!(PurchaseDate not entered and ToPurchaseDate not entered))
			and (PurchaseDate != ToPurchaseDate))

		IsQuantityAdjusted
			when ((!(ItemQuantity not entered and ToItemQuantity not entered))
			and (ItemQuantity != ToItemQuantity))

		IsCostAdjusted
			when ((!(TransactionItemCost not entered and ToTransactionItemCost not entered))
			and (TransactionItemCost != ToTransactionItemCost))

		IsTaxAdjusted
			when ((!(TransactionItemTax not entered and ToTransactionItemTax not entered))
			and (TransactionItemTax != ToTransactionItemTax))

		IsPOAdjusted
			when ((!(PONumber not entered and ToPONumber not entered))
			and (PONumber != ToPONumber))

		IsVendorAdjusted
			when ((!(Vendor not entered and ToVendor not entered))
			and (Vendor != ToVendor))

		IsVendoeNameAdjusted
			when ((!(VendorName not entered and ToVendorName not entered))
			and (VendorName != ToVendorName))

		IsInvoiceAdjusted
			when ((!(PayablesInvoice not entered and ToPayablesInvoice not entered))
			and (PayablesInvoice != ToPayablesInvoice))

		IsModelAdjusted
			when ((!(ModelNumber not entered and ToModelNumber not entered))
			and (ModelNumber != ToModelNumber))

		IsSerialAdjusted
			when ((!(SerialNumber not entered and ToSerialNumber not entered))
			and (SerialNumber != ToSerialNumber))

		IsLocAdjusted
			when ((!(LocationDetail not entered and ToLocationDetail not entered))
			and (LocationDetail != ToLocationDetail))

		IsBarcodeAdjusted
			when ((!(BarCode not entered and ToBarCode not entered))
			and (BarCode != ToBarCode))

		IsInvDateAdjusted
			when ((!(InventoryDate not entered and ToInventoryDate not entered))
			and (InventoryDate != ToInventoryDate))





		IsItemConditionAdjusted
			when ((!(ItemCondition not entered and ToItemCondition not entered))
			and (ItemCondition != ToItemCondition))


        IsAdjust
        	restricted
            when (Asset entered)

		IsTagEntered
			when (Asset.TagNumber entered)

		IsGeographicalLatitudeAdjusted
			when ((!(GeographicalLatitude not entered and ToGeographicalLatitude not entered))
			and  (GeographicalLatitude != ToGeographicalLatitude))

		IsGeographicalLongitudeAdjusted
			when ((!(GeographicalLongitude not entered and ToGeographicalLongitude not entered))
			and  (GeographicalLongitude != ToGeographicalLongitude))

		IsGeographicalAltitudeAdjusted
			when ((!(GeographicalAltitude not entered and ToGeographicalAltitude not entered))
			and  (GeographicalAltitude != ToGeographicalAltitude))

		IsReferenceCompanyAdjusted
			when ((!(AssetItemReferenceFields.ReferenceCompany not entered and ToAssetItemReferenceFields.ReferenceCompany not entered))
			and  (AssetItemReferenceFields.ReferenceCompany != ToAssetItemReferenceFields.ReferenceCompany))

		IsReferenceVendorAdjusted
			when ((!(AssetItemReferenceFields.ReferenceVendor not entered and ToAssetItemReferenceFields.ReferenceVendor not entered))
			and  (AssetItemReferenceFields.ReferenceVendor != ToAssetItemReferenceFields.ReferenceVendor))

		IsReferenceInvoiceAdjusted
			when ((!(AssetItemReferenceFields.ReferenceInvoice not entered and ToAssetItemReferenceFields.ReferenceInvoice not entered))
			and  (AssetItemReferenceFields.ReferenceInvoice != ToAssetItemReferenceFields.ReferenceInvoice))

		IsReferencePurchaseOrderAdjusted
			when ((!(AssetItemReferenceFields.ReferencePurchaseOrder not entered and ToAssetItemReferenceFields.ReferencePurchaseOrder not entered))
			and  (AssetItemReferenceFields.ReferencePurchaseOrder != ToAssetItemReferenceFields.ReferencePurchaseOrder))

		IsReferenceSequenceNumberAdjusted
			when ((!(AssetItemReferenceFields.ReferenceSequenceNumber not entered and ToAssetItemReferenceFields.ReferenceSequenceNumber not entered))
			and  (AssetItemReferenceFields.ReferenceSequenceNumber != ToAssetItemReferenceFields.ReferenceSequenceNumber))

		IsReferenceProjectAdjusted
			when ((!(AssetItemReferenceFields.ReferenceProject not entered and ToAssetItemReferenceFields.ReferenceProject not entered))
			and  (AssetItemReferenceFields.ReferenceProject != ToAssetItemReferenceFields.ReferenceProject))

		IsInvoiceCompanyAdjusted
			when ((!(InvoiceCompany not entered and ToInvoiceCompany not entered))
			and  (InvoiceCompany != ToInvoiceCompany))

		IsPurchaseOrderLineAdjusted
			when ((!(PurchaseOrderLine not entered and ToPurchaseOrderLine not entered))
			and  (PurchaseOrderLine != ToPurchaseOrderLine))

		AssetItemFundsExists
			restricted
			when (!Asset.FundOverride
			and   AssetAdjustment.FundsAllocationUpdated)

	Relations

		AssetBarCodeRel
			one-to-one relation to AssetBarCode
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
				related.AssetBarCode 			= LocalBarCode

		AssetItemFundsRel
			one-to-many relation to AssetItemFund
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup		= FinanceEnterpriseGroup
				related.Asset						= Asset
				related.AssetItem					= AssetItem

	Actions
		Create is a Create Action
			restricted
			Action Rules
				BypassActiveCodeBlockEdit = true
		Update is an Update Action
			restricted
			Action Rules
				BypassActiveCodeBlockEdit = true
		Delete is a Delete Action
			restricted
			Action Rules
				BypassActiveCodeBlockEdit = true

		ResetAdjustment is an Instance Action
			restricted
			Parameters
				PrmUpdateType		is Numeric 1
					States
						ResetAdjustment		value is 1

			Parameter Rules
				PrmUpdateType
					initial value is 1

			Action Rules
				BypassActiveCodeBlockEdit = true
				if (AssetItem not exists)
					if (PurchaseDate entered)	
						invoke Create AssetItem
							fill in fields from this instance
				else
					if (PurchaseDate not entered)

						invoke Delete AssetItem
							invoked.PrmUpdateType				= PrmUpdateType
					else
						if (IsBarcodeAdjusted)
							if (!(BarCode not entered
							and ToBarCode entered))
								LocalBarCode	= BarCode
								if (!AssetBarCodeRel exists)
									invoke Create AssetBarCodeRel
						invoke AdjustmentUpdate AssetItem
							invoked.TransientUpdateType			= PrmUpdateType
							invoked.AssetItem					= AssetItem
							invoked.ItemNumber					= ItemNumber
							invoked.Description					= Description
							invoked.PurchaseDate				= PurchaseDate
							invoked.ItemQuantity		  		= ItemQuantity
							invoked.BaseItemCost				= BaseItemCost
							invoked.BaseItemTax					= BaseItemTax
							invoked.TransactionItemCost			= TransactionItemCost
							invoked.TransactionItemTax			= TransactionItemTax
							invoked.BaseNumberOfDecimals		= BaseNumberOfDecimals
							invoked.TransactionNumberOfDecimals								= TransactionNumberOfDecimals
							invoked.InvoiceAndPurchaseOrderInformation.PurchaseOrder 		= PONumber
							invoked.InvoiceAndPurchaseOrderInformation.Vendor		 		= Vendor
							invoked.VendorName												= VendorName
							invoked.InvoiceAndPurchaseOrderInformation.PayablesInvoice		= PayablesInvoice
							invoked.InvoiceAndPurchaseOrderInformation.DistributionSequence	= DistributionSequence
							invoked.ModelNumber					= ModelNumber
							invoked.SerialNumber				= SerialNumber
							invoked.AssetProject				= AssetProject
							invoked.LocationDetail				= LocationDetail
							invoked.BarCode						= BarCode
							invoked.InventoryDate				= InventoryDate
							invoked.ItemCondition				= ItemCondition
							invoked.GeographicalLatitude		= GeographicalLatitude
							invoked.GeographicalLongitude		= GeographicalLongitude
							invoked.GeographicalAltitude		= GeographicalAltitude
							invoked.AssetItemReferenceFields.ReferenceCompany			= AssetItemReferenceFields.ReferenceCompany
							invoked.AssetItemReferenceFields.ReferenceVendor			= AssetItemReferenceFields.ReferenceVendor
							invoked.AssetItemReferenceFields.ReferenceInvoice			= AssetItemReferenceFields.ReferenceInvoice
							invoked.AssetItemReferenceFields.ReferencePurchaseOrder		= AssetItemReferenceFields.ReferencePurchaseOrder
							invoked.AssetItemReferenceFields.ReferenceSequenceNumber	= AssetItemReferenceFields.ReferenceSequenceNumber
							invoked.AssetItemReferenceFields.ReferenceProject			= AssetItemReferenceFields.ReferenceProject

				invoke Delete

		Purge is a Purge Action
			restricted

