MobileSupplyChainInventoryReplenishmentLine is a BusinessClass
    owned by mscm
    prefix is MSIRL 
    sql name is "MSCMInventoryReplenishmentLine"

    Ontology 
        symbolic key is MobileSupplyChainInventoryReplenishmentLine

    Persistent Fields
        Item
        Quantity                is like Quantity
        Notes                   is Text
        TransactionUOM          is a UnitOfMeasure

    Relations
        ItemLocationRel
            one-to-one relation to ItemLocation
            Field Mapping uses symbolic key
                related.Company             = Company
                related.InventoryLocation   = InventoryLocation
                related.Item                = Item

    Derived Fields
        DerivedPreferredBin is a DerivedField
            type is MessageField
            return ItemLocationRel.PreferredBin
        
        DerivedMinimumOrder is a DerivedField
            type is Numeric 6
            return ItemLocationRel.MinimumOrderQuantity

    Local Fields
        ErrorOccured                    is Boolean
        ErrorMessage                    is Text


    Actions
        Create is a Create Action
            Action Rules

                invoke Create RequisitionLine
                    resume on error
                        ErrorOccured    = true
                        ErrorMessage    = error message                                

                    invoked.Requisition                 = MobileSupplyChainInventoryReplenishment.Requisition
                    invoked.Company                     = Company
                    invoked.RequestingLocation          = InventoryLocation
                    invoked.Item                        = Item
                    invoked.Quantity                    = Quantity   
                    invoked.EnteredUOM                  = TransactionUOM 

                if (ErrorOccured) 
                    Notes                           = ErrorMessage

    Sets    
        ByItem
            Sort Order
                Item
                Company
                InventoryLocation
                MobileSupplyChainInventoryReplenishment
                MobileSupplyChainInventoryReplenishmentLine
