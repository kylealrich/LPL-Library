GLProcurementExpense is a BusinessClass
	owned by GeneralLedger
	prefix is GLPEx
	default label is "GlobalLedgerProcurementExpense"

	Ontology
		symbolic key is GLProcurementExpense		
		
	Patterns

	Persistent Fields
		FinanceEnterpriseGroup
		JournalizeGroup
		AccountingEntity
			delete ignored
		FinanceCodeBlock
		DimensionCode
		PostingDate
        TransactionDate					is an ExchangeDate
		EntityYearPeriod				is a GeneralLedgerCalendarPeriod
			delete ignored
        CurrencyCode					is a FromCurrency
        	delete ignored
        TransactionAmount				is a CurrencyAmount
		ControlDocumentNumber			is Alpha up to 30






		OrganizationKeyFields			is Alpha 75
    	System							is a GeneralLedgerSystemCode
    		delete ignored
    	JournalCode						is AlphaUpper 6
		GeneralLedgerEvent
			default label is "GlobalLedgerEvent"
			delete ignored		
		ReportCurrencyAmount			is a FinanceCurrencyAmount
		AutoReverse						is Boolean
		VendorGroupAndVendor 			is a GlonlyVendorGroupAndVendor
        Reference
		Description						
		DocumentNumber					is Alpha up to 30
        UnitsAmount						
		RelatedJournalTransaction		is BusinessObjectReference		
			disable Auditing
		OriginatingTransaction			is BusinessObjectReference		
		PrimaryLedger					is a Ledger
			delete ignored
#ifdef module ap

		DrillBackLink					is Alpha up to 500

		PayablesCompany
			delete ignored
		Vendor
			delete ignored
		Invoice
		MatchProcessType
		PurchaseOrder
			delete ignored
		Item
			delete ignored
		ItemType
		ItemDescription
		AddOnCharge
			delete ignored
		TaxCode
			delete ignored
		Quantity
		UnitOfMeasure
			delete ignored
		UnitCost

		InventoryLocation
			delete ignored
		OrigICDocument					is Numeric 10
		OrigICLine						is Numeric 6
		ICPostingType					is a PostingType
		ICInventoryTransaction			is a InventoryTransaction
			delete ignored
		ICTransactionSystemCode			is a TransactionSystemCode

		POLineNumber					is Numeric 6
		LineAmount						is an InternationalAmount
		Buyer							is like Buyer
		ReceivedQuantity				is a Quantity	
		RequestingLocation	
			delete ignored

		Requisition						
			delete ignored
		Requester						is like Requester
		RequisitionLine					
			delete ignored
		GLTranSource					is BusinessObjectReference
#endif
	Context Fields
		SearchDateRange					is a DateRange
		PostingDateRange
		CurrencyTable
		SearchAccountingEntity
		SearchAccountingUnit
		SearchSystemCode
		SearchAccount
		SearchProject
		SearchPostToEntity
		SearchFinanceDimension1
		SearchFinanceDimension2
		SearchFinanceDimension3
		SearchFinanceDimension4
		SearchFinanceDimension5
		SearchFinanceDimension6
		SearchFinanceDimension7
		SearchFinanceDimension8
		SearchFinanceDimension9
		SearchFinanceDimension10
#ifdef module ap
		SearchVendor
#endif
		ExcludeAccountingUnit		
		ExcludeAccount


#ifdef module ap
	Transient Fields
		TransientBaseCost		is like UnitCost
			default label is "BaseCost"
			derive value from DerivedBaseCost
		TransientQuantity		is like Quantity
			default label is "Quantity"
			derive value from DerivedQuantity
	
	Derived Fields
		DerivedBaseCost			is a DerivedField
			type is like UnitCost
			if (OriginatingTransaction.BusinessClassName = "PayablesInvoiceDistribution")
				return OriginatingTransaction(PayablesInvoiceDistribution).DerivedUnitCost
			return UnitCost

		DerivedQuantity			is a DerivedField
			type is like Quantity
			if (System != "IC")
				return Quantity
			else
				if (TransactionAmount < 0
				and Quantity > 0)
					return (Quantity * -1)
				else
				    if (TransactionAmount > 0
				    and Quantity < 0)
						return (Quantity * -1)
					else
						return Quantity
				
#endif

	Conditions
		SecurityGroupAllowsAccess
			when (AccountingEntity.AccountingEntitySecurityGroupAllowsAccess
			and  (FinanceCodeBlock.AccountingUnit !entered
			or    FinanceCodeBlock.AccountingUnit.SecurityGroupAllowsAccess)
			and  (FinanceCodeBlock.Project !entered
			or    FinanceCodeBlock.Project.SecurityGroupAllowsAccess)
			and   FinanceCodeBlock.GeneralLedgerChartAccount.SecurityGroupAllowsAccess
			and  (FinanceCodeBlock.FinanceDimension1 !entered
			or    FinanceCodeBlock.FinanceDimension1.SecurityGroupAllowsAccess)
			and  (FinanceCodeBlock.FinanceDimension2 !entered
			or    FinanceCodeBlock.FinanceDimension2.SecurityGroupAllowsAccess)
			and  (FinanceCodeBlock.FinanceDimension3 !entered
			or    FinanceCodeBlock.FinanceDimension3.SecurityGroupAllowsAccess)
			and  (FinanceCodeBlock.FinanceDimension4 !entered
			or    FinanceCodeBlock.FinanceDimension4.SecurityGroupAllowsAccess)
			and  (FinanceCodeBlock.FinanceDimension5 !entered
			or    FinanceCodeBlock.FinanceDimension5.SecurityGroupAllowsAccess)
			and  (FinanceCodeBlock.FinanceDimension6 !entered
			or    FinanceCodeBlock.FinanceDimension6.SecurityGroupAllowsAccess)
			and  (FinanceCodeBlock.FinanceDimension7 !entered
			or    FinanceCodeBlock.FinanceDimension7.SecurityGroupAllowsAccess)
			and  (FinanceCodeBlock.FinanceDimension8 !entered
			or    FinanceCodeBlock.FinanceDimension8.SecurityGroupAllowsAccess)
			and  (FinanceCodeBlock.FinanceDimension9 !entered
			or    FinanceCodeBlock.FinanceDimension9.SecurityGroupAllowsAccess)
			and  (FinanceCodeBlock.FinanceDimension10 !entered
			or    FinanceCodeBlock.FinanceDimension10.SecurityGroupAllowsAccess))
		SecurityGroupAllowsAccessBlankValuesExcluded
			when (FinanceCodeBlock.AccountingEntity.AccountingEntitySecurityGroupAllowsAccess
			and  ((FinanceEnterpriseGroup.AccountingUnitSelected  
			and    FinanceCodeBlock.AccountingUnit.SecurityGroupAllowsAccess)
			or    !FinanceEnterpriseGroup.AccountingUnitSelected)
			and  ((FinanceEnterpriseGroup.ProjectEntry  
			and   FinanceCodeBlock.Project.SecurityGroupAllowsAccess)
			or    !FinanceEnterpriseGroup.ProjectEntry)
			and   FinanceCodeBlock.GeneralLedgerChartAccount.SecurityGroupAllowsAccess
			and  ((FinanceEnterpriseGroup.FinanceDimension1Entry
			and   FinanceCodeBlock.FinanceDimension1.SecurityGroupAllowsAccess)
			or   !FinanceEnterpriseGroup.FinanceDimension1Entry)
			and  ((FinanceEnterpriseGroup.FinanceDimension2Entry
			and   FinanceCodeBlock.FinanceDimension2.SecurityGroupAllowsAccess)
			or   !FinanceEnterpriseGroup.FinanceDimension2Entry)
			and  ((FinanceEnterpriseGroup.FinanceDimension3Entry
			and   FinanceCodeBlock.FinanceDimension3.SecurityGroupAllowsAccess)
			or   !FinanceEnterpriseGroup.FinanceDimension3Entry)
			and  ((FinanceEnterpriseGroup.FinanceDimension4Entry
			and   FinanceCodeBlock.FinanceDimension4.SecurityGroupAllowsAccess)
			or   !FinanceEnterpriseGroup.FinanceDimension4Entry)
			and  ((FinanceEnterpriseGroup.FinanceDimension5Entry
			and   FinanceCodeBlock.FinanceDimension5.SecurityGroupAllowsAccess)
			or   !FinanceEnterpriseGroup.FinanceDimension5Entry)
			and  ((FinanceEnterpriseGroup.FinanceDimension6Entry
			and   FinanceCodeBlock.FinanceDimension6.SecurityGroupAllowsAccess)
			or   !FinanceEnterpriseGroup.FinanceDimension6Entry)
			and  ((FinanceEnterpriseGroup.FinanceDimension7Entry
			and   FinanceCodeBlock.FinanceDimension7.SecurityGroupAllowsAccess)
			or   !FinanceEnterpriseGroup.FinanceDimension7Entry)
			and  ((FinanceEnterpriseGroup.FinanceDimension8Entry
			and   FinanceCodeBlock.FinanceDimension8.SecurityGroupAllowsAccess)
			or   !FinanceEnterpriseGroup.FinanceDimension8Entry)
			and  ((FinanceEnterpriseGroup.FinanceDimension9Entry
			and   FinanceCodeBlock.FinanceDimension9.SecurityGroupAllowsAccess)
			or   !FinanceEnterpriseGroup.FinanceDimension9Entry)
			and  ((FinanceEnterpriseGroup.FinanceDimension10Entry
			and   FinanceCodeBlock.FinanceDimension10.SecurityGroupAllowsAccess)
			or   !FinanceEnterpriseGroup.FinanceDimension10Entry))		
		SystemAPPO
			when (System = "AP"
			or    System = "PO")
		SystemAPPORQ
			when (System = "PO"
			or    System = "AP"
			or    System = "RQ")
		SystemIC
			when (System = "IC")
		MatchesAccountingEntitySearch
			when ((SearchAccountingEntity entered
			and   AccountingEntity within SearchAccountingEntity.AccountingEntityGroup)
			or   (!SearchAccountingEntity entered))
		MatchesPostToEntitySearch
			when ((SearchPostToEntity entered
			and   FinanceCodeBlock.ToAccountingEntity within SearchPostToEntity.PostToEntityGroup)
			or   (!SearchPostToEntity entered))
		MatchesAccountingUnitSearch
			when ((!SearchAccountingUnit entered)
			or   ((ExcludeAccountingUnit = "Y"
			and    FinanceCodeBlock.AccountingUnit not within SearchAccountingUnit.AccountingUnitGroup)
			or    (!ExcludeAccountingUnit = "Y"
			and    FinanceCodeBlock.AccountingUnit within SearchAccountingUnit.AccountingUnitGroup)))
		PostingWithinDateRange
			when ((SearchDateRange entered
			and    PostingDate within SearchDateRange)
			or    (!SearchDateRange entered))
		MatchesSystemCodeSearch
			when ((SearchSystemCode entered
			and    System within SearchSystemCode.SystemCodeGroup)
			or    (!SearchSystemCode entered))
		MatchesAccountSearch
			when ((!SearchAccount entered)
			or   ((ExcludeAccount = "Y"
			and    FinanceCodeBlock.GeneralLedgerChartAccount not within SearchAccount.AccountGroup)
			or	  (!ExcludeAccount = "Y"
			and    FinanceCodeBlock.GeneralLedgerChartAccount within SearchAccount.AccountGroup)))
		MatchesProjectSearch
			when ((!SearchProject entered)
			or	  (FinanceCodeBlock.Project within SearchProject.ProjectGroup))
		MatchesFinDim1Search
			when ((!SearchFinanceDimension1 entered)
			or	  (FinanceCodeBlock.FinanceDimension1 within SearchFinanceDimension1.FinanceDimension1Group))
		MatchesFinDim2Search
			when ((!SearchFinanceDimension2 entered)
			or	  (FinanceCodeBlock.FinanceDimension2 within SearchFinanceDimension2.FinanceDimension2Group))
		MatchesFinDim3Search
			when ((!SearchFinanceDimension3 entered)
			or	  (FinanceCodeBlock.FinanceDimension3 within SearchFinanceDimension3.FinanceDimension3Group))
		MatchesFinDim4Search
			when ((!SearchFinanceDimension4 entered)
			or	  (FinanceCodeBlock.FinanceDimension4 within SearchFinanceDimension4.FinanceDimension4Group))
		MatchesFinDim5Search
			when ((!SearchFinanceDimension5 entered)
			or	  (FinanceCodeBlock.FinanceDimension5 within SearchFinanceDimension5.FinanceDimension5Group))
		MatchesFinDim6Search
			when ((!SearchFinanceDimension6 entered)
			or	  (FinanceCodeBlock.FinanceDimension6 within SearchFinanceDimension6.FinanceDimension6Group))
		MatchesFinDim7Search
			when ((!SearchFinanceDimension7 entered)
			or	  (FinanceCodeBlock.FinanceDimension7 within SearchFinanceDimension7.FinanceDimension7Group))
		MatchesFinDim8Search
			when ((!SearchFinanceDimension8 entered)
			or	  (FinanceCodeBlock.FinanceDimension8 within SearchFinanceDimension8.FinanceDimension8Group))
		MatchesFinDim9Search
			when ((!SearchFinanceDimension9 entered)
			or	  (FinanceCodeBlock.FinanceDimension9 within SearchFinanceDimension9.FinanceDimension9Group))
		MatchesFinDim10Search
			when ((!SearchFinanceDimension10 entered)
			or	  (FinanceCodeBlock.FinanceDimension10 within SearchFinanceDimension10.FinanceDimension10Group))
		
	Sets

#ifdef module ap
		ByGLTranSource
			bypass no duplicates validation

			Sort Order
				GLTranSource 
#endif
		ByGLExpenseTotalOrder
			duplicates
			Sort Order
				FinanceEnterpriseGroup

				FinanceCodeBlock.ToAccountingEntity
				EntityYearPeriod				
				FinanceCodeBlock.Ledger
				System
				CurrencyCode
				FinanceCodeBlock.AccountingUnit
				FinanceCodeBlock.GeneralLedgerChartAccount
				FinanceCodeBlock.Project
				DimensionCode
				PrimaryLedger

		BySystemDateCodeBlock
			Sort Order
				FinanceEnterpriseGroup
				System
				AccountingEntity
				FinanceCodeBlock.ToAccountingEntity
				EntityYearPeriod
				FinanceCodeBlock.AccountingUnit
				FinanceCodeBlock.GeneralLedgerChartAccount
				FinanceCodeBlock.Project
				DimensionCode
				PostingDate descending
				GLProcurementExpense
			
		ByEntityAccountingUnit
			Sort Order
				FinanceEnterpriseGroup
				AccountingEntity
				FinanceCodeBlock.AccountingUnit
				System
				EntityYearPeriod
				PostingDate descending
				GLProcurementExpense
				
		ByAccount
			Sort Order
				FinanceEnterpriseGroup
				System
				FinanceCodeBlock.GeneralLedgerChartAccount
				EntityYearPeriod
				PostingDate descending
				GLProcurementExpense

		TransactionsByProject
			Sort Order
			 	FinanceEnterpriseGroup
			 	System
			 	FinanceCodeBlock.Project
				EntityYearPeriod
			 	PostingDate descending
			 	TransactionDate
			 	GLProcurementExpense

	Actions
	
		Create is a Create Action
			restricted
			bypass field rules
#ifdef module ap
			Action Rules
				if (!Vendor entered
				and PurchaseOrder entered)
					Vendor = PurchaseOrder.Vendor
#endif
		
		Update is an Update Action
			restricted
#ifdef module ap
			Action Rules
				if (!Vendor entered
				and PurchaseOrder entered)
					Vendor = PurchaseOrder.Vendor
#endif		
		Delete is a Delete Action
			restricted

