TermsCodePreview is a BusinessClass
    owned by te
    prefix is TCP

    Ontology
        symbolic key is TermsCodePreview



    Patterns
        implements StaticJava
        disable AuditIndex

    Persistent Fields
        InvoiceAmount is an InternationalAmount
            classic name is INTL-AMT
        InvoiceDate   is Date
            classic name is DATE
		CalculatedTermsTable 			is a CalculateTermsArray
        AmountNumberOfDecimals 			is Numeric 1 
            States
				Zero	  	value is "0"
                Two			value is "2"
                Three		value is "3"      

    Local Fields                                                                                                                                                                                
    	CalculateTerms
		LocalRunRoutine			is Alpha 1
		TempTrigger 			is Alpha 1
		I1						is Numeric 1
		LocalInvoiceAmount		is an InternationalAmount


    Conditions

		HasDiscountPercent
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[1].DiscountDate entered)
		HasDiscountPercent2
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[2].DiscountDate entered)
		HasDiscountPercent3
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[3].DiscountDate entered)

		HasDueDate
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[1].DueDate entered)
		HasDueDate2
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[2].DueDate entered)
		HasDueDate3
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[3].DueDate entered)
		HasDueDate4
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[4].DueDate entered)
		HasDueDate5
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[5].DueDate entered)
		HasDueDate6
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[6].DueDate entered)
		HasDueDate7
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[7].DueDate entered)
		HasDueDate8
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[8].DueDate entered)
		HasDueDate9
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[9].DueDate entered)
		HasDueDate10
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[10].DueDate entered)
		HasDueDate11
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[11].DueDate entered)
		HasDueDate12
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[12].DueDate entered)
		HasDueDate13
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[13].DueDate entered)
		HasDueDate14
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[14].DueDate entered)
		HasDueDate15
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[15].DueDate entered)
		HasDueDate16
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[16].DueDate entered)
		HasDueDate17
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[17].DueDate entered)
		HasDueDate18
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[18].DueDate entered)
		HasDueDate19
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[19].DueDate entered)
		HasDueDate20
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[20].DueDate entered)
		HasDueDate21
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[21].DueDate entered)
		HasDueDate22
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[22].DueDate entered)
		HasDueDate23
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[23].DueDate entered)
		HasDueDate24
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[24].DueDate entered)
		HasDueDate25
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[25].DueDate entered)
		HasDueDate26
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[26].DueDate entered)
		HasDueDate27
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[27].DueDate entered)
		HasDueDate28
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[28].DueDate entered)
		HasDueDate29
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[29].DueDate entered)
		HasDueDate30
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[30].DueDate entered)
		HasDueDate31
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[31].DueDate entered)
		HasDueDate32
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[32].DueDate entered)
		HasDueDate33
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[33].DueDate entered)
		HasDueDate34
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[34].DueDate entered)
		HasDueDate35
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[35].DueDate entered)
		HasDueDate36
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[36].DueDate entered)
		HasDueDate37
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[37].DueDate entered)
		HasDueDate38
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[38].DueDate entered)
		HasDueDate39
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[39].DueDate entered)
		HasDueDate40
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[40].DueDate entered)
		HasDueDate41
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[41].DueDate entered)
		HasDueDate42
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[42].DueDate entered)
		HasDueDate43
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[43].DueDate entered)
		HasDueDate44
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[44].DueDate entered)
		HasDueDate45
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[45].DueDate entered)
		HasDueDate46
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[46].DueDate entered)
		HasDueDate47
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[47].DueDate entered)
		HasDueDate48
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[48].DueDate entered)
		HasDueDate49
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[49].DueDate entered)
		HasDueDate50
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[50].DueDate entered)
		HasDueDate51
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[51].DueDate entered)
		HasDueDate52
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[52].DueDate entered)
		HasDueDate53
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[53].DueDate entered)
		HasDueDate54
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[54].DueDate entered)
		HasDueDate55
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[55].DueDate entered)
		HasDueDate56
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[56].DueDate entered)
		HasDueDate57
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[57].DueDate entered)
		HasDueDate58
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[58].DueDate entered)
		HasDueDate59
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[59].DueDate entered)
		HasDueDate60
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[60].DueDate entered)
		HasDueDate61
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[61].DueDate entered)
		HasDueDate62
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[62].DueDate entered)
		HasDueDate63
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[63].DueDate entered)
		HasDueDate64
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[64].DueDate entered)
		HasDueDate65
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[65].DueDate entered)
		HasDueDate66
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[66].DueDate entered)
		HasDueDate67
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[67].DueDate entered)
		HasDueDate68
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[68].DueDate entered)
		HasDueDate69
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[69].DueDate entered)
		HasDueDate70
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[70].DueDate entered)
		HasDueDate71
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[71].DueDate entered)
		HasDueDate72
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[72].DueDate entered)
		HasDueDate73
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[73].DueDate entered)
		HasDueDate74
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[74].DueDate entered)
		HasDueDate75
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[75].DueDate entered)
		HasDueDate76
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[76].DueDate entered)
		HasDueDate77
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[77].DueDate entered)
		HasDueDate78
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[78].DueDate entered)
		HasDueDate79
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[79].DueDate entered)
		HasDueDate80
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[80].DueDate entered)
		HasDueDate81
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[81].DueDate entered)
		HasDueDate82
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[82].DueDate entered)
		HasDueDate83
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[83].DueDate entered)
		HasDueDate84
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[84].DueDate entered)
		HasDueDate85
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[85].DueDate entered)
		HasDueDate86
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[86].DueDate entered)
		HasDueDate87
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[87].DueDate entered)
		HasDueDate88
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[88].DueDate entered)
		HasDueDate89
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[89].DueDate entered)
		HasDueDate90
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[90].DueDate entered)
		HasDueDate91
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[91].DueDate entered)
		HasDueDate92
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[92].DueDate entered)
		HasDueDate93
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[93].DueDate entered)
		HasDueDate94
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[94].DueDate entered)
		HasDueDate95
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[95].DueDate entered)
		HasDueDate96
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[96].DueDate entered)
		HasDueDate97
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[97].DueDate entered)
		HasDueDate98
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[98].DueDate entered)
		HasDueDate99
			restricted
			when (CalculatedTermsTable.CalculateTermsOutput[99].DueDate entered)

    Derived Fields
    	CalculateResults is a DerivedField
    		type is Alpha 1
    		restricted
    		CalculateTerms.TransactionDate   = InvoiceDate
			CalculateTerms.TransactionAmount = LocalInvoiceAmount
			TempTrigger = CalculateTerms.TermsCalTrigger
		
	Actions
		Create is a Create Action
			Action Rules
				LocalInvoiceAmount = InvoiceAmount
				if (AmountNumberOfDecimals = "0")
					display "LocalInvoiceAmountBeforeRounding=<LocalInvoiceAmount>"
					round LocalInvoiceAmount down to nearest 1
					display "LocalInvoiceAmountAfterRounding=<LocalInvoiceAmount>"
			Exit Rules
				LocalRunRoutine = CalculateResults
				CalculatedTermsTable = CalculateTerms.CalculateTermsTable
					constraint (CalculateTerms.OutputErrorNumber not entered)
						"<CalculateTerms.OutputErrorMessage>"
						
		Update is an Update Action
			Action Rules
				LocalInvoiceAmount = InvoiceAmount
				if (AmountNumberOfDecimals = "0")
					display "LocalInvoiceAmountBeforeRounding=<LocalInvoiceAmount>"
					round LocalInvoiceAmount down to nearest 1
					display "LocalInvoiceAmountAfterRounding=<LocalInvoiceAmount>"			
			Exit Rules
				LocalRunRoutine = CalculateResults
				CalculatedTermsTable = CalculateTerms.CalculateTermsTable
					constraint (CalculateTerms.OutputErrorNumber not entered)
						"<CalculateTerms.OutputErrorMessage>"
								
		Delete is a Delete Action   		
