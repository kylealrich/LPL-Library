SourcingEventPlanHolder is a BusinessClass 
    owned by ss
    prefix is SEPH
	representative image is NotifiedSupplier.SupplierSourceId.Picture.File
		missing image is random background
			foreground text is "<NotifiedSupplier.SupplierSourceId.MainContact.Initials>"

    Ontology
    	part of SourcingEvent
    		relative key is NotifiedSupplier 
    			    			
    Patterns
        implements DynamicCreation

	Persistent Fields
		AddedBySupplier	is Boolean

    Derived Fields
		AwardedStatus is a DerivedField
			type is Alpha 5
			return SourcingEventResponseRel.AwardedStatus
			
		ResponseTag is a MessageField
			"NoResponse"

    	DerivedSupplierName is a DerivedField
    		type is Alpha size 60
    		return NotifiedSupplier.Supplier.SupplierName
    		
    	DerivedContactName is a DerivedField
    		type is Alpha size 60
    		return NotifiedSupplier.SupplierSourceId.MainContact.FirstAndLastName
    	
    	DerivedEmailAddress is a DerivedField
    		type is EmailAddressField
    		return NotifiedSupplier.SupplierSourceId.EmailAddress
    	
    	DerivedPhone is a DerivedField
    		type is Alpha size 30
    		return NotifiedSupplier.SupplierSourceId.TelephoneNumber.TelephoneDisplay 
    	
    	DerivedMobile is a DerivedField
    		type is Alpha size 30
    		return NotifiedSupplier.SupplierSourceId.MobilePhone.MobilePhoneNumber.TelephoneDisplay
    
    	DerivedFax is a DerivedField
    		type is Alpha size 30
    		return NotifiedSupplier.SupplierSourceId.DerivedFaxNumber
    		
    	DerivedContactTitle is a DerivedField
    		type is like Description
    		return NotifiedSupplier.SupplierSourceId.ContactTitle
    		
		DerivedFullAddressDisplay is a DerivedField
			type is Text
			return NotifiedSupplier.SupplierSourceId.Supplier.FullAddressDisplay
			
		DerivedRemitToAddress is a DerivedField
			type is Text
			return NotifiedSupplier.SupplierSourceId.Supplier.FullRemitDisplay
			
		DerivedWebAddress is a DerivedField
			type is URL
			return NotifiedSupplier.SupplierSourceId.Supplier.WebAddress
			
		DerivedDBA is a DerivedField
			type is Alpha size 30 
			return NotifiedSupplier.SupplierSourceId.Supplier.DoingBusinessAs
    
    Conditions
    	SupplierWebAddressExists
			restricted
    		when (NotifiedSupplier.SupplierSourceId.Supplier.WebAddress entered)
    	SupplierContactEmailAddressExists
			restricted
    		when (NotifiedSupplier.SupplierSourceId.EmailAddress entered)
    	SupplierContactHasResponded
    		when (SourcingEventResponseRel exists)
    	SupplierContactNotified
			restricted
    		when (SourcingEventNotificationRel exists)
    	RemitToAddressExists
			restricted
    		when (NotifiedSupplier.SupplierSourceId.Supplier.BillingAddress.DeliveryAddress.AddressLine1 entered)
    	ShowResponseTag
			restricted
    		when (SourcingEvent.NotClosedNotSealed
			and !SupplierContactHasResponded)

    Relations
		SourcingEventResponseRel
			one-to-many relation to SourcingEventResponse
			Field Mapping uses symbolic key
		 		related.NotifiedSupplier.SupplierGroup    = NotifiedSupplier.SupplierGroup
		 		related.NotifiedSupplier.Supplier         = NotifiedSupplier.Supplier
		 		related.NotifiedSupplier.SupplierSourceId = NotifiedSupplier.SupplierSourceId
		 		related.Company                           = Company
		 		related.SourcingEvent                     = SourcingEvent
		 	Instance Selection
		 		where (!related.NoBid)

     	SourcingEventNotificationRel
			one-to-many relation to SourcingEventNotification
			Field Mapping uses BySupplier
				related.NotifiedSupplier.SupplierGroup 	  = NotifiedSupplier.SupplierGroup
				related.NotifiedSupplier.Supplier	   	  = NotifiedSupplier.Supplier
				related.NotifiedSupplier.SupplierSourceId = NotifiedSupplier.SupplierSourceId
				related.Company                           = Company
				related.SourcingEvent                     = SourcingEvent

    Sets
        BySupplier
        	Sort Order
 				NotifiedSupplier.SupplierGroup
 				NotifiedSupplier.Supplier
				NotifiedSupplier.SupplierSourceId
 				Company
 				SourcingEvent					

    Actions
   		Create is a Create Action
   			restricted

   		Update is an Update Action
   			restricted
					
		Delete is a Delete Action
   			valid when (SourcingEvent.InEditableState) 		
   			Action Rules
				constraint (SourcingEvent.InActionableState)
					"CannotDeletePlanHolderWhileEventIsPendingAward,Cancelled,OrClosed"   			
				constraint (!SourcingEvent.NeedsApproval)
					"CannotDeletePlanHolderWhileEventIsPendingEventApproval"
