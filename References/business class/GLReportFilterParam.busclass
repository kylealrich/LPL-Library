GLReportFilterParam is a BusinessClass
    owned by GeneralLedger
    prefix is GLRFP

    Ontology
    	symbolic key is GLReportFilterParam

    Patterns
		implements Resequence on DisplayOrder
			new sequence field is NewDisplayOrder
			set is ByDisplayOrder		

    Persistent Fields
		DimensionParam     	is Alpha 200
			is related value for "GeneralLedgerTotal"
				dimensions only
    	DisplayOrder		is Numeric 2
    
    Transient Fields
		NewDisplayOrder 	is like GLReportFilterParam

	Field Rules
		DisplayOrder
			default to GLReportFilterParam
		DimensionParam
			required
			constraint(IsValidDimension)
				"TheSelectedDimensionIsCurrentlyAReportSelectionFilterOrIsUnsupportedAtThisTime"
			constraint (BirstPublishedSources)
				"<DimensionParam>IsNotDefinedIn_\G\L_\ReportDesignerDataModel"

	Sets
		ByDisplayOrder
			Sort Order
				FinanceEnterpriseGroup
				GLReport
				DisplayOrder
				GLReportFilterParam
    
		ByDimensionParam
			Sort Order
				FinanceEnterpriseGroup
				GLReport
				DimensionParam


	Derived Fields
		
		IsValidDimension is a DerivedField
			type is Boolean
			if(DimensionParam = "GeneralLedgerTotal.EntityYearPeriod"
			or DimensionIsReportFilter)
				return false
			else
				return true
		
		BirstPublishedSources is a NativeField
			type is Boolean
			restricted
		
		DimensionLabel is a DerivedField
			type is Alpha size 30
			
			if (DimensionParam = "FinanceDimension1")
				return FinanceEnterpriseGroup.FinanceDimension1Label
			else
			if (DimensionParam = "FinanceDimension2")
				return FinanceEnterpriseGroup.FinanceDimension2Label
			else 
			if (DimensionParam = "FinanceDimension3")
				return FinanceEnterpriseGroup.FinanceDimension3Label
			else 
			if (DimensionParam = "FinanceDimension4")
				return FinanceEnterpriseGroup.FinanceDimension4Label
			else 
			if (DimensionParam = "FinanceDimension5")
				return FinanceEnterpriseGroup.FinanceDimension5Label
			else 
			if (DimensionParam = "FinanceDimension6")
				return FinanceEnterpriseGroup.FinanceDimension6Label
			else 
			if (DimensionParam = "FinanceDimension7")
				return FinanceEnterpriseGroup.FinanceDimension7Label
			else 
			if (DimensionParam = "FinanceDimension8")
				return FinanceEnterpriseGroup.FinanceDimension8Label
			else 
			if (DimensionParam = "FinanceDimension9")
				return FinanceEnterpriseGroup.FinanceDimension9Label
			else 
			if (DimensionParam = "FinanceDimension10")
				return FinanceEnterpriseGroup.FinanceDimension10Label				
			else 
			if (DimensionParam = "AccountingEntity")
				return FinanceEnterpriseGroup.AccountingEntityLabel
			else 
			if (DimensionParam = "GeneralLedgerTotal.AccountingUnit")
				return FinanceEnterpriseGroup.AccountingUnitLabel
			else 
			if (DimensionParam = "GeneralLedgerTotal.GeneralLedgerChartAccount")
				return FinanceEnterpriseGroup.AccountLabel
			else
			if (DimensionParam = "GeneralLedgerTotal.Project")
				return FinanceEnterpriseGroup.ProjectLabel
			else
			if (DimensionParam = "GeneralLedgerTotal.Currency")
				return "Currency"
			else
			if (DimensionParam = "GeneralLedgerTotal.Ledger")
				return "Ledger"
			else
			if (DimensionParam = "GeneralLedgerTotal.System")
				return "System"
			else
				return DimensionParam

	Rule Blocks
		UpdateExitRules
			if (GLReport.IntegrationStatus = 1)
				if (DimensionParam changed
				or DisplayOrder changed)
					invoke UpdateGLReport GLReport
						invoked.PrmIntegrationStatus = 2
	
	Actions
		Create is an Action
			Entrance Rules
				if (GLReport.Lock)
					constraint(GLReport.create stamp.actor = actor)
						"ReportHasBeenLockedForEditing"
		
		Update is an Action
			Entrance Rules
				if (GLReport.Lock)
					constraint(GLReport.create stamp.actor = actor)
						"ReportHasBeenLockedForEditing"
			Exit Rules
				include UpdateExitRules
		
		Delete is an Action
			Entrance Rules
				if (GLReport.Lock)
					constraint(GLReport.create stamp.actor = actor)
						"ReportHasBeenLockedForEditing"
		
	Conditions
		DimensionIsReportFilter
			when (GLReportFilterDimensionRel exists)

	Relations
		ParamAccountingEntityRel
			one-to-many relation to GLReportFilterParam
			Field Mapping uses ByDimensionParam
				related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
				related.GLReport				= GLReport
				related.DimensionParam			= "AccountingEntity"

		ParamFinanceDimension1Rel
			one-to-many relation to GLReportFilterParam
			Field Mapping uses ByDimensionParam
				related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
				related.GLReport				= GLReport
				related.DimensionParam			= "FinanceDimension1"

		ParamFinanceDimension2Rel
			one-to-many relation to GLReportFilterParam
			Field Mapping uses ByDimensionParam
				related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
				related.GLReport				= GLReport
				related.DimensionParam			= "FinanceDimension2"

		ParamFinanceDimension3Rel
			one-to-many relation to GLReportFilterParam
			Field Mapping uses ByDimensionParam
				related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
				related.GLReport				= GLReport
				related.DimensionParam			= "FinanceDimension3"

		ParamFinanceDimension4Rel
			one-to-many relation to GLReportFilterParam
			Field Mapping uses ByDimensionParam
				related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
				related.GLReport				= GLReport
				related.DimensionParam			= "FinanceDimension4"

		ParamFinanceDimension5Rel
			one-to-many relation to GLReportFilterParam
			Field Mapping uses ByDimensionParam
				related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
				related.GLReport				= GLReport
				related.DimensionParam			= "FinanceDimension5"

		ParamFinanceDimension6Rel
			one-to-many relation to GLReportFilterParam
			Field Mapping uses ByDimensionParam
				related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
				related.GLReport				= GLReport
				related.DimensionParam			= "FinanceDimension6"

		ParamFinanceDimension7Rel
			one-to-many relation to GLReportFilterParam
			Field Mapping uses ByDimensionParam
				related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
				related.GLReport				= GLReport
				related.DimensionParam			= "FinanceDimension7"

		ParamFinanceDimension8Rel
			one-to-many relation to GLReportFilterParam
			Field Mapping uses ByDimensionParam
				related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
				related.GLReport				= GLReport
				related.DimensionParam			= "FinanceDimension8"

		ParamFinanceDimension9Rel
			one-to-many relation to GLReportFilterParam
			Field Mapping uses ByDimensionParam
				related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
				related.GLReport				= GLReport
				related.DimensionParam			= "FinanceDimension9"

		ParamFinanceDimension10Rel
			one-to-many relation to GLReportFilterParam
			Field Mapping uses ByDimensionParam
				related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
				related.GLReport				= GLReport
				related.DimensionParam			= "FinanceDimension10"
	
		ParamAccountingUnitRel
			one-to-many relation to GLReportFilterParam
			Field Mapping uses ByDimensionParam
				related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
				related.GLReport				= GLReport
				related.DimensionParam			= "AccountingUnit"

		ParamCurrencyRel
			one-to-many relation to GLReportFilterParam
			Field Mapping uses ByDimensionParam
				related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
				related.GLReport				= GLReport
				related.DimensionParam			= "Currency"

		ParamProjectRel
			one-to-many relation to GLReportFilterParam
			Field Mapping uses ByDimensionParam
				related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
				related.GLReport				= GLReport
				related.DimensionParam			= "Project"
				
		ParamLedgerRel
			one-to-many relation to GLReportFilterParam
			Field Mapping uses ByDimensionParam
				related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
				related.GLReport				= GLReport
				related.DimensionParam			= "Ledger"

		ParamGeneralLedgerCalendarPeriodRel
			one-to-many relation to GLReportFilterParam
			Field Mapping uses ByDimensionParam
				related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
				related.GLReport				= GLReport
				related.DimensionParam			= "GeneralLedgerTotal.EntityYearPeriod"

		ParamGeneralLedgerChartAccountRel
			one-to-many relation to GLReportFilterParam
			Field Mapping uses ByDimensionParam
				related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
				related.GLReport				= GLReport
				related.DimensionParam			= "GeneralLedgerTotal.GeneralLedgerChartAccount"				
				
		ParamGeneralLedgerSystemCodeRel
			one-to-many relation to GLReportFilterParam
			Field Mapping uses ByDimensionParam
				related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
				related.GLReport				= GLReport
				related.DimensionParam			= "GeneralLedgerTotal.System"

        GLReportFilterDimensionRel
            one-to-one relation to GLReportFilterDimension
            delete cascades
            Field Mapping uses ByDimensionParam
                related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
                related.GLReport				= GLReport
				related.Dimension				= DimensionParam
