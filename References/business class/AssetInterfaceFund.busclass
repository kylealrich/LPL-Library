AssetInterfaceFund is a BusinessClass
	owned by am
	
	prefix is AIntF
	
	Ontology
		symbolic key is AssetInterfaceFund
		
	
	Patterns
		implements StaticJava
		
	Persistent Fields
		AccountingEntity				
		AccountingUnit					
		Fund 							is an AssetFundField	
		PercentContribution				is Percent size 9.6
		TransactionAmount				is an InternationalAmount
			default label is "Amount"
		OriginatingGLTransactionDetail	is a GLTransactionDetail	
			delete ignored
		Project			
		FinanceDimension1
		FinanceDimension2
		FinanceDimension3
		FinanceDimension4
		FinanceDimension5
		FinanceDimension6
		FinanceDimension7
		FinanceDimension8
		FinanceDimension9
		FinanceDimension10
		OriginatingAssetCapitalTransaction	is a AssetCapitalTransaction
			delete ignored
			
	Context Fields

	Transient Fields
		TransientFromCurrency			is a FromCurrency
			derive value from AssetInterface.Currency
	
	Derived Fields	

		
	Relations				
		ThisInstanceRel
			one-to-one relation to AssetInterfaceFund
			Field Mapping uses ByInterfaceFund
				related.AssetInterface			= AssetInterface 
				related.AccountingEntity		= AccountingEntity
				related.AccountingUnit			= AccountingUnit	
				related.Project					= Project
				related.FinanceDimension1		= FinanceDimension1	
				related.FinanceDimension2		= FinanceDimension2		
				related.FinanceDimension3		= FinanceDimension3					
				related.FinanceDimension4		= FinanceDimension4				
				related.FinanceDimension5		= FinanceDimension5
				related.FinanceDimension6		= FinanceDimension6
				related.FinanceDimension7		= FinanceDimension7					
				related.FinanceDimension8		= FinanceDimension8				
				related.FinanceDimension9		= FinanceDimension9
				related.FinanceDimension10		= FinanceDimension10
																
		AssetFundControlRel
			one-to-one relation to AssetFundControl
			Field Mapping uses symbolic key
				related.AssetFundControl	= AssetInterface.FinanceEnterpriseGroup
				
	Conditions	
		AccountingUnitIsFundDimension
			restricted
			when (actor.context.FinanceEnterpriseGroup.FundDimension = 1)		
			
        AccountingUnitSelected
        	when (AssetFundControlRel.AccountingUnit)
        	
        ProjectSelected
           	when (AssetFundControlRel.Project)     
           	 	
		FinanceDimension1Selected
        	when (AssetFundControlRel.FinanceDimension1)
        	
		FinanceDimension2Selected
        	when (AssetFundControlRel.FinanceDimension2)
        	
		FinanceDimension3Selected
        	when (AssetFundControlRel.FinanceDimension3)
        	
		FinanceDimension4Selected
        	when (AssetFundControlRel.FinanceDimension4)
        	
		FinanceDimension5Selected
        	when (AssetFundControlRel.FinanceDimension5)
        	
		FinanceDimension6Selected
        	when (AssetFundControlRel.FinanceDimension6)
        	
		FinanceDimension7Selected
        	when (AssetFundControlRel.FinanceDimension7)
        	
		FinanceDimension8Selected
        	when (AssetFundControlRel.FinanceDimension8)
        	
		FinanceDimension9Selected
        	when (AssetFundControlRel.FinanceDimension9)
        	
		FinanceDimension10Selected
        	when (AssetFundControlRel.FinanceDimension10)
        	
		
	Field Rules

	
	Sets
      	ByInterfaceFund
			Sort Order
				AssetInterface
				AccountingEntity	
				AccountingUnit
				Project		
				FinanceDimension1
				FinanceDimension2
				FinanceDimension3
				FinanceDimension4
				FinanceDimension5
				FinanceDimension6
				FinanceDimension7
				FinanceDimension8
				FinanceDimension9
				FinanceDimension10			
										
	Actions
		Create is an Action

			Entrance Rules
				display "AIF_133<AssetInterface>"
				constraint (!ThisInstanceRel exists)
					"AssetFundRecordAlreadyExistsForFund<Fund>"						

			Action Rules
				if (AccountingEntity.FinanceEnterpriseGroup.FundDimension.AccountingUnit)
					constraint (AccountingUnit entered)
						"FundDimensionIsRequired"
					Fund = AccountingUnit		
				else
					constraint (FinanceDimension1 entered)	
						"FundDimensionIsRequired"
					Fund = FinanceDimension1	

		CreateFromTransfer is a Create Action
			restricted
			Action Rules
				if (AccountingEntity.FinanceEnterpriseGroup.FundDimension.AccountingUnit)
					constraint (AccountingUnit entered)
						"FundDimensionIsRequired"
					Fund = AccountingUnit		
				else
					constraint (FinanceDimension1 entered)	
						"FundDimensionIsRequired"
					Fund = FinanceDimension1											
			
		Update is an Action   
			Field Rules
				PercentContribution
					cannot be changed
						"PercentContributionCannotBeChanged"


		UpdateFund is an Instance Action   
			Parameters
				PrmTransactionAmount		is like InternationalAmount
				PrmPercentContribution		is Percent size 9.6
			Action Rules
				TransactionAmount  		+= PrmTransactionAmount
				PercentContribution		= PrmPercentContribution


		RecalculatePercents is a Set Action
			restricted
			Parameters
				PrmAssetInterface	is like AssetInterface
				NewAmount 			is like InternationalAmount

			Instance Selection
				where (AssetInterface = PrmAssetInterface)

			Action Rules
		
				Instance Rules	
					PercentContribution = TransactionAmount / NewAmount	

		Delete is an Action
			Action Rules			
			
