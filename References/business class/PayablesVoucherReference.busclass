PayablesVoucherReference is a BusinessTask  
    owned by ap

    Parameters
        Company                 	is a PayablesCompany
        CompanyGroup				is a GeneralLedgerCompanyGroup
        YearOption					is Numeric 1 
			States
				CurrentYear	  value is 1
				PreviousYear  value is 2

    Parameter Rules
        Company
			constraint (CompanyGroup not entered)
				"CompanyGroupMustNotBeEntered"	
				
			if (Company not entered
			and CompanyGroup not entered)
				required
			
			if (Company entered)
				constraint (Company.VoucherReference)
					"PayablesCompanyIsNotConfiguredForVoucherReferenceNumber"
				
		YearOption
			required
			
    Actions
    	PayablesVoucherReference is an Instance Action
    		Action Rules
    			if (Company entered)
       	    		invoke CopyPayablesInvoice Company 
       	    			invoked.PrmYearOption = YearOption

				if (CompanyGroup entered)
       	    		for each CompanyGroup.GeneralLedgerCompanyGroupMembersRel
       	    			Company = each.Company
       	    			if (Company.VoucherReference)
       	    				invoke CopyPayablesInvoice Company 
       	    					invoked.PrmYearOption = YearOption
		
       	    
