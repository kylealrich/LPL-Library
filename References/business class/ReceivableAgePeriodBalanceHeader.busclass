ReceivableAgePeriodBalanceHeader is a BusinessClass 
    owned by ar
    prefix is APrBH
    sql name is RcvAgePeriodBalanceHeader

    Ontology
        symbolic key is ReceivableAgePeriodBalanceHeader

    Patterns
        disable AuditIndex
        disable Auditing

    Persistent Fields

		CustomerGroup			is like CustomerGroup
		NationalGroup			is a NationalAccountGroup
		Future1Amount			is an InternationalAmount
		FutureAmount 			is an InternationalAmount
		CurrentAmount 			is an InternationalAmount
		Period1Amount 			is an InternationalAmount	
		Period2Amount 			is an InternationalAmount
		Period3Amount			is an InternationalAmount
		Period4Amount 			is an InternationalAmount
		Period5Amount			is an InternationalAmount
		Period6Amount 			is an InternationalAmount
		Period7Amount 			is an InternationalAmount
		Period8Amount 			is an InternationalAmount
		CreateDate				is Date

	Local Fields
		LocalPeriod				is Numeric 2
	
	Derived Fields

		Future1Title is a DerivedField
			type is Alpha size 25
			LocalPeriod = 1
			return first AgePeriodRel.CustomerGroupPeriodTitle

		FutureTitle is a DerivedField
			type is Alpha size 25
			LocalPeriod = 2
			return first AgePeriodRel.CustomerGroupPeriodTitle

		CurrentTitle is a DerivedField
			type is Alpha size 25
			LocalPeriod = 3
			return first AgePeriodRel.CustomerGroupPeriodTitle

		Period1Title is a DerivedField
			type is Alpha size 25
			LocalPeriod = 4
			return first AgePeriodRel.CustomerGroupPeriodTitle

		Period2Title is a DerivedField
			type is Alpha size 25
			LocalPeriod = 5
			return first AgePeriodRel.CustomerGroupPeriodTitle

		Period3Title is a DerivedField
			type is Alpha size 25
			LocalPeriod = 6
			return first AgePeriodRel.CustomerGroupPeriodTitle

		Period4Title is a DerivedField
			type is Alpha size 25
			LocalPeriod = 7
			return first AgePeriodRel.CustomerGroupPeriodTitle

		Period5Title is a DerivedField
			type is Alpha size 25
			LocalPeriod = 8
			return first AgePeriodRel.CustomerGroupPeriodTitle

		Period6Title is a DerivedField
			type is Alpha size 25
			LocalPeriod = 9
			return first AgePeriodRel.CustomerGroupPeriodTitle

		Period7Title is a DerivedField
			type is Alpha size 25
			LocalPeriod = 10
			return first AgePeriodRel.CustomerGroupPeriodTitle

		Period8Title is a DerivedField
			type is Alpha size 25
			LocalPeriod = 11
			return first AgePeriodRel.CustomerGroupPeriodTitle

    Relations

        CompanyCustomerRel
            one-to-one relation to CompanyCustomer
            Field Mapping uses symbolic key
                related.Company  		= Company
                related.Customer 		= Customer

		ReceivableAgePeriodBalanceDetailRel
			one-to-many relation to ReceivableAgePeriodBalanceDetail
            Field Mapping uses symbolic key
                related.Company  		= Company
                related.Customer 		= Customer

		AgePeriodRel
			one-to-many relation to ReceivableAgePeriod
            Field Mapping uses ByAgePeriodSequence
            	related.CustomerGroup		= CustomerGroup
                related.ReceivableCompany	= blank
                related.AgingCode 			= blank
                related.AgePeriodSequence	= LocalPeriod

		
	Sets
	
        ByCustomerGroup
            indexed
            Sort Order
                CustomerGroup
                Company
                Customer

	Field Rules
	
		CustomerGroup
			force default to Company.CustomerGroupField.CustomerGroup
			
		NationalGroup.NatCompany
			if (CompanyCustomerRel.NationalAccountIndicator.No)
				NationalGroup.NatCompany = Company
			else
			if (CompanyCustomerRel.NationalAccountIndicator.Child)
				NationalGroup.NatCompany = CompanyCustomerRel.NationalCompany
			else
				NationalGroup.NatCompany = CompanyCustomerRel.Company

		NationalGroup.NatCustomer
			if (CompanyCustomerRel.NationalAccountIndicator.No)
				NationalGroup.NatCustomer = Customer
			else
			if (CompanyCustomerRel.NationalAccountIndicator.Child)
				NationalGroup.NatCustomer = CompanyCustomerRel.NationalCustomer
			else
				NationalGroup.NatCustomer = CompanyCustomerRel.Customer

		CreateDate
			default to current corporate date
				
    Actions
        Create is a Create Action
        	restricted

        Update is an Update Action
        	restricted

		FastUpdate is an Update Action
			restricted
			bypass field rules
			        	
        Delete is a Delete Action
			restricted
			Entrance Rules
				invoke Delete ReceivableAgePeriodBalanceDetailRel
				
        FastDelete is a Delete Action
			restricted
			bypass relational integrity rules
			Entrance Rules
				invoke FastDelete ReceivableAgePeriodBalanceDetailRel
				
                
