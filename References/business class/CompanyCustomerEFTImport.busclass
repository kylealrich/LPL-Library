CompanyCustomerEFTImport is a BusinessClass
    owned by ar
    prefix is AIF
    classic name is ARIEFT

    Ontology
        symbolic key is CompanyCustomerEFTImport
            classic set name is AIFSET1

    Patterns
        implements StaticJava
        disable AuditIndex
		disable Auditing 
       	disable EffectiveDated

    Persistent Fields

        BankEntity                  is like BankEntity  
        BankAccountNumber
            classic name is BANK-ACCT-NBR
        StartDate
        EndDate                     is Date
        PrenotificationDate         is Date
        EFTBankAccountType
            classic name is FT-TYPE
        EFTPrenotification          is AlphaUpper size 1
	        classic name is PRE-NOTE
	        States
	        	Exempt			value is "E"
	            No          	value is "N"
	            Yes          	value is "Y"
        PrenoteStatus
        BankAccountType
            classic name is CUST-ACCT-TYPE
        RIBKey
            classic name is RIBKEY
        EFTCustomerPrenote	  	is AlphaUpper size 1
	        classic name is CUST-PRE-NOTE
	        States
	        	Exempt			value is "E"
	            No          	value is "N"
	            Yes          	value is "Y"
        EFTCustomerPrenoteMethod    is AlphaUpper size 1
            classic name is CUST-NOTE-METH
            default label is "E\F\TCustomerNotificationMethod"
            States
                AlternateEdi value is "A"
                    default label is "Alternate EDI"
                Edi          value is "E"
                    default label is "EDI"
                Fax          value is "F"
        EFTCustomerAdjustmentMethod is an AdjNoteMeth
            classic name is ADJ-NOTE-METH
        User1Field
            classic name is USER1-FIELD
        User2Field
            classic name is USER2-FIELD
        PaymentFormat
        BankAccountValidationType
            classic name is VBANK-IDENT
        BankAccountTransactionCode
            classic name is BANK-TRAN-CD
        IBAN 				  					   is Boolean
        BicID 				  					   is AlphaUpper size 12
        MandateID			 					   is AlphaUpper size 35
        MandateType			  					   is AlphaUpper size 2
        	States
        		CORE 			value is 01
        		B2B				value is 02
        		COR1			value is 03    
	
	Local Fields
		ValidateBankAccountNumber
		
    Field Rules
    	BicID
	    	if (PaymentFormat.SEPA
	    	or BankAccountValidationType.IbanAndBIC)
	    		required
		EFTCustomerPrenoteMethod
			required
		EFTCustomerAdjustmentMethod
			required
			
	Rule Blocks				
		VerifyBankAccount


	        initialize ValidateBankAccountNumber
	        ValidateBankAccountNumber.BankAccountValidationType = BankAccountValidationType
	        ValidateBankAccountNumber.BankAccountNumber			= BankAccountNumber
	        constraint (ValidateBankAccountNumber.IsValidBankAccount)
				"<ValidateBankAccountNumber.ErrorMessage>"
					
			if (BankAccountNumber entered or BankEntity entered)
				constraint (BankAccountNumber entered and BankEntity entered)
					"Bank_\and_\bank_\account_\required"
					
		VerifyPrenote
			if (EFTCustomerPrenote = "Y")
				if (PrenoteStatus.EftRecordSent 
				or PrenoteStatus.Printed)
					constraint (PrenotificationDate entered)
						"Cannot_\enter_\prenotification_\status;_\prenotification_\date_\not_\set"
						
			
    Actions
        Create is a Create Action
        	Entrance Rules
	        	include VerifyBankAccount
	        	include VerifyPrenote
        Update is an Update Action
        	Entrance Rules
	        	include VerifyBankAccount
	        	include VerifyPrenote
        Delete is a Delete Action   
        FastDelete is a Delete Action
        	restricted
        	bypass relational integrity rules 
			                 
