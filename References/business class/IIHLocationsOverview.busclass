IIHLocationsOverview is a BusinessClass
	owned by InventoryIntelligence
	default label is "LocationsOverview"
	
	prefix is IIHR
	
	Ontology
		symbolic key is IIHLocationsOverview
		
	
	Patterns
		implements DynamicCreation
		disable Auditing
		implements CreateStamp
		implements UpdateStamp
		
	Persistent Fields
		PerpetualLocationsCount				is Decimal size 10
		ParLocationsCount					is Decimal size 10
		PerpetualItemCount 					is Decimal size 10
		ParItemCount 						is Decimal size 10
		PerpetualRefInvValue				is like InternationalAmount
		ParRefInvValue						is like InternationalAmount
		PerpetualTargetInvValue				is like InternationalAmount
			default label is "TargetInventoryValue"
		ParTargetInvValue					is like InternationalAmount
			default label is "TargetInventoryValue"		
		PerpetualEligibleIemCount			is Decimal size 10
			default label is "PerpetualEligibleItemCount"
		ParEligibleIemCount					is Decimal size 10
			default label is "ParEligibleItemCount"
		PerpetualEligibleIemValue			is like InternationalAmount
			default label is "PerpetualEligibleItemValue"
		ParEligibleIemValue					is like InternationalAmount
			default label is "ParEligibleItemValue"
		PerpetualRemovalCandidatesCount 	is Decimal size 10
		ParRemovalCandidatesCount 			is Decimal size 10
		PerpetualRemovalCandidatesValue 	is like InternationalAmount
		ParRemovalCandidatesValue 			is like InternationalAmount
		
		PerpetualDecreaseItemCount			is Decimal size 10
		PerpetualDecreaseReferenceValue 	is like InternationalAmount
		PerpetualDecreaseTargetValue 		is like InternationalAmount
		PerpetualDecreasePotentialSavings 	is like InternationalAmount
		PerpetualDecreaseAchievedSoFar	 	is like InternationalAmount
		
		ParDecreaseItemCount				is Decimal size 10
		ParDecreaseReferenceValue 			is like InternationalAmount
		ParDecreaseTargetValue 				is like InternationalAmount
		ParDecreasePotentialSavings 		is like InternationalAmount
		ParDecreaseAchievedSoFar	 		is like InternationalAmount
		
		PerpetualIncreaseItemCount			is Decimal size 10
		PerpetualIncreaseReferenceValue 	is like InternationalAmount
		PerpetualIncreaseTargetValue 		is like InternationalAmount
		PerpetualCostOfImprovedService 		is like InternationalAmount
		PerpetualIncreaseCostSoFar	 		is like InternationalAmount
		
		ParIncreaseItemCount				is Decimal size 10
		ParIncreaseReferenceValue 			is like InternationalAmount
		ParIncreaseTargetValue 				is like InternationalAmount
		ParIncreaseCostOfImprovedService 	is like InternationalAmount
		ParIncreaseCostSoFar	 			is like InternationalAmount
	
	Field Rules

	Conditions
		IncludeConsignment						
			restricted
			when (IIHGlobalConfigurationRel.ConsignmentInValuation
			and HasGlobalAccess)

		DoNotIncludeConsignment					
			restricted
			when (!IIHGlobalConfigurationRel.ConsignmentInValuation
			and HasGlobalAccess)
	
	Derived Fields
		AnalysisDateDerived is a StringField
            type is Alpha size 30
            first IIProcessResultRel.AnalysisDateString
            
		TotalRefInvValue is a DerivedField
			type is like InternationalAmount
			return (ParRefInvValue + PerpetualRefInvValue)

		TotalTargetInventoryValue is a DerivedField			
			type is like InternationalAmount
			return (ParTargetInvValue + PerpetualTargetInvValue)
			
		TotalEligibleIemValue is a DerivedField
			type is like InternationalAmount
			default label is "TotalEligibleItemValue"
			return (ParEligibleIemValue + PerpetualEligibleIemValue)
			
		IncreaseItemCount is a DerivedField
            type is Decimal size 10
            return (ParIncreaseItemCount + PerpetualIncreaseItemCount)
            
		IncreaseReferenceValue is a DerivedField
            type is like InternationalAmount
            return (PerpetualIncreaseReferenceValue + ParIncreaseReferenceValue)
            
		IncreaseTargetValue is a DerivedField
            type is like InternationalAmount
            return (ParIncreaseTargetValue + PerpetualIncreaseTargetValue)
            
		IncreaseCostOfImprovedService is a DerivedField
            type is like InternationalAmount
            return (ParIncreaseCostOfImprovedService + PerpetualCostOfImprovedService)
            
		IncreaseCostSoFar is a DerivedField
            type is like InternationalAmount
            return (ParIncreaseCostSoFar + PerpetualIncreaseCostSoFar)
            
		DecreaseItemCount is a DerivedField
            type is Decimal size 10
            return (ParDecreaseItemCount + PerpetualDecreaseItemCount)
            
		DecreaseReferenceValue is a DerivedField
            type is like InternationalAmount
            return (ParDecreaseReferenceValue + PerpetualDecreaseReferenceValue)
            
		DecreaseTargetValue is a DerivedField
            type is like InternationalAmount
            return (ParDecreaseTargetValue + PerpetualDecreaseTargetValue)
            
		DecreasePotentialSavings is a DerivedField
            type is like InternationalAmount
            return (ParDecreasePotentialSavings + PerpetualDecreasePotentialSavings)
            
		DecreaseAchievedSoFar is a DerivedField
            type is like InternationalAmount
            return (ParDecreaseAchievedSoFar + PerpetualDecreaseAchievedSoFar)
            
		RemovalCandidatesCount is a DerivedField
            type is Decimal size 10
            return (ParRemovalCandidatesCount+ PerpetualRemovalCandidatesCount)
            
		RemovalCandidatesValue is a DerivedField
            type is like InternationalAmount
            return (ParRemovalCandidatesValue + PerpetualRemovalCandidatesValue)
            
		EligibleItemCount is a DerivedField
            type is Decimal size 10
            return (ParEligibleIemCount+ PerpetualEligibleIemCount)
            
		TotalItemCount is a DerivedField
            type is Decimal size 10
            return (ParItemCount + PerpetualItemCount)

		TotalPotentialChange is a DerivedField				
            type is like InternationalAmount
			return (DecreasePotentialSavings + IncreaseCostOfImprovedService)

		HasGlobalAccess is a DerivedField					
            type is Boolean
			restricted
            if (IIHGlobalConfigurationRel exists
            and (IIHGlobalConfigurationRel.DefaultGlobalAccess.View
                or IIHGlobalConfigurationRel.DefaultGlobalAccess.Edit))
                return true
            else
                return false

		PerpetualRecommendationsCount is a DerivedField
            type is Decimal size 10
            return (PerpetualIncreaseItemCount + PerpetualDecreaseItemCount)

		ParRecommendationsCount is a DerivedField
            type is Decimal size 10
            return (ParIncreaseItemCount + ParDecreaseItemCount)
	
	Relations
		IIHLocationsOverviewRel
		    one-to-many relation to IIHLocationsOverview
		    Field Mapping uses symbolic key
		        related.FinanceEnterpriseGroup = actor.context.FinanceEnterpriseGroup
		        
		IIProcessResultRel
		    one-to-many relation to InventoryIntelligenceProcessResult
		    Field Mapping uses ByProcessStatusStartTime
		        related.FinanceEnterpriseGroup = FinanceEnterpriseGroup
		        related.Process                = 2
		        related.Status                 = 2

		IIProcessResultChartsRel											
		    one-to-many relation to InventoryIntelligenceProcessResult
		    Field Mapping uses ByProcessStatusStartTime
		        related.FinanceEnterpriseGroup = FinanceEnterpriseGroup
		        related.Process                = 2
		        related.Status                 = 2
			Instance Selection
				where (related.RunsLimit)

		CumulativeHistoryChartRel
		    one-to-many relation to InventoryIntelligenceProcessResult
		    Field Mapping uses ByProcessStatusStartTime
		        related.FinanceEnterpriseGroup = FinanceEnterpriseGroup
		        related.Process                = 2
		        related.Status                 = 2
			Instance Selection
				where (related.CumulativeChartRunsLimit)

		IIHItemLocationRel is a IIHItemLocation set				
			Instance Selection
				where(related.Company.FinanceEnterpriseGroup = FinanceEnterpriseGroup)

		RemovalCandidatesRel
			one-to-many relation to IIHItemLocation
			Field Mapping uses ByRemovalCandidate
				related.RemovalCandidate	= true
			Instance Selection
				where(related.Company.FinanceEnterpriseGroup = FinanceEnterpriseGroup)

		IIHInventoryLocationRel is a IIHInventoryLocation set		
			Instance Selection
				where(related.Company.FinanceEnterpriseGroup = FinanceEnterpriseGroup)

		IIHGlobalConfigurationRel								
    		one-to-one relation to IIHGlobalConfiguration
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup = FinanceEnterpriseGroup
	Actions 			

		Create is a Create Action
			restricted
		Update is an Update Action
			restricted
		Delete is a Delete Action
			restricted
		FastUpdate is an Update Action
			restricted
			bypass field rules
	
