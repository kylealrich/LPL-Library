AssetBookType is a BusinessClass
    owned by am
    prefix is ADR
    classic name is AMBOOKTYPE

    Ontology
        symbolic key is AssetBookType
            classic set name is ADRSET1
            classic name for AssetBookType.Type is ASSET-TYPE

    Patterns
        implements StaticJava
        disable AuditIndex

    Persistent Fields

        DepreciationRate
            classic name is DEPR-RATE
      

            
	Local Fields
		LocalAsset	is like Asset					           

    Conditions

        IsDetailExists
        	restricted
            when (first AssetBookTypeDepreciationsRel exists)

    Relations

        AssetBookTypeDepreciationsRel	is a AssetBookTypeDepreciation set
            Instance Selection
                where (related.Book 			= Book
                and related.AssetType.Type 		= AssetBookType.Type
                and related.AssetType.SubType 	= AssetBookType.SubType)
                
		AssetBooksRel
			one-to-many relation to AssetBook
			Field Mapping uses Set2
				related.FinanceEnterpriseGroup 	= FinanceEnterpriseGroup
				related.Book					= Book
				
		AssetTypeRel
			one-to-many relation to AssetType
			Field Mapping uses Set2
				related.AssetType.Type		= AssetBookType.Type
				related.AssetType.SubType	= AssetBookType.SubType
				
		AssetsRel
			one-to-many relation to Asset
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
				related.Asset					= LocalAsset
			Instance Selection
				where (related.AssetType.Type		= AssetBookType.Type
				and	   related.AssetType.SubType	= AssetBookType.SubType)                

    Sets

        Set2
            indexed
            Sort Order
                AssetBookType
                Book
	


	Rule Blocks
	
		DeleteRules
		
			for each AssetBooksRel
				LocalAsset = each.Asset
				constraint (AssetsRel not exists)
					"CannotDeleteRate:ItIsBeingUsedByAsset<LocalAsset>"		
		
	Field Rules
		Book
			constraint (Book.DepreciationType.ClassLevel)
				"BookIsNotAnAccountLevelDepreciationBook"		
			
		AssetBookType
			constraint (AssetTypeRel exists)
				"AssetTypeDoesNotExist"							

		DepreciationRate
			constraint (DepreciationRate <= 1)
				"DepreciationRateCannotExceed100%"				
				
	Derived Fields	
							
    Actions
        Create is a Create Action
			Action Rules

        Update is an Update Action
			Action Rules

        Delete is a Delete Action
			Action Rules
				include DeleteRules
				

