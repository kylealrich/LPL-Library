TrueCostMSCMExtractInterface is a BusinessClass
	owned by truecost
	
	prefix is TCMSE
	default label is "True\CostPoint_ofUseInterface"
	Ontology
		symbolic key is TrueCostMSCMExtractInterface
		
	
	Patterns
		disable Auditing
		disable EffectiveDated
		disable AsOfDateProcessing
		
	Persistent Fields







	
	Local Fields
		LocalTrueCostConfiguration			is like TrueCostConfiguration
		LocalTrueCostWeight					is like TrueCostWeight
		LocalDate							is Date
		LocalLastDate						is Date
		
	Field Rules
		
	Derived Fields
		LastDayOfMonth			is a DerivedField
			type is Date
			restricted
			while (!LocalDate is last day in month)
				LocalDate += 1 day
			return LocalDate	
		
			
	Relations
		TrueCostResourceUtilTableRel
			one-to-many relation to TrueCostResourceUtilTable
			Field Mapping uses symbolic key
				related.TrueCostConfiguration							= LocalTrueCostConfiguration
				related.TrueCostResourceUtilTable.AccountingEntity		= TrueCostMSCMExtractInterface.CompanyNo
				related.TrueCostResourceUtilTable.Department			= TrueCostMSCMExtractInterface.DepartmentCode
				related.TrueCostResourceUtilTable.CostObject			= TrueCostMSCMExtractInterface.ProcedureChargeCode
				related.TrueCostResourceUtilTable.ResourceUsed			= TrueCostMSCMExtractInterface.ItemNo
				related.TrueCostResourceUtilTable.UseDate				= LocalLastDate
		
		TrueCostResourceUtilAggregationRel
			one-to-many relation to TrueCostResourceUtilTable
			Field Mapping uses symbolic key
				related.TrueCostConfiguration							= LocalTrueCostConfiguration
				related.TrueCostResourceUtilTable.AccountingEntity		= TrueCostMSCMExtractInterface.CompanyNo
				related.TrueCostResourceUtilTable.Department			= TrueCostMSCMExtractInterface.DepartmentCode
				related.TrueCostResourceUtilTable.CostObject			= TrueCostMSCMExtractInterface.ProcedureChargeCode
				related.TrueCostResourceUtilTable.ResourceUsed			= TrueCostMSCMExtractInterface.ItemNo
				related.TrueCostResourceUtilTable.UseDate				= LocalLastDate
				
		TrueCostWeightRel
			one-to-many relation to TrueCostWeight
			Field Mapping uses symbolic key
				related.TrueCostConfiguration							= LocalTrueCostConfiguration
				related.TrueCostWeight									= LocalTrueCostWeight
				
	Rule Blocks
		ProcessLastDayOfMonth
			LocalDate = TrueCostMSCMExtractInterface.LastUpdateDate
			LocalLastDate = LastDayOfMonth
			
	Actions
	
		Create is a Create Action
		Update is an Update Action
		Delete is a Delete Action
		
		GenerateResourceUtilizationData 				is a Set Action
			Parameters
				PrmTCConfig				is a TrueCostConfiguration
					default label is "True\CostConfiguration"
				PrmTCWeight				is a TrueCostWeight
					default label is "True\CostWeight"
					
			Parameter Rules
				PrmTCConfig
					LocalTrueCostConfiguration = PrmTCConfig
					required
						"True\CostConfigurationIsRequired"
				PrmTCWeight
					LocalTrueCostWeight = PrmTCWeight
					required
						constraint (TrueCostWeightRel.ResourceRate)
							"True\CostWeightMustBeResourceRate"
			
			Action Rules
				Instance Rules
					LocalTrueCostConfiguration = PrmTCConfig
					LocalTrueCostWeight = PrmTCWeight
					include ProcessLastDayOfMonth
					if (!TrueCostResourceUtilTableRel exists)
						invoke Create TrueCostResourceUtilTable
							resume on error
							invoked.TrueCostResourceUtilTable.TrueCostConfiguration				= LocalTrueCostConfiguration
							invoked.TrueCostResourceUtilTable.AccountingEntity					= TrueCostMSCMExtractInterface.CompanyNo
							invoked.TrueCostResourceUtilTable.Department						= TrueCostMSCMExtractInterface.DepartmentCode
							invoked.TrueCostResourceUtilTable.CostObject						= TrueCostMSCMExtractInterface.ProcedureChargeCode
							invoked.TrueCostResourceUtilTable.ResourceUsed						= TrueCostMSCMExtractInterface.ItemNo
							invoked.TrueCostResourceUtilTable.UseDate							= LocalLastDate
							invoked.TrueCostResourceUtilTable.SerialNo							= TrueCostMSCMExtractInterface.SerialNo
							invoked.TrueCostResourceUtilTable.Count								= TrueCostMSCMExtractInterface.QtyUsed
							invoked.TrueCostResourceUtilTable.TrueCostWeight					= LocalTrueCostWeight
							invoked.TrueCostResourceUtilTable.AveProcedureTime					= 1
					else
						invoke Update TrueCostResourceUtilTableRel
							invoked.TrueCostResourceUtilTable.Count			+= TrueCostMSCMExtractInterface.QtyUsed
							invoked.TrueCostResourceUtilTable.UseDate		= LocalLastDate
								
							
							
