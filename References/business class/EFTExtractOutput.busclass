EFTExtractOutput is a BusinessClass
	owned by ar
	prefix is EFTE

	Ontology
		symbolic key is EFTExtractOutput

	Patterns
		implements StaticJava
		disable AuditIndex

	Persistent Fields
		DataFileName			is AlphaUpper size 50
		CreateDate				is TimeStamp
		EFTExtractResult
			delete ignored			
		Customer
		DataFile				is a PaymentAttachment
		ProcessedByThirdParty	is Boolean

	Transient Fields

	Local Fields

	Derived Fields
		DataFileNameOutputFileName is a StringField
			type is Alpha 100
			DataFileName
			"-"
			Company
			"-"
			Customer
			"-"

	Conditions
		HasDataTapeFileAttachment
			restricted
			when (DataFile entered)

	Relations

	Sets
		ByCreateDate
			Sort Order
				CreateDate descending
				Company
				EFTExtractOutput

		ByProcessedByThirdParty
			Sort Order
				ProcessedByThirdParty descending
				Company
				EFTExtractOutput

		ByEFTExtractResult	
			Sort Order
				EFTExtractResult descending
				Company
				EFTExtractOutput


	Field Rules
		CreateDate
			default to current timestamp
		DataFileName
			default to "EFTEXTRACT"

	Actions
		Create is a Create Action
			restricted

		Update is an Update Action
			restricted

		Delete is a Delete Action
			restricted

		Purge is a Purge Action
			restricted

		CreateEFTExtractFile is an Instance Action
			Action Rules
				display "Entered"
				trigger "EFTExtractFile" PA service
					resume on error
					title is "CreateEFTExtractFile"
					Variables
						Company
						EFTExtractOutput

		PurgeEFTExtractOutputRecords is a Set Action
			run in foreground
			completion message is "PurgeOfExtractOutputRecordsHasCompleted"
			Parameters
				PrmReceivableCompany						is a ReceivableCompany
				PrmCreateDateRange							is a DateRange 

			Parameter Rules
				PrmCreateDateRange
					required
				PrmReceivableCompany
					required
			Instance Selection
				where (CreateDate date within PrmCreateDateRange
				and	   Company = PrmReceivableCompany)
	
			Action Rules
				Instance Rules
					invoke Purge

