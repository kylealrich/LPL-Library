StudentActivityClosedPeriod is a BusinessClass
    owned by studentactivities
    prefix is SACP

    Ontology
    	symbolic key is StudentActivityClosedPeriod

 	Patterns
 		implements DynamicCreation

    Persistent Fields
		StudentActivityDistrict
		CloseDate				is Date

	Transient Fields
		TransactionCurrencyCode			is a Currency
			derive value from DerivedCurrency

	Derived Fields
		DerivedCurrency is a DerivedField
			type is like Currency
			return StudentActivityDistrict.AccountingEntity.FunctionalCurrency

		AssetActivityBalance is a DerivedField
			type is like InternationalAmount
			return (sum AssetActivityBalanceRel.PeriodEndingBalance)

		LiabilityActivityBalance is a DerivedField
			type is like InternationalAmount
			return (sum LiabilityActivityBalanceRel.PeriodEndingBalance)

		RevenueActivityBalance is a DerivedField
			type is like InternationalAmount
			return (sum RevenueActivityBalanceRel.PeriodEndingBalance)
			
		ClosedPeriodDisplay is a LabelField
			"Period:<StudentActivityClosedPeriod>"
			
		PeriodEndDateDisplay is a LabelField
			"PeriodEndDate:<StudentActivityClosedPeriod.GeneralLedgerCalendarPeriod.Date>"
			
		CloseDateDisplay is a LabelField
			"CloseDate:<CloseDate>"


	Sets
					

	Relations
		AssetActivityBalanceRel is a StudentActivityBalance set
			Instance Selection
				where (related.StudentActivityAccount.StudentActivityType.Asset)
				
		LiabilityActivityBalanceRel is a StudentActivityBalance set
			Instance Selection
				where (related.StudentActivityAccount.StudentActivityType.Liability)
				
		RevenueActivityBalanceRel is a StudentActivityBalance set
			Instance Selection
				where (related.StudentActivityAccount.StudentActivityType.Revenue)

		StudentActivityBalanceDetailRel
			one-to-many relation to StudentActivityBalanceDetail
			Field Mapping uses ByActivityType
				related.StudentActivityDistrict		= StudentActivityDistrict
				related.StudentActivityClosedPeriod	= StudentActivityClosedPeriod

		AssetActivityBalanceDetailRel
			one-to-many relation to StudentActivityBalanceDetail
			Field Mapping uses ByActivityType
				related.StudentActivityDistrict		= StudentActivityDistrict
				related.StudentActivityClosedPeriod	= StudentActivityClosedPeriod
				related.StudentActivityType			= 1
				 				
		LiabilityActivityBalanceDetailRel
			one-to-many relation to StudentActivityBalanceDetail
			Field Mapping uses ByActivityType
				related.StudentActivityDistrict		= StudentActivityDistrict
				related.StudentActivityClosedPeriod	= StudentActivityClosedPeriod
				related.StudentActivityType			= 2

		RevenueActivityBalanceDetailRel
			one-to-many relation to StudentActivityBalanceDetail
			Field Mapping uses ByActivityType
				related.StudentActivityDistrict		= StudentActivityDistrict
				related.StudentActivityClosedPeriod	= StudentActivityClosedPeriod
				related.StudentActivityType			= 3

		StudentActivityAccountRel
			one-to-many relation to StudentActivityAccount
			Field Mapping uses symbolic key
				related.StudentActivityDistrict		= StudentActivityDistrict


	Conditions

	Field Rules
		CloseDate	
			default to current corporate date
		
	Actions
  		DeleteIfNoDetailsExist is an Instance Action
  			restricted
  			Action Rules
  				if (!StudentActivityBalance set exists)
  					invoke Delete
		
		Create is a Create Action
			restricted
										
		Update is an Update Action
			restricted
			
		Delete is a Delete Action
			restricted							
