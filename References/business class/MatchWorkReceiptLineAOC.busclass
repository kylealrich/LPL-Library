MatchWorkReceiptLineAOC is a BusinessClass
    owned by ma
    prefix is MWREC

    Ontology
        symbolic key is MatchWorkReceiptLineAOC

    Patterns

        disable AuditIndex
        disable Auditing
        disable EffectiveDated
      	disable DataTranslations

    Persistent Fields

        Vendor
        Item
		ItemType
        MatchDetailKey
        MatchAmount						is an InternationalAmount
        MatchedQuantity					is like Quantity
        UnmatchedQuantity				is like Quantity
        ChargebackQuantity				is like Quantity
        MatchUnitCost					is like UnitCost
        OpenToMatch						is an InternationalAmount
		Selected						is Boolean
        PayablesInvoice
		MatchObjectID					is an ObjId
		MatchSequence					is a SeqNbr
		MatchSub						is Numeric 3
        MiscellaneousAddOnChargeInvoicedAmount 	is an InternationalAmount
        ReceivedQuantityToMatch        	is like Quantity
        ReceivedAmountToMatch          	is an InternationalAmount
		OriginalUnitCost				is like UnitCost
		UnmatchedAmount					is an InternationalAmount     
		TotalAddOnCharge				is an InternationalAmount
		ReceivedQuantity				is an InternationalAmount   
		ReceivedDate					is Date
		OpenToMatchQuantity				is like Quantity
		VendorPriceUOMQuantity			is like Quantity
		LastRecord						is Boolean
		TaxCode
		Status							is Numeric 1
		Closed
		SortNumber					is Numeric 1	
		MatchReconQueueSet

	Derived Fields
		DerivedExtendedMatchAmount is a DerivedField
			type is like InternationalCost
			if (UnmatchedQuantity entered)
				return (UnmatchedQuantity * MatchUnitCost)
			else
			if (PurchaseOrderReceiptLineAOCRel.MiscellaneousAddOnChargeInvoicedAmount entered)
				return PurchaseOrderReceiptLineAOCRel.MiscellaneousAddOnChargeInvoicedAmount
			else
				return PurchaseOrderReceiptLineAOCRel.DerivedOpenToMatchExtendedCost

		DerivedQuantity is a DerivedField
			type is like InternationalCost
			if (UnmatchedQuantity entered)
				return UnmatchedQuantity
			else
			if (PurchaseOrderLine not entered)
				return 1
    
		DerivedItemType is a DerivedField
			type is Alpha 1
			if (ItemType.Inventoried)
				return "I"
			else
			if (ItemType.NonStock)
				return "N"
			else
			if (ItemType.Special)
				return "X"
			else
			if (ItemType.Service)
				return "S"

	Relations
		MatchWorkReceiptRel
			one-to-one relation to MatchWorkReceipt
			Field Mapping uses symbolic key
                related.Company                 	= Company
				related.MatchWork					= MatchWork
				related.PurchaseOrderReceipt		= PurchaseOrderReceipt

		PurchaseOrderReceiptLineAOCRel
			one-to-one relation to PurchaseOrderReceiptLineAOC
			Field Mapping uses symbolic key
				related.Company						= Company
				related.PurchaseOrderReceipt		= PurchaseOrderReceipt
				related.PurchaseOrderReceiptLine	= PurchaseOrderReceiptLine
				related.AddOnCharge					= AddOnCharge

		PurchaseOrderAndLineAddOnChargeRel
			one-to-one relation to PurchaseOrderAndLineAddOnCharge
			Field Mapping uses symbolic key
				related.Company						= Company
				related.PurchaseOrder				= PurchaseOrder
				related.PurchaseOrderLine			= PurchaseOrderLine
				related.AddOnCharge					= AddOnCharge

	Sets
		ByVendorMatchDetailKey
            indexed
            Sort Order
            	MatchWork
				Company
				Vendor
				ItemType
				MatchDetailKey
				AddOnCharge
				PurchaseOrder
				PurchaseOrderLine
				PurchaseOrderReceipt
				PurchaseOrderReceiptLine

		ByPurchaseOrderReceipt
            indexed
            Sort Order
            	MatchWork
				Company
				PurchaseOrder
				PurchaseOrderReceipt
				PurchaseOrderLine
				PurchaseOrderReceiptLine
				AddOnCharge		

























	Actions
		Create is a Create Action
			restricted
			Entrance Rules

			Exit Rules









				if (PurchaseOrderLine not entered  
				and MatchWork.PayablesInvoice.CostComponentMatch)
					Selected = true

		Update is an Update Action

		FastUpdate is an Update Action
			bypass field rules

		Delete is a Delete Action
			restricted
			bypass relational integrity rules
		Purge is a Purge Action
			restricted
			bypass relational integrity rules

		SelectRecordForRecon is an Instance Action
			valid when (!Selected)
			default label is "Select"
			Action Rules
				Selected		= true
				PayablesInvoice	= MatchWork.PayablesInvoice

		UnselectRecordForRecon is an Instance Action
			valid when (Selected)
			default label is "Unselect"
			Action Rules
				Selected = false
				initialize PayablesInvoice
				initialize MatchReconQueueSet
