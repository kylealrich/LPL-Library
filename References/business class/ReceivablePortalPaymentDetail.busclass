ReceivablePortalPaymentDetail is a BusinessClass
	owned by ar

	prefix is RPPD

	Ontology
		symbolic key is ReceivablePortalPaymentDetail



	Patterns
		disable AuditIndex
		disable Auditing



	Persistent Fields
		FromReceivableCompany
		ReceivableInvoiceDetailType
		Invoice
		Description
		PaymentSeq						is a Sequence
		Customer
		PortalRequestedAppliedAmount	is an InternationalAmount
			default label is "Amount"
		CreateDate						is TimeStamp	


	Field Rules
		CreateDate
			default to current timestamp


	Transient Fields
		TransientDaysSinceCreated is AlphaRight size 4	
			default label is "DaysSinceCreated"
			derive value from DerivedDaysSinceCreated




	Derived Fields









		PortalListTitleWithTotal is a LabelField
			restricted
			"Invoice_Detail_Selected_For_Payment"

		DerivedPortalListTitle		is a DerivedField
			type is MessageField

			return PortalListTitleWithTotal

		DaysSinceCreatedCalculation is a ComputeField	
			type is Numeric size 4
			restricted
			(current corporate date - CreateDate)

		DerivedDaysSinceCreated is a DerivedField	
			type is AlphaRight size 4
			default label is "DaysSinceCreated"
			if (DaysSinceCreatedCalculation < 1)
				return "0"
			else
				return DaysSinceCreatedCalculation


	Sets

		Set2
			indexed
			Sort Order
				ReceivablePortalPaymentHeader
				Customer
				FromReceivableCompany
				ReceivableInvoiceDetailType
				Invoice
				PaymentSeq

		Set3
			indexed
			Sort Order
				FromReceivableCompany
				ReceivableInvoiceDetailType
				Invoice
				PaymentSeq
				CustomerGroup
				CustomerRepresentative
				CustomerRepresentativeContact
				ReceivablePortalPaymentHeader
				ReceivablePortalPaymentDetail

		ByCreateDate
			indexed
			Sort Order
				CreateDate	
				FromReceivableCompany
				ReceivableInvoiceDetailType
				Invoice
				PaymentSeq
				CustomerGroup
				CustomerRepresentative
				CustomerRepresentativeContact
				ReceivablePortalPaymentHeader
				ReceivablePortalPaymentDetail



	Relations

		ReceivableInvoiceDetailRel	
			one-to-one relation to ReceivableInvoiceDetail

			Field Mapping uses symbolic key
				related.Company														 =	FromReceivableCompany
				related.ReceivableInvoiceDetail.ReceivableInvoiceDetailType			 =	ReceivableInvoiceDetailType
				related.ReceivableInvoiceDetail.Invoice								 =	Invoice
				related.ReceivableInvoiceDetail.PaymentSeq							 =	PaymentSeq



	Actions

		Create is a Create Action
			Action Rules




		Update is an Update Action
			Action Rules


		Delete is a Delete Action
			Action Rules

		DeleteIdlePortalPaymentSelected is an Instance Action	
			Action Rules
				invoke InitializeOrphanedPortalPaymentSelectedRecords ReceivableInvoiceDetailRel
				if (!ReceivablePortalPaymentHeader.MultipleReceivablePortalPaymentDetailRelExist)
					invoke InitializeReceivablePortalPaymentHeader CustomerRepresentativeContact
					invoke Delete CustomerRepresentativeContact.ReceivablePortalPaymentHeaderRel
				else
					invoke Delete 

