ContractTierMemberQualifierPurchasesPiePiece is a BusinessClass
	owned by po
	prefix is CTMPP
	sql name is ContractTierMbrQualPiePiece

	Ontology
		symbolic key is ContractTierMemberQualifierPurchasesPiePiece

	Patterns
		implements DynamicCreation
		
	Persistent Fields
		PurchasesIndicator			is Numeric 1
			States
				ProgressTowardsNextTier		value is 1
				AmountOrPercentYetToGo		value is 2
		PurchasePercent				is Percent 5.2
		PurchaseAmount				is an InternationalAmount
				
	Derived Fields
		AmountProgressMessage is a MessageField
			restricted
			"AmountAttained_=<PurchaseAmount>"
		PercentProgressMessage is a MessageField
			restricted
			"%Attained_=<PurchasePercent>OfPurchases"
		AllPurchasesMessage is a MessageField
			restricted
			"_OfAllPurchasesInTheProductSet"
		AmountYetToGoMessage is a MessageField
			restricted
			"AmountToGo_=<PurchaseAmount>"
		PercentYetToGoMessage is a MessageField
			restricted
			"%ToGo_=<PurchasePercent>OfPurchases"
		PiePieceElementName is a DerivedField
			type is Text
			if (PurchasesIndicator.ProgressTowardsNextTier)
				if (ContractTierQualifier.PurchasePercentQualifier)
					if (PurchasePercent		>= ContractTierQualifier.PurchaseAmtPct.PurchasePercent)
						return NextTierAchievedPercent
					else
						return PercentProgressMessage
				else
					if (PurchaseAmount		>= ContractTierQualifier.PurchaseAmtPct.PurchaseAmount)
						return NextTierAchievedAmount
					else
						return AmountProgressMessage
			else
				if (ContractTierQualifier.PurchasePercentQualifier)
					return PercentYetToGoMessage
				else
					return AmountYetToGoMessage
			
		TagOnMessage is a ConditionalField
			type is Text
			restricted
			if (ContractTierQualifier.PurchasePercentQualifier)
				AllPurchasesMessage
			else
				blank
					 					
		NextTierProgressStillNeeded is a MessageField
			restricted
			"NextTierProgressChart"
			
		NextTierAchievedPercent is a MessageField
			restricted
			"YouHaveReachedTheNextTier!_=<PurchasePercent>OfAllPurchases"
			
		NextTierAchievedAmount is a MessageField
			restricted
			"YouHaveReachedTheNextTier!_=<PurchaseAmount>"
			
		PieChartTitle is a DerivedField
			type is Text
			if (ContractTierQualifier.NextTierHasBeenReached)
				if (ContractTierQualifier.PurchasePercentQualifier)
					return NextTierAchievedPercent
				else
					return NextTierAchievedAmount 
			else
				return NextTierProgressStillNeeded
			
	Field Rules
	
	Actions
		Create is a Create Action
		
		Purge is a Purge Action

