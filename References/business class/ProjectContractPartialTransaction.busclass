ProjectContractPartialTransaction is a BusinessClass
	sql name is "ProjConPartTrans"
    owned by Projects
    prefix is PCPTN

    Ontology
    	part of ProjectContract
    		relative key is SequenceNumber
    		
	Patterns
		disable Auditing

    Persistent Fields
    	GLTransactionDetail
    	RecordType			is Numeric size 1
    		States
    			Bill		value is 0
    			Revenue		value is 1
		Hold				is Boolean

	Derived Fields
		TotalBilledAmount is a DerivedField
			type is like InternationalAmount
				precision is ProjectContract.Currency.NumberOfDecimals
			if (RecordType.Bill)
				return sum GLTransactionDetail.ProjectContractInvoiceBillRel.Amount
			else
				return sum GLTransactionDetail.ProjectContractInvoiceRevenueRel.Amount
		TotalBilledBillableAmount is a DerivedField
			type is like InternationalAmount
				precision is ProjectContract.Currency.NumberOfDecimals
			if (RecordType.Bill)
				return sum GLTransactionDetail.ProjectContractInvoiceBillRel.BillableAmount
			else
				return sum GLTransactionDetail.ProjectContractInvoiceRevenueRel.BillableAmount
		TotalFees is a DerivedField
			type is like InternationalAmount
				precision is ProjectContract.Currency.NumberOfDecimals
			if (RecordType.Bill)
				return sum GLTransactionDetail.ProjectContractInvoiceBillFeesRel.Amount
			else
				return sum GLTransactionDetail.ProjectContractInvoiceRevenueFeesRel.Amount
		TotalBilledUnits is a DerivedField
			type is like UnitsAmount
			if (RecordType.Bill)
				return sum GLTransactionDetail.ProjectContractInvoiceBillRel.UnitsAmount
			else
				return sum GLTransactionDetail.ProjectContractInvoiceRevenueRel.UnitsAmount
			
    Conditions
		UnheldBill
			restricted
			when (RecordType.Bill
			and  !Hold)
			
    Relations
				
    Sets

    Field Rules
    	SequenceNumber
    		autosequence
    			minimize contention

	Actions
		Create is a Create Action
			restricted
		Delete is a Delete Action
			restricted
		Update is an Update Action
			restricted
		Purge is a Purge Action
			restricted
		RemoveHold is an Instance Action
			valid when (Hold)
			Action Rules
				Hold = false
		PutOnHold is an Instance Action
			valid when (!Hold)
			Action Rules
				Hold = true

				
				
