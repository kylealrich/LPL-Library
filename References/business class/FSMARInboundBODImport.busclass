FSMARInboundBODImport is a BusinessClass
	owned by integration
	prefix is FSMAR
	
	Ontology
		symbolic key is FSMARInboundBODImport

	Patterns
		implements InlineUserFields
			size is 1000
        implements StaticJava
        disable AuditIndex
	
	Context Fields
		FSMInboundBODTracker
	
	Persistent Fields
	
	Field Rules
				
	Local Fields
		NewReceivableInvoice  			is a ReceivableInvoice view
		NewBODTracker  					is a FSMInboundBODTracker view		
        LikeInboundTracker				is like FSMInboundBODTracker
        LocalConfigurationParameter		is Alpha size up to 200
		LocalDescription				is Alpha size up to 60
		LocalAccount 					is AlphaUpper 26
		LocalInvoiceCurrency			is AlphaUpper size 5
		LocalCreditDebitMemoReason		is AlphaUpper size 4
		LocalProcessLevel				is AlphaUpper size 5
		LocalInvoiceType				is AlphaUpper size 1
		LocalCustomerGroup				is AlphaUpper size 5
		LocalAccountingEntity			is AlphaUpper size 40
		LocalInvoice					is AlphaUpper size 22
		LocalTermsCode					is AlphaUpper size 10			
		LocalAccountingUnit				is AlphaUpper size 25
		LocalFinanceDimension1      	is AlphaUpper size 15	
		LocalFinanceDimension2      	is AlphaUpper size 15
		LocalFinanceDimension3      	is AlphaUpper size 15		
		LocalFinanceDimension4      	is AlphaUpper size 15
		LocalFinanceDimension5      	is AlphaUpper size 15		
		LocalFinanceDimension6      	is AlphaUpper size 15
		LocalFinanceDimension7      	is AlphaUpper size 15		
		LocalFinanceDimension8      	is AlphaUpper size 15
		LocalFinanceDimension9      	is AlphaUpper size 15		
		LocalFinanceDimension10     	is AlphaUpper size 15
		LocalCodeValue					is AlphaUpper size 25
		LocalProject					is AlphaUpper size 25
		LocalReceivableCrossReference 	is AlphaUpper size 22
		LocalRGeneralLedgerCode 		is AlphaUpper size 10
		LocalCustomerPurchaseOrder		is AlphaUpper size 22
		LocalLedger						is AlphaUpper size 20
		LocalTransactionUserField1		is AlphaUpper size 10
		LocalCertificationNumber		is AlphaUpper size 40
		LocalCertificationDateAlpha		is Alpha 40
		LocalCertificationDate			is Alpha 40
		LocalNameValue					is Alpha 100
		LocalConfirmBOD					is Alpha 20
		LocalInterfacedCustomer     	is Alpha 20
		LocalGeneralLedgerDate			is Alpha 20
		ActionCode						is Alpha 9  
		LocalInvoiceTypeAlpha			is Alpha 20
		LocalErrorMessage 				is Alpha 300
        ErrorMessage      				is Alpha 300
        LocalFromLogicalID				is Alpha 40
        LocalComponentID				is Alpha 40
        LocalCodeListID     			is Alpha 40
        LocalInvoiceDateAlpha			is Alpha 20
        LocalBODID						is Alpha 100
        LocalTaskID						is Alpha 100
        LocalReferenceID				is Alpha 100
        LocalConfirmationCode 			is Alpha 100
        LocalAuthorizationID 			is Alpha 100
        LocalDocumentID					is Alpha 100
        LocalLocation					is Alpha 20
        LocalInvoiceDate				is Alpha 25
        LocalGLDateAlpha				is Alpha 25
        LocalDueDateAlpha				is Alpha 25
        LocalDueDate					is Alpha 25
        LocalBatchNumberAlpha			is Alpha 20
        LocalCustomerPO					is Alpha 22
        LocalCountry					is Alpha 40
        LocalAddressCode				is Alpha 40
        LocalIntegrationApplication		is Alpha 40
        LocalStatus						is Numeric size 1
        LocalSalesRepresentative		is Numeric size 4
        LocalCustomer					is Numeric size 9
		LocalBatchNumber				is Numeric size 6
		LocalBillTo						is Numeric size 9
		LocalCompany					is Numeric 4
		LocalUserAreaCount          	is Numeric 9
		LocalIterator 					is Numeric 9
		LocalDistCount              	is Numeric 9
        LocalFSMInboundBODTracker		is Numeric 15
        LocalVariationID				is Alpha 100
		LocalCustomerAlpha				is Numeric 9
		LocalLoop						is Numeric 9
       	LocalDistCodeCount  			is Numeric 9
		LocalTrackerID					is Numeric 9
		LocalICustomer  				is Numeric 9
		LocalBillingInvoice				is Numeric 10
		LocalTransactionAmount			is Decimal 19.3
		LocalInvoiceAmount				is Decimal 19.3
		LocalEmptyProjectAmount			is Decimal 19.3
		LocalEmptyAmount				is Decimal 19.3
		LocalProjectAmount				is Decimal 19.3
		LocalLineAmount					is Decimal 19.3
		LocalCurrencyRate				is Decimal 31.15
		Error             				is Boolean
		ProjectCheck					is Boolean
		LocalPInvoiceXML 				is XMLDocument
        LocalBODXML						is XMLDocument
        LocalMainUserTemplate			is Alpha size 250
        LocalInStatus					is Alpha 40
        LocalInvoiceHold				is Alpha 40
        LocalBillToID					is Alpha 40
        LocalFolioAuthorizationCode		is Text
		LocalOutputFileType				is Alpha 40

        NewAsset						is a Asset view
        LocalAssetProject				is Alpha 20
        LocalFinanceEnterpriseGroup		is Alpha 50
        LocalAsset						is Numeric size 15
        LocalSIAssetMasterXML			is XMLDocument
        LocalAssetTemplate				is AlphaUpper size 25
        LocalAssetCurreny				is AlphaUpper size 5
        LocalAssetType					is AlphaUpper size 10
        LocalAssetCategory				is AlphaUpper size 1
        LocalAssetAccountGroup			is AlphaUpper size 10
        LocalAssetAccountingUnitGroup	is AlphaUpper size 10
        LocalAssetDescription			is Alpha 60
        LocalAssetReference				is Alpha 40
        LocalItemTotalBaseCost			is Decimal size 19.3
        LocalAssetLocation				is AlphaUpper size 15
        LocalAssetBook					is AlphaUpper size 10
        LocalAssetMethod				is AlphaUpper size 10
        LocalDeprecialtionCategory		is Boolean
        LocalServiceDate				is Alpha 25
        LocalServiceDateAlpha			is Alpha 20
        LocalTransactionItemCost		is Decimal size 19.3
        LocalItemQuantity				is Numeric size 10
        LocalPurchaseDate				is Alpha 25
        LocalPurchaseDateAlpha			is Alpha 20
        LocalItemNumber					is AlphaUpper size 25
        LocalInvoiceandPurchaseOrder	is Numeric 12
        LocalModelNumber				is AlphaUpper size 30
        LocalSerialNumber				is AlphaUpper size 30
        LocalActionCode					is Alpha 10
        LocalOriginalCreateDateTime		is Alpha 70
        LocalItemTotalTransactionCost	is Decimal 19.3
        LocalGenericDelimiter			is Alpha 9
        LocalCodeLeng					is Numeric 4
		LocalListID						is Alpha 20

		LocalCustomerName					is Alpha 120
		LocalCustomerContactName			is Alpha 20
		LocalCustomerCountryCode			is Alpha 3
		LocalCustomerDeliveryAddressLine1 	is Alpha 40
		LocalCustomerDeliveryAddressLine2 	is Alpha 40
		LocalCustomerDeliveryAddressLine3 	is Alpha 40
		LocalCustomerDeliveryAddressLine4 	is Alpha 40
		LocalCrossAccountingEntity		  	is Alpha 60
		LocalCustomerStateProvinance		is Alpha 3
		LocalCustomerCity					is Alpha 58
		LocalCustomerPostalCode				is Alpha 12
		LocalCustomerPhoneNumber			is Alpha 15
		LocalCustomerURLAddress				is URL
		LocalCustomerEmail 					is an EmailAddressMulti 
			holds pii
		LocalActive							is Alpha 1
		Locallid							is Alpha 300
		LocalCommunicationLength			is Numeric 10
		LocalContactCommunicationLength		is Numeric 10
		LocalChannelCode					is Alpha 60
		LocalUseCode						is Alpha 60
		LocalDialNumber						is Alpha 60
		LocalURI							is Alpha 60
		LocalStatusCode						is Alpha 60
		LocalCustomerAE						is Alpha 12
		LocalCustomerPartyAE				is Alpha 60
		NewCustomer							is a Customer view
		LocalReceivableCode					is Alpha 10  
		LocalCreditLimit					is Decimal 15
		LocalContactPhonePrefix     		is Alpha 6
		LocalContactPhoneExtension 		is Alpha 10
		LocalContactFaxNumber				is Alpha 15
		LocalContactFaxExtension			is Alpha 10
		LocalContactPhoneNumber				is Alpha 15
		LocalContactEmail					is an EmailAddressMulti 
			holds pii
		LocalPCustomerPartyMasterXML 		is XMLDocument 

		NewCompanyCustomerContact			is a CompanyCustomerContact view
		LocalNameValue1						is Alpha 100
		LocalNameValue2						is Alpha 100
		LocalNameValue3						is Alpha 100	
		LocalCCContactCode					is Alpha 50
		LocalHeaderAccountingEntity			is AlphaUpper size 12
		LocalEmployerReferenceLength		is Numeric 10 
		LocalCustomerPhonePrefix     		is Alpha 6
		LocalCustomerPhoneExtension 		is Alpha 10
		LocalCustomerFaxNumber				is Alpha 15
		LocalCustomerFaxExtension			is Alpha 10
		LocalExtension 						is Alpha 10
		LocalCountryDialing					is Alpha 15
		LocalPContactMasterXML				is XMLDocument      
        LocalSystem							is Alpha 20
        LocalAccountingDate					is Alpha 40
        LocalBankTransactionCode			is Alpha 10

		LocalCustomerPartyID				is Alpha size 30
        LocalTermCode						is Alpha 40
        LocalTaxExempt						is Alpha 40
        LocalSalRep     					is Alpha 40
        LocalCarrier						is Alpha 20
        LocalTaxID							is Alpha 20
        NewCustomerShipTo					is a CustomerShipTo view
        LocalCustomerShipTo					is Numeric 4
		LocalPShipToPartyMasterXML          is XMLDocument 
		LocalCustomerPartyReference			is Alpha size 30
		LocalCustomerShipToStatus			is Alpha 20
		LocalTaxExemptCode					is AlphaUpper 1


        LocalItem							is AlphaUpper 32
        LocalCustomerOrder					is Numeric 12	
        LocalRelease						is Alpha 5
        LocalOrderType						is AlphaUpper 2
        LocalCustomerShipToID				is Alpha 30
        LocalCurrency  						is AlphaUpper 5
        LocalCustomerBillToID				is Alpha 30
        LocalLineCount						is Numeric 9
        NewCustomerOrder					is a CustomerOrder view
        LocalQuantity						is Alpha 13
        LocalUOM							is AlphaUpper 4
        LocalEnteredPrice					is Alpha 21
        LocalUnitCost						is Alpha 21
        LocalPriceOverrideIndicator 		is Alpha 10
        LocalItemDescription				is Alpha 60
        LocalItemID							is AlphaUpper 50
        LocalItemType						is AlphaUpper 1
        LocalInventoryTracked				is Boolean
        LocalCustomerBillTo					is Numeric 4
        LocalProcessSalesOrderXML			is XMLDocument
        LocalReference						is Alpha 100
        LocalCustomerOrderLineNum			is Numeric 6
        LocalCORStatus						is Numeric 1


		NewCustomerBillTo					is a CustomerBillTo view
		LocalOriginalApplicationArea		is XMLDocument

       	
	Derived Fields
#ifdef module glif
#ifdef module ar		
		ProcessInvoiceConfirmBODXML is a DerivedField
			type is XMLDocument
			restricted
			ProcessInvoiceConfirmBODXML = template.IONProcessInvoice_ConfirmBOD_ST document for this instance
		
		ProcessInvoiceAcknowledgeBODXML is a DerivedField
			type is XMLDocument
			restricted
			ProcessInvoiceAcknowledgeBODXML = template.IONProcessInvoice_AcknowledgeBOD_ST document for this instance
		
		DerivedTrackerID is a DerivedField
			type is Numeric 15
			restricted
			return LocalTrackerID
		
		DerivedGenericDelimiter is a DerivedField
			type is Alpha size 9
			restricted
			LocalConfigurationParameter = "Generic_Delimiter"
			if (FSMBODConfigurationParameterRel exists)
				return FSMBODConfigurationParameterRel.Value
		
		DerivedTenantID is a DerivedField
			type is Alpha size 60
			restricted
			LocalConfigurationParameter = "tenantID"
			if (FSMBODConfigurationParameterRel exists)
				return FSMBODConfigurationParameterRel.Value
		
		DerivedReleaseID is a DerivedField
			type is Alpha size 60
			restricted
			LocalConfigurationParameter = "releaseID"
			if (FSMBODConfigurationParameterRel exists)
				return FSMBODConfigurationParameterRel.Value
		
		DerivedLogicalID is a DerivedField
			type is Alpha size 60
			restricted
			LocalConfigurationParameter = "logicalID"
			if (FSMBODConfigurationParameterRel exists)
				return FSMBODConfigurationParameterRel.Value
		
		DerivedVersionID is a DerivedField
			type is Alpha size 60
			restricted
			LocalConfigurationParameter = "VersionID"
			if (FSMBODConfigurationParameterRel exists)
				return FSMBODConfigurationParameterRel.Value
		
		DeriverdIntegrationApplication is a DerivedField
			type is Alpha size 20
			restricted
			LocalConfigurationParameter = "IntegrationApplication"
			if (FSMBODConfigurationParameterRel exists)
				return FSMBODConfigurationParameterRel.Value
		
		DerivedBODCurrentTimeStamp is a DerivedField
			type is TimeStamp
			DerivedBODCurrentTimeStamp = system current timestamp
			return DerivedBODCurrentTimeStamp
		
		DerivedAlphaCurrentTimeStamp is a DerivedField
			type is Alpha size 20
			return DerivedBODCurrentTimeStamp			
		
		DerivedBODFormattedCurrentTimeStamp is a DerivedField
			type is Alpha size 25
			return DerivedAlphaCurrentTimeStamp[1:4] + "-" + DerivedAlphaCurrentTimeStamp[5:6] + "-" + DerivedAlphaCurrentTimeStamp[7:8] + "T" + DerivedAlphaCurrentTimeStamp[9:10] + ":" + DerivedAlphaCurrentTimeStamp[11:12] + ":" + DerivedAlphaCurrentTimeStamp[13:14] + "Z"
		
		DerivedFromLogicalID is a DerivedField
			type is Alpha 40
			restricted
			return LocalFromLogicalID
		
		DerivedComponentID is a DerivedField
			type is Alpha 40
			restricted
			return LocalComponentID
		
		DerivedBODID is a DerivedField
			type is Alpha 100
			restricted
			return LocalBODID
			
		DerivedConfigDocID is a DerivedField
			type is Alpha size 2
			restricted
			LocalConfigurationParameter = "RequiredCleanDocumentID"
			if (FSMBODConfigurationParameterRel exists)
				return FSMBODConfigurationParameterRel.Value
		
		DerivedConfigFEG is a DerivedField
			type is Alpha size 2
			restricted
			LocalConfigurationParameter = "IsMultipleFEG"
			if (FSMBODConfigurationParameterRel exists)
				return FSMBODConfigurationParameterRel.Value
		
		DerivedCompany is a DerivedField
			type is Alpha 22
			restricted
			return LocalAccountingEntity
		
		DerivedLocation is a DerivedField
			type is Alpha 20
			restricted
			return LocalLocation
		
		DerivedInvoice is a DerivedField
			type is AlphaUpper 22
			restricted
			return LocalInvoice
		
		DerivedTaskID is a DerivedField
			type is Alpha 100
			restricted
			return LocalTaskID
		
		DerivedReferenceID is a DerivedField
			type is Alpha 100
			restricted
			return LocalReferenceID
		
		DerivedConfirmationCode is a DerivedField
			type is Alpha 100
			restricted
			return LocalConfirmationCode
		
		DerivedAuthorizationID is a DerivedField
			type is Alpha 100
			restricted
			return LocalAuthorizationID
		
		DerivedPIConfirmBODID is a DerivedField
			type is Alpha 300
			restricted
			return "infor-nid:"+DerivedTenantID+":"+DerivedCompany+":"+DerivedLocation+":"+DerivedInvoice+":"+"?BOD&verb=Confirm&TrackerID="+ DerivedTrackerID
		
		DerivedPIACKBODID is a DerivedField
			type is Alpha 300
			restricted
			return "infor-nid:"+DerivedTenantID+":"+DerivedCompany+":"+DerivedLocation+":"+DerivedInvoice+":"+"?Invoice&verb=Ack&TrackerID="+ DerivedTrackerID
		
		DerivedPIErrorMessage is a DerivedField
			type is Alpha 300
			restricted
			return LocalErrorMessage
		
		DerivedPIOriginalBODMsg is a DerivedField
			type is XMLDocument
			restricted
			return LocalPInvoiceXML
		
		DerivedAckResponse is a DerivedField
			type is Alpha 20
			restricted
			if(LocalConfirmBOD = "true")
				return "Rejected"
			else
				return "Accepted"			
		
		DerivedListID is a DerivedField
			type is Alpha 22
			restricted
			if(LocalConfirmBOD = "true")
				return "Error"
			else
				return "Success"
		
		DerivedReasonCode is a DerivedField
			type is Alpha 20
			restricted
			if(LocalConfirmBOD = "true")
				return "Application_Error"
			else
				return "Application_Success"		
		
		DerivedPIErrorMsgDescription is a DerivedField
			type is Alpha 300
			restricted
			return	"Failed message," + "Message: "+ DerivedPIErrorMessage +",TrackerID= "+ DerivedTrackerID
		
		DerivedPIReturnMessage is a DerivedField
			type is Alpha 300
			restricted
			if(LocalConfirmBOD = "true")
				return "Error processing Invoice- " + DerivedPIErrorMessage
			else
				return LocalErrorMessage
	
		NativeBillingInvoice is a NativeField
			type is Alpha 100
			restricted	
		
		DerivedBLInvoiceNumber is a DerivedField
			type is Alpha size 25
			restricted
			DerivedBLInvoiceNumber = LocalInvoice[3:12]

		DerivedBillingInvoiceNumber is a DerivedField
			type is Alpha size 25
			restricted
			if(DerivedBLInvoiceNumber[1:7] = "0000000")
				return DerivedBLInvoiceNumber[8]
			else
			if(DerivedBLInvoiceNumber[1:6] = "000000")
				return DerivedBLInvoiceNumber[7:8]
			else
			if(DerivedBLInvoiceNumber[1:5] = "00000")
				return DerivedBLInvoiceNumber[6:8]	
			else
			if(DerivedBLInvoiceNumber[1:4] = "0000")
				return DerivedBLInvoiceNumber[5:8]
			else
			if(DerivedBLInvoiceNumber[1:3] = "000")
				return DerivedBLInvoiceNumber[4:8]
			else
			if(DerivedBLInvoiceNumber[1:2] = "00")
				return DerivedBLInvoiceNumber[3:8]
			else
			if(DerivedBLInvoiceNumber[1] = "0")
				return DerivedBLInvoiceNumber[2:8]
			else
				return DerivedBLInvoiceNumber
		
		DerivedBillingInvoicePrefix is a DerivedField
			type is Alpha size 25
			restricted
			return LocalInvoice[1:2]
				

		NativeFinanceEnterpriseGroup is a NativeField
			type is Alpha 100
			restricted	
			
		NativeAssetProject		is a NativeField
			type is Alpha 100
			restricted
			
		DerivedSIMErrorMessage is a DerivedField
			type is Alpha 300
			return LocalErrorMessage
					
		DerivedSIMReturnMessage is a DerivedField
			type is Alpha 300
			restricted
			if(LocalConfirmBOD = "true")
				return "Error processing AssetMaster- " + DerivedSIMErrorMessage + ":"+ "TrackerID="+ LocalTrackerID
			else
				return DerivedSIMReturnMessage	
				
		DerivedAssetMasterBODID		is a DerivedField
			type is Alpha 300
			restricted
			return "infor-nid:"+ DerivedTenantID + ":" +LocalAccountingEntity+ ":" +LocalCompany +":" + "?BOD&verb=Confirm&&TrackerID="+ LocalTrackerID 
	
		DerivedAssetMasterConfirmBODID is a DerivedField
			type is Alpha 300
			restricted
			return "infor-nid:" + DerivedTenantID + ":" +LocalAccountingEntity + ":" + LocalDocumentID + ":" +"?BOD&verb=Confirm&&TrackerID="+ LocalTrackerID 
			
		SyncAssetMasterConfirmBODXML is a DerivedField
			type is XMLDocument
			restricted
			SyncAssetMasterConfirmBODXML = template.IONSyncAssetMaster_ConfirmBOD_ST document for this instance
		
		DerivedAdjustmentDate is a DerivedField
			type is Date
			restricted
			return DerivedBODCurrentTimeStamp date


		DerivedDefaultCompany is a DerivedField
			type is Numeric 4
			restricted
			LocalConfigurationParameter = "CRMTOCSF_Inbound_Default_Company"
			if (FSMBODConfigurationParameterRel exists)
				return FSMBODConfigurationParameterRel.Value
			
		NativeCustomer	is a NativeField
			type is Alpha size 40
			restricted
			
		DerivedPCustomerPartyConfirmBODID is a DerivedField
			type is Alpha 300
			restricted
			return "infor-nid:"+DerivedTenantID+":"+LocalAccountingEntity+":"+"?CustomerPartyMaster&verb=Confirm&TrackerID="+ DerivedTrackerID
			
		DerivedPCustErrorMsgDescription is a DerivedField
			type is Alpha 300
			restricted
			return	"Failed message," + "Message: "+ LocalErrorMessage +",TrackerID= "+ DerivedTrackerID
		
		DerivedPCustomerPartyAckBODID is a DerivedField
			type is Alpha 300
			restricted
			return "infor-nid:" + DerivedTenantID +":" +LocalAccountingEntity + ":" +LocalCustomer+  ":" +"?CustomerPartyMaster&verb=Ack&TrackerID="+ LocalTrackerID
		
		DerivedPCustAckID is a DerivedField
			type is Alpha 100
			restricted
			if(DerivedConfigDocID = "Y")
				return LocalCustomer
			else
			if(LocalCompany entered and LocalCustomer entered)
				return LocalCompany	+ DerivedGenericDelimiter + LocalCustomer
			else
				return ""
			
		DerivedPCustReturnMessage is a DerivedField
			type is Alpha 300
			restricted
			if(LocalConfirmBOD = "true")
				return "Error processing ProcessCustomerParty- " + LocalErrorMessage + ", For BOD TrackerID - " + LocalTrackerID
			else
				return LocalErrorMessage	
				
		ProcessCustomerPartyMasterConfirmBODXML is a DerivedField
			type is XMLDocument
			restricted
			ProcessCustomerPartyMasterConfirmBODXML = template.IONProcessCustomerPartyMaster_ConfirmBOD_ST document for this instance
			
		ProcessCustomerPartyAcknowledgeBODXML is a DerivedField
			type is XMLDocument
			restricted
			ProcessCustomerPartyAcknowledgeBODXML = template.IONProcessCustomerPartyMaster_AcknowledgeBOD_ST document for this instance


		NativeContactCode	is a NativeField
			type is Alpha size 40
			restricted
		
		DerivedPContactMasterConfirmBODID is a DerivedField
			type is Alpha 300
			restricted
			return "infor-nid:"+DerivedTenantID+":"+LocalAccountingEntity+":"+LocalCustomer+":?ContactMaster&verb=Confirm&TrackerID="+ DerivedTrackerID
			
		DerivedPContactMasterErrorMsgDescription is a DerivedField
			type is Alpha 300
			restricted
			return	"Failed message," + "Message: "+ LocalErrorMessage +",TrackerID= "+ DerivedTrackerID
		
		DerivedPContactMasterAckBODID is a DerivedField
			type is Alpha 300
			restricted
			return "infor-nid:" + DerivedTenantID +":" +LocalAccountingEntity + ":" +DerivedPContactMasterAckID+  ":" +"?ContactMaster&verb=Ack&TrackerID="+ LocalTrackerID
		
		DerivedPContactMasterAckID is a DerivedField
			type is Alpha 100
			restricted
			if(DerivedConfigDocID = "Y" and LocalCustomer entered and LocalCCContactCode entered)
				return LocalCustomer + DerivedGenericDelimiter + LocalCCContactCode
			else
				if(LocalCompany entered and LocalCustomer entered and LocalCCContactCode entered)
					return LocalCompany	+ DerivedGenericDelimiter + LocalCustomer + DerivedGenericDelimiter + LocalCCContactCode
				else
					return ""
			
		DerivedPContactMasterReturnMessage is a DerivedField
			type is Alpha 300
			restricted
			if(LocalConfirmBOD = "true")
				return "Error processing ProcessContactMaster- " + LocalErrorMessage
			else
				return LocalErrorMessage	
				
		ProcessContactMasterConfirmBODXML is a DerivedField
			type is XMLDocument
			restricted
			ProcessContactMasterConfirmBODXML = template.IONProcessContactMaster_ConfirmBOD_ST document for this instance
			
		ProcessContactMasterAcknowledgeBODXML is a DerivedField
			type is XMLDocument
			restricted
			ProcessContactMasterAcknowledgeBODXML = template.IONProcessContactMaster_AcknowledgeBOD_ST document for this instance


		NativeCompany is a NativeField
			type is Alpha 100
			restricted	
		
		NativeSICustomerBillTo is a NativeField
			type is Alpha size 60
			restricted	
			
		DerivedBatchNumber is a DerivedField
			type is Alpha size 40
			restricted
			LocalConfigurationParameter = "SyncInvoice_Inbound_BatchNumber"
			if (FSMBODConfigurationParameterRel exists)
				return FSMBODConfigurationParameterRel.Value
		
		DerivedSystem is a DerivedField
			type is Alpha size 40
			restricted
			LocalConfigurationParameter = "SyncInvoice_Inbound_System"
			if (FSMBODConfigurationParameterRel exists)
				return FSMBODConfigurationParameterRel.Value
		
		DerivedRunGroup is a DerivedField
			type is Alpha size 25
			return DerivedAlphaCurrentTimeStamp[7:8] + DerivedAlphaCurrentTimeStamp[5:6] + DerivedAlphaCurrentTimeStamp[1:4] + DerivedAlphaCurrentTimeStamp[9:10]
		
		DerivedSIConfirmBODID is a DerivedField
			type is Alpha 300
			restricted
			return "infor-nid:"+DerivedTenantID+":"+LocalAccountingEntity+":"+DerivedLocation+":"+LocalInvoice+":"+"?BOD&verb=Confirm&TrackerID="+ DerivedTrackerID
		
		DerivedSIErrorMsgDescription is a DerivedField
			type is Alpha 300
			restricted
			return	"Failed message," + "Message: "+ LocalErrorMessage +",TrackerID= "+ DerivedTrackerID
		
		SyncInvoiceConfirmBODXML is a DerivedField
			type is XMLDocument
			restricted
			SyncInvoiceConfirmBODXML = template.IONSyncInvoice_ConfirmBOD_ST document for this instance


		NativeCustomerParty	is a NativeField
			type is Alpha size 40
			restricted

		NativeCustomerShipTo is a NativeField
			type is Alpha size 40
			restricted	
		
		DerivedPCShipToAckdocumentId is a DerivedField
			type is Alpha 60
			restricted
			if(DerivedConfigDocID = "Y" and LocalCustomerShipTo entered and LocalCustomer entered)
				return LocalCustomer + DerivedGenericDelimiter + LocalCustomerShipTo
			else
				if(LocalCustomerShipTo entered and LocalCompany entered and LocalCustomer entered)
					return LocalCompany + DerivedGenericDelimiter + LocalCustomer + DerivedGenericDelimiter + LocalCustomerShipTo
				else
					return ""
				
		DerivedProcessShipToPartyMasterAckBODID is a DerivedField
			type is Alpha 300
			restricted 
			return "infor-nid:" + DerivedTenantID +":" +LocalAccountingEntity + ":" +DerivedPCShipToAckdocumentId+  ":" +"?ShipToPartyMaster&verb=Ack&TrackerID="+ LocalTrackerID

		DerivedPCShipToReturnMessage is a DerivedField
			type is Alpha 300
			restricted
			if(LocalConfirmBOD = "true")
				return "Error processing ProcessShipToPartyMaster- " + LocalErrorMessage + ":"+ "TrackerID="+ LocalTrackerID
			else
				return LocalErrorMessage
	
		DerivedProcessCShipTOMConfirmBODID is a DerivedField
			type is Alpha 300
			restricted
			return "infor-nid:"+DerivedTenantID+":"+LocalAccountingEntity + ":" + LocalCustomer +":"+"?BOD&verb=Confirm&TrackerID="+ LocalTrackerID

		ProcessShipToPartyMasterConfirmBODXML is a DerivedField
			type is XMLDocument
			restricted
			ProcessShipToPartyMasterConfirmBODXML = template.IONProcessShipToPartyMaster_ConfirmBOD_ST document for this instance
		
		ProcessShipToPartyMasterAcknowledgeBODXML is a DerivedField
			type is XMLDocument
			restricted
			ProcessShipToPartyMasterAcknowledgeBODXML = template.IONProcessShipToPartyMaster_AcknowledgeBOD_ST document for this instance


		NativeCustomerBillTo is a NativeField
			type is Alpha size 60
			restricted	
			
		NativeItem is a NativeField
			type is Alpha size 60
			restricted	
			
		Derivedlocation is a DerivedField
			type is Alpha 300
			restricted
			if(DerivedConfigDocID = "Y")
				return LocalLocation
			else
				return LocalCompany + DerivedGenericDelimiter + LocalLocation

		DerivedPSalesOrderAckdocumentID is a DerivedField
			type is Alpha 60
			restricted
			if(DerivedConfigDocID = "Y" and LocalCustomerOrder entered and LocalCompany entered)			
				return LocalCompany + DerivedGenericDelimiter + LocalDocumentID
			else
				return ""
				
		DerivedSalesOrderAckBODID is a DerivedField
			type is Alpha 300
			restricted
			return "infor-nid:" + DerivedTenantID + ":" + LocalCustomerAE + ":" + Derivedlocation + ":" + DerivedPSalesOrderAckdocumentID + ":" +"?BOD&verb=Ack&LocalTrackerID=" + LocalTrackerID

		DerivedPSalesOrderReturnMessage is a DerivedField
			type is Alpha 300
			restricted
			if(LocalConfirmBOD = "true")
				return "Error processing ProcessSalesOrder" +", "+"Record Key:"+ "-" + LocalCustomer +", "+"Message:"+ LocalErrorMessage + ", "+ "LocalTrackerID:" + LocalTrackerID
			else
				return LocalErrorMessage
				
		DerivedProcessSalesOrderMConfirmBODID is a DerivedField
			type is Alpha 300
			restricted
			return "infor-nid:" + DerivedTenantID + ":" +LocalCustomerAE + ":" + LocalLocation + ":" + ":" +"?BOD&verb=Confirm&LocalTrackerID=" + DerivedTrackerID

		ProcessSalesOrderAcknowledgeBODXML is a DerivedField
			type is XMLDocument
			restricted
			ProcessSalesOrderAcknowledgeBODXML = template.IONProcessSalesOrder_AcknowledgeBOD_ST document for this instance

		ProcessSalesOrderConfirmBODXML is a DerivedField
			type is XMLDocument
			restricted
			ProcessSalesOrderConfirmBODXML = template.IONProcessSalesOrder_ConfirmBOD_ST document for this instance
			
		DerivedDefaultReleaseFlag is a DerivedField
			type is Alpha size 9
			restricted
			LocalConfigurationParameter = "ProcessSalesOrder_In_Release"
			if (FSMBODConfigurationParameterRel exists)
				return FSMBODConfigurationParameterRel.Value

		DerivedDefaultOrderType is a DerivedField
			type is Alpha size 20
			restricted
			LocalConfigurationParameter = "ProcessSalesOrder_In_OrderType"
			if (FSMBODConfigurationParameterRel exists)
				return FSMBODConfigurationParameterRel.Value	
		
		NativeReferenceID is a NativeField
			type is Alpha size 60
			restricted	
		
		NativeCustomerSalesShipTo  is a NativeField
			type is Alpha size 40
			restricted
		


		DerivedBillToPartyMasterConfirmBODID is a DerivedField
			type is Alpha 300
			restricted
			return "infor-nid:" + DerivedTenantID + ":" +LocalAccountingEntity + ":" + LocalCustomer + ":?BillToPartyMaster&verb=Confirm&LocalTrackerID=" + DerivedTrackerID

		DerivedBillToPartyMasterAckBODID is a DerivedField
			type is Alpha 300
			restricted
			return "infor-nid:" + DerivedTenantID + ":" +LocalAccountingEntity + ":" + DerivedBillToPMasterAckID + ":?BillToPartyMaster&verb=Ack&LocalTrackerID=" + DerivedTrackerID

		ProcessBillToPartyMasterAcknowledgeBODXML is a DerivedField
			type is XMLDocument
			restricted
			ProcessBillToPartyMasterAcknowledgeBODXML = template.IONProcessBillToPartyMaster_AcknowledgeBOD_ST document for this instance

		ProcessBillToPartyMasterConfirmBODXML is a DerivedField
			type is XMLDocument
			restricted
			ProcessBillToPartyMasterConfirmBODXML = template.IONProcessBillToPartyMaster_ConfirmBOD_ST document for this instance

		DerivedBillToPMasterReturnMessage is a DerivedField
			type is Alpha 300
			restricted
			if(LocalConfirmBOD = "true")
				return "Error Processing ProcessBillToPartyMaster - " + LocalErrorMessage + ", "+ "LocalTrackerID:" + LocalTrackerID
			else
				return LocalErrorMessage

		DerivedBillToPMasterAckID is a DerivedField
			type is Alpha 100
			restricted
			if(DerivedConfigDocID = "Y" and LocalCustomer entered and LocalCustomerBillToID entered)
				return LocalCustomer + DerivedGenericDelimiter + LocalCustomerBillToID
			else
			if(LocalCompany entered and LocalCustomer entered and LocalCustomerBillToID entered)
				return LocalCompany	+ DerivedGenericDelimiter + LocalCustomer + DerivedGenericDelimiter + LocalCustomerBillToID
			else
				return ""


	Relations
		GeneralLedgerCompanyRel
			one-to-one relation to GeneralLedgerCompany
			Field Mapping uses symbolic key
				related.Company							= LocalCompany

		ReceivableInvoiceRel
			one-to-one relation to ReceivableInvoice
			Field Mapping uses symbolic key
				related.Company					 		=	LocalCompany
				related.ReceivableInvoiceType	 		=	LocalInvoiceType
				related.ReceivableInvoice		 		=	LocalInvoice
		
		ReceivableInvoiceLineItemRel
			one-to-many relation to ReceivableInvoiceLineItem
            Field Mapping uses symbolic key
                related.Company							= LocalCompany 
                related.ReceivableInvoiceType			= LocalInvoiceType               
				related.ReceivableInvoice				= LocalInvoice
			Instance Selection			
				where (related.Project					= LocalProject)
		
		InterfacedCustomerRel
            one-to-one relation to CustomerMappingTableInterface
            Field Mapping uses ByInterfacedCustomer
            	related.CustomerGroup					= LocalCustomerGroup
            	related.InterfacedCustomer				= LocalInterfacedCustomer
		
		FSMInboundBODTrackerRel
            one-to-one relation to FSMInboundBODTracker
            Field Mapping uses symbolic key
                related.FSMInboundBODTracker			= LocalFSMInboundBODTracker                
		
		FSMBODConfigurationParameterRel
        	one-to-one relation to FSMBODConfigurationParameter
			Field Mapping uses symbolic key
            	related.FSMBODConfigurationParameter 		= LocalConfigurationParameter
            	
		FSMBODConfigurationRel
        	one-to-one relation to FSMBODConfiguration
			Field Mapping uses symbolic key
            	related.FSMBODConfiguration.Verb 		= 2
            	related.FSMBODConfiguration.Noun 		= "Invoice"
            	related.FSMBODConfiguration.Direction 	= 2
			
		UserTemplateRel
			one-to-many relation to UserTemplate
			Field Mapping uses symbolic key
			Instance Selection
				where (related.UserTemplate   = LocalMainUserTemplate)
		
		AccountingEntityRel
            one-to-one relation to AccountingEntity
            Field Mapping uses symbolic key
            	related.FinanceEnterpriseGroup			= LocalFinanceEnterpriseGroup
            	related.AccountingEntity				= LocalAccountingEntity
            	
        AddressCodeRel
            one-to-one relation to AddressCode
            Field Mapping uses symbolic key
            	related.FinanceEnterpriseGroup			= LocalFinanceEnterpriseGroup
            	related.AddressCode						= LocalAddressCode
            	
        BillingInvoiceRel
			one-to-many relation to BillingInvoice
			Field Mapping uses symbolic key
				related.Company							= LocalAccountingEntity
				related.BillingInvoice.InvoicePrefix	= DerivedBillingInvoicePrefix
				related.BillingInvoice.InvoiceNumber	= LocalBillingInvoice
            	

		FSMBODConfigurationAssetMasterRel
        	one-to-one relation to FSMBODConfiguration
			Field Mapping uses symbolic key
            	related.FSMBODConfiguration.Verb 		= 1
            	related.FSMBODConfiguration.Noun 		= "AssetMaster"
            	related.FSMBODConfiguration.Direction 	= 2
				
		AssetTemplateRel
			one-to-many relation to AssetTemplate
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup = LocalFinanceEnterpriseGroup
			Instance Selection
				where (related.DepreciationExpenseProject.Project = LocalAssetProject)	
		AssetRel
			one-to-one relation to Asset
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup	= LocalFinanceEnterpriseGroup
				related.Asset					= LocalAsset
				
		AssetBookRel
			one-to-many relation to AssetBook
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup	= LocalFinanceEnterpriseGroup
				related.Asset					= LocalAsset
				
		AssetReferenceRel
			one-to-many relation to Asset
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup 	= LocalFinanceEnterpriseGroup
			Instance Selection
				where (related.Company 			= LocalCompany
				and related.Reference1 			= LocalAssetReference)
		
		AssetItemRel
			one-to-many relation to AssetItem
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup 	= LocalFinanceEnterpriseGroup
				related.Asset					= LocalAsset

		FSMBODConfigurationCustomerPartyMasterRel
        	one-to-one relation to FSMBODConfiguration
			Field Mapping uses symbolic key
            	related.FSMBODConfiguration.Verb 		= 2
            	related.FSMBODConfiguration.Noun 		= "CustomerPartyMaster"
            	related.FSMBODConfiguration.Direction 	= 2
				
		FSMBODConfigurationContactMasterRel
        	one-to-one relation to FSMBODConfiguration
			Field Mapping uses symbolic key
            	related.FSMBODConfiguration.Verb 		= 2
            	related.FSMBODConfiguration.Noun 		= "ContactMaster"
            	related.FSMBODConfiguration.Direction 	= 2
				
		FSMBODCrossReferenceDetailRel
			one-to-many relation to FSMBODCrossReferenceDetail
			Field Mapping uses symbolic key
            	related.FSMBODCrossReference.SourceField 		= "SourceAccountingEntity"
            	related.FSMBODCrossReference.DestinationField 	= "DestinationAccountingEntity"
            Instance Selection
				where (related.SourceValue	= LocalAccountingEntity)
				
		FSMBODCrossReferenceCompanyDetailRel
			one-to-many relation to FSMBODCrossReferenceDetail
			Field Mapping uses symbolic key
            	related.FSMBODCrossReference.SourceField 		= "SourceAccountingEntity"
            	related.FSMBODCrossReference.DestinationField 	= "DestinationCompany"
            Instance Selection
				where (related.SourceValue	= LocalCrossAccountingEntity)
		
		ReceivableDefaultCodeRel
			one-to-many relation to ReceivableDefaultCode
			Field Mapping uses symbolic key
				related.Company		= LocalCompany
		
		CustomerRel
			one-to-one relation to Customer
			Field Mapping uses symbolic key
				related.CustomerGroup = LocalCustomerGroup
				related.Customer 	  = LocalCustomer
		
		CompanyCustomerRel
			one-to-one relation to CompanyCustomer
			Field Mapping uses symbolic key
				related.Company 	= LocalCompany
				related.Customer    = LocalCustomer
				
		CompanyCustomerContactRel
			one-to-one relation to CompanyCustomerContact
			Field Mapping uses symbolic key
				related.Company 			   = LocalCompany
				related.Customer 			   = LocalCustomer
				related.CompanyCustomerContact = LocalCCContactCode


		FSMBODConfigurationSyncInvoiceRel
        	one-to-one relation to FSMBODConfiguration
			Field Mapping uses symbolic key
            	related.FSMBODConfiguration.Verb 		= 1
            	related.FSMBODConfiguration.Noun 		= "Invoice"
            	related.FSMBODConfiguration.Direction 	= 2


		FSMBODConfigurationProcessShipToPartyMasterRel
        	one-to-one relation to FSMBODConfiguration
			Field Mapping uses symbolic key
            	related.FSMBODConfiguration.Verb 		= 2
            	related.FSMBODConfiguration.Noun 		= "ShipToPartyMaster"
            	related.FSMBODConfiguration.Direction 	= 2

    	CustomerShipToRel
			one-to-one relation to CustomerShipTo
			Field Mapping uses symbolic key
				related.Company				= LocalCompany
				related.Customer			= LocalCustomer
				related.CustomerShipTo		= LocalCustomerShipTo
				
		FSMBODCleanDocIDRel
			one-to-many relation to FSMBODCrossReferenceDetail
			Field Mapping uses symbolic key
            	related.FSMBODCrossReference.SourceField 		= "DESTAE"
            	related.FSMBODCrossReference.DestinationField 	= "CSFGLC"
            Instance Selection
				where (related.SourceValue	= LocalAccountingEntity)


		FSMBODCrossReferenceLocationDetailRel
			one-to-many relation to FSMBODCrossReferenceDetail
			Field Mapping uses symbolic key
            	related.FSMBODCrossReference.SourceField 		= "SourceCompany"
            	related.FSMBODCrossReference.DestinationField 	= "DestinationLocation"
            Instance Selection
				where (related.SourceValue	= LocalCompany)
				
		FSMBODCrossReferenceProcessDetailRel
			one-to-many relation to FSMBODCrossReferenceDetail
			Field Mapping uses symbolic key
            	related.FSMBODCrossReference.SourceField 		= "SourceCompany"
            	related.FSMBODCrossReference.DestinationField 	= "DestinationProcessLevel"
            Instance Selection
				where (related.SourceValue	= LocalCompany)
				
		FSMBODConfigurationProcessSalesOrderRel
        	one-to-one relation to FSMBODConfiguration
			Field Mapping uses symbolic key
            	related.FSMBODConfiguration.Verb 		= 2
            	related.FSMBODConfiguration.Noun 		= "SalesOrder"
            	related.FSMBODConfiguration.Direction 	= 2
				
		ItemLocationRel
			one-to-one relation to ItemLocation
			Field Mapping uses symbolic key
				related.Company				=	LocalCompany
				related.InventoryLocation	=	LocalLocation
				related.Item				= 	LocalItem

		CustomerOrderRel
			one-to-one relation to CustomerOrder
			Field Mapping uses symbolic key
				related.Company				=	LocalCompany
				related.CustomerOrder		= 	LocalCustomerOrder
		
		CustomerOrderRelation
			one-to-many relation to CustomerOrder
			Field Mapping uses symbolic key
				related.Company				=	LocalCompany
			Instance Selection
				where (related.Reference1   = 	LocalReferenceID )
		
		UpdateCustomerOrderRel
			one-to-one relation to CustomerOrder
			Field Mapping uses symbolic key
				related.Company				=	LocalCompany
				related.CustomerOrder		= 	LocalReferenceID

		CustomerOrderLineRel
			one-to-one relation to CustomerOrderLine
			Field Mapping uses symbolic key
				related.Company						= LocalCompany
				related.CustomerOrder				= LocalCustomerOrder
				related.CustomerOrderLine			= LocalCustomerOrderLineNum


		FSMBODConfigurationProcessBillToPartyMasterRel
			one-to-one relation to FSMBODConfiguration
			Field Mapping uses symbolic key
				related.FSMBODConfiguration.Verb 		= 2
				related.FSMBODConfiguration.Noun 		= "BillToPartyMaster"
				related.FSMBODConfiguration.Direction 	= 2

		CustomerBillToRel
			one-to-one relation to CustomerBillTo
			Field Mapping uses symbolic key
				related.CustomerGroup		= LocalCustomerGroup
				related.Customer			= LocalCustomer
				related.CustomerBillTo		= LocalCustomerBillToID


	Actions
		
		Create is a Create Action
			restricted
		
		Update is an Update Action
			restricted
		
		Delete is a Delete Action				
			restricted


		ProcessInvoiceBODImport is an Import Action
			restricted
			bod type is Process.Invoice			
			Parameters
				InvoiceBOD 					is XMLDocument
			Action Rules
				LocalBODXML					= InvoiceBOD
				LocalCompany				= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID/@accountingEntity"
				LocalAccountingEntity		= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID/@accountingEntity"
				LocalInvoice				= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID"
				LocalProcessLevel			= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID/@location"
				LocalBillTo					= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/BillToParty/PartyIDs/ID"
				LocalCustomerAlpha			= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/CustomerParty/PartyIDs/ID"
				LocalVariationID			= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID/@variationID"
				LocalInvoiceTypeAlpha		= InvoiceBOD select "//DataArea/Invoice/@type"
				LocalBODID					= InvoiceBOD select "//ApplicationArea/BODID"
				LocalInvoiceType			= LocalInvoiceTypeAlpha[0:1]
				LocalUserAreaCount 			= InvoiceBOD select "count (//DataArea/Invoice/InvoiceHeader/UserArea/Property)"
				LocalStatus					= ReceivableInvoiceRel.Status
				LocalCustomerGroup			= GeneralLedgerCompanyRel.CustomerBusinessGroup
				
				LocalIterator = 1
				while (LocalUserAreaCount >= LocalIterator)					
					LocalNameValue = InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/UserArea/Property[<LocalIterator>]/NameValue/@name"
					if(LocalNameValue = "InterfacedCustomer")
						LocalInterfacedCustomer 	= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/UserArea/Property[<LocalIterator>]/NameValue"														
					LocalIterator = LocalIterator + 1
				
				if (InterfacedCustomerRel exists)
					LocalICustomer = InterfacedCustomerRel.Customer
				
				if(LocalBillTo entered)
					LocalCustomer	= LocalBillTo
				else
					LocalCustomer	= LocalCustomerAlpha
				
				if (LocalICustomer entered)
					LocalCustomer	= LocalICustomer
				
				if(FSMBODConfigurationRel exists and FSMBODConfigurationRel.Enable)
					if(FSMInboundBODTracker not entered)
						invoke Create FSMInboundBODTracker
							assign result to NewBODTracker
							invoked.Verb 						= 2
							invoked.Noun 						= "Invoice"	
							invoked.Direction					= 2				
							invoked.Company						= LocalCompany
							invoked.Customer					= LocalCustomer
							invoked.Invoice						= LocalInvoice
							invoked.BODAccountingEntity			= LocalAccountingEntity
							invoked.BODDocumentID				= LocalInvoice
							invoked.BODVariationID				= LocalVariationID
							invoked.BODLocation					= LocalProcessLevel
							invoked.BODID						= LocalBODID
							invoked.Status						= 1
							invoked.StartDate					= system current timestamp
							invoked.BODXML						= LocalBODXML
							initialize invoked.Error			
							initialize invoked.ErrorMessage					
						LocalFSMInboundBODTracker 				= NewBODTracker.FSMInboundBODTracker
					else
						LocalFSMInboundBODTracker 				= FSMInboundBODTracker
						invoke Update FSMInboundBODTrackerRel
							invoked.Company						= LocalCompany
							invoked.Customer					= LocalCustomer
							invoked.Invoice						= LocalInvoice
							invoked.BODAccountingEntity			= LocalAccountingEntity
							invoked.BODDocumentID				= LocalInvoice
							invoked.BODVariationID				= LocalVariationID
							invoked.BODLocation					= LocalProcessLevel
							invoked.BODID						= LocalBODID
							invoked.Status						= 1
							invoked.StartDate					= system current timestamp
							invoked.BODXML						= LocalBODXML
							initialize invoked.Error			
							initialize invoked.ErrorMessage					
					
					if(DeriverdIntegrationApplication = "Local.ly")
						invoke UpdateBillingInvoice
							invoked.InvoiceBOD      		= InvoiceBOD
		               		invoked.PrmInboundTracker 		= LocalFSMInboundBODTracker
					else
					if(ReceivableInvoiceRel not exists)
						invoke CreateReceivableInvoice	                
		               		invoked.InvoiceBOD      		= InvoiceBOD
		               		invoked.PrmInboundTracker 		= LocalFSMInboundBODTracker
		               		invoked.PrmInvoiceType			= LocalInvoiceType
		               		invoked.PrmCustomer				= LocalCustomer
	          		
	          		if(ReceivableInvoiceRel exists and LocalStatus = 1 and DeriverdIntegrationApplication != "Local.ly")	
	          			invoke Update FSMInboundBODTrackerRel
							invoked.Error 					= true
							invoked.ErrorMessage 			= "Invoice Already Exists"
							invoked.Status					= 2
							invoked.CloseDate				= system current timestamp
						invoke SendPIConfirmBOD
							invoked.PrmErrorMessage 		= "Invoice Already Exists"
							invoked.InvoiceBOD      		= InvoiceBOD
							invoked.PrmTrackerID			= LocalFSMInboundBODTracker
						invoke SendPIACKBOD
                    		invoked.PrmErrorMessage 		= "Invoice Already Exists"
                    		invoked.InvoiceBOD     			= InvoiceBOD
                    		invoked.PrmTrackerID			= LocalFSMInboundBODTracker
          		else 
				if(FSMInboundBODTracker not entered)
					invoke Create FSMInboundBODTracker
						assign result to NewBODTracker
						invoked.Verb 						= 2
						invoked.Noun 						= "Invoice"
						invoked.Direction					= 2					
						invoked.Company						= LocalCompany
						invoked.Customer					= LocalCustomer
						invoked.Invoice						= LocalInvoice
						invoked.BODAccountingEntity			= LocalAccountingEntity
						invoked.BODDocumentID				= LocalInvoice
						invoked.BODVariationID				= LocalVariationID
						invoked.BODLocation					= LocalProcessLevel
						invoked.BODID						= LocalBODID
						invoked.Status						= 4
						invoked.StartDate					= system current timestamp
						invoked.CloseDate					= system current timestamp
						invoked.BODXML						= LocalBODXML
						invoked.Error						= true			
						invoked.ErrorMessage				= "Process Invoice Inbound BOD Service is not Enabled"
					LocalFSMInboundBODTracker 				= NewBODTracker.FSMInboundBODTracker
				else
					LocalFSMInboundBODTracker 				= FSMInboundBODTracker
					invoke Update FSMInboundBODTrackerRel
						invoked.Company						= LocalCompany
						invoked.Customer					= LocalCustomer
						invoked.Invoice						= LocalInvoice
						invoked.BODAccountingEntity			= LocalAccountingEntity
						invoked.BODDocumentID				= LocalInvoice
						invoked.BODVariationID				= LocalVariationID
						invoked.BODLocation					= LocalProcessLevel
						invoked.BODID						= LocalBODID
						invoked.Status						= 4
						invoked.StartDate					= system current timestamp
						invoked.CloseDate					= system current timestamp
						invoked.BODXML						= LocalBODXML
						invoked.Error						= true			
						invoked.ErrorMessage				= "Process Invoice Inbound BOD Service is not Enabled"
						
		CreateReceivableInvoice is an Import Action
			restricted			
			Parameters
				InvoiceBOD 						is XMLDocument
				PrmInboundTracker  				is like FSMInboundBODTracker
				PrmCustomer						is Numeric 9
				PrmInvoiceType					is AlphaUpper 1 
			Action Rules
				LocalFSMInboundBODTracker 		= PrmInboundTracker
				LocalBatchNumberAlpha			= current date
				LocalBatchNumber				= LocalBatchNumberAlpha[7:8] + LocalBatchNumberAlpha[5:6] 
				LocalCustomer					= PrmCustomer
				LocalInvoiceType				= PrmInvoiceType
				LocalCompany					= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID/@accountingEntity"
				LocalInvoice					= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID"
				LocalProcessLevel				= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID/@location"
				LocalInvoiceDateAlpha			= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentDateTime"
				LocalInvoiceDate 				= LocalInvoiceDateAlpha[1:4] + LocalInvoiceDateAlpha[6:7] + LocalInvoiceDateAlpha[9:10]	
				LocalDueDateAlpha				= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/PaymentTerm/Term/DueDateTime"	
				LocalDueDate					= LocalDueDateAlpha[1:4] + LocalDueDateAlpha[6:7] + LocalDueDateAlpha[9:10]		
				LocalInvoiceCurrency			= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/TotalAmount/@currencyID"
				LocalInvoiceAmount				= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/TotalAmount"
				LocalDescription				= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/Description"
				LocalCurrencyRate				= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/CurrencyExchangeRate/RateNumeric"
				LocalTermsCode					= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/PaymentTerm/Term/ID"
				LocalReceivableCrossReference	= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentReference/DocumentID/ID"
				LocalSalesRepresentative		= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/SupplierParty/SalesContact/ID"
				LocalTransactionUserField1		= ""	
				LocalCustomerPO					= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/AlternateDocumentID/ID/@schemeName"
				LocalUserAreaCount 				= InvoiceBOD select "count (//DataArea/Invoice/InvoiceHeader/UserArea/Property)"	
				LocalDistCount   				= InvoiceBOD select "count (//DataArea/Invoice/InvoiceHeader/Distribution)"
				
				if(LocalCustomerPO entered)
					if(LocalCustomerPO != "Customer")
						LocalCustomerPurchaseOrder 	= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/PurchaseOrderReference/DocumentID/ID"
					else
						LocalCustomerPurchaseOrder 	= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/AlternateDocumentID/ID"
				
				LocalIterator = 1
				while (LocalUserAreaCount >= LocalIterator)					
					LocalNameValue = InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/UserArea/Property[<LocalIterator>]/NameValue/@name"
					if(LocalNameValue = "GeneralLedgerDate")
						LocalGLDateAlpha 	= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/UserArea/Property[<LocalIterator>]/NameValue"														
						LocalGeneralLedgerDate			= LocalGLDateAlpha[1:4] + LocalGLDateAlpha[6:7] + LocalGLDateAlpha[9:10]		
					else 
					if(LocalNameValue = "ReceivableGeneralLedgerCode")
						LocalRGeneralLedgerCode = InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/UserArea/Property[<LocalIterator>]/NameValue"
					else
					if(LocalNameValue = "InterfacedCustomer")
						LocalInterfacedCustomer = InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/UserArea/Property[<LocalIterator>]/NameValue"
					else
					if(LocalNameValue = "CreditDebitMemoReason")									
						LocalCreditDebitMemoReason = InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/UserArea/Property[<LocalIterator>]/NameValue"
					else
					if(LocalNameValue = "CertificationNumber")									
						LocalCertificationNumber = InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/UserArea/Property[<LocalIterator>]/NameValue"
					else
					if(LocalNameValue = "CertificationDate")									
						LocalCertificationDateAlpha = InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/UserArea/Property[<LocalIterator>]/NameValue"
						LocalCertificationDate		= LocalCertificationDateAlpha[1:4] + LocalCertificationDateAlpha[6:7] + LocalCertificationDateAlpha[9:10]
					LocalIterator = LocalIterator + 1	
				
				if(LocalGeneralLedgerDate entered)
					LocalGeneralLedgerDate			= LocalGeneralLedgerDate
				else
					LocalGeneralLedgerDate			= LocalInvoiceDate
				
				invoke Create ReceivableInvoice
					assign result to NewReceivableInvoice
					resume on error
                   		Error             										= true
                        ErrorMessage     										= error message
					invoked.Company         									= LocalCompany
	                invoked.BatchNumber 										= LocalBatchNumber
					invoked.ReceivableInvoice									= LocalInvoice
					invoked.Customer											= LocalCustomer
					invoked.ReceivableProcessLevel    							= LocalProcessLevel
					invoked.ReceivableInvoiceType								= LocalInvoiceType
					invoked.TransactionDate										= LocalInvoiceDate
					invoked.GeneralLedgerDate									= LocalGeneralLedgerDate 
					invoked.OriginalCurrency 									= LocalInvoiceCurrency
					invoked.InvoiceAmount.CurrencyAmount 						= LocalInvoiceAmount
					invoked.Description											= LocalDescription
					invoked.DueDate												= LocalDueDate
					invoked.Origin												= "B"
					invoked.TermsCode											= LocalTermsCode
					invoked.CreditDebitMemoReason								= LocalCreditDebitMemoReason
					invoked.ReceivableGeneralLedgerCode							= LocalRGeneralLedgerCode
					invoked.CustomerPurchaseOrder								= LocalCustomerPurchaseOrder
					invoked.SalesRepresentative									= LocalSalesRepresentative
					invoked.TransactionUserField1								= LocalTransactionUserField1
					invoked.TransientSignedTransactionAmount					= LocalInvoiceAmount
					invoked.ReceivableCrossReference.ReceivableInvoice			= LocalReceivableCrossReference
					invoked.InvoiceAmount.FunctionalAmount.EnteredCurrencyRate	= LocalCurrencyRate
					invoked.CertificationNumber									= LocalCertificationNumber
					invoked.CertificationDate									= LocalCertificationDate
				if(Error)
					invoke Update FSMInboundBODTrackerRel
						invoked.Error 						= Error
						invoked.ErrorMessage 				= ErrorMessage
						invoked.Status						= 2
						invoked.CloseDate					= system current timestamp
					invoke SendPIConfirmBOD
						invoked.PrmErrorMessage 			= ErrorMessage
						invoked.InvoiceBOD      			= InvoiceBOD
						invoked.PrmTrackerID				= LocalFSMInboundBODTracker
					invoke SendPIACKBOD
                        invoked.PrmErrorMessage 			= ErrorMessage
                        invoked.InvoiceBOD      			= InvoiceBOD
                        invoked.PrmTrackerID				= LocalFSMInboundBODTracker
                else        
					if (LocalDistCount > 0)				
						invoke CreateReceivableGLDistribution	                
	                		invoked.InvoiceBOD      				= InvoiceBOD
	                		invoked.PrmInboundTracker 				= LocalFSMInboundBODTracker
	                		invoked.PrmGeneralLedgerDate 			= LocalGeneralLedgerDate
	                		invoked.PrmBatchNumber					= LocalBatchNumber
	                		invoked.PrmCustomer						= LocalCustomer
	                		invoked.PrmInvoiceType					= LocalInvoiceType
					
					if(!FSMInboundBODTrackerRel.Error)
						invoke ReleaseReceivableInvoice
							invoked.InvoiceBOD      				= InvoiceBOD
							invoked.PrmInboundTracker 				= LocalFSMInboundBODTracker
							invoked.PrmReceivableInvoice 			= NewReceivableInvoice.ReceivableInvoice
																	
		CreateReceivableGLDistribution is an Import Action
			restricted			
			Parameters
				InvoiceBOD 							is XMLDocument
				PrmInboundTracker  					is like FSMInboundBODTracker
				PrmGeneralLedgerDate				is Alpha 20	
				PrmBatchNumber						is Numeric 9
				PrmCustomer							is Numeric 9
				PrmInvoiceType						is AlphaUpper 1	
			Local Fields
				LocalLine							is XMLDocument		
			Action Rules
				LocalInvoiceType					= PrmInvoiceType
				LocalCustomer						= PrmCustomer
				LocalBatchNumber					= PrmBatchNumber
				LocalGeneralLedgerDate				= PrmGeneralLedgerDate
				LocalFSMInboundBODTracker 			= PrmInboundTracker
				LocalCompany						= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID/@accountingEntity"
				LocalInvoice						= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID"
				LocalInvoiceCurrency				= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/TotalAmount/@currencyID"
				LocalProcessLevel					= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID/@location"
				LocalInvoiceCurrency				= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/TotalAmount/@currencyID"
				LocalInvoiceDateAlpha				= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentDateTime"
				LocalInvoiceDate 					= LocalInvoiceDateAlpha[1:4] + LocalInvoiceDateAlpha[6:7] + LocalInvoiceDateAlpha[9:10]
				LocalDistCount   					= InvoiceBOD select "count (//DataArea/Invoice/InvoiceHeader/Distribution)"
				LocalIterator = 1
				while (LocalDistCount >= LocalIterator)
					LocalLine						= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/Distribution[<LocalIterator>]"
					LocalAccountingEntity			= LocalLine select "/Distribution/LedgerID/@accountingEntity"
					LocalAccount					= LocalLine select "/Distribution/GLAccount/GLNominalAccount"
					LocalTransactionAmount			= LocalLine select "/Distribution/Amount"
					LocalProject					= LocalLine select "/Distribution/ProjectReference/ID"
					LocalDescription				= LocalLine select "/Distribution/Classification/Description"
					LocalLedger						= LocalLine select "/Distribution/LedgerID"
					LocalDistCodeCount 				= LocalLine select "count (/Distribution/Classification/Codes/Code)"
					initialize LocalAccountingUnit
					initialize LocalFinanceDimension1		
					initialize LocalFinanceDimension2
					initialize LocalFinanceDimension3		
					initialize LocalFinanceDimension4
					initialize LocalFinanceDimension5		
					initialize LocalFinanceDimension6
					initialize LocalFinanceDimension7		
					initialize LocalFinanceDimension8
					initialize LocalFinanceDimension9		
					initialize LocalFinanceDimension10
					
					LocalLoop = 1			
					while (LocalDistCodeCount >= LocalLoop) 			
						LocalCodeListID	= LocalLine select "/Distribution/Classification/Codes/Code[<LocalLoop>]/@listID"
						LocalCodeValue  = LocalLine select "/Distribution/Classification/Codes/Code[<LocalLoop>]"	
						
						if(LocalCodeListID = "AccountingUnit")
							LocalAccountingUnit	= LocalCodeValue
						else
						if(LocalCodeListID = "FinanceDimension1")
							LocalFinanceDimension1	= LocalCodeValue
						else
						if(LocalCodeListID = "FinanceDimension2")
							LocalFinanceDimension2	= LocalCodeValue
						else
						if(LocalCodeListID = "FinanceDimension3")
							LocalFinanceDimension3	= LocalCodeValue
						else
						if(LocalCodeListID = "FinanceDimension4")
							LocalFinanceDimension4	= LocalCodeValue
						else
						if(LocalCodeListID = "FinanceDimension5")
							LocalFinanceDimension5	= LocalCodeValue
						else
						if(LocalCodeListID = "FinanceDimension6")
							LocalFinanceDimension6	= LocalCodeValue
						else
						if(LocalCodeListID = "FinanceDimension7")
							LocalFinanceDimension7	= LocalCodeValue
						else
						if(LocalCodeListID = "FinanceDimension8")
							LocalFinanceDimension8	= LocalCodeValue
						else
						if(LocalCodeListID = "FinanceDimension9")
							LocalFinanceDimension9	= LocalCodeValue
						else
						if(LocalCodeListID = "FinanceDimension10")
							LocalFinanceDimension10	= LocalCodeValue															
						LocalLoop = LocalLoop + 1
					invoke Create ReceivableGLDistribution
						resume on error
                   			Error           										= true
                        	ErrorMessage    										= error message
						invoked.Invoice												= LocalInvoice
						invoked.BatchNumber											= LocalBatchNumber
	                	invoked.OriginalCurrency 									= LocalInvoiceCurrency
						invoked.TransType											= LocalInvoiceType	
						invoked.GeneralLedgerDate									= LocalGeneralLedgerDate
						invoked.TransactionDate										= LocalInvoiceDate
						invoked.AccumulationType									= "D"		
						invoked.SequenceNumber										= LocalIterator
						invoked.Origin												= "RI"
						invoked.Description											= LocalDescription
						invoked.ReceivableCompanyDataGroup.TransactionCompany		= LocalCompany
						invoked.ReceivableCompanyDataGroup.Customer         		= LocalCustomer
						invoked.ReceivableCompanyDataGroup.ReceivableProcessLevel	= LocalProcessLevel
						invoked.DistributionAmount.CurrencyAmount 					= LocalTransactionAmount
						invoked.GeneralLedgerAccount.Project						= LocalProject
						invoked.GeneralLedgerAccount.Ledger							= LocalLedger
						invoked.GeneralLedgerAccount.ToAccountingEntity 			= LocalAccountingEntity
						invoked.GeneralLedgerAccount.GeneralLedgerChartAccount		= LocalAccount
						invoked.GeneralLedgerAccount.AccountingUnit					= LocalAccountingUnit 
						invoked.GeneralLedgerAccount.FinanceDimension1				= LocalFinanceDimension1
						invoked.GeneralLedgerAccount.FinanceDimension2				= LocalFinanceDimension2
						invoked.GeneralLedgerAccount.FinanceDimension3				= LocalFinanceDimension3
						invoked.GeneralLedgerAccount.FinanceDimension4				= LocalFinanceDimension4
						invoked.GeneralLedgerAccount.FinanceDimension5				= LocalFinanceDimension5
						invoked.GeneralLedgerAccount.FinanceDimension6				= LocalFinanceDimension6
						invoked.GeneralLedgerAccount.FinanceDimension7				= LocalFinanceDimension7
						invoked.GeneralLedgerAccount.FinanceDimension8				= LocalFinanceDimension8
						invoked.GeneralLedgerAccount.FinanceDimension9				= LocalFinanceDimension9
						invoked.GeneralLedgerAccount.FinanceDimension10				= LocalFinanceDimension10					
					if(Error)	
						invoke Update FSMInboundBODTrackerRel
							invoked.Error 						= Error
							invoked.ErrorMessage 				= ErrorMessage
							invoked.Status						= 2
							invoked.CloseDate					= system current timestamp
						invoke SendPIConfirmBOD
							invoked.PrmErrorMessage 			= ErrorMessage
							invoked.InvoiceBOD      			= InvoiceBOD
							invoked.PrmTrackerID				= LocalFSMInboundBODTracker
						invoke SendPIACKBOD
	                        invoked.PrmErrorMessage 			= ErrorMessage
	                        invoked.InvoiceBOD      			= InvoiceBOD
	                        invoked.PrmTrackerID				= LocalFSMInboundBODTracker
						invoke Delete ReceivableInvoiceRel
						LocalIterator = LocalDistCount + 1
					else
						if(LocalProject not entered)
							LocalEmptyAmount			= LocalTransactionAmount
							LocalEmptyProjectAmount 	= LocalEmptyProjectAmount + LocalEmptyAmount
						
						if(LocalProject entered)
							LocalProjectAmount			= LocalTransactionAmount
							ProjectCheck 				= true
							
							if(ReceivableInvoiceLineItemRel not exist)
								invoke	CreateReceivableInvoiceLineItem
									invoked.InvoiceBOD      		= InvoiceBOD
									invoked.PrmInvoiceType			= LocalInvoiceType
									invoked.PrmProjectAmount		= LocalProjectAmount
									invoked.PrmProject				= LocalProject
							else
								if(ReceivableInvoiceLineItemRel exist)
									LocalLineAmount 				= ReceivableInvoiceLineItemRel.TransactionAmount
									LocalProjectAmount 				= LocalProjectAmount + LocalLineAmount
									
									invoke	UpdateReceivableInvoiceLineItem	
										invoked.InvoiceBOD      	= InvoiceBOD
										invoked.PrmInvoiceType		= LocalInvoiceType
										invoked.PrmProjectAmount	= LocalProjectAmount
										invoked.PrmProject			= LocalProject
						
						LocalIterator = LocalIterator + 1			
						if(LocalIterator%20 = 0)
							commit transaction
				
				if(ProjectCheck and !Error)
					invoke	CreateReceivableInvoiceLineItem
						invoked.InvoiceBOD      			= InvoiceBOD
						invoked.PrmInvoiceType				= LocalInvoiceType
						invoked.PrmProjectAmount			= LocalEmptyProjectAmount
						invoked.PrmProject					= ""

		ReleaseReceivableInvoice is an Instance Action
			restricted
			Parameters
        		InvoiceBOD 									is XMLDocument	
        		PrmReceivableInvoice   						is like ReceivableInvoice
        		PrmInboundTracker  							is like FSMInboundBODTracker
			Action Rules
				LocalFSMInboundBODTracker 					= PrmInboundTracker
				invoke Unreleased.Release ReceivableInvoiceRel
					resume on error
                   		Error          						= true
                        ErrorMessage    					= error message
				if(Error)
					invoke Update FSMInboundBODTrackerRel
						invoked.Error 						= Error
						invoked.ErrorMessage 				= ErrorMessage
						invoked.Status						= 2
						invoked.CloseDate					= system current timestamp
					invoke SendPIConfirmBOD
						invoked.PrmErrorMessage 			= ErrorMessage
						invoked.InvoiceBOD      			= InvoiceBOD
						invoked.PrmTrackerID				= LocalFSMInboundBODTracker
					invoke SendPIACKBOD
                        invoked.PrmErrorMessage 			= ErrorMessage
                        invoked.InvoiceBOD      			= InvoiceBOD
                        invoked.PrmTrackerID				= LocalFSMInboundBODTracker
					invoke Delete ReceivableInvoiceRel
				else
					invoke Update FSMInboundBODTrackerRel
						invoked.Status						= 3
						invoked.CloseDate					= system current timestamp
					invoke SendPIACKBOD
                        invoked.PrmErrorMessage 			= "Invoice Created Sucessfully"
                        invoked.InvoiceBOD      			= InvoiceBOD
                        invoked.PrmTrackerID				= LocalFSMInboundBODTracker	
							
		CreateReceivableInvoiceLineItem is an Import Action
			restricted
			Parameters
        		InvoiceBOD 							is XMLDocument	
        		PrmProject   						is Alpha 25
        		PrmInvoiceType  					is AlphaUpper 1
        		PrmProjectAmount					is Decimal 19.3
			Action Rules
				LocalCompany						= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID/@accountingEntity"
				LocalInvoice						= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID"
				LocalInvoiceType					= PrmInvoiceType
				LocalProject						= PrmProject
				LocalTransactionAmount				= PrmProjectAmount
				invoke Create ReceivableInvoiceLineItem
					resume on error
               			Error           			= true
                    	ErrorMessage    			= error message
					invoked.Company					= LocalCompany
					invoked.ReceivableInvoice		= LocalInvoice
                	invoked.ReceivableInvoiceType 	= LocalInvoiceType
					invoked.Project					= LocalProject	
					invoked.TransactionAmount		= LocalTransactionAmount	

		UpdateReceivableInvoiceLineItem is an Import Action
			restricted
			Parameters
        		InvoiceBOD 							is XMLDocument	
        		PrmProject   						is Alpha 25
        		PrmInvoiceType  					is AlphaUpper 1
        		PrmProjectAmount					is Decimal 19.3
			Action Rules
				LocalCompany						= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID/@accountingEntity"
				LocalInvoice						= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID"
				LocalInvoiceType					= PrmInvoiceType
				LocalProject						= PrmProject
				LocalTransactionAmount				= PrmProjectAmount
				invoke Update ReceivableInvoiceLineItemRel
					resume on error
               			Error           			= true
                    	ErrorMessage    			= error message
					invoked.Company					= LocalCompany
					invoked.ReceivableInvoice		= LocalInvoice
                	invoked.ReceivableInvoiceType 	= LocalInvoiceType
					invoked.Project					= LocalProject	
					invoked.TransactionAmount		= LocalTransactionAmount
		
		UpdateBillingInvoice is an Import Action
			restricted			
			Parameters
				InvoiceBOD 						is XMLDocument
				PrmInboundTracker  				is like FSMInboundBODTracker
			Action Rules
				LocalFSMInboundBODTracker 		= PrmInboundTracker
				LocalFinanceEnterpriseGroup		= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID/@accountingEntity"
				LocalInvoice					= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID"
				LocalGenericDelimiter        	= DerivedGenericDelimiter
				LocalInvoice 					= NativeBillingInvoice
				LocalBillingInvoice				= DerivedBillingInvoiceNumber
				if(LocalFinanceEnterpriseGroup entered)
					LocalFinanceEnterpriseGroup  = NativeFinanceEnterpriseGroup
				else
					LocalFinanceEnterpriseGroup = ""
				LocalAddressCode 				= AccountingEntityRel.AddressCode
				LocalCountry					= AddressCodeRel.PostalAddress.Country
				LocalDistCount					= InvoiceBOD select "count (//DataArea/Invoice/InvoiceHeader/AlternateDocumentID)"
				LocalUserAreaCount 				= InvoiceBOD select "count (//DataArea/Invoice/InvoiceHeader/UserArea/Property)"
				
				LocalIterator = 1
				while (LocalDistCount >= LocalIterator)					
					LocalNameValue = InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/AlternateDocumentID[<LocalIterator>]/ID/@schemeName"
					if(LocalNameValue = "LCL.MX.UUID" or LocalNameValue = "lcl.MX.UUID")
						LocalCertificationNumber 	= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/AlternateDocumentID[<LocalIterator>]/ID"														
					LocalIterator = LocalIterator + 1
				
				LocalIterator = 1
				while (LocalUserAreaCount >= LocalIterator)					
					LocalNameValue = InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/UserArea/Property[<LocalIterator>]/NameValue/@name"
					if(LocalNameValue = "lcl.Status" or LocalNameValue = "LCL.Status")
						LocalInStatus 	= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/UserArea/Property[<LocalIterator>]/NameValue"														
					else
					if(LocalNameValue = "lcl.FolioAuthorizationCode" or LocalNameValue = "lcl.QRCode")
						LocalFolioAuthorizationCode 	= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/UserArea/Property[<LocalIterator>]/NameValue"														
					else
					if(LocalNameValue = "lcl.OutputFileType")
						LocalOutputFileType = InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/UserArea/Property[<LocalIterator>]/NameValue"
					LocalIterator = LocalIterator + 1
				if (LocalCertificationNumber entered or LocalInStatus = "Forwarded")
					LocalFolioAuthorizationCode = ""
				if(LocalCountry = "MX")
					LocalInvoiceHold = "A"	
				if((LocalInStatus = "Rejected" and LocalCountry = "MX") or (LocalCountry = "CL" and (LocalInStatus = "Rejected" or LocalInStatus = "Failed" or LocalInStatus = "Submitted")) or 
					(LocalInStatus = "Rejected" or LocalInStatus = "Failed") or (LocalCountry = "SA" and LocalOutputFileType = "ZATCA E-Invoice" and (LocalInStatus = "Rejected" or LocalInStatus = "Failed")))
					invoke  Unreleased.Update BillingInvoiceRel
						resume on error
		               		Error             						= true
		                    ErrorMessage     						= error message
						invoked.Company         					= LocalAccountingEntity
		                invoked.BillingInvoice.InvoiceNumber 		= LocalBillingInvoice
						invoked.CertificationNumber					= LocalCertificationNumber
						invoked.BillingInvoice.InvoicePrefix		= DerivedBillingInvoicePrefix
						invoked.InvoiceHold							= LocalInvoiceHold
					if(Error)
						invoke Update FSMInboundBODTrackerRel
							invoked.Error 						= Error
							invoked.ErrorMessage 				= ErrorMessage
							invoked.Status						= 2
							invoked.CloseDate					= system current timestamp
						invoke SendPIConfirmBOD
							invoked.PrmErrorMessage 			= ErrorMessage
							invoked.InvoiceBOD      			= InvoiceBOD
							invoked.PrmTrackerID				= LocalFSMInboundBODTracker
						invoke SendPIACKBOD
	                        invoked.PrmErrorMessage 			= ErrorMessage
	                        invoked.InvoiceBOD      			= InvoiceBOD
	                        invoked.PrmTrackerID				= LocalFSMInboundBODTracker
	                else
	                	invoke Update FSMInboundBODTrackerRel
							invoked.Status						= 3
							invoked.CloseDate					= system current timestamp
				else	
				if((LocalCountry = "MX" and LocalCertificationNumber entered) or (LocalCountry = "CL" and LocalInStatus = "Registered") or
					(LocalCountry = "SA" and LocalOutputFileType = "ZATCA E-Invoice" and LocalInStatus = "Registered") or (LocalInStatus = "Forwarded"))
					invoke  Unreleased.Update BillingInvoiceRel
						resume on error
		               		Error             										= true
		                    ErrorMessage     										= error message
						invoked.Company         									= LocalAccountingEntity
		                invoked.BillingInvoice.InvoiceNumber 						= LocalBillingInvoice
						invoked.CertificationNumber									= LocalCertificationNumber
						invoked.BillingInvoice.InvoicePrefix						= DerivedBillingInvoicePrefix
						invoked.FolioAuthorizationCode								= LocalFolioAuthorizationCode
					if(Error)
						invoke Update FSMInboundBODTrackerRel
							invoked.Error 						= Error
							invoked.ErrorMessage 				= ErrorMessage
							invoked.Status						= 2
							invoked.CloseDate					= system current timestamp
						invoke SendPIConfirmBOD
							invoked.PrmErrorMessage 			= ErrorMessage
							invoked.InvoiceBOD      			= InvoiceBOD
							invoked.PrmTrackerID				= LocalFSMInboundBODTracker
						invoke SendPIACKBOD
	                        invoked.PrmErrorMessage 			= ErrorMessage
	                        invoked.InvoiceBOD      			= InvoiceBOD
	                        invoked.PrmTrackerID				= LocalFSMInboundBODTracker
	                else
	                	invoke  Unreleased.ReleaseSyncInvoice BillingInvoiceRel
							resume on error
			               		Error             				= true
			                    ErrorMessage     				= error message
	                	if(Error)
	                		invoke Update FSMInboundBODTrackerRel
								invoked.Error 						= Error
								invoked.ErrorMessage 				= ErrorMessage
								invoked.Status						= 2
								invoked.CloseDate					= system current timestamp
							invoke SendPIConfirmBOD
								invoked.PrmErrorMessage 			= ErrorMessage
								invoked.InvoiceBOD      			= InvoiceBOD
								invoked.PrmTrackerID				= LocalFSMInboundBODTracker
							invoke SendPIACKBOD
		                        invoked.PrmErrorMessage 			= ErrorMessage
		                        invoked.InvoiceBOD      			= InvoiceBOD
		                        invoked.PrmTrackerID				= LocalFSMInboundBODTracker
		                else
		                	invoke Update FSMInboundBODTrackerRel
								invoked.Status						= 3
								invoked.CloseDate					= system current timestamp
							invoke SendPIACKBOD
		                        invoked.PrmErrorMessage 			= "BillingInvoice Released Sucessfully"
		                        invoked.InvoiceBOD      			= InvoiceBOD
		                        invoked.PrmTrackerID				= LocalFSMInboundBODTracker
				else
					invoke Update FSMInboundBODTrackerRel
						invoked.Status						= 3
						invoked.CloseDate					= system current timestamp
		
		SendPIConfirmBOD is an Instance Action
			restricted			
			Parameters
				InvoiceBOD 								is XMLDocument
				PrmErrorMessage 						is Alpha 300
				PrmTrackerID							is Numeric 15
			Action Rules
				LocalPInvoiceXML						= InvoiceBOD
				LocalErrorMessage						= PrmErrorMessage
				LocalTrackerID							= PrmTrackerID
				LocalAccountingEntity					= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID/@accountingEntity"
				LocalInvoice							= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID"
				LocalFromLogicalID						= InvoiceBOD select "//ApplicationArea/Sender/LogicalID"
				LocalComponentID						= InvoiceBOD select "//ApplicationArea/Sender/ComponentID"
				LocalBODID								= InvoiceBOD select "//ApplicationArea/BODID"
				LocalMainUserTemplate					= "IONProcessInvoice_ConfirmBOD_ST"	
				LocalConfirmBOD							= "true"
				if(UserTemplateRel exists)
					send ion bod
						bod is ProcessInvoiceConfirmBODXML
						bod type is "Confirm.BOD"
						accounting entity is LocalAccountingEntity
						document id is LocalInvoice
					
		SendPIACKBOD is an Instance Action
			restricted			
			Parameters
				InvoiceBOD 								is XMLDocument
				PrmErrorMessage 						is Alpha 300
				PrmTrackerID							is Numeric 15
			Action Rules
				LocalPInvoiceXML						= InvoiceBOD
				LocalErrorMessage						= PrmErrorMessage
				LocalTrackerID							= PrmTrackerID
				LocalInvoice							= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID"
				LocalFromLogicalID						= InvoiceBOD select "//ApplicationArea/Sender/LogicalID"
				LocalComponentID						= InvoiceBOD select "//ApplicationArea/Sender/ComponentID"
				LocalBODID								= InvoiceBOD select "//ApplicationArea/BODID"
				LocalTaskID								= InvoiceBOD select "//ApplicationArea/Sender/TaskID"
				LocalReferenceID						= InvoiceBOD select "//ApplicationArea/Sender/ReferenceID"
				LocalConfirmationCode					= InvoiceBOD select "//ApplicationArea/Sender/ConfirmationCode"
				LocalAuthorizationID					= InvoiceBOD select "//ApplicationArea/Sender/AuthorizationID"
				LocalAccountingEntity					= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID/@accountingEntity"
				LocalDocumentID							= InvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID"
				LocalMainUserTemplate					= "IONProcessInvoice_AcknowledgeBOD_ST"
				
				if(UserTemplateRel exists)
					send ion bod
						bod is ProcessInvoiceAcknowledgeBODXML
						bod type is "Acknowledge.Invoice"	
						accounting entity is LocalAccountingEntity
						document id is LocalDocumentID
#endif
#endif						



		SyncAssetMasterBODImport is an Import Action
			restricted
			bod type is Sync.AssetMaster
			Parameters			
				AssetMasterBOD 				is XMLDocument		
			Action Rules
				LocalAccountingEntity   	 = AssetMasterBOD select "//DataArea/AssetMaster/IDs/ID/@accountingEntity" 
				LocalVariationID             = AssetMasterBOD select "//DataArea/AssetMaster/IDs/ID/@variationID"
				LocalAsset					 = AssetMasterBOD select "//DataArea/AssetMaster/IDs/ID"
				LocalDocumentID				 = AssetMasterBOD select "//DataArea/AssetMaster/IDs/ID"
				LocalBODID                   = AssetMasterBOD select "//ApplicationArea/BODID"
				LocalAssetReference			 = AssetMasterBOD select "//DataArea/AssetMaster/IDs/ID"
				LocalBODXML					 = AssetMasterBOD
				LocalFinanceEnterpriseGroup	 = AssetMasterBOD select "//DataArea/AssetMaster/IDs/ID/@accountingEntity"
				LocalActionCode				 = AssetMasterBOD select "//DataArea/Sync/ActionCriteria/ActionExpression/@actionCode"
				LocalGenericDelimiter        = DerivedGenericDelimiter

				if(DerivedConfigDocID = "Y")
					if(FSMBODCleanDocIDRel.DestinationValue entered)
						LocalCrossAccountingEntity	= 	FSMBODCleanDocIDRel.DestinationValue
					else
						LocalCrossAccountingEntity 	= 	LocalAccountingEntity
					if(DerivedConfigFEG !="Y")
						LocalCompany				=	LocalCrossAccountingEntity
						LocalFinanceEnterpriseGroup = 	GeneralLedgerCompanyRel.FinanceEnterpriseGroup
					else
						LocalFinanceEnterpriseGroup		=	LocalCrossAccountingEntity
						if(LocalFinanceEnterpriseGroup entered)
							LocalFinanceEnterpriseGroup  = NativeFinanceEnterpriseGroup
						else
							LocalFinanceEnterpriseGroup = ""
				else
					if(LocalFinanceEnterpriseGroup entered)
						LocalFinanceEnterpriseGroup  = NativeFinanceEnterpriseGroup
					else
						LocalFinanceEnterpriseGroup = ""
				LocalCrossAccountingEntity		= AssetMasterBOD select "//DataArea/AssetMaster/IDs/ID/@accountingEntity"
				
				if(FSMBODConfigurationAssetMasterRel exists and FSMBODConfigurationAssetMasterRel.Enable)
					ActionCode 			= AssetMasterBOD select "//DataArea/Sync/ActionCriteria/ActionExpression/@actionCode"
					LocalUserAreaCount 	= AssetMasterBOD select "count (//DataArea/AssetMaster/UserArea/Property)"
					
					if(FSMInboundBODTracker not entered)
						invoke Create FSMInboundBODTracker
							assign result to NewBODTracker
							invoked.Verb 					= 1
							invoked.Noun 					= "AssetMaster"
							invoked.Direction				= 2					
							invoked.FinanceEnterpriseGroup	= LocalFinanceEnterpriseGroup
							invoked.BODAccountingEntity		= LocalCrossAccountingEntity
							invoked.BODDocumentID			= LocalDocumentID
							invoked.BODVariationID			= LocalVariationID
							invoked.BODID					= LocalBODID
							invoked.Status					= 4
							invoked.StartDate				= system current timestamp
							invoked.BODXML					= LocalBODXML
							initialize invoked.Error			
							initialize invoked.ErrorMessage					
						LocalFSMInboundBODTracker = NewBODTracker.FSMInboundBODTracker					
					else
						LocalFSMInboundBODTracker = FSMInboundBODTracker
						invoke Update FSMInboundBODTrackerRel
							invoked.BODAccountingEntity		= LocalCrossAccountingEntity
							invoked.BODDocumentID			= LocalDocumentID
							invoked.BODVariationID			= LocalVariationID
							invoked.BODID					= LocalBODID
							invoked.Status					= 1
							invoked.StartDate				= system current timestamp
							invoked.BODXML					= LocalBODXML
							initialize invoked.Error			
							initialize invoked.ErrorMessage	
						
					LocalIterator = 1
					while (LocalUserAreaCount >= LocalIterator)	
						LocalNameValue = AssetMasterBOD select "//DataArea/AssetMaster/UserArea/Property[<LocalIterator>]/NameValue/@name"
						if(LocalNameValue = "eam.UDFCHAR01")
							LocalAssetProject 	= AssetMasterBOD select "//DataArea/AssetMaster/UserArea/Property[<LocalIterator>]/NameValue"	
							if(DerivedConfigDocID !="Y")
								if (LocalAssetProject entered)
									LocalAssetProject = NativeAssetProject	
								else
									LocalAssetProject = ""	
						LocalIterator = LocalIterator + 1
					if(AssetTemplateRel  exists)
						LocalCompany = AssetTemplateRel.Company
						if(AssetReferenceRel exists)
							LocalAsset = AssetReferenceRel.Asset
							invoke UpdateReleasedAsset
		               			invoked.AssetMasterBOD      		= AssetMasterBOD
		               			invoked.PrmAsset					= LocalAsset
		               			invoked.PrmInboundTracker 			= LocalFSMInboundBODTracker
		               			invoked.PrmFinanceEnterpriseGroup	= LocalFinanceEnterpriseGroup
		               			invoked.PrmAssetProject				= LocalAssetProject
						else
							invoke CreateAsset                
			               		invoked.AssetMasterBOD      			= AssetMasterBOD
			               		invoked.PrmInboundTracker 				= LocalFSMInboundBODTracker
			               		invoked.PrmFinanceEnterpriseGroup		= LocalFinanceEnterpriseGroup
			               		invoked.PrmAssetProject					= LocalAssetProject
		            else
		            	invoke Update FSMInboundBODTrackerRel
							invoked.Error 						= true
							invoked.ErrorMessage 				= "AssetTemplate does not Exists"
							invoked.Status						= 2
							invoked.CloseDate					= system current timestamp 
						invoke SendSIMConfirmBOD
							invoked.PrmErrorMessage 			= "AssetTemplate does not Exists"
							invoked.AssetMasterBOD      		= AssetMasterBOD
							invoked.PrmTrackerID				= LocalFSMInboundBODTracker
							invoked.PrmAssetProject				= LocalAssetProject
				else
				if(FSMInboundBODTracker not entered)
					invoke Create FSMInboundBODTracker
						assign result to NewBODTracker
						invoked.Verb 					= 1
						invoked.Noun 					= "AssetMaster"	
						invoked.Direction				= 2				
						invoked.FinanceEnterpriseGroup	= LocalFinanceEnterpriseGroup
						invoked.BODAccountingEntity		= LocalCrossAccountingEntity
						invoked.BODDocumentID			= LocalDocumentID
						invoked.BODVariationID			= LocalVariationID
						invoked.BODID					= LocalBODID
						invoked.Status					= 4
						invoked.StartDate				= system current timestamp
						invoked.CloseDate				= system current timestamp
						invoked.BODXML					= LocalBODXML
						invoked.Error					= true			
						invoked.ErrorMessage			= "Sync Asset Master Inbound BOD Service is not Enabled"
					LocalFSMInboundBODTracker = NewBODTracker.FSMInboundBODTracker	
				else
					LocalFSMInboundBODTracker = FSMInboundBODTracker
					invoke Update FSMInboundBODTrackerRel
						invoked.FinanceEnterpriseGroup	= LocalFinanceEnterpriseGroup
						invoked.BODAccountingEntity		= LocalCrossAccountingEntity
						invoked.BODDocumentID			= LocalDocumentID
						invoked.BODVariationID			= LocalVariationID
						invoked.BODID					= LocalBODID
						invoked.Status					= 4
						invoked.StartDate				= system current timestamp
						invoked.CloseDate				= system current timestamp
						invoked.BODXML					= LocalBODXML
						invoked.Error					= true			
						invoked.ErrorMessage			= "Sync Asset Master Inbound BOD Service is not Enabled"
														
		UpdateReleasedAsset is an Import Action
			restricted
			Parameters
				AssetMasterBOD 				is XMLDocument
				PrmInboundTracker   		is like FSMInboundBODTracker
				PrmAsset				 	is like Asset
				PrmFinanceEnterpriseGroup 	is AlphaUpper 4
				PrmAssetProject				is Alpha 60
			Action Rules
				LocalFSMInboundBODTracker 		= PrmInboundTracker
				LocalAssetProject				= PrmAssetProject
				LocalFinanceEnterpriseGroup		= PrmFinanceEnterpriseGroup
				LocalAsset						= PrmAsset
				LocalItemTotalBaseCost			= AssetMasterBOD select "//DataArea/AssetMaster/Cost/Amount"
				LocalAssetLocation				= AssetMasterBOD select "//DataArea/AssetMaster/ItemInstance/StorageLocation/IDs/ID"
				LocalAssetDescription			= AssetMasterBOD select "//DataArea/AssetMaster/Description"
				LocalUserAreaCount 				= AssetMasterBOD select "count (//DataArea/AssetMaster/UserArea/Property)"
				
				if(LocalAssetDescription not entered)
					LocalAssetDescription		= AssetTemplateRel.Description
				LocalIterator = 1
				while (LocalUserAreaCount >= LocalIterator)					
					LocalNameValue = AssetMasterBOD select "//DataArea/AssetMaster/UserArea/Property[<LocalIterator>]/NameValue/@name"
					if(LocalNameValue = "eam.PurchaseCost")
						LocalItemTotalTransactionCost 	= AssetMasterBOD select "//DataArea/AssetMaster/UserArea/Property[<LocalIterator>]/NameValue"														
					else
						LocalItemTotalTransactionCost = ""
					LocalIterator = LocalIterator + 1
				
				invoke Released.Update AssetRel
					resume on error
                   		Error            					= true
                        ErrorMessage     					= error message 
                    invoked.Asset       					= LocalAsset
                    invoked.FinanceEnterpriseGroup			= LocalFinanceEnterpriseGroup
                    invoked.Description						= LocalAssetDescription
                    invoked.ItemTotalBaseCost				= LocalItemTotalBaseCost
                    invoked.AssetLocation					= LocalAssetLocation
                    invoked.ItemTotalTransactionCost 		= LocalItemTotalTransactionCost
                if(Error)
					invoke Update FSMInboundBODTrackerRel
						invoked.Error 						= Error
						invoked.ErrorMessage 				= ErrorMessage
						invoked.Status						= 2
						invoked.CloseDate					= system current timestamp 
					invoke SendSIMConfirmBOD
						invoked.PrmErrorMessage 			= ErrorMessage
						invoked.AssetMasterBOD      		= AssetMasterBOD
						invoked.PrmTrackerID				= LocalFSMInboundBODTracker
						invoked.PrmAssetProject				= LocalAssetProject
				if(AssetItemRel exists and (!FSMInboundBODTrackerRel.Error))
					invoke UpdateAssetItem
               			invoked.AssetMasterBOD      		= AssetMasterBOD
               			invoked.PrmAsset					= LocalAsset
               			invoked.PrmInboundTracker 			= LocalFSMInboundBODTracker
               			invoked.PrmFinanceEnterpriseGroup	= LocalFinanceEnterpriseGroup
               			invoked.PrmAssetProject				= LocalAssetProject
			    else
					invoke Update FSMInboundBODTrackerRel
						invoked.Status						= 3
						invoked.CloseDate					= system current timestamp 
		
		UpdateAssetItem is an Import Action
			restricted
			Parameters
				AssetMasterBOD 				is XMLDocument
				PrmInboundTracker   		is like FSMInboundBODTracker
				PrmAsset				 	is like Asset
				PrmFinanceEnterpriseGroup 	is AlphaUpper 4
				PrmAssetProject				is Alpha 60
			Action Rules
				LocalFSMInboundBODTracker 		= PrmInboundTracker
				LocalAssetProject				= PrmAssetProject
				LocalFinanceEnterpriseGroup		= PrmFinanceEnterpriseGroup
				LocalAsset						= PrmAsset
				LocalTransactionItemCost		= AssetMasterBOD select "//DataArea/AssetMaster/Cost/Amount"
				LocalAssetDescription			= AssetMasterBOD select "//DataArea/AssetMaster/ItemInstance/Description"
				LocalModelNumber				= AssetMasterBOD select "//DataArea/AssetMaster/AssetIDs/ModelNumber"
				LocalSerialNumber				= AssetMasterBOD select "//DataArea/AssetMaster/AssetIDs/SerialNumber"
				LocalUserAreaCount 				= AssetMasterBOD select "count (//DataArea/AssetMaster/UserArea/Property)"
				
				LocalIterator = 1
				while (LocalUserAreaCount >= LocalIterator)					
					LocalNameValue = AssetMasterBOD select "//DataArea/AssetMaster/UserArea/Property[<LocalIterator>]/NameValue/@name"
					if(LocalNameValue = "eam.PurchaseDate")
						LocalPurchaseDateAlpha 	= AssetMasterBOD select "//DataArea/AssetMaster/UserArea/Property[<LocalIterator>]/NameValue"														
					 	LocalPurchaseDate		= LocalPurchaseDateAlpha[1:4] + LocalPurchaseDateAlpha[6:7] + LocalPurchaseDateAlpha[9:10]
					LocalIterator = LocalIterator+1
				invoke Update AssetItemRel
					resume on error
                   		Error            											= true
                        ErrorMessage     											= error message 
                    invoked.Asset       											= LocalAsset
                    invoked.AssetItem												= AssetItemRel.AssetItem
                    invoked.FinanceEnterpriseGroup									= LocalFinanceEnterpriseGroup
                    invoked.TransactionItemCost										= LocalTransactionItemCost
                    invoked.PurchaseDate											= LocalPurchaseDate
                    invoked.ModelNumber												= LocalModelNumber
                    invoked.SerialNumber											= LocalSerialNumber
                    invoked.Description												= LocalAssetDescription
					invoked.AdjustmentDate											= DerivedAdjustmentDate
                if(Error)
					invoke Update FSMInboundBODTrackerRel
						invoked.Error 						= Error
						invoked.ErrorMessage 				= ErrorMessage
						invoked.Status						= 2
						invoked.CloseDate					= system current timestamp 
					invoke SendSIMConfirmBOD
						invoked.PrmErrorMessage 			= ErrorMessage
						invoked.AssetMasterBOD      		= AssetMasterBOD
						invoked.PrmTrackerID				= LocalFSMInboundBODTracker
						invoked.PrmAssetProject				= LocalAssetProject	
				else
					invoke PostRelease.Release AssetRel
						resume on error
	                   		Error            					= true
	                        ErrorMessage     					= error message 
	                if(Error)
						invoke Update FSMInboundBODTrackerRel
							invoked.Error 						= Error
							invoked.ErrorMessage 				= ErrorMessage
							invoked.Status						= 2
							invoked.CloseDate					= system current timestamp 
						invoke SendSIMConfirmBOD
							invoked.PrmErrorMessage 			= ErrorMessage
							invoked.AssetMasterBOD      		= AssetMasterBOD
							invoked.PrmTrackerID				= LocalFSMInboundBODTracker
							invoked.PrmAssetProject				= LocalAssetProject
					else
						invoke Update FSMInboundBODTrackerRel
							invoked.Status						= 3
							invoked.CloseDate					= system current timestamp 
				
		CreateAsset is an Import Action
			restricted
			Parameters
				AssetMasterBOD 				is XMLDocument
				PrmInboundTracker   		is like FSMInboundBODTracker
				PrmFinanceEnterpriseGroup 	is AlphaUpper 4 
				PrmAssetProject				is Alpha size 60
			Action Rules
				LocalFSMInboundBODTracker 		= PrmInboundTracker
				LocalFinanceEnterpriseGroup		= PrmFinanceEnterpriseGroup
				LocalAssetProject				= PrmAssetProject
				LocalAssetCurreny				= AssetMasterBOD select "//DataArea/AssetMaster/Cost/Amount/@currencyID"
				LocalAsset 					    = AssetMasterBOD select "//DataArea/AssetMaster/IDs/ID"
				LocalCompany 					= AssetTemplateRel.Company
				LocalAssetTemplate 				= AssetTemplateRel.AssetTemplate
				LocalAssetAccountGroup			= AssetTemplateRel.AssetAccountGroup
				LocalAssetAccountingUnitGroup 	= AssetTemplateRel.AssetAccountingUnitGroup
				LocalAssetDescription			= AssetTemplateRel.Description
				LocalServiceDateAlpha			= AssetMasterBOD select "//DataArea/AssetMaster/CommissionDateTime"
				LocalServiceDate				= LocalServiceDateAlpha[1:4] + LocalServiceDateAlpha[6:7] + LocalServiceDateAlpha[9:10]	
				LocalCodeLeng					= AssetMasterBOD select "count (//DataArea/AssetMaster/Classification/Codes/Code)"
				
				LocalLoop = 1
				while(LocalLoop <= LocalCodeLeng)
        			initialize LocalAssetCategory
    				initialize LocalAssetType
        			LocalListID				= AssetMasterBOD select "//DataArea/AssetMaster/Classification/Codes/Code[<LocalLoop>]/@listID"
        			if(LocalListID = "AssetCategory")
        				LocalAssetCategory		= AssetMasterBOD select "//DataArea/AssetMaster/Classification/Codes/Code[<LocalLoop>]"
        			else
        			if(LocalListID = "AssetType")
        				LocalAssetType		= AssetMasterBOD select "//DataArea/AssetMaster/Classification/Codes/Code[<LocalLoop>]"
        			LocalLoop = LocalLoop + 1
				
				invoke PortableCreateFromTemplate Asset
					assign result to NewAsset 
					resume on error
                   		Error            					= true
                        ErrorMessage     					= error message 
                    invoked.AssetTemplate        			= LocalAssetTemplate
                    invoked.Description   					= LocalAssetDescription
                    invoked.Company							= LocalCompany	
                    invoked.FinanceEnterpriseGroup			= LocalFinanceEnterpriseGroup
                    invoked.Currency						= LocalAssetCurreny
                    invoked.AssetCategory					= LocalAssetCategory
                    invoked.AssetType.Type					= LocalAssetType
                    invoked.AssetAccountGroup				= LocalAssetAccountGroup
                    invoked.AssetAccountingUnitGroup 		= LocalAssetAccountingUnitGroup
                    invoked.BODProcessing					= true 
					invoked.BypassAssetItem					= true
                if(Error)
					invoke Update FSMInboundBODTrackerRel
						invoked.Error 						= Error
						invoked.ErrorMessage 				= ErrorMessage
						invoked.Status						= 2
						invoked.CloseDate					= system current timestamp 
					invoke SendSIMConfirmBOD
						invoked.PrmErrorMessage 			= ErrorMessage
						invoked.AssetMasterBOD      		= AssetMasterBOD
						invoked.PrmTrackerID				= LocalFSMInboundBODTracker
						invoked.PrmAssetProject				= LocalAssetProject
				LocalAsset = NewAsset.Asset
               	if(AssetRel exists and (!FSMInboundBODTrackerRel.Error))
               		invoke UpdateAsset
               			invoked.AssetMasterBOD      		= AssetMasterBOD
               			invoked.PrmAsset					= LocalAsset
               			invoked.PrmInboundTracker 			= LocalFSMInboundBODTracker
               			invoked.PrmFinanceEnterpriseGroup	= LocalFinanceEnterpriseGroup
               	if(AssetBookRel exists and LocalServiceDate entered and (!FSMInboundBODTrackerRel.Error))
					invoke UpdateAssetBook
						invoked.AssetMasterBOD      		= AssetMasterBOD
		           		invoked.PrmAsset					= LocalAsset
		           		invoked.PrmInboundTracker 			= LocalFSMInboundBODTracker
		           		invoked.PrmFinanceEnterpriseGroup	= LocalFinanceEnterpriseGroup
		        if(!FSMInboundBODTrackerRel.Error)   		
			        invoke  CreateAssetItem
						invoked.AssetMasterBOD      		= AssetMasterBOD
		           		invoked.PrmAsset					= LocalAsset
		           		invoked.PrmInboundTracker 			= LocalFSMInboundBODTracker
		           		invoked.PrmFinanceEnterpriseGroup	= LocalFinanceEnterpriseGroup
	           	if(!FSMInboundBODTrackerRel.Error)
					invoke ReleaseAsset
						invoked.AssetMasterBOD      		= AssetMasterBOD
		           		invoked.PrmAsset					= LocalAsset
		           		invoked.PrmInboundTracker 			= LocalFSMInboundBODTracker
		           		invoked.PrmFinanceEnterpriseGroup	= LocalFinanceEnterpriseGroup
			
        UpdateAsset is an Import Action
			restricted
			Parameters
				AssetMasterBOD 				is XMLDocument
				PrmInboundTracker   		is like FSMInboundBODTracker
				PrmAsset				 	is like Asset
				PrmFinanceEnterpriseGroup 	is AlphaUpper 4
				PrmAssetProject				is Alpha 60
			Action Rules
				LocalFSMInboundBODTracker 		= PrmInboundTracker
				LocalFinanceEnterpriseGroup		= PrmFinanceEnterpriseGroup
				LocalAssetProject				= PrmAssetProject
				LocalAsset						= PrmAsset
				LocalAssetReference				= AssetMasterBOD select "//DataArea/AssetMaster/IDs/ID"
				LocalItemTotalBaseCost			= AssetMasterBOD select "//DataArea/AssetMaster/Cost/Amount"
				LocalAssetLocation				= AssetMasterBOD select "//DataArea/AssetMaster/ItemInstance/StorageLocation/IDs/ID"
				LocalUserAreaCount 				= AssetMasterBOD select "count (//DataArea/AssetMaster/UserArea/Property)"
				
				LocalIterator = 1
				while (LocalUserAreaCount >= LocalIterator)					
					LocalNameValue = AssetMasterBOD select "//DataArea/AssetMaster/UserArea/Property[<LocalIterator>]/NameValue/@name"
					if(LocalNameValue = "eam.PurchaseCost")
						LocalItemTotalTransactionCost 	= AssetMasterBOD select "//DataArea/AssetMaster/UserArea/Property[<LocalIterator>]/NameValue"														
					else
						LocalItemTotalTransactionCost = ""
					LocalIterator = LocalIterator + 1
				
				invoke Update AssetRel
					resume on error
                   		Error            					= true
                        ErrorMessage     					= error message 
                    invoked.Asset       					= LocalAsset
                    invoked.FinanceEnterpriseGroup			= LocalFinanceEnterpriseGroup
                    invoked.Reference1						= LocalAssetReference
                    invoked.ItemTotalBaseCost				= LocalItemTotalBaseCost
                    invoked.AssetLocation					= LocalAssetLocation
                    invoked.ItemTotalTransactionCost 		= LocalItemTotalTransactionCost
                if(Error)
					invoke Update FSMInboundBODTrackerRel
						invoked.Error 						= Error
						invoked.ErrorMessage 				= ErrorMessage
						invoked.Status						= 2
						invoked.CloseDate					= system current timestamp 
					invoke SendSIMConfirmBOD
						invoked.PrmErrorMessage 			= ErrorMessage
						invoked.AssetMasterBOD      		= AssetMasterBOD
						invoked.PrmTrackerID				= LocalFSMInboundBODTracker
						invoked.PrmAssetProject				= LocalAssetProject
				
		UpdateAssetBook is an Import Action
			restricted
			Parameters
				AssetMasterBOD 				is XMLDocument
				PrmInboundTracker   		is like FSMInboundBODTracker
				PrmAsset				 	is like Asset
				PrmFinanceEnterpriseGroup 	is AlphaUpper 4
			Action Rules
				LocalFSMInboundBODTracker 		= PrmInboundTracker
				LocalFinanceEnterpriseGroup		= PrmFinanceEnterpriseGroup
				LocalAsset						= PrmAsset
				LocalAssetBook					= AssetBookRel.Book
				LocalServiceDateAlpha			= AssetMasterBOD select "//DataArea/AssetMaster/CommissionDateTime"
				LocalServiceDate				= LocalServiceDateAlpha[1:4] + LocalServiceDateAlpha[6:7] + LocalServiceDateAlpha[9:10]	
				LocalUserAreaCount 				= AssetMasterBOD select "count (//DataArea/AssetMaster/UserArea/Property)"
				
				LocalIterator = 1
				while (LocalUserAreaCount >= LocalIterator)					
					LocalNameValue = AssetMasterBOD select "//DataArea/AssetMaster/UserArea/Property[<LocalIterator>]/NameValue/@name"
					if(LocalNameValue = "eam.DepreciationCategory")
						LocalDeprecialtionCategory 	= AssetMasterBOD select "//DataArea/AssetMaster/UserArea/Property[<LocalIterator>]/NameValue"
					else
						LocalDeprecialtionCategory = ""
					LocalIterator = LocalIterator + 1	
					 
				if(LocalDeprecialtionCategory = "Suspended")
					LocalDeprecialtionCategory = 0
				else
					LocalDeprecialtionCategory = 1
				
				invoke Update AssetBookRel
					resume on error
                   		Error            					= true
                        ErrorMessage     					= error message 
                    invoked.Asset       					= LocalAsset
                    invoked.FinanceEnterpriseGroup			= LocalFinanceEnterpriseGroup
                    invoked.Book							= LocalAssetBook
                    invoked.Active							= LocalDeprecialtionCategory
                    invoked.InServiceDate					= LocalServiceDate
					
		CreateAssetItem is an Import Action
			restricted
			Parameters
				AssetMasterBOD 				is XMLDocument
				PrmInboundTracker   		is like FSMInboundBODTracker
				PrmAsset				 	is like Asset
				PrmFinanceEnterpriseGroup 	is AlphaUpper 4
				PrmAssetProject				is Alpha 60
			Action Rules
				LocalFSMInboundBODTracker 		= PrmInboundTracker
				LocalFinanceEnterpriseGroup		= PrmFinanceEnterpriseGroup
				LocalAssetProject				= PrmAssetProject
				LocalAsset						= PrmAsset
				LocalCompany					= AssetTemplateRel.Company
				LocalTransactionItemCost		= AssetMasterBOD select "//DataArea/AssetMaster/Cost/Amount"
				LocalItemQuantity				= 1
				LocalItemNumber					= AssetMasterBOD select "//DataArea/AssetMaster/ItemInstance/ItemID/ID"
				LocalInvoiceandPurchaseOrder	= AssetMasterBOD select "//DataArea/AssetMaster/DocumentID/ID"
				LocalAssetLocation				= AssetMasterBOD select "//DataArea/AssetMaster/ItemInstance/StorageLocation/IDs/ID"
				LocalModelNumber				= AssetMasterBOD select "//DataArea/AssetMaster/AssetIDs/ModelNumber"
				LocalSerialNumber				= AssetMasterBOD select "//DataArea/AssetMaster/AssetIDs/SerialNumber"
				LocalAssetDescription			= AssetMasterBOD select "//DataArea/AssetMaster/ItemInstance/Description"
				LocalUserAreaCount 				= AssetMasterBOD select "count (//DataArea/AssetMaster/UserArea/Property)"
				
				LocalIterator = 1
				while (LocalUserAreaCount >= LocalIterator)					
					LocalNameValue = AssetMasterBOD select "//DataArea/AssetMaster/UserArea/Property[<LocalIterator>]/NameValue/@name"
					if(LocalNameValue = "eam.PurchaseDate")
						LocalPurchaseDateAlpha 	= AssetMasterBOD select "//DataArea/AssetMaster/UserArea/Property[<LocalIterator>]/NameValue"														
					 	LocalPurchaseDate		= LocalPurchaseDateAlpha[1:4] + LocalPurchaseDateAlpha[6:7] + LocalPurchaseDateAlpha[9:10]
					LocalIterator = LocalIterator+1
				
				invoke Create AssetItem
					resume on error
                   		Error            											= true
                        ErrorMessage     											= error message 
                    invoked.Asset       											= LocalAsset
                    invoked.FinanceEnterpriseGroup									= LocalFinanceEnterpriseGroup
                    invoked.InvoiceAndPurchaseOrderInformation.InvoiceCompany	    = LocalCompany
                    invoked.TransactionItemCost										= LocalTransactionItemCost
                    invoked.ItemQuantity											= LocalItemQuantity
                    invoked.PurchaseDate											= LocalPurchaseDate
                    invoked.ItemNumber												= LocalItemNumber
                    invoked.InvoiceAndPurchaseOrderInformation.PurchaseOrder		= LocalInvoiceandPurchaseOrder
                    invoked.LocationDetail											= LocalAssetLocation
                    invoked.ModelNumber												= LocalModelNumber
                    invoked.SerialNumber											= LocalSerialNumber
                    invoked.Description												= LocalAssetDescription
                if(Error)
					invoke Update FSMInboundBODTrackerRel
						invoked.Error 						= Error
						invoked.ErrorMessage 				= ErrorMessage
						invoked.Status						= 2
						invoked.CloseDate					= system current timestamp 
					invoke SendSIMConfirmBOD
						invoked.PrmErrorMessage 			= ErrorMessage
						invoked.AssetMasterBOD      		= AssetMasterBOD
						invoked.PrmTrackerID				= LocalFSMInboundBODTracker
						invoked.PrmAssetProject				= LocalAssetProject
						
		ReleaseAsset is an Import Action
			restricted
			Parameters
				AssetMasterBOD 				is XMLDocument
				PrmInboundTracker   		is like FSMInboundBODTracker
				PrmAsset				 	is like Asset
				PrmFinanceEnterpriseGroup 	is AlphaUpper 4
				PrmAssetProject				is Alpha 60
			Action Rules
				LocalFSMInboundBODTracker 		= PrmInboundTracker
				LocalFinanceEnterpriseGroup		= PrmFinanceEnterpriseGroup
				LocalAssetProject				= PrmAssetProject
				LocalAsset						= PrmAsset	
				if(AssetRel exists)
					invoke Release AssetRel
						resume on error
	                   		Error            					= true
	                        ErrorMessage     					= error message 
	                if(Error)
						invoke Update FSMInboundBODTrackerRel
							invoked.Error 						= Error
							invoked.ErrorMessage 				= ErrorMessage
							invoked.Status						= 2
							invoked.CloseDate					= system current timestamp 
						invoke SendSIMConfirmBOD
							invoked.PrmErrorMessage 			= ErrorMessage
							invoked.AssetMasterBOD      		= AssetMasterBOD
							invoked.PrmTrackerID				= LocalFSMInboundBODTracker
							invoked.PrmAssetProject				= LocalAssetProject
					else
						invoke Update FSMInboundBODTrackerRel
							invoked.Status						= 3
							invoked.CloseDate					= system current timestamp 
				
		SendSIMConfirmBOD is an Instance Action
			restricted			
			Parameters
				AssetMasterBOD 	is XMLDocument
				PrmErrorMessage is Alpha 300
				PrmTrackerID	is Numeric 15
				PrmAssetProject	is Alpha 60
			Action Rules
				LocalSIAssetMasterXML				= AssetMasterBOD
				LocalAssetProject					= PrmAssetProject
				LocalErrorMessage					= PrmErrorMessage
				LocalTrackerID						= PrmTrackerID
				LocalFromLogicalID					= AssetMasterBOD select "//ApplicationArea/Sender/LogicalID"
				LocalComponentID					= AssetMasterBOD select "//ApplicationArea/Sender/ComponentID"
				LocalBODID							= AssetMasterBOD select "//ApplicationArea/BODID"
				LocalDocumentID						= AssetMasterBOD select "//DataArea/AssetMaster/IDs/ID"
				LocalOriginalCreateDateTime			= AssetMasterBOD select "//ApplicationArea/CreationDateTime"
				LocalVariationID            		= AssetMasterBOD select "//DataArea/AssetMaster/IDs/ID/@variationID"
				LocalConfirmBOD						= "true"
				LocalMainUserTemplate				= "IONSyncAssetMaster_ConfirmBOD_ST"
				LocalFinanceEnterpriseGroup	 		= AssetMasterBOD select "//DataArea/AssetMaster/IDs/ID/@accountingEntity"
				LocalGenericDelimiter        		= DerivedGenericDelimiter
				LocalCompany						= AssetTemplateRel.Company
				if(LocalFinanceEnterpriseGroup entered)
					LocalFinanceEnterpriseGroup  = NativeFinanceEnterpriseGroup
				else
					LocalFinanceEnterpriseGroup = ""
				if(UserTemplateRel exists)
					send ion bod
						bod is SyncAssetMasterConfirmBODXML
						bod type is "Confirm.BOD"
						accounting entity is LocalAccountingEntity
						document id is LocalDocumentID									


		ProcessCustomerPartyMasterBODImport is an Import Action
			restricted
			bod type is Process.CustomerPartyMaster			
			Parameters
				CustomerPartyMasterBOD 		 is XMLDocument	
			Action Rules
				LocalBODXML					 = CustomerPartyMasterBOD
				LocalGenericDelimiter        = DerivedGenericDelimiter
				LocalDocumentID   	 	 	 = CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/PartyIDs/ID"
				LocalAccountingEntity   	 = CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/PartyIDs/ID/@accountingEntity"
				LocalVariationID             = CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/PartyIDs/ID/@variationID"
				LocalBODID                   = CustomerPartyMasterBOD select "//ApplicationArea/BODID"
				LocalCrossAccountingEntity	 = FSMBODCrossReferenceDetailRel.DestinationValue
				if(DerivedConfigDocID = "Y")
					if(FSMBODCleanDocIDRel.DestinationValue entered)
						LocalCrossAccountingEntity  =  FSMBODCleanDocIDRel.DestinationValue
					else
						LocalCrossAccountingEntity	=  LocalAccountingEntity
					if(DerivedConfigFEG != "Y")
						LocalAccountingEntity       = LocalCrossAccountingEntity
					else
						if(LocalCrossAccountingEntity entered)
							LocalAccountingEntity   = LocalCrossAccountingEntity
							LocalAccountingEntity   = NativeCompany
						else
							LocalAccountingEntity = ""
					LocalCompany	=	LocalAccountingEntity
				else
				if(LocalCrossAccountingEntity entered)
					LocalCompany			 = FSMBODCrossReferenceCompanyDetailRel.DestinationValue
				else 
				if(DerivedDefaultCompany entered)
					LocalCompany			 = DerivedDefaultCompany
				ActionCode					 = CustomerPartyMasterBOD select "//DataArea/Process/ActionCriteria/ActionExpression/@actionCode"
				
				if(FSMBODConfigurationCustomerPartyMasterRel exists and FSMBODConfigurationCustomerPartyMasterRel.Enable)
					if(FSMInboundBODTracker not entered)
						invoke Create FSMInboundBODTracker
							assign result to NewBODTracker
							invoked.Verb 					= 2
							invoked.Noun 					= "CustomerPartyMaster"
							invoked.Direction				= 2					
							invoked.BODDocumentID			= LocalDocumentID
							invoked.BODVariationID			= LocalVariationID
							invoked.BODID					= LocalBODID
							invoked.Company					= LocalCompany
							invoked.Status					= 1
							invoked.StartDate				= system current timestamp
							invoked.BODXML					= LocalBODXML
							invoked.BODAccountingEntity		= LocalAccountingEntity
							initialize invoked.Error			
							initialize invoked.ErrorMessage
						LocalFSMInboundBODTracker 			= NewBODTracker.FSMInboundBODTracker
					else
						LocalFSMInboundBODTracker 			= FSMInboundBODTracker
						invoke Update FSMInboundBODTrackerRel
							invoked.BODDocumentID			= LocalDocumentID
							invoked.BODVariationID			= LocalVariationID
							invoked.BODID					= LocalBODID
							invoked.Company					= LocalCompany
							invoked.Status					= 1
							invoked.StartDate				= system current timestamp
							invoked.BODXML					= LocalBODXML
							invoked.BODAccountingEntity		= LocalAccountingEntity
							initialize invoked.Error			
							initialize invoked.ErrorMessage
							
					if(ActionCode entered)
						invoke GetCustomerPartyMasterBOD
							invoked.CustomerPartyMasterBOD  = CustomerPartyMasterBOD
			                invoked.PrmInboundTracker 	    = LocalFSMInboundBODTracker
			                invoked.PrmCompany			    = LocalCompany
			       		    invoked.PrmBODDocumentID		= LocalDocumentID 
			       		    invoked.PrmBODAccountingEntity	= LocalAccountingEntity
			       		    
			    else
			    if(FSMInboundBODTracker not entered) 
					invoke Create FSMInboundBODTracker
						assign result to NewBODTracker
						invoked.Verb 					= 2
						invoked.Noun 					= "CustomerPartyMaster"
						invoked.Direction				= 2					
						invoked.BODDocumentID			= LocalDocumentID
						invoked.BODVariationID			= LocalVariationID
						invoked.BODID					= LocalBODID
						invoked.Status					= 4
						invoked.StartDate				= system current timestamp
						invoked.BODXML					= LocalBODXML
						invoked.BODAccountingEntity		= LocalAccountingEntity
						invoked.Company					= LocalCompany
						invoked.CloseDate				= system current timestamp
						invoked.Error					= true			
						invoked.ErrorMessage			= "Process CustomerPartyMaster Inbound BOD Service is not Enabled"  
					LocalFSMInboundBODTracker = NewBODTracker.FSMInboundBODTracker
				else
					LocalFSMInboundBODTracker = FSMInboundBODTracker
					invoke Update FSMInboundBODTrackerRel
						invoked.BODDocumentID			= LocalDocumentID
						invoked.BODVariationID			= LocalVariationID
						invoked.BODID					= LocalBODID
						invoked.Status					= 4
						invoked.StartDate				= system current timestamp
						invoked.BODXML					= LocalBODXML
						invoked.BODAccountingEntity		= LocalAccountingEntity
						invoked.Company					= LocalCompany
						invoked.CloseDate				= system current timestamp
						invoked.Error					= true			
						invoked.ErrorMessage			= "Process CustomerPartyMaster Inbound BOD Service is not Enabled"
						
		GetCustomerPartyMasterBOD is an Import Action
			restricted
			Parameters
				CustomerPartyMasterBOD 		is XMLDocument
				PrmInboundTracker   		is like FSMInboundBODTracker
				PrmCompany					is like ReceivableCompany
				PrmBODDocumentID			is Alpha 100
				PrmBODAccountingEntity      is Alpha 12
			Action Rules
				LocalCompany 		  			  = PrmCompany
				LocalFSMInboundBODTracker 		  = PrmInboundTracker
				LocalDocumentID 				  = PrmBODDocumentID
				LocalAccountingEntity 			  = PrmBODAccountingEntity				
				LocalGenericDelimiter        	  = DerivedGenericDelimiter
				ActionCode					 	  = CustomerPartyMasterBOD select "//DataArea/Process/ActionCriteria/ActionExpression/@actionCode"
				LocalCustomerName			      = CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/Name"
				LocalCustomerContactName	      = CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/Contact/Name"
				LocalCustomerCountryCode	      = CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/Location/Address/CountryCode"
				LocalCustomerDeliveryAddressLine1 = CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/Location/Address/AddressLine[1]"
				LocalCustomerDeliveryAddressLine2 = CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/Location/Address/AddressLine[2]"
				LocalCustomerDeliveryAddressLine3 = CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/Location/Address/AddressLine[3]"
				LocalCustomerDeliveryAddressLine4 = CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/Location/Address/AddressLine[4]"
				LocalCustomerStateProvinance	  = CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/Location/Address/CountrySubDivisionCode"
				LocalCustomerCity				  = CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/Location/Address/CityName"
				LocalCustomerPostalCode			  = CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/Location/Address/PostalCode"
				LocalCommunicationLength 		  = CustomerPartyMasterBOD select "count(//DataArea/CustomerPartyMaster/Communication)"
				LocalContactCommunicationLength   = CustomerPartyMasterBOD select "count(//DataArea/CustomerPartyMaster/Contact/Communication)"
				LocalStatusCode					  = CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/Status/Code"
				LocalCreditLimit                  = CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/CustomerAccount/TotalCreditLimitAmount"
				LocalIterator					  = 1
				while(LocalCommunicationLength >= LocalIterator)
					LocalChannelCode 			  = CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/Communication[<LocalIterator>]/ChannelCode"
					LocalUseCode	 			  = CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/Communication[<LocalIterator>]/UseCode"
					LocalDialNumber	 			  = CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/Communication[<LocalIterator>]/DialNumber"
					LocalURI		 			  = CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/Communication[<LocalIterator>]/URI"
					if(LocalChannelCode = "Phone" and LocalUseCode = "Office")
						LocalCustomerPhoneNumber = LocalDialNumber
					if(LocalChannelCode = "WebSite" and LocalUseCode = "Office")
						LocalCustomerURLAddress = LocalURI
					if(LocalChannelCode = "EMail" and LocalUseCode = "Office")
						LocalCustomerEmail = LocalURI
					LocalIterator 				= LocalIterator +1
				
				LocalIterator					  = 1
				while(LocalContactCommunicationLength >= LocalIterator)
					LocalChannelCode		= CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/Contact/Communication[<LocalIterator>]/ChannelCode"
					LocalUseCode	 		= CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/Contact/Communication[<LocalIterator>]/UseCode"
					LocalCountryDialing		= CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/Contact/Communication[<LocalIterator>]/CountryDialing"
					LocalDialNumber	 		= CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/Contact/Communication[<LocalIterator>]/DialNumber"
					LocalExtension			= CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/Contact/Communication[<LocalIterator>]/Extension"
					LocalURI		 	    = CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/Contact/Communication[<LocalIterator>]/URI"
					if(LocalChannelCode = "Phone" and LocalUseCode  = "Office")
						LocalContactPhoneNumber 	= LocalDialNumber
						LocalContactPhonePrefix		= LocalCountryDialing
						LocalContactPhoneExtension	= LocalExtension
					if(LocalChannelCode= "Phone" and LocalUseCode = "Fax")
						LocalContactFaxNumber 		= LocalDialNumber
						LocalContactFaxExtension	= LocalExtension
					if(LocalChannelCode = "EMail" and LocalUseCode = "Office")
						LocalContactEmail = LocalURI
					LocalIterator = LocalIterator +1
				
				if(LocalStatusCode = "Active")
					LocalActive    = "A"
				else
					LocalActive    = "I"
					
				if(DerivedConfigDocID != "Y")	
					if(ActionCode != "Add" and LocalDocumentID not entered)
						LocalCustomer  = ""
					else
						LocalCustomer  = NativeCustomer
				else
				if(ActionCode != "Add")
					LocalCustomer = LocalDocumentID
				else
					LocalCustomer = ""
				if(GeneralLedgerCompanyRel exists)
					LocalCustomerGroup 			= GeneralLedgerCompanyRel.CustomerBusinessGroup
					LocalFinanceEnterpriseGroup	= GeneralLedgerCompanyRel.FinanceEnterpriseGroup
					LocalCustomerAE				= GeneralLedgerCompanyRel.AccountingEntity
				if(LocalCustomerAE entered)
					LocalCustomerPartyAE = LocalFinanceEnterpriseGroup+DerivedGenericDelimiter+LocalCustomerAE
				else
					LocalCustomerPartyAE = ""

				if(DerivedConfigDocID = "Y")
					LocalCustomerPartyAE = CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/PartyIDs/ID/@accountingEntity"
				else
					LocalCustomerPartyAE = LocalCustomerPartyAE

				if(ActionCode = "Add")
					invoke CreateCustomer
						invoked.CustomerPartyMasterBOD          = CustomerPartyMasterBOD
		                invoked.PrmInboundTracker 			    = LocalFSMInboundBODTracker
		                invoked.PrmCompany			            = LocalCompany
		                invoked.PrmCustomerName				    = LocalCustomerName
		                invoked.PrmCustomerContactName			= LocalCustomerContactName
		                invoked.PrmCustomerCountryCode			= LocalCustomerCountryCode
		                invoked.PrmCustomerDeliveryAddressLine1	= LocalCustomerDeliveryAddressLine1
		                invoked.PrmCustomerDeliveryAddressLine2	= LocalCustomerDeliveryAddressLine2
		                invoked.PrmCustomerDeliveryAddressLine3	= LocalCustomerDeliveryAddressLine3
		                invoked.PrmCustomerDeliveryAddressLine4	= LocalCustomerDeliveryAddressLine4
		                invoked.PrmCustomerStateProvinance		= LocalCustomerStateProvinance
		                invoked.PrmCustomerCity					= LocalCustomerCity
		                invoked.PrmCustomerPostalCode			= LocalCustomerPostalCode
		                invoked.PrmCustomerPhoneNumber			= LocalCustomerPhoneNumber
		                invoked.PrmCustomerURLAddress			= LocalCustomerURLAddress
		                invoked.PrmCustomerEmail				= LocalCustomerEmail
		                invoked.PrmActive						= LocalActive
		                invoked.PrmCustomerGroup				= LocalCustomerGroup
		                invoked.PrmCustomerPartyAE				= LocalCustomerPartyAE
		                invoked.PrmCreditLimit 					= LocalCreditLimit
		                invoked.PrmContactPhoneNumber			= LocalContactPhoneNumber
		                invoked.PrmContactFaxNumber				= LocalContactFaxNumber
						invoked.PrmContactEmail					= LocalContactEmail
			    else
		        	invoke FindCustomer
		        		invoked.CustomerPartyMasterBOD          = CustomerPartyMasterBOD
		                invoked.PrmInboundTracker 			    = LocalFSMInboundBODTracker
		                invoked.PrmCompany			            = LocalCompany
		                invoked.PrmCustomerName				    = LocalCustomerName
		                invoked.PrmCustomerContactName			= LocalCustomerContactName
		                invoked.PrmCustomerCountryCode			= LocalCustomerCountryCode
		                invoked.PrmCustomerDeliveryAddressLine1	= LocalCustomerDeliveryAddressLine1
		                invoked.PrmCustomerDeliveryAddressLine2	= LocalCustomerDeliveryAddressLine2
		                invoked.PrmCustomerDeliveryAddressLine3	= LocalCustomerDeliveryAddressLine3
		                invoked.PrmCustomerDeliveryAddressLine4	= LocalCustomerDeliveryAddressLine4
		                invoked.PrmCustomerStateProvinance		= LocalCustomerStateProvinance
		                invoked.PrmCustomerCity					= LocalCustomerCity
		                invoked.PrmCustomerPostalCode			= LocalCustomerPostalCode
		                invoked.PrmCustomerPhoneNumber			= LocalCustomerPhoneNumber
		                invoked.PrmCustomerURLAddress			= LocalCustomerURLAddress
		                invoked.PrmCustomerEmail				= LocalCustomerEmail
		                invoked.PrmActive						= LocalActive
		                invoked.PrmCustomer						= LocalCustomer
		        		invoked.PrmActionCode					= ActionCode
		        		invoked.PrmCustomerGroup				= LocalCustomerGroup
		                invoked.PrmCustomerPartyAE				= LocalCustomerPartyAE
		                invoked.PrmCreditLimit 					= LocalCreditLimit
		                invoked.PrmContactPhoneNumber			= LocalContactPhoneNumber
		                invoked.PrmContactFaxNumber				= LocalContactFaxNumber
						invoked.PrmContactEmail					= LocalContactEmail		
		                		        
		CreateCustomer 	is an Import Action
			restricted
			Parameters
				CustomerPartyMasterBOD 			is XMLDocument
				PrmInboundTracker   			is like FSMInboundBODTracker
				PrmCompany						is like ReceivableCompany
				PrmCustomerName   				is Alpha 120
				PrmCustomerContactName          is Alpha 20
				PrmCustomerCountryCode     		is Alpha 3
				PrmCustomerDeliveryAddressLine1 is Alpha 40
				PrmCustomerDeliveryAddressLine2 is Alpha 40
				PrmCustomerDeliveryAddressLine3	is Alpha 40
				PrmCustomerDeliveryAddressLine4	is Alpha 40
				PrmCustomerStateProvinance		is Alpha 3
				PrmCustomerCity					is Alpha 58
				PrmCustomerPostalCode			is Alpha 12
				PrmCustomerPhoneNumber			is Alpha 15
				PrmCustomerURLAddress			is URL
				PrmCustomerEmail 				is an EmailAddressMulti 
					holds pii
				PrmActive						is Alpha 1
				PrmCustomerGroup				is Alpha 5
				PrmCustomerPartyAE				is Alpha 40
				PrmCreditLimit                  is Decimal 15
				PrmContactPhoneNumber			is Alpha 15
				PrmContactFaxNumber				is Alpha 15
				PrmContactEmail					is an EmailAddressMulti 
					holds pii
			Action Rules
				LocalCompany 		  				= PrmCompany
				LocalFSMInboundBODTracker 			= PrmInboundTracker
				LocalCustomerName					= PrmCustomerName
				LocalCustomerContactName			= PrmCustomerContactName
				LocalCustomerCountryCode			= PrmCustomerCountryCode
				LocalCustomerDeliveryAddressLine1 	= PrmCustomerDeliveryAddressLine1
				LocalCustomerDeliveryAddressLine2 	= PrmCustomerDeliveryAddressLine2
				LocalCustomerDeliveryAddressLine3 	= PrmCustomerDeliveryAddressLine3
				LocalCustomerDeliveryAddressLine4 	= PrmCustomerDeliveryAddressLine4
				LocalCustomerStateProvinance	  	= PrmCustomerStateProvinance
				LocalCustomerCity				  	= PrmCustomerCity
				LocalCustomerPostalCode			  	= PrmCustomerPostalCode
				LocalCustomerPhoneNumber 			= PrmCustomerPhoneNumber
				LocalCustomerURLAddress 			= PrmCustomerURLAddress
				LocalCustomerEmail 					= PrmCustomerEmail
				LocalActive 						= PrmActive
				LocalCustomerGroup 					= PrmCustomerGroup
				LocalCustomerPartyAE 				= PrmCustomerPartyAE
				LocalCreditLimit					= PrmCreditLimit
				LocalContactPhoneNumber				= PrmContactPhoneNumber
				LocalContactFaxNumber				= PrmContactFaxNumber
				LocalContactEmail					= PrmContactEmail
				
				invoke Create Customer
					assign result to NewCustomer
					resume on error
               			Error            							   = true
                    	ErrorMessage     							   = error message 
					invoked.CustomerGroup 							   = LocalCustomerGroup
					invoked.Contact		   							   = LocalCustomerContactName
					invoked.PostalAddress.Country      				   = LocalCustomerCountryCode
					invoked.PostalAddress.DeliveryAddress.AddressLine1 = LocalCustomerDeliveryAddressLine1
					invoked.PostalAddress.DeliveryAddress.AddressLine2 = LocalCustomerDeliveryAddressLine2
					invoked.PostalAddress.DeliveryAddress.AddressLine3 = LocalCustomerDeliveryAddressLine3
					invoked.PostalAddress.DeliveryAddress.AddressLine4 = LocalCustomerDeliveryAddressLine4
					invoked.PostalAddress.Municipality 				   = LocalCustomerCity
					invoked.PostalAddress.PostalCode 				   = LocalCustomerPostalCode
					invoked.PostalAddress.StateProvince 			   = LocalCustomerStateProvinance
					invoked.Name 									   = LocalCustomerName
					invoked.URLAddress 								   = LocalCustomerURLAddress
					invoked.PhoneNumber.SubscriberNumber			   = LocalContactPhoneNumber
					invoked.EmailAddress 							   = LocalContactEmail
					invoked.CreditLimit								   = LocalCreditLimit
				if(Error)
					invoke Update FSMInboundBODTrackerRel
						invoked.Error 						= Error
						invoked.ErrorMessage 				= ErrorMessage
						invoked.Status						= 2
						invoked.CloseDate					= system current timestamp
					invoke SendPCustomerPartyConfirmBOD
						invoked.PrmErrorMessage 			= "Creating Customer" +", "+"Record Key: "+LocalCustomerPartyAE + "-"+", "+"Message:"+ ErrorMessage 
						invoked.CustomerPartyMasterBOD      = CustomerPartyMasterBOD
						invoked.PrmTrackerID				= LocalFSMInboundBODTracker
					invoke SendPCustomerPartytemACKBOD
                        invoked.PrmErrorMessage 			= "Creating Customer" +", "+"Record Key: "+LocalCustomerPartyAE + "-"+", "+"Message:"+ ErrorMessage 
                        invoked.CustomerPartyMasterBOD      = CustomerPartyMasterBOD
						invoked.PrmTrackerID				= LocalFSMInboundBODTracker
						invoked.PrmCustomerPartyAE			= LocalCustomerPartyAE
				if(!FSMInboundBODTrackerRel.Error)
					invoke CreateCompanyCustomer
						invoked.CustomerPartyMasterBOD      = CustomerPartyMasterBOD
		                invoked.PrmInboundTracker 			= LocalFSMInboundBODTracker		
						invoked.PrmCompany			        = LocalCompany
						invoked.PrmActive				    = LocalActive
						invoked.PrmCustomer					= NewCustomer.Customer
						invoked.PrmCustomerPartyAE			= LocalCustomerPartyAE
						invoked.PrmContactFaxNumber			= LocalContactFaxNumber
						invoked.PrmCustomerURLAddress		= LocalCustomerURLAddress
						
		CreateCompanyCustomer 	is an Import Action
			restricted
			Parameters
				CustomerPartyMasterBOD 			is XMLDocument
				PrmInboundTracker   			is like FSMInboundBODTracker
				PrmCompany						is like ReceivableCompany
				PrmActive						is Alpha 1 
				PrmCustomer						is Numeric 9
				PrmCustomerPartyAE				is Alpha 40
				PrmCustomerURLAddress			is URL
				PrmContactFaxNumber				is Alpha 15
			Action Rules
				LocalCompany 		  		= PrmCompany
				LocalFSMInboundBODTracker 	= PrmInboundTracker
				LocalActive 				= PrmActive
				LocalCustomer				= PrmCustomer
				LocalCustomerPartyAE 		= PrmCustomerPartyAE
				LocalCustomerURLAddress		= PrmCustomerURLAddress
				LocalContactFaxNumber		= PrmContactFaxNumber
				
				if(ReceivableDefaultCodeRel exists)
					LocalReceivableCode		= ReceivableDefaultCodeRel.ReceivableDefaultCode
					invoke Create CompanyCustomer
						resume on error
                   			Error            				= true
                        	ErrorMessage     				= error message 
                        invoked.Company						= LocalCompany
                        invoked.Customer					= LocalCustomer
                        invoked.ReceivableDefaultCode		= LocalReceivableCode
                        invoked.ActiveStatus				= LocalActive
                        invoked.URLAddress 					= LocalCustomerURLAddress
						invoked.FaxNumber.SubscriberNumber	= LocalContactFaxNumber
                    if(Error)
						invoke Update FSMInboundBODTrackerRel
							invoked.Error 						= Error
							invoked.ErrorMessage 				= ErrorMessage
							invoked.Status						= 2
							invoked.CloseDate					= system current timestamp
						invoke SendPCustomerPartyConfirmBOD
							invoked.PrmErrorMessage 			= "Creating CompanyCustomer" +", "+"Record Key: "+LocalCustomerPartyAE + "-"+LocalCustomer+", "+"Message:"+ ErrorMessage 
							invoked.CustomerPartyMasterBOD      = CustomerPartyMasterBOD
							invoked.PrmTrackerID				= LocalFSMInboundBODTracker
						invoke SendPCustomerPartytemACKBOD
                        	invoked.PrmErrorMessage 			= "Creating CompanyCustomer" +", "+"Record Key: "+LocalCustomerPartyAE + "-"+LocalCustomer+", "+"Message:"+ ErrorMessage 
                        	invoked.CustomerPartyMasterBOD      = CustomerPartyMasterBOD
							invoked.PrmTrackerID				= LocalFSMInboundBODTracker
							invoked.PrmCompany			        = LocalCompany
							invoked.PrmCustomer					= LocalCustomer
							invoked.PrmCustomerPartyAE			= LocalCustomerPartyAE
				else
					invoke Update FSMInboundBODTrackerRel
						invoked.Error 							= Error
						invoked.ErrorMessage 					= "Error Processing ProcessCustomerPartyMaster - Unable to find ReceivableDefaultCode of Company"+" "+ LocalCompany
						invoked.Status							= 2
						invoked.CloseDate						= system current timestamp
					invoke SendPCustomerPartyConfirmBOD
						invoked.PrmErrorMessage 				= "Error Processing ProcessCustomerPartyMaster - Unable to find ReceivableDefaultCode of Company"+" "+ LocalCompany
						invoked.CustomerPartyMasterBOD      	= CustomerPartyMasterBOD
						invoked.PrmTrackerID					= LocalFSMInboundBODTracker
					invoke SendPCustomerPartytemACKBOD
                    	invoked.PrmErrorMessage 				= "Error Processing ProcessCustomerPartyMaster - Unable to find ReceivableDefaultCode of Company"+" "+ LocalCompany
                    	invoked.CustomerPartyMasterBOD      	= CustomerPartyMasterBOD
						invoked.PrmTrackerID					= LocalFSMInboundBODTracker
						invoked.PrmCompany			        	= LocalCompany
						invoked.PrmCustomer						= LocalCustomer
						invoked.PrmCustomerPartyAE				= LocalCustomerPartyAE
				if(!FSMInboundBODTrackerRel.Error)
					invoke Update FSMInboundBODTrackerRel
						invoked.Status							= 3
						invoked.CloseDate						= system current timestamp
					invoke SendPCustomerPartytemACKBOD
                        invoked.PrmErrorMessage 				= "CompanyCustomer Created Successfully"
                        invoked.CustomerPartyMasterBOD      	= CustomerPartyMasterBOD
						invoked.PrmTrackerID					= LocalFSMInboundBODTracker
						invoked.PrmCustomer						= LocalCustomer
						invoked.PrmCompany			        	= LocalCompany
						invoked.PrmCustomerPartyAE				= LocalCustomerPartyAE
						
		FindCustomer is an Import Action
			restricted
			Parameters
				CustomerPartyMasterBOD 			is XMLDocument
				PrmInboundTracker   			is like FSMInboundBODTracker
				PrmCompany						is like ReceivableCompany
				PrmCustomerName   				is Alpha 120
				PrmCustomerContactName          is Alpha 20
				PrmCustomerCountryCode     		is Alpha 3
				PrmCustomerDeliveryAddressLine1 is Alpha 40
				PrmCustomerDeliveryAddressLine2 is Alpha 40
				PrmCustomerDeliveryAddressLine3	is Alpha 40
				PrmCustomerDeliveryAddressLine4	is Alpha 40
				PrmCustomerStateProvinance		is Alpha 3
				PrmCustomerCity					is Alpha 58
				PrmCustomerPostalCode			is Alpha 12
				PrmCustomerPhoneNumber			is Alpha 15
				PrmCustomerURLAddress			is URL
				PrmCustomerEmail 				is an EmailAddressMulti 
					holds pii
				PrmActive						is Alpha 1
				PrmCustomer						is Numeric 9
				PrmActionCode					is Alpha 9
				PrmCustomerGroup				is Alpha 5
				PrmCustomerPartyAE				is Alpha 40
				PrmCreditLimit					is Decimal 15
				PrmContactPhoneNumber			is Alpha 15
				PrmContactFaxNumber				is Alpha 15
				PrmContactEmail					is an EmailAddressMulti 
					holds pii	
			Action Rules
				LocalCompany 		  				= PrmCompany
				LocalFSMInboundBODTracker 			= PrmInboundTracker
				LocalCustomerName					= PrmCustomerName
				LocalCustomerContactName			= PrmCustomerContactName
				LocalCustomerCountryCode			= PrmCustomerCountryCode
				LocalCustomerDeliveryAddressLine1 	= PrmCustomerDeliveryAddressLine1
				LocalCustomerDeliveryAddressLine2 	= PrmCustomerDeliveryAddressLine2
				LocalCustomerDeliveryAddressLine3 	= PrmCustomerDeliveryAddressLine3
				LocalCustomerDeliveryAddressLine4 	= PrmCustomerDeliveryAddressLine4
				LocalCustomerStateProvinance	  	= PrmCustomerStateProvinance
				LocalCustomerCity				  	= PrmCustomerCity
				LocalCustomerPostalCode			  	= PrmCustomerPostalCode
				LocalCustomerPhoneNumber 			= PrmCustomerPhoneNumber
				LocalCustomerURLAddress 			= PrmCustomerURLAddress
				LocalCustomerEmail 					= PrmCustomerEmail
				LocalActive 						= PrmActive
				LocalCustomer						= PrmCustomer
				ActionCode							= PrmActionCode
				LocalCustomerGroup 					= PrmCustomerGroup
				LocalCustomerPartyAE 				= PrmCustomerPartyAE
				LocalCreditLimit					= PrmCreditLimit
				LocalContactPhoneNumber				= PrmContactPhoneNumber
				LocalContactFaxNumber				= PrmContactFaxNumber
				LocalContactEmail					= PrmContactEmail
				
				if(CustomerRel exists and (ActionCode = "Replace" or ActionCode = "Change"))
					invoke Update CompanyCustomerRel
						resume on error
	                   		Error            					= true
	                        ErrorMessage     					= error message 
	                    invoked.ActiveStatus					= LocalActive
	                    invoked.EmailAddress 					= LocalContactEmail
	                    invoked.PhoneNumber.SubscriberNumber	= LocalContactPhoneNumber
	                    invoked.CreditLimit						= LocalCreditLimit
	                    invoked.FaxNumber.SubscriberNumber		= LocalContactFaxNumber
	                    invoked.URLAddress						= LocalCustomerURLAddress
	                if(Error)
						invoke Update FSMInboundBODTrackerRel
							invoked.Error 						= Error
							invoked.ErrorMessage 				= ErrorMessage
							invoked.Status						= 2
							invoked.CloseDate					= system current timestamp
						invoke SendPCustomerPartyConfirmBOD
							invoked.PrmErrorMessage 			= "Updating CompanyCustomer" +", "+"Record Key: "+LocalCustomerPartyAE + "-"+LocalCustomer+", "+"Message:"+ ErrorMessage 
							invoked.CustomerPartyMasterBOD      = CustomerPartyMasterBOD
							invoked.PrmTrackerID				= LocalFSMInboundBODTracker
						invoke SendPCustomerPartytemACKBOD
	                    	invoked.PrmErrorMessage 			= "Updating CompanyCustomer" +", "+"Record Key: "+LocalCustomerPartyAE + "-"+LocalCustomer+", "+"Message:"+ ErrorMessage
	                    	invoked.CustomerPartyMasterBOD      = CustomerPartyMasterBOD
							invoked.PrmTrackerID				= LocalFSMInboundBODTracker
							invoked.PrmCustomer					= LocalCustomer
							invoked.PrmCompany			        = LocalCompany
							invoked.PrmCustomerPartyAE			= LocalCustomerPartyAE
								
					if(!FSMInboundBODTrackerRel.Error)
						invoke Update CustomerRel
							resume on error
		                   		Error            							   	= true
		                        ErrorMessage     							   	= error message 
							invoked.Contact = LocalCustomerContactName
							invoked.PostalAddress.Country 						= LocalCustomerCountryCode
							invoked.PostalAddress.DeliveryAddress.AddressLine1 	= LocalCustomerDeliveryAddressLine1
							invoked.PostalAddress.DeliveryAddress.AddressLine2 	= LocalCustomerDeliveryAddressLine2
							invoked.PostalAddress.DeliveryAddress.AddressLine3 	= LocalCustomerDeliveryAddressLine3
							invoked.PostalAddress.DeliveryAddress.AddressLine4 	= LocalCustomerDeliveryAddressLine4
							invoked.PostalAddress.Municipality 					= LocalCustomerCity
							invoked.PostalAddress.PostalCode 					= LocalCustomerPostalCode
							invoked.PostalAddress.StateProvince 				= LocalCustomerStateProvinance
							invoked.Name 										= LocalCustomerName
							invoked.EmailAddress 								= LocalContactEmail
							invoked.URLAddress									= LocalCustomerURLAddress
							invoked.PhoneNumber.SubscriberNumber 				= LocalContactPhoneNumber
							invoked.CreditLimit									= LocalCreditLimit
					 	if(Error)
							invoke Update FSMInboundBODTrackerRel
								invoked.Error 									= Error
								invoked.ErrorMessage 							= ErrorMessage
								invoked.Status									= 2
								invoked.CloseDate								= system current timestamp
							invoke SendPCustomerPartyConfirmBOD
								invoked.PrmErrorMessage 						= "Updating Customer" +", "+"Record Key: "+LocalCustomerPartyAE + "-"+LocalCustomer+", "+"Message:"+ ErrorMessage 
								invoked.CustomerPartyMasterBOD      			= CustomerPartyMasterBOD
								invoked.PrmTrackerID							= LocalFSMInboundBODTracker
							invoke SendPCustomerPartytemACKBOD
		                    	invoked.PrmErrorMessage 						= "Updating Customer" +", "+"Record Key: "+LocalCustomerPartyAE + "-"+LocalCustomer+", "+"Message:"+ ErrorMessage 
		                    	invoked.CustomerPartyMasterBOD      			= CustomerPartyMasterBOD
								invoked.PrmTrackerID							= LocalFSMInboundBODTracker
								invoked.PrmCustomer								= LocalCustomer
								invoked.PrmCompany			        			= LocalCompany
								invoked.PrmCustomerPartyAE						= LocalCustomerPartyAE
					if(!FSMInboundBODTrackerRel.Error)
						invoke Update FSMInboundBODTrackerRel
							invoked.Status									= 3
							invoked.CloseDate								= system current timestamp
						invoke SendPCustomerPartytemACKBOD
	                    	invoked.PrmErrorMessage 						= "CompanyCustomer Updated Successfully"
	                    	invoked.CustomerPartyMasterBOD      			= CustomerPartyMasterBOD
							invoked.PrmTrackerID							= LocalFSMInboundBODTracker
							invoked.PrmCustomer								= LocalCustomer
							invoked.PrmCompany			        			= LocalCompany
							invoked.PrmCustomerPartyAE						= LocalCustomerPartyAE				
			    else
			    if(CustomerRel not exists and (ActionCode = "Replace" or ActionCode = "Change")) 
			    	invoke CreateCustomer
			    		invoked.CustomerPartyMasterBOD          = CustomerPartyMasterBOD
		                invoked.PrmInboundTracker 			    = LocalFSMInboundBODTracker
		                invoked.PrmCompany			            = LocalCompany
		                invoked.PrmCustomerName				    = LocalCustomerName
		                invoked.PrmCustomerContactName			= LocalCustomerContactName
		                invoked.PrmCustomerCountryCode			= LocalCustomerCountryCode
		                invoked.PrmCustomerDeliveryAddressLine1	= LocalCustomerDeliveryAddressLine1
		                invoked.PrmCustomerDeliveryAddressLine2	= LocalCustomerDeliveryAddressLine2
		                invoked.PrmCustomerDeliveryAddressLine3	= LocalCustomerDeliveryAddressLine3
		                invoked.PrmCustomerDeliveryAddressLine4	= LocalCustomerDeliveryAddressLine4
		                invoked.PrmCustomerStateProvinance		= LocalCustomerStateProvinance
		                invoked.PrmCustomerCity					= LocalCustomerCity
		                invoked.PrmCustomerPostalCode			= LocalCustomerPostalCode
		                invoked.PrmCustomerPhoneNumber			= LocalCustomerPhoneNumber
		                invoked.PrmCustomerURLAddress			= LocalCustomerURLAddress
		                invoked.PrmCustomerEmail				= LocalCustomerEmail
		                invoked.PrmActive						= LocalActive
		                invoked.PrmCustomerGroup				= LocalCustomerGroup
			            invoked.PrmCustomerPartyAE				= LocalCustomerPartyAE
			            invoked.PrmCreditLimit 					= LocalCreditLimit
		                invoked.PrmContactPhoneNumber			= LocalContactPhoneNumber
		                invoked.PrmContactFaxNumber				= LocalContactFaxNumber
						invoked.PrmContactEmail					= LocalContactEmail
		        else
			    if(CustomerRel exists and (ActionCode = "Delete"))
			    	invoke Delete CustomerRel
						resume on error
	                   		Error            					= true
	                        ErrorMessage     					= error message 
				 	if(Error)
						invoke Update FSMInboundBODTrackerRel
							invoked.Error 						= Error
							invoked.ErrorMessage 				= ErrorMessage
							invoked.Status						= 2
							invoked.CloseDate					= system current timestamp
						invoke SendPCustomerPartyConfirmBOD
							invoked.PrmErrorMessage 			= "Deleting Customer" +", "+"Record Key: "+LocalCustomerPartyAE + "-"+LocalCustomer+", "+"Message:"+ ErrorMessage
							invoked.CustomerPartyMasterBOD      = CustomerPartyMasterBOD
							invoked.PrmTrackerID				= LocalFSMInboundBODTracker
						invoke SendPCustomerPartytemACKBOD
	                    	invoked.PrmErrorMessage 			= "Deleting Customer" +", "+"Record Key: "+LocalCustomerPartyAE + "-"+LocalCustomer+", "+"Message:"+ ErrorMessage
	                    	invoked.CustomerPartyMasterBOD      = CustomerPartyMasterBOD
							invoked.PrmTrackerID				= LocalFSMInboundBODTracker
							invoked.PrmCustomer					= LocalCustomer
							invoked.PrmCompany			        = LocalCompany
							invoked.PrmCustomerPartyAE			= LocalCustomerPartyAE
					if(!FSMInboundBODTrackerRel.Error)
						invoke Update FSMInboundBODTrackerRel
							invoked.Status						= 3
							invoked.CloseDate					= system current timestamp
						invoke SendPCustomerPartytemACKBOD
	                    	invoked.PrmErrorMessage 			= "CompanyCustomer Deleted Successfully"
	                    	invoked.CustomerPartyMasterBOD      = CustomerPartyMasterBOD
							invoked.PrmTrackerID				= LocalFSMInboundBODTracker
							invoked.PrmCustomer					= LocalCustomer
							invoked.PrmCompany			        = LocalCompany
							invoked.PrmCustomerPartyAE			= LocalCustomerPartyAE
				
				else
			    if(CustomerRel not exists and (ActionCode = "Delete"))
			    	
			    	invoke Update FSMInboundBODTrackerRel
						invoked.Error 						= Error
						invoked.ErrorMessage 				= "Unable to find Customer"+" " +LocalCustomer+" "+"to Delete"
						invoked.Status						= 2
						invoked.CloseDate					= system current timestamp
					invoke SendPCustomerPartyConfirmBOD
						invoked.PrmErrorMessage 			= "Unable to find Customer"+" " +LocalCustomer+" "+"to Delete"
						invoked.CustomerPartyMasterBOD      = CustomerPartyMasterBOD
						invoked.PrmTrackerID				= LocalFSMInboundBODTracker
					invoke SendPCustomerPartytemACKBOD
	                	invoked.PrmErrorMessage 			= "Unable to find Customer"+" " +LocalCustomer+" "+"to Delete"
	                	invoked.CustomerPartyMasterBOD      = CustomerPartyMasterBOD
						invoked.PrmTrackerID				= LocalFSMInboundBODTracker
						invoked.PrmCustomer					= LocalCustomer
						invoked.PrmCompany			        = LocalCompany
						invoked.PrmCustomerPartyAE			= LocalCustomerPartyAE	
						
		SendPCustomerPartyConfirmBOD is an Instance Action
			restricted			
			Parameters
				CustomerPartyMasterBOD 	is XMLDocument
				PrmErrorMessage 		is Alpha 300
				PrmTrackerID			is Numeric 15
			Action Rules
				LocalPCustomerPartyMasterXML		= CustomerPartyMasterBOD
				LocalErrorMessage					= PrmErrorMessage
				LocalTrackerID						= PrmTrackerID
				LocalFromLogicalID					= CustomerPartyMasterBOD select "//ApplicationArea/Sender/LogicalID"
				LocalComponentID					= CustomerPartyMasterBOD select "//ApplicationArea/Sender/ComponentID"
				LocalBODID							= CustomerPartyMasterBOD select "//ApplicationArea/BODID"
				LocalDocumentID						= CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/PartyIDs/ID"
				LocalAccountingEntity				= CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/PartyIDs/ID/@accountingEntity"
				LocalOriginalCreateDateTime			= CustomerPartyMasterBOD select "//ApplicationArea/CreationDateTime"
				LocalConfirmBOD						= "true"
				LocalMainUserTemplate				= "IONProcessCustomerPartyMaster_ConfirmBOD_ST"
				if(UserTemplateRel exists)
					send ion bod
						bod is ProcessCustomerPartyMasterConfirmBODXML
						bod type is "Confirm.BOD"
						accounting entity is LocalAccountingEntity
						document id is LocalDocumentID	
						
		SendPCustomerPartytemACKBOD is an Instance Action
			restricted			
			Parameters
				CustomerPartyMasterBOD 					is XMLDocument
				PrmErrorMessage 						is Alpha 300
				PrmTrackerID							is Numeric 15
				PrmCustomerPartyAE						is Alpha 40
				PrmCustomer								is Numeric 9
				PrmCompany								is like ReceivableCompany
			Action Rules
				LocalPCustomerPartyMasterXML			= CustomerPartyMasterBOD
				LocalErrorMessage						= PrmErrorMessage
				LocalTrackerID							= PrmTrackerID
				LocalCustomerPartyAE 					= PrmCustomerPartyAE	
				LocalCustomer 							= PrmCustomer
				LocalCompany 		  					= PrmCompany
				LocalComponentID						= CustomerPartyMasterBOD select "//ApplicationArea/Sender/ComponentID"
				LocalBODID								= CustomerPartyMasterBOD select "//ApplicationArea/BODID"
				LocalTaskID								= CustomerPartyMasterBOD select "//ApplicationArea/Sender/TaskID"
				LocalReferenceID						= CustomerPartyMasterBOD select "//ApplicationArea/Sender/ReferenceID"
				LocalConfirmationCode					= CustomerPartyMasterBOD select "//ApplicationArea/Sender/ConfirmationCode"
				LocalAuthorizationID					= CustomerPartyMasterBOD select "//ApplicationArea/Sender/AuthorizationID"
				LocalFromLogicalID						= CustomerPartyMasterBOD select "//ApplicationArea/Sender/LogicalID"
				LocalOriginalCreateDateTime				= CustomerPartyMasterBOD select "//ApplicationArea/CreationDateTime"
				LocalDocumentID							= CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/PartyIDs/ID"
				LocalAccountingEntity					= CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/PartyIDs/ID/@accountingEntity"
				Locallid 								= CustomerPartyMasterBOD select "//DataArea/CustomerPartyMaster/PartyIDs/ID/@lid"
				LocalMainUserTemplate					= "IONProcessCustomerPartyMaster_AcknowledgeBOD_ST"
				
				if(UserTemplateRel exists)
					send ion bod
						bod is ProcessCustomerPartyAcknowledgeBODXML
						bod type is "Acknowledge.CustomerPartyMaster"	
						accounting entity is LocalAccountingEntity
						document id is LocalDocumentID
						

		
		ProcessContactMasterBODImport is an Import Action
			restricted
			bod type is Process.ContactMaster			
			Parameters
				ContactMasterBOD 		 	is XMLDocument	
			Action Rules
				LocalBODXML					 = ContactMasterBOD
				LocalGenericDelimiter        = DerivedGenericDelimiter
				LocalHeaderAccountingEntity  = ContactMasterBOD select "//DataArea/ContactMaster/IDs/ID/@accountingEntity"
				LocalVariationID             = ContactMasterBOD select "//DataArea/ContactMaster/IDs/ID/@variationID"
				LocalBODID                   = ContactMasterBOD select "//ApplicationArea/BODID"
				ActionCode					 = ContactMasterBOD select "//DataArea/Process/ActionCriteria/ActionExpression/@actionCode"
				LocalEmployerReferenceLength = ContactMasterBOD select "count(//DataArea/ContactMaster/EmployerReference)"
				LocalIterator = 1
				while (LocalEmployerReferenceLength >= LocalIterator)					
					LocalNameValue 	  = ContactMasterBOD select "//DataArea/ContactMaster/EmployerReference[<LocalIterator>]/@type"
					LocalNameValue1   = ContactMasterBOD select "//DataArea/ContactMaster/EmployerReference[<LocalIterator>]/DocumentID/ID"
					LocalNameValue2   = ContactMasterBOD select "//DataArea/ContactMaster/EmployerReference[<LocalIterator>]/DocumentID/ID/@accountingEntity"
					LocalNameValue3   = ContactMasterBOD select "//DataArea/ContactMaster/EmployerReference[<LocalIterator>]/DocumentID/ID/@lid"	
					if(LocalNameValue = "Customer")
						LocalDocumentID 		= LocalNameValue1
						LocalAccountingEntity 	= LocalNameValue2
						Locallid			  	= LocalNameValue3														
					LocalIterator = LocalIterator + 1
				if(LocalHeaderAccountingEntity entered)
					LocalAccountingEntity 		= LocalHeaderAccountingEntity 
				LocalCrossAccountingEntity	 	= FSMBODCrossReferenceDetailRel.DestinationValue
				if(DerivedConfigDocID = "Y")
					if(FSMBODCleanDocIDRel.DestinationValue entered)
						LocalCrossAccountingEntity =  FSMBODCleanDocIDRel.DestinationValue
					else
						LocalCrossAccountingEntity	=  LocalAccountingEntity
						
					if(DerivedConfigFEG != "Y")
						LocalAccountingEntity = LocalCrossAccountingEntity
					else
						if(LocalCrossAccountingEntity entered)
							LocalAccountingEntity = LocalCrossAccountingEntity
							LocalAccountingEntity = NativeCompany
						else
							LocalAccountingEntity = ""
					LocalCompany	=	LocalAccountingEntity
				else
				if(LocalCrossAccountingEntity entered)
					LocalCompany				= FSMBODCrossReferenceCompanyDetailRel.DestinationValue
				else 
				if(DerivedDefaultCompany entered)
					LocalCompany				= DerivedDefaultCompany
				
				if(FSMBODConfigurationContactMasterRel exists and FSMBODConfigurationContactMasterRel.Enable)
					if(FSMInboundBODTracker not entered)
						invoke Create FSMInboundBODTracker
							assign result to NewBODTracker
							invoked.Verb 					= 2
							invoked.Noun 					= "ContactMaster"
							invoked.Direction				= 2				
							invoked.BODID					= LocalBODID
							invoked.Status					= 1
							invoked.StartDate				= system current timestamp
							invoked.BODXML					= LocalBODXML
							invoked.Company					= LocalCompany
							invoked.BODDocumentID			= LocalDocumentID
							invoked.BODAccountingEntity		= LocalAccountingEntity
							invoked.BODVariationID			= LocalVariationID
							initialize invoked.Error			
							initialize invoked.ErrorMessage
							
						LocalFSMInboundBODTracker = NewBODTracker.FSMInboundBODTracker
					else
						LocalFSMInboundBODTracker = FSMInboundBODTracker
						invoke Update FSMInboundBODTrackerRel
							invoked.BODID					= LocalBODID
							invoked.Status					= 1
							invoked.StartDate				= system current timestamp
							invoked.BODXML					= LocalBODXML
							invoked.Company					= LocalCompany
							invoked.BODDocumentID			= LocalDocumentID
							invoked.BODAccountingEntity		= LocalAccountingEntity
							invoked.BODVariationID			= LocalVariationID
							initialize invoked.Error			
							initialize invoked.ErrorMessage
							
					if(ActionCode entered)
						invoke GetContactMasterBOD
							invoked.ContactMasterBOD      		= ContactMasterBOD
			                invoked.PrmInboundTracker 			= LocalFSMInboundBODTracker
			                invoked.PrmCompany					= LocalCompany
			       		    invoked.PrmBODAccountingEntity		= LocalAccountingEntity
			       		    invoked.PrmBODDocumentID			= LocalDocumentID
			       		    invoked.PrmActionCode				= ActionCode
			                invoked.Prmlid						= Locallid
		     	else 
				if(FSMInboundBODTracker not entered)
					invoke Create FSMInboundBODTracker
						assign result to NewBODTracker
						invoked.Verb 							= 2
						invoked.Noun 							= "ContactMaster"
						invoked.Direction						= 2					
						invoked.BODVariationID					= LocalVariationID
						invoked.BODID							= LocalBODID
						invoked.BODDocumentID					= LocalDocumentID
						invoked.Status							= 4
						invoked.StartDate						= system current timestamp
						invoked.BODXML							= LocalBODXML
						invoked.Company							= LocalCompany
						invoked.BODAccountingEntity				= LocalAccountingEntity
						invoked.CloseDate						= system current timestamp
						invoked.Error							= true			
						invoked.ErrorMessage					= "Process ContactMaster Inbound BOD Service is not Enabled"
					LocalFSMInboundBODTracker = NewBODTracker.FSMInboundBODTracker	  
				else
					LocalFSMInboundBODTracker = FSMInboundBODTracker
					invoke Update FSMInboundBODTrackerRel
						invoked.BODVariationID					= LocalVariationID
						invoked.BODID							= LocalBODID
						invoked.BODDocumentID					= LocalDocumentID
						invoked.Status							= 4
						invoked.StartDate						= system current timestamp
						invoked.BODXML							= LocalBODXML
						invoked.Company							= LocalCompany
						invoked.BODAccountingEntity				= LocalAccountingEntity
						invoked.CloseDate						= system current timestamp
						invoked.Error							= true			
						invoked.ErrorMessage					= "Process ContactMaster Inbound BOD Service is not Enabled"
						
		GetContactMasterBOD is an Import Action
			restricted
			Parameters
				ContactMasterBOD 			is XMLDocument
				PrmInboundTracker   		is like FSMInboundBODTracker
				PrmCompany					is like ReceivableCompany
				PrmBODAccountingEntity      is Alpha 12
				PrmActionCode				is Alpha 9 
				PrmBODDocumentID			is Alpha 50
				Prmlid						is Alpha 300
			Action Rules
				LocalCompany 		  			  = PrmCompany
				LocalFSMInboundBODTracker 		  = PrmInboundTracker
				LocalAccountingEntity 	  		  = PrmBODAccountingEntity
				ActionCode						  = PrmActionCode	
				LocalDocumentID					  =	PrmBODDocumentID
				Locallid						  =	Prmlid
				LocalGenericDelimiter        	  = DerivedGenericDelimiter
				LocalBODXML					 	  = ContactMasterBOD
				if(LocalDocumentID entered)
					LocalCustomer = NativeCustomer
				LocalCustomerContactName		  = ContactMasterBOD select "//DataArea/ContactMaster/FamilyName"
				LocalCCContactCode				  = ContactMasterBOD select "//DataArea/ContactMaster/IDs/ID"
				LocalCommunicationLength 		  = ContactMasterBOD select "count(//DataArea/ContactMaster/CommunicationDetail)"
				LocalLoop						  = 1
				while(LocalCommunicationLength >= LocalLoop)
					LocalChannelCode 			  = ContactMasterBOD select "//DataArea/ContactMaster/CommunicationDetail[<LocalLoop>]/ChannelCode"
					LocalUseCode	    		  = ContactMasterBOD select "//DataArea/ContactMaster/CommunicationDetail[<LocalLoop>]/UseCode"
					LocalDialNumber	 			  = ContactMasterBOD select "//DataArea/ContactMaster/CommunicationDetail[<LocalLoop>]/DialNumber"
					LocalURI		 			  = ContactMasterBOD select "//DataArea/ContactMaster/CommunicationDetail[<LocalLoop>]/URI"
					LocalExtension	 			  = ContactMasterBOD select "//DataArea/ContactMaster/CommunicationDetail[<LocalLoop>]/Extension"
					LocalCountryDialing			  = ContactMasterBOD select "//DataArea/ContactMaster/CommunicationDetail[<LocalLoop>]/CountryDialing"
					if(LocalChannelCode = "Phone" and LocalUseCode = "Office")
						LocalCustomerPhoneNumber 	= LocalDialNumber
						LocalCustomerPhonePrefix 	= LocalCountryDialing
						LocalCustomerPhoneExtension	= LocalExtension
					if(LocalChannelCode = "Phone" and LocalUseCode = "Fax")
						LocalCustomerFaxNumber 		= LocalDialNumber
						LocalCustomerFaxExtension	= LocalExtension
					if(LocalChannelCode = "EMail" and LocalUseCode = "Office")
						LocalCustomerEmail = LocalURI
					LocalLoop = LocalLoop +1
				
				if(ActionCode != "Add" and LocalCCContactCode entered)
					LocalCCContactCode = NativeContactCode
				else
					LocalCCContactCode = ""
					
				if(ActionCode = "Add")
					invoke CreateCompanyCustomerContact
						invoked.ContactMasterBOD          		= ContactMasterBOD
		                invoked.PrmInboundTracker 			    = LocalFSMInboundBODTracker
		                invoked.PrmCompany			            = LocalCompany
		                invoked.PrmCustomer						= LocalCustomer
		                invoked.PrmContactName					= LocalCustomerContactName
		                invoked.PrmCustomerPhonePrefix			= LocalCustomerPhonePrefix
		                invoked.PrmCustomerPhoneNumber			= LocalCustomerPhoneNumber
		                invoked.PrmCustomerPhoneExtension		= LocalCustomerPhoneExtension
		                invoked.PrmCustomerFaxNumber			= LocalCustomerFaxNumber
		                invoked.PrmCustomerFaxExtension			= LocalCustomerFaxExtension
		                invoked.PrmCustomerEmail				= LocalCustomerEmail
		                invoked.Prmlid							= Locallid
		                invoked.PrmAccountingEntity				= LocalAccountingEntity
		        else
		        	invoke FindCompanyCustomerContact
		        		invoked.ContactMasterBOD          		= ContactMasterBOD
		                invoked.PrmInboundTracker 			    = LocalFSMInboundBODTracker
		                invoked.PrmCompany			            = LocalCompany
		                invoked.PrmCustomer						= LocalCustomer
		                invoked.PrmContactName					= LocalCustomerContactName
		                invoked.PrmCustomerPhonePrefix			= LocalCustomerPhonePrefix
		                invoked.PrmCustomerPhoneNumber			= LocalCustomerPhoneNumber
		                invoked.PrmCustomerPhoneExtension		= LocalCustomerPhoneExtension
		                invoked.PrmCustomerFaxNumber			= LocalCustomerFaxNumber
		                invoked.PrmCustomerFaxExtension			= LocalCustomerFaxExtension
		                invoked.PrmCustomerEmail				= LocalCustomerEmail
		                invoked.Prmlid							= Locallid
		                invoked.PrmCCContactCode				= LocalCCContactCode
		                invoked.PrmActionCode					= ActionCode
		                invoked.PrmAccountingEntity				= LocalAccountingEntity
			                
					                
		CreateCompanyCustomerContact  is an Import Action
			restricted
			Parameters
				ContactMasterBOD 				is XMLDocument
				PrmInboundTracker   			is like FSMInboundBODTracker
				PrmCompany						is like ReceivableCompany
				PrmCustomer						is Numeric 9
				PrmContactName          		is Alpha 80
				PrmCustomerPhonePrefix     		is Alpha 6
				PrmCustomerPhoneNumber 			is Alpha 15
				PrmCustomerPhoneExtension 		is Alpha 10
				PrmCustomerFaxNumber			is Alpha 15
				PrmCustomerFaxExtension			is Alpha 10
				PrmCustomerEmail				is an EmailAddressMulti 
					holds pii
				Prmlid							is Alpha 58
				PrmAccountingEntity				is Alpha 12
			Action Rules
				LocalCompany 		  				= PrmCompany
				LocalFSMInboundBODTracker 			= PrmInboundTracker
				LocalCustomer						= PrmCustomer
				LocalCustomerContactName			= PrmContactName
				LocalCustomerPhonePrefix			= PrmCustomerPhonePrefix
				LocalCustomerPhoneNumber 			= PrmCustomerPhoneNumber
				LocalCustomerPhoneExtension 		= PrmCustomerPhoneExtension
				LocalCustomerFaxNumber 				= PrmCustomerFaxNumber
				LocalCustomerFaxExtension 			= PrmCustomerFaxExtension
				LocalCustomerEmail	  				= PrmCustomerEmail
				Locallid				  			= Prmlid
				LocalAccountingEntity				= PrmAccountingEntity
				invoke CreateContactNumber CompanyCustomerContact
					assign result to NewCompanyCustomerContact
					resume on error
                   		Error            					= true
                        ErrorMessage     					= error message 
                    invoked.Company							= LocalCompany
                    invoked.Customer						= LocalCustomer
                    invoked.Name							= LocalCustomerContactName
                    invoked.PhoneNumber.InternationalPrefix	= LocalCustomerPhonePrefix
                    invoked.PhoneNumber.Extension			= LocalCustomerPhoneExtension
                    invoked.PhoneNumber.SubscriberNumber	= LocalCustomerPhoneNumber
                    invoked.FaxNumber.Extension				= LocalCustomerFaxExtension
                    invoked.FaxNumber.SubscriberNumber		= LocalCustomerFaxNumber
                    invoked.EmailAddress					= LocalCustomerEmail
                if(Error)
					invoke Update FSMInboundBODTrackerRel
						invoked.Error 						= Error
						invoked.ErrorMessage 				= ErrorMessage
						invoked.Status						= 2
						invoked.CloseDate					= system current timestamp
					invoke SendPContactMasterConfirmBOD
						invoked.PrmErrorMessage 			= ErrorMessage
						invoked.ContactMasterBOD      		= ContactMasterBOD
						invoked.PrmTrackerID				= LocalFSMInboundBODTracker
						invoked.PrmAccountingEntity			= LocalAccountingEntity
					invoke SendPContactMasterACKBOD
                    	invoked.PrmErrorMessage 			= ErrorMessage
                    	invoked.ContactMasterBOD      		= ContactMasterBOD
						invoked.PrmTrackerID				= LocalFSMInboundBODTracker
						invoked.PrmCustomer					= LocalCustomer
						invoked.PrmCompany			        = LocalCompany
						invoked.PrmAccountingEntity			= LocalAccountingEntity
						invoked.Prmlid						= Locallid
				if(!FSMInboundBODTrackerRel.Error)
					invoke Update FSMInboundBODTrackerRel
						invoked.Status						= 3
						invoked.CloseDate					= system current timestamp
					invoke SendPContactMasterACKBOD
                    	invoked.PrmErrorMessage 			= "CompanyCustomerContact Created Successfully"
                    	invoked.ContactMasterBOD      		= ContactMasterBOD
						invoked.PrmTrackerID				= LocalFSMInboundBODTracker
						invoked.PrmCustomer					= LocalCustomer
						invoked.PrmCompany			        = LocalCompany
						invoked.PrmAccountingEntity			= LocalAccountingEntity
						invoked.Prmlid						= Locallid
						invoked.PrmCompanyCustomerContact	= NewCompanyCustomerContact.CompanyCustomerContact
						
		FindCompanyCustomerContact  is an Import Action
			restricted
			Parameters
				ContactMasterBOD 				is XMLDocument
				PrmInboundTracker   			is like FSMInboundBODTracker
				PrmCompany						is like ReceivableCompany
				PrmCustomer						is Numeric 9
				PrmContactName          		is Alpha 80
				PrmCustomerPhonePrefix     		is Alpha 6
				PrmCustomerPhoneNumber 			is Alpha 15
				PrmCustomerPhoneExtension 		is Alpha 10
				PrmCustomerFaxNumber			is Alpha 15
				PrmCustomerFaxExtension			is Alpha 10
				PrmCustomerEmail				is an EmailAddressMulti 
					holds pii
				Prmlid							is Alpha 58
				PrmCCContactCode				is Alpha 5
				PrmActionCode					is Alpha 9 
				PrmAccountingEntity				is Alpha 12
			Action Rules
				LocalCompany 		  				= PrmCompany
				LocalFSMInboundBODTracker 			= PrmInboundTracker
				LocalCustomer						= PrmCustomer
				LocalCustomerContactName			= PrmContactName
				LocalCustomerPhonePrefix			= PrmCustomerPhonePrefix
				LocalCustomerPhoneNumber 			= PrmCustomerPhoneNumber
				LocalCustomerPhoneExtension 		= PrmCustomerPhoneExtension
				LocalCustomerFaxNumber 				= PrmCustomerFaxNumber
				LocalCustomerFaxExtension 			= PrmCustomerFaxExtension
				LocalCustomerEmail	  				= PrmCustomerEmail
				Locallid				  			= Prmlid
				LocalCCContactCode					= PrmCCContactCode
				ActionCode							= PrmActionCode
				LocalAccountingEntity				= PrmAccountingEntity
				
				if(CompanyCustomerContactRel exists and (ActionCode = "Replace" or ActionCode = "Change"))
					invoke Update CompanyCustomerContactRel
						resume on error
	                   		Error            					= true
	                        ErrorMessage     					= error message 
	                    invoked.Company							= LocalCompany
	                    invoked.Customer						= LocalCustomer
	                    invoked.Name							= LocalCustomerContactName
	                    invoked.PhoneNumber.InternationalPrefix	= LocalCustomerPhonePrefix
	                    invoked.PhoneNumber.Extension			= LocalCustomerPhoneExtension
	                    invoked.PhoneNumber.SubscriberNumber	= LocalCustomerPhoneNumber
	                    invoked.FaxNumber.Extension				= LocalCustomerFaxExtension
	                    invoked.FaxNumber.SubscriberNumber		= LocalCustomerFaxNumber
	                    invoked.EmailAddress					= LocalCustomerEmail
	                if(Error)
						invoke Update FSMInboundBODTrackerRel
							invoked.Error 						= Error
							invoked.ErrorMessage 				= ErrorMessage
							invoked.Status						= 2
							invoked.CloseDate					= system current timestamp
						invoke SendPContactMasterConfirmBOD
							invoked.PrmErrorMessage 			= ErrorMessage
							invoked.ContactMasterBOD      		= ContactMasterBOD
							invoked.PrmTrackerID				= LocalFSMInboundBODTracker
							invoked.PrmAccountingEntity			= LocalAccountingEntity
						invoke SendPContactMasterACKBOD
	                    	invoked.PrmErrorMessage 			= ErrorMessage
	                    	invoked.ContactMasterBOD	        = ContactMasterBOD
							invoked.PrmTrackerID				= LocalFSMInboundBODTracker
							invoked.PrmCustomer					= LocalCustomer
							invoked.PrmCompany			        = LocalCompany
							invoked.Prmlid						= Locallid
							invoked.PrmAccountingEntity			= LocalAccountingEntity
					if(!FSMInboundBODTrackerRel.Error)
						invoke Update FSMInboundBODTrackerRel
							invoked.Status						= 3
							invoked.CloseDate					= system current timestamp
						invoke SendPContactMasterACKBOD
	                    	invoked.PrmErrorMessage 			= "CompanyCustomerContact Updated Successfully"
	                    	invoked.ContactMasterBOD      		= ContactMasterBOD
							invoked.PrmTrackerID				= LocalFSMInboundBODTracker
							invoked.PrmCustomer					= LocalCustomer
							invoked.PrmCompany			        = LocalCompany
							invoked.PrmAccountingEntity			= LocalAccountingEntity
							invoked.Prmlid						= Locallid
							invoked.PrmCompanyCustomerContact	= LocalCCContactCode
				else
				if(CompanyCustomerContactRel not exists and (ActionCode = "Replace" or ActionCode = "Change"))
					invoke CreateCompanyCustomerContact
						invoked.ContactMasterBOD          		= ContactMasterBOD
		                invoked.PrmInboundTracker 			    = LocalFSMInboundBODTracker
		                invoked.PrmCompany			            = LocalCompany
		                invoked.PrmCustomer						= LocalCustomer
		                invoked.PrmContactName					= LocalCustomerContactName
		                invoked.PrmCustomerPhonePrefix			= LocalCustomerPhonePrefix
		                invoked.PrmCustomerPhoneNumber			= LocalCustomerPhoneNumber
		                invoked.PrmCustomerPhoneExtension		= LocalCustomerPhoneExtension
		                invoked.PrmCustomerFaxNumber			= LocalCustomerFaxNumber
		                invoked.PrmCustomerFaxExtension			= LocalCustomerFaxExtension
		                invoked.PrmCustomerEmail				= LocalCustomerEmail
		                invoked.Prmlid							= Locallid
		                invoked.PrmAccountingEntity				= LocalAccountingEntity
		        else       
				if(CompanyCustomerContactRel exists and (ActionCode = "Delete"))
					invoke Delete CompanyCustomerContactRel
						resume on error
	                   		Error            					= true
	                        ErrorMessage     					= error message 
	                if(Error)
						invoke Update FSMInboundBODTrackerRel
							invoked.Error 						= Error
							invoked.ErrorMessage 				= ErrorMessage
							invoked.Status						= 2
							invoked.CloseDate					= system current timestamp
						invoke SendPContactMasterConfirmBOD
							invoked.PrmErrorMessage 			= ErrorMessage
							invoked.ContactMasterBOD      		= ContactMasterBOD
							invoked.PrmTrackerID				= LocalFSMInboundBODTracker
							invoked.PrmAccountingEntity			= LocalAccountingEntity
						invoke SendPContactMasterACKBOD
	                    	invoked.PrmErrorMessage 			= ErrorMessage
	                    	invoked.ContactMasterBOD      		= ContactMasterBOD
							invoked.PrmTrackerID				= LocalFSMInboundBODTracker
							invoked.PrmCustomer					= LocalCustomer
							invoked.PrmCompany			        = LocalCompany
							invoked.Prmlid						= Locallid
							invoked.PrmAccountingEntity			= LocalAccountingEntity
					if(!FSMInboundBODTrackerRel.Error)
						invoke Update FSMInboundBODTrackerRel
							invoked.Status						= 3
							invoked.CloseDate					= system current timestamp
						invoke SendPContactMasterACKBOD
	                    	invoked.PrmErrorMessage 			= "CompanyCustomerContact Deleted Successfully"
	                    	invoked.ContactMasterBOD      		= ContactMasterBOD
							invoked.PrmTrackerID				= LocalFSMInboundBODTracker
							invoked.PrmCustomer					= LocalCustomer
							invoked.PrmCompany			        = LocalCompany
							invoked.PrmAccountingEntity			= LocalAccountingEntity
							invoked.Prmlid						= Locallid
							invoked.PrmCompanyCustomerContact	= LocalCCContactCode
				else       
				if(CompanyCustomerContactRel not exists and (ActionCode = "Delete"))			
					invoke Update FSMInboundBODTrackerRel
						invoked.Error 						= Error
						invoked.ErrorMessage 				= "Error Processing ProcessContactMaster - Unable to find CompanyCustomerContact"+" "+ LocalCCContactCode+" "+"for Customer"+" "+LocalCustomer+" "+"to Delete."
						invoked.Status						= 2
						invoked.CloseDate					= system current timestamp
					invoke SendPContactMasterConfirmBOD
						invoked.PrmErrorMessage 			= "Error Processing ProcessContactMaster - Unable to find CompanyCustomerContact"+" "+ LocalCCContactCode+" "+"for Customer"+" "+LocalCustomer+" "+"to Delete."
						invoked.ContactMasterBOD      		= ContactMasterBOD
						invoked.PrmTrackerID				= LocalFSMInboundBODTracker
						invoked.PrmAccountingEntity			= LocalAccountingEntity
					invoke SendPContactMasterACKBOD
	                	invoked.PrmErrorMessage 			= "Error Processing ProcessContactMaster - Unable to find CompanyCustomerContact"+" "+ LocalCCContactCode+" "+"for Customer"+" "+LocalCustomer+" "+"to Delete."
	                	invoked.ContactMasterBOD      		= ContactMasterBOD
						invoked.PrmTrackerID				= LocalFSMInboundBODTracker
						invoked.PrmCustomer					= LocalCustomer
						invoked.PrmCompany			        = LocalCompany
						invoked.Prmlid						= Locallid
						invoked.PrmAccountingEntity			= LocalAccountingEntity	
						
		SendPContactMasterACKBOD is an Instance Action
			restricted			
			Parameters
				ContactMasterBOD 						is XMLDocument
				PrmErrorMessage 						is Alpha 300
				PrmTrackerID							is Numeric 15
				PrmAccountingEntity						is Alpha 12
				PrmCustomer								is Numeric 9
				PrmCompany								is like ReceivableCompany
				PrmCompanyCustomerContact				is Alpha 5
				Prmlid									is Alpha 58
			Action Rules
				LocalPCustomerPartyMasterXML			= ContactMasterBOD
				LocalErrorMessage						= PrmErrorMessage
				LocalTrackerID							= PrmTrackerID
				LocalAccountingEntity					= PrmAccountingEntity	
				LocalCustomer 							= PrmCustomer
				LocalCompany 		  					= PrmCompany
				LocalCCContactCode						= PrmCompanyCustomerContact
				Locallid				  				= Prmlid
				LocalComponentID						= ContactMasterBOD select "//ApplicationArea/Sender/ComponentID"
				LocalBODID								= ContactMasterBOD select "//ApplicationArea/BODID"
				LocalTaskID								= ContactMasterBOD select "//ApplicationArea/Sender/TaskID"
				LocalReferenceID						= ContactMasterBOD select "//ApplicationArea/Sender/ReferenceID"
				LocalConfirmationCode					= ContactMasterBOD select "//ApplicationArea/Sender/ConfirmationCode"
				LocalAuthorizationID					= ContactMasterBOD select "//ApplicationArea/Sender/AuthorizationID"
				LocalFromLogicalID						= ContactMasterBOD select "//ApplicationArea/Sender/LogicalID"
				LocalOriginalCreateDateTime				= ContactMasterBOD select "//ApplicationArea/CreationDateTime"
				LocalDocumentID							= ContactMasterBOD select "//DataArea/ContactMaster/IDs/ID"
				LocalMainUserTemplate					= "IONProcessContactMaster_AcknowledgeBOD_ST"
				
				if(UserTemplateRel exists)
					send ion bod
						bod is ProcessContactMasterAcknowledgeBODXML
						bod type is "Acknowledge.ContactMaster"	
						accounting entity is LocalAccountingEntity
						document id is LocalDocumentID
						
		SendPContactMasterConfirmBOD is an Instance Action
			restricted			
			Parameters
				ContactMasterBOD 		is XMLDocument
				PrmErrorMessage 		is Alpha 300
				PrmTrackerID			is Numeric 15
				PrmAccountingEntity		is Alpha 12
			Action Rules
				LocalPContactMasterXML				= ContactMasterBOD
				LocalErrorMessage					= PrmErrorMessage
				LocalTrackerID						= PrmTrackerID
				LocalAccountingEntity				= PrmAccountingEntity
				LocalFromLogicalID					= ContactMasterBOD select "//ApplicationArea/Sender/LogicalID"
				LocalComponentID					= ContactMasterBOD select "//ApplicationArea/Sender/ComponentID"
				LocalBODID							= ContactMasterBOD select "//ApplicationArea/BODID"
				LocalDocumentID						= ContactMasterBOD select "//DataArea/ContactMaster/IDs/ID"
				LocalOriginalCreateDateTime			= ContactMasterBOD select "//ApplicationArea/CreationDateTime"
				LocalConfirmBOD						= "true"
				LocalMainUserTemplate				= "IONProcessContactMaster_ConfirmBOD_ST"
				if(UserTemplateRel exists)
					send ion bod
						bod is ProcessContactMasterConfirmBODXML
						bod type is "Confirm.BOD"
						accounting entity is LocalAccountingEntity
						document id is LocalDocumentID							
						


		SyncInvoiceBODImport is an Import Action
			restricted
			bod type is Sync.Invoice			
			Parameters
				SyncInvoiceBOD 				is XMLDocument
			Action Rules
				LocalBODXML					= SyncInvoiceBOD
				LocalAccountingEntity		= SyncInvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID/@accountingEntity"
				LocalInvoice				= SyncInvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DisplayID"
				LocalDocumentID				= SyncInvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID"
				LocalProcessLevel			= SyncInvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID/@location"
				LocalVariationID			= SyncInvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID/@variationID"
				LocalCustomer				= SyncInvoiceBOD select "//DataArea/Invoice/InvoiceHeader/CustomerParty/PartyIDs/ID"
				LocalBillTo					= SyncInvoiceBOD select "//DataArea/Invoice/InvoiceHeader/BillToParty/PartyIDs/ID"
				LocalBODID					= SyncInvoiceBOD select "//ApplicationArea/BODID"
				LocalGenericDelimiter       = DerivedGenericDelimiter
				
				if(LocalAccountingEntity entered)
					LocalCompany			= NativeCompany	
							
				if(FSMBODConfigurationSyncInvoiceRel exists and FSMBODConfigurationSyncInvoiceRel.Enable)
					if(FSMInboundBODTracker not entered)
						invoke Create FSMInboundBODTracker
							assign result to NewBODTracker
							invoked.Verb 						= 1
							invoked.Noun 						= "Invoice"	
							invoked.Direction				    = 2				
							invoked.Company						= LocalCompany
							invoked.Customer					= LocalCustomer
							invoked.RunGroup					= DerivedRunGroup
							invoked.Invoice						= LocalInvoice
							invoked.BODAccountingEntity			= LocalAccountingEntity
							invoked.BODDocumentID				= LocalDocumentID
							invoked.BODVariationID				= LocalVariationID
							invoked.BODLocation					= LocalProcessLevel
							invoked.BODID						= LocalBODID
							invoked.Status						= 1
							invoked.StartDate					= system current timestamp
							invoked.BODXML						= LocalBODXML
							initialize invoked.Error			
							initialize invoked.ErrorMessage					
						LocalFSMInboundBODTracker 				= NewBODTracker.FSMInboundBODTracker
					else
						LocalFSMInboundBODTracker 				= FSMInboundBODTracker
						invoke Update FSMInboundBODTrackerRel
							invoked.Company						= LocalCompany
							invoked.Customer					= LocalCustomer
							invoked.RunGroup					= DerivedRunGroup
							invoked.Invoice						= LocalInvoice
							invoked.BODAccountingEntity			= LocalAccountingEntity
							invoked.BODDocumentID				= LocalDocumentID
							invoked.BODVariationID				= LocalVariationID
							invoked.BODLocation					= LocalProcessLevel
							invoked.BODID						= LocalBODID
							invoked.Status						= 1
							invoked.StartDate					= system current timestamp
							invoked.BODXML						= LocalBODXML
							initialize invoked.Error			
							initialize invoked.ErrorMessage					
					
					invoke CreateReceivableInvoiceImport
						invoked.SyncInvoiceBOD      	= SyncInvoiceBOD
	               		invoked.PrmInboundTracker 		= LocalFSMInboundBODTracker
	               		invoked.PrmCompany				= LocalCompany
	               		invoked.PrmCustomer				= LocalCustomer
		      		
		  		else 
				if(FSMInboundBODTracker not entered)
					invoke Create FSMInboundBODTracker
						assign result to NewBODTracker
						invoked.Verb 						= 1
						invoked.Noun 						= "Invoice"
						invoked.Direction					= 2					
						invoked.Company						= LocalCompany
						invoked.Customer					= LocalCustomer
						invoked.RunGroup					= DerivedRunGroup
						invoked.Invoice						= LocalInvoice
						invoked.BODAccountingEntity			= LocalAccountingEntity
						invoked.BODDocumentID				= LocalDocumentID
						invoked.BODVariationID				= LocalVariationID
						invoked.BODLocation					= LocalProcessLevel
						invoked.BODID						= LocalBODID
						invoked.Status						= 4
						invoked.StartDate					= system current timestamp
						invoked.CloseDate					= system current timestamp
						invoked.BODXML						= LocalBODXML
						invoked.Error						= true			
						invoked.ErrorMessage				= "Sync Invoice Inbound BOD Service is not Enabled"
					LocalFSMInboundBODTracker = NewBODTracker.FSMInboundBODTracker
				else
					LocalFSMInboundBODTracker = FSMInboundBODTracker
					invoke Update FSMInboundBODTrackerRel
						invoked.Company						= LocalCompany
						invoked.Customer					= LocalCustomer
						invoked.RunGroup					= DerivedRunGroup
						invoked.Invoice						= LocalInvoice
						invoked.BODAccountingEntity			= LocalAccountingEntity
						invoked.BODDocumentID				= LocalDocumentID
						invoked.BODVariationID				= LocalVariationID
						invoked.BODLocation					= LocalProcessLevel
						invoked.BODID						= LocalBODID
						invoked.Status						= 4
						invoked.StartDate					= system current timestamp
						invoked.CloseDate					= system current timestamp
						invoked.BODXML						= LocalBODXML
						invoked.Error						= true			
						invoked.ErrorMessage				= "Sync Invoice Inbound BOD Service is not Enabled"
								
		CreateReceivableInvoiceImport is an Import Action
			restricted			
			Parameters
				SyncInvoiceBOD 					is XMLDocument
				PrmInboundTracker  				is like FSMInboundBODTracker
				PrmCompany						is Numeric 10
				PrmCustomer						is Numeric 9
			Action Rules
				LocalFSMInboundBODTracker 		= PrmInboundTracker
				LocalCustomer					= PrmCustomer
				LocalCompany					= PrmCompany
				LocalGenericDelimiter		 	= DerivedGenericDelimiter
				LocalInvoice					= SyncInvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DisplayID"
				LocalProcessLevel				= SyncInvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID/@location"
				LocalInvoiceDateAlpha			= SyncInvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentDateTime"
				LocalInvoiceDate 				= LocalInvoiceDateAlpha[1:4] + LocalInvoiceDateAlpha[6:7] + LocalInvoiceDateAlpha[9:10]	
				LocalDueDateAlpha				= SyncInvoiceBOD select "//DataArea/Invoice/InvoiceHeader/PaymentTerm/Term/DueDateTime"	
				LocalDueDate					= LocalDueDateAlpha[1:4] + LocalDueDateAlpha[6:7] + LocalDueDateAlpha[9:10]		
				LocalInvoiceCurrency			= SyncInvoiceBOD select "//DataArea/Invoice/InvoiceHeader/TotalAmount/@currencyID"
				LocalInvoiceAmount				= SyncInvoiceBOD select "//DataArea/Invoice/InvoiceHeader/TotalAmount"
				LocalDescription				= SyncInvoiceBOD select "//DataArea/Invoice/InvoiceHeader/Description"
				LocalTermsCode					= SyncInvoiceBOD select "//DataArea/Invoice/InvoiceHeader/PaymentTerm/PaymentTermCode"
				LocalSalesRepresentative		= SyncInvoiceBOD select "//DataArea/Invoice/InvoiceHeader/SupplierParty/SalesContact/ID"
				LocalTransactionUserField1		= ""	
				LocalBillToID					= SyncInvoiceBOD select "//DataArea/Invoice/InvoiceHeader/BillToParty/PartyIDs/ID"
				LocalCustomerPO					= SyncInvoiceBOD select "//DataArea/Invoice/InvoiceHeader/AlternateDocumentID/ID/@schemeName"
				LocalBankTransactionCode		= SyncInvoiceBOD select "//DataArea/Invoice/InvoiceHeader/PaymentMethodCode"
				LocalUserAreaCount 				= SyncInvoiceBOD select "count (//DataArea/Invoice/InvoiceHeader/UserArea/Property)"	
				
				if(LocalInvoiceAmount < 0)
					LocalInvoiceType = "C"	
				else 
					LocalInvoiceType = "I"
					
				if(LocalBillToID entered)
					LocalBillTo = NativeSICustomerBillTo
					
				if(LocalCustomerPO entered)
					if(LocalCustomerPO != "Customer")
						LocalCustomerPurchaseOrder 	= SyncInvoiceBOD select "//DataArea/Invoice/InvoiceHeader/PurchaseOrderReference/DocumentID/ID"
					else
						LocalCustomerPurchaseOrder 	= SyncInvoiceBOD select "//DataArea/Invoice/InvoiceHeader/AlternateDocumentID/ID"
				
				LocalIterator = 1
				while (LocalUserAreaCount >= LocalIterator)					
					LocalNameValue = SyncInvoiceBOD select "//DataArea/Invoice/InvoiceHeader/UserArea/Property[<LocalIterator>]/NameValue/@name"
					if(LocalNameValue = "InvoicePostDate")
						LocalGLDateAlpha 	= SyncInvoiceBOD select "//DataArea/Invoice/InvoiceHeader/UserArea/Property[<LocalIterator>]/NameValue"														
					else 
					if(LocalNameValue = "m3_AccountingDate")
						LocalAccountingDate = SyncInvoiceBOD select "//DataArea/Invoice/InvoiceHeader/UserArea/Property[<LocalIterator>]/NameValue"
					LocalIterator = LocalIterator + 1	
				
				if(LocalGLDateAlpha entered)
					LocalGeneralLedgerDate			= LocalGLDateAlpha[1:4] + LocalGLDateAlpha[6:7] + LocalGLDateAlpha[9:10]
				else 
					LocalGeneralLedgerDate			= LocalAccountingDate[1:4] + LocalAccountingDate[6:7] + LocalAccountingDate[9:10]
				
				invoke Create ReceivableInvoiceImport
					resume on error
                   		Error             					= true
                        ErrorMessage     					= error message
					invoked.RunGroup						= DerivedRunGroup
					invoked.Company         				= LocalCompany
	                invoked.BatchNumber 					= DerivedBatchNumber
					invoked.Invoice							= LocalInvoice
					invoked.Customer						= LocalCustomer
					invoked.ReceivableProcessLevel    		= LocalProcessLevel
					invoked.InvoiceType						= LocalInvoiceType
					invoked.TransactionDate					= LocalInvoiceDate
					invoked.GeneralLedgerDate				= LocalGeneralLedgerDate 
					invoked.OriginalCurrency 				= LocalInvoiceCurrency
					invoked.InvoiceAmount.CurrencyAmount 	= LocalInvoiceAmount
					invoked.Description						= LocalDescription
					invoked.DueDate							= LocalDueDate
					invoked.Status							= 1
					invoked.GLStatus						= 9
					invoked.TermsCode						= LocalTermsCode
					invoked.TransactionUserField1			= LocalTransactionUserField1
					invoked.SalesRepresentative				= LocalSalesRepresentative
					invoked.CustomerPurchaseOrder			= LocalCustomerPurchaseOrder
					invoked.BankTransactionCode				= LocalBankTransactionCode
					invoked.CustomerBillTo					= LocalBillTo
					invoked.System							= DerivedSystem
				if(Error)
					invoke Update FSMInboundBODTrackerRel
						invoked.Error 						= Error
						invoked.ErrorMessage 				= ErrorMessage
						invoked.Status						= 2
						invoked.CloseDate					= system current timestamp
					invoke SendSIConfirmBOD
						invoked.PrmErrorMessage 			= ErrorMessage
						invoked.SyncInvoiceBOD      		= SyncInvoiceBOD
						invoked.PrmTrackerID				= LocalFSMInboundBODTracker
				else
				 	invoke Update FSMInboundBODTrackerRel
						invoked.Status						= 3
						invoked.CloseDate					= system current timestamp
		
		SendSIConfirmBOD is an Instance Action
			restricted			
			Parameters
				SyncInvoiceBOD 							is XMLDocument
				PrmErrorMessage 						is Alpha 300
				PrmTrackerID							is Numeric 15
			Action Rules
				LocalBODXML								= SyncInvoiceBOD
				LocalErrorMessage						= PrmErrorMessage
				LocalTrackerID							= PrmTrackerID
				LocalAccountingEntity					= SyncInvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID/ID/@accountingEntity"
				LocalDocumentID							= SyncInvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DocumentID"
				LocalInvoice							= SyncInvoiceBOD select "//DataArea/Invoice/InvoiceHeader/DisplayID"
				LocalFromLogicalID						= SyncInvoiceBOD select "//ApplicationArea/Sender/LogicalID"
				LocalComponentID						= SyncInvoiceBOD select "//ApplicationArea/Sender/ComponentID"
				LocalBODID								= SyncInvoiceBOD select "//ApplicationArea/BODID"
				LocalMainUserTemplate					= "IONSyncInvoice_ConfirmBOD_ST"	
				if(UserTemplateRel exists)
					send ion bod
						bod is SyncInvoiceConfirmBODXML
						bod type is "Confirm.BOD"
						accounting entity is LocalAccountingEntity
						document id is LocalDocumentID			


		ProcessShipToPartyMasterBODImport is an Import Action
			restricted
			bod type is Process.ShipToPartyMaster			
			Parameters
				ShipToPartyMasterBOD 				is XMLDocument		
			Action Rules
				LocalBODXML					 = ShipToPartyMasterBOD
				LocalAccountingEntity	   	 = ShipToPartyMasterBOD select "//DataArea/ShipToPartyMaster/CustomerParty/PartyIDs/ID/@accountingEntity"
				LocalVariationID             = ShipToPartyMasterBOD select "//DataArea/ShipToPartyMaster/PartyIDs/ID/@variationID"	
				LocalBODID                   = ShipToPartyMasterBOD select "//ApplicationArea/BODID"
				ActionCode				 	 = ShipToPartyMasterBOD select "//DataArea/Process/ActionCriteria/ActionExpression/@actionCode"
				LocalDocumentID				 = ShipToPartyMasterBOD select "//DataArea/ShipToPartyMaster/PartyIDs/ID"
				LocalCustomerPartyID		 = ShipToPartyMasterBOD select "//DataArea/ShipToPartyMaster/CustomerParty/PartyIDs/ID"
				LocalGenericDelimiter		 = DerivedGenericDelimiter
				LocalCustomerPartyReference	 = NativeCustomerParty
				if(DerivedConfigDocID = "Y")
					LocalCustomer	=	LocalCustomerPartyID
					if(FSMBODCleanDocIDRel.DestinationValue entered)
						LocalCrossAccountingEntity =  FSMBODCleanDocIDRel.DestinationValue
					else
						LocalCrossAccountingEntity	=  LocalAccountingEntity
						
					if(DerivedConfigFEG != "Y")
						LocalAccountingEntity = LocalCrossAccountingEntity
					else
						if(LocalCrossAccountingEntity entered)
							LocalAccountingEntity = LocalCrossAccountingEntity
							LocalAccountingEntity = NativeCompany
						else
							LocalAccountingEntity = ""
					LocalCompany	=	LocalAccountingEntity
				if(FSMBODConfigurationProcessShipToPartyMasterRel exists and FSMBODConfigurationProcessShipToPartyMasterRel.Enable)
					if(FSMInboundBODTracker not entered)
						invoke Create FSMInboundBODTracker
							assign result to NewBODTracker
							invoked.Verb 					= 2
							invoked.Noun 					= "ShipToPartyMaster"
							invoked.Direction				= 2					
							invoked.BODDocumentID			= LocalDocumentID
							invoked.Company					= LocalCompany
							invoked.BODVariationID			= LocalVariationID
							invoked.BODID					= LocalBODID
							invoked.Status					= 1
							invoked.StartDate				= system current timestamp
							invoked.BODXML					= LocalBODXML
							invoked.BODAccountingEntity		= LocalAccountingEntity
							initialize invoked.Error			
							initialize invoked.ErrorMessage
						
						LocalFSMInboundBODTracker = NewBODTracker.FSMInboundBODTracker
					else
						LocalFSMInboundBODTracker = FSMInboundBODTracker
						invoke Update FSMInboundBODTrackerRel
							invoked.BODDocumentID			= LocalDocumentID
							invoked.BODVariationID			= LocalVariationID
							invoked.Company					= LocalCompany
							invoked.BODID					= LocalBODID
							invoked.Status					= 1
							invoked.StartDate				= system current timestamp
							invoked.BODXML					= LocalBODXML
							invoked.BODAccountingEntity		= LocalAccountingEntity
							initialize invoked.Error			
							initialize invoked.ErrorMessage
					if(ActionCode entered)
						invoke GetShipToPartyMasterBOD
							invoked.PrmCompany					= LocalCompany
							invoked.PrmCustomer					= LocalCustomer
			       		    invoked.PrmBODAccountingEntity		= LocalAccountingEntity
			       		    invoked.PrmBODDocumentID			= LocalDocumentID
			       		    invoked.PrmActionCode				= ActionCode
			                invoked.ShipToPartyMasterBOD		= ShipToPartyMasterBOD
			                invoked.PrmInboundTracker 		  	= LocalFSMInboundBODTracker
			    else 
				if(FSMInboundBODTracker not entered)
					invoke Create FSMInboundBODTracker
						assign result to NewBODTracker
						invoked.Verb 					= 2
						invoked.Noun 					= "ShipToPartyMaster"
						invoked.Direction				= 2					
						invoked.BODDocumentID			= LocalDocumentID
						invoked.Company					= LocalCompany
						invoked.BODVariationID			= LocalVariationID
						invoked.BODID					= LocalBODID
						invoked.Status					= 4
						invoked.StartDate				= system current timestamp
						invoked.BODXML					= LocalBODXML
						invoked.BODAccountingEntity		= LocalAccountingEntity
						invoked.CloseDate				= system current timestamp
						invoked.Error					= true			
						invoked.ErrorMessage			= "Process ShipToPartyMaster Inbound BOD Service is not Enabled"
					LocalFSMInboundBODTracker = NewBODTracker.FSMInboundBODTracker
				else
					LocalFSMInboundBODTracker = FSMInboundBODTracker
					invoke Update FSMInboundBODTrackerRel
						invoked.BODDocumentID			= LocalDocumentID
						invoked.Company					= LocalCompany
						invoked.BODVariationID			= LocalVariationID
						invoked.BODID					= LocalBODID
						invoked.Status					= 4
						invoked.StartDate				= system current timestamp
						invoked.BODXML					= LocalBODXML
						invoked.BODAccountingEntity		= LocalAccountingEntity
						invoked.CloseDate				= system current timestamp
						invoked.Error					= true			
						invoked.ErrorMessage			= "Process ShipToPartyMaster Inbound BOD Service is not Enabled"
						
		GetShipToPartyMasterBOD is an Import Action 
			restricted
			Parameters
				ShipToPartyMasterBOD 		is XMLDocument
				PrmInboundTracker   		is like FSMInboundBODTracker
				PrmCompany					is Numeric 4
				PrmCustomer					is Numeric 9
				PrmBODAccountingEntity      is Alpha 12
				PrmActionCode				is Alpha 9 
				PrmBODDocumentID			is Alpha 50
			Action Rules
				LocalFSMInboundBODTracker			= PrmInboundTracker
				ActionCode							= PrmActionCode
				LocalAccountingEntity 	  		  	= PrmBODAccountingEntity
				LocalCompany 		  			  	= PrmCompany
				LocalCustomer						= PrmCustomer
				LocalGenericDelimiter		 		= DerivedGenericDelimiter
				LocalCustomerShipToID				= PrmBODDocumentID
				LocalCustomerDeliveryAddressLine1	= ShipToPartyMasterBOD	select "//DataArea/ShipToPartyMaster/Location/Address/AddressLine[1]"
				LocalCustomerDeliveryAddressLine2	= ShipToPartyMasterBOD	select "//DataArea/ShipToPartyMaster/Location/Address/AddressLine[2]"
				LocalCustomerDeliveryAddressLine3	= ShipToPartyMasterBOD	select "//DataArea/ShipToPartyMaster/Location/Address/AddressLine[3]"
				LocalCustomerDeliveryAddressLine4	= ShipToPartyMasterBOD	select "//DataArea/ShipToPartyMaster/Location/Address/AddressLine[4]"
				LocalCustomerName					= ShipToPartyMasterBOD	select "//DataArea/ShipToPartyMaster/Name"
				LocalCustomerCountryCode			= ShipToPartyMasterBOD	select "//DataArea/ShipToPartyMaster/Location/Address/CountryCode"
				LocalCustomerCity					= ShipToPartyMasterBOD	select "//DataArea/ShipToPartyMaster/Location/Address/CityName"
				LocalCustomerStateProvinance		= ShipToPartyMasterBOD	select "//DataArea/ShipToPartyMaster/Location/Address/CountrySubDivisionCode[1]"
				LocalCustomerPostalCode				= ShipToPartyMasterBOD	select "//DataArea/ShipToPartyMaster/Location/Address/PostalCode"
				LocalCustomerContactName			= ShipToPartyMasterBOD	select "//DataArea/ShipToPartyMaster/Location/Address/AttentionOfName[1]"
				LocalCustomerShipToStatus			= ShipToPartyMasterBOD	select "//DataArea/ShipToPartyMaster/Status/Code"
				LocalTermCode						= ShipToPartyMasterBOD	select "//DataArea/ShipToPartyMaster/PaymentTermCode"
				LocalSalesRepresentative			= ShipToPartyMasterBOD	select "//DataArea/ShipToPartyMaster/SalesPersonReference/IDs/ID[1]"
				LocalCarrier						= ShipToPartyMasterBOD	select "//DataArea/ShipToPartyMaster/CarrierParty/PartyIDs/ID[1]"
				LocalTaxID							= ShipToPartyMasterBOD	select "//DataArea/ShipToPartyMaster/PartyIDs/TaxID"	
				if (ActionCode != "Add")
					LocalCustomerShipTo		= NativeCustomerShipTo
						
				if(LocalCustomerShipToStatus = "Open" or LocalCustomerShipToStatus = "Working")
					LocalActive = "A"
				else
					LocalActive = "I"

				if(LocalTaxID entered)
					LocalTaxExemptCode = "T"
				else
					LocalTaxExemptCode = "E"
				if(ActionCode = "Add")
					invoke CreateProcessCustomerShipTo
						invoked.ShipToPartyMasterBOD        		= ShipToPartyMasterBOD
		                invoked.PrmInboundTracker 					= LocalFSMInboundBODTracker
		                invoked.PrmCompany							= LocalCompany
		                invoked.PrmCustomer							= LocalCustomer	
		                invoked.PrmCustomerName						= LocalCustomerName
		                invoked.PrmCustomerCountryCode				= LocalCustomerCountryCode
		                invoked.PrmCustomerDeliveryAddressLine1	  	= LocalCustomerDeliveryAddressLine1
		                invoked.PrmCustomerDeliveryAddressLine2		= LocalCustomerDeliveryAddressLine2
		                invoked.PrmCustomerDeliveryAddressLine3		= LocalCustomerDeliveryAddressLine3
		                invoked.PrmCustomerDeliveryAddressLine4		= LocalCustomerDeliveryAddressLine4
		                invoked.PrmCustomerStateProvinance			= LocalCustomerStateProvinance
		                invoked.PrmCustomerCity						= LocalCustomerCity
		                invoked.PrmCustomerPostalCode				= LocalCustomerPostalCode
		                invoked.PrmActive							= LocalActive
		                invoked.PrmTermCode 						= LocalTermCode
						invoked.PrmTaxExemptCode					= LocalTaxExemptCode
						invoked.PrmSalesRepresentative				= LocalSalesRepresentative
						invoked.PrmCarrier							= LocalCarrier
						invoked.PrmCustomerContactName				= LocalCustomerContactName
						invoked.PrmBODAccountingEntity				= LocalAccountingEntity
			       		invoked.PrmBODDocumentID					= LocalDocumentID
			            invoked.PrmTaxID							= LocalTaxID
				else
				 	invoke FindProcessCustomerShipTo
						invoked.ShipToPartyMasterBOD        		= ShipToPartyMasterBOD
		                invoked.PrmInboundTracker 					= LocalFSMInboundBODTracker
		                invoked.PrmCompany							= LocalCompany
		                invoked.PrmCustomer							= LocalCustomer	
		                invoked.PrmCustomerName						= LocalCustomerName
		                invoked.PrmCustomerCountryCode				= LocalCustomerCountryCode
		                invoked.PrmCustomerDeliveryAddressLine1	  	= LocalCustomerDeliveryAddressLine1
		                invoked.PrmCustomerDeliveryAddressLine2		= LocalCustomerDeliveryAddressLine2
		                invoked.PrmCustomerDeliveryAddressLine3		= LocalCustomerDeliveryAddressLine3
		                invoked.PrmCustomerDeliveryAddressLine4		= LocalCustomerDeliveryAddressLine4
		                invoked.PrmCustomerStateProvinance			= LocalCustomerStateProvinance
		                invoked.PrmCustomerCity						= LocalCustomerCity
		                invoked.PrmCustomerPostalCode				= LocalCustomerPostalCode
		                invoked.PrmActive							= LocalActive
		                invoked.PrmTermCode 						= LocalTermCode
						invoked.PrmTaxExemptCode					= LocalTaxExemptCode
						invoked.PrmSalesRepresentative				= LocalSalesRepresentative
						invoked.PrmCarrier							= LocalCarrier
						invoked.PrmCustomerContactName				= LocalCustomerContactName
						invoked.PrmCustomerShipTo					= LocalCustomerShipTo
						invoked.PrmBODAccountingEntity				= LocalAccountingEntity
			       		invoked.PrmBODDocumentID					= LocalDocumentID
			       		invoked.PrmActionCode						= ActionCode
			            invoked.PrmTaxID							= LocalTaxID

		CreateProcessCustomerShipTo is an Import Action
			restricted
			Parameters
				ShipToPartyMasterBOD 			 is XMLDocument
				PrmInboundTracker   			 is like FSMInboundBODTracker
				PrmCompany						 is Numeric 4
				PrmCustomer						 is Numeric 9
				PrmBODAccountingEntity      	 is Alpha 12
				PrmBODDocumentID				 is Alpha 50
				PrmCustomerName					 is Alpha 120
				PrmCustomerCountryCode			 is Alpha 3			
				PrmCustomerDeliveryAddressLine1  is Alpha 40
				PrmCustomerDeliveryAddressLine2  is Alpha 40
				PrmCustomerDeliveryAddressLine3  is Alpha 40
				PrmCustomerDeliveryAddressLine4  is Alpha 40
				PrmCustomerStateProvinance       is Alpha 3
				PrmCustomerCity                  is Alpha 58
				PrmCustomerPostalCode			 is Alpha 12
				PrmActive						 is Alpha 1				 
				PrmTermCode						 is AlphaUpper 10	
				PrmTaxExemptCode				 is AlphaUpper 1
				PrmSalesRepresentative			 is Numeric 4
				PrmCarrier						 is Numeric 9
				PrmCustomerContactName			 is Alpha 20
				PrmTaxID						 is AlphaUpper 15
			Action Rules
				LocalCompany						= 	PrmCompany
				LocalCustomer						=   PrmCustomer
				LocalFSMInboundBODTracker			=	PrmInboundTracker
				LocalTermCode      		    		= 	PrmTermCode
				LocalTaxExemptCode					=	PrmTaxExemptCode
				LocalSalesRepresentative			= 	PrmSalesRepresentative
				LocalCarrier			 			= 	PrmCarrier
				LocalAccountingEntity				= 	PrmBODAccountingEntity
				LocalDocumentID						= PrmBODDocumentID	
				LocalCustomerDeliveryAddressLine1	= PrmCustomerDeliveryAddressLine1
				LocalCustomerDeliveryAddressLine2	= PrmCustomerDeliveryAddressLine2
				LocalCustomerDeliveryAddressLine3	= PrmCustomerDeliveryAddressLine3
				LocalCustomerDeliveryAddressLine4	= PrmCustomerDeliveryAddressLine4
				LocalCustomerName					= PrmCustomerName
				LocalCustomerCountryCode			= PrmCustomerCountryCode
				LocalCustomerCity					= PrmCustomerCity
				LocalCustomerStateProvinance		= PrmCustomerStateProvinance
				LocalCustomerPostalCode				= PrmCustomerPostalCode
				LocalCustomerContactName			= PrmCustomerContactName
				LocalActive							= PrmActive
				LocalTaxID							= PrmTaxID
   				invoke CreateCustomerShipTo CustomerShipTo
					assign result to NewCustomerShipTo 
					resume on error
                   		Error            								= true
                        ErrorMessage     								= error message 
	                invoked.Company         							= LocalCompany
	                invoked.Customer   									= LocalCustomer
					invoked.Name										= LocalCustomerName
					invoked.ShipToAddress.DeliveryAddress.AddressLine1	= LocalCustomerDeliveryAddressLine1
					invoked.ShipToAddress.DeliveryAddress.AddressLine2	= LocalCustomerDeliveryAddressLine2
					invoked.ShipToAddress.DeliveryAddress.AddressLine3	= LocalCustomerDeliveryAddressLine3
					invoked.ShipToAddress.DeliveryAddress.AddressLine4	= LocalCustomerDeliveryAddressLine4
					invoked.ShipToAddress.Municipality					= LocalCustomerCity
					invoked.ShipToAddress.StateProvince					= LocalCustomerStateProvinance
					invoked.ShipToAddress.PostalCode					= LocalCustomerPostalCode
					invoked.ShipToAddress.Country						= LocalCustomerCountryCode
	                invoked.TermCode									= LocalTermCode
	                invoked.TaxExemptCode 								= LocalTaxExemptCode
	                invoked.SalesRepresentative							= LocalSalesRepresentative	
	                invoked.Carrier										= LocalCarrier
	                invoked.TaxCode										= LocalTaxID
	                invoked.Active										= LocalActive
	                invoked.Contact										= LocalCustomerContactName
				if(Error)
					invoke Update FSMInboundBODTrackerRel
						invoked.Error 						= Error
						invoked.ErrorMessage 				= ErrorMessage
						invoked.Status						= 2
						invoked.CloseDate					= system current timestamp 
					invoke SendPShipToPartyMasterConfirmBOD
						invoked.PrmErrorMessage 			= ErrorMessage
						invoked.ShipToPartyMasterBOD      	= ShipToPartyMasterBOD
						invoked.PrmTrackerID				= LocalFSMInboundBODTracker
					invoke SendPShipToPartyMasterACKBOD
                        invoked.PrmErrorMessage 			= ErrorMessage
                        invoked.ShipToPartyMasterBOD     	= ShipToPartyMasterBOD
                        invoked.PrmTrackerID				= LocalFSMInboundBODTracker
                        invoked.PrmCompany					= LocalCompany
                        invoked.PrmCustomer					= LocalCustomer
 				else
		        	invoke Update FSMInboundBODTrackerRel
						invoked.Status			= 3
						invoked.CloseDate		= system current timestamp	
					invoke SendPShipToPartyMasterACKBOD
	                	invoked.PrmErrorMessage 			= "CustomerShipTo Created Sucessfully"
	                    invoked.ShipToPartyMasterBOD   		= ShipToPartyMasterBOD
	                    invoked.PrmTrackerID				= LocalFSMInboundBODTracker	
	                    invoked.PrmAckId					= true
			            invoked.PrmCompany					= LocalCompany
			            invoked.PrmCustomer					= LocalCustomer
			            invoked.PrmCustomerShipTo			= NewCustomerShipTo.CustomerShipTo

		FindProcessCustomerShipTo is an Import Action
			restricted
			Parameters
				ShipToPartyMasterBOD 		is XMLDocument
				PrmInboundTracker   			is like FSMInboundBODTracker
				PrmCompany					is Numeric 4
				PrmCustomer					is Numeric 9
				PrmBODAccountingEntity      is Alpha 12
				PrmActionCode				is Alpha 9 
				PrmBODDocumentID			is Alpha 50
				PrmCustomerName				is Alpha 120
				PrmCustomerCountryCode		is Alpha 3			
				PrmCustomerDeliveryAddressLine1  is Alpha 40
				PrmCustomerDeliveryAddressLine2  is Alpha 40
				PrmCustomerDeliveryAddressLine3  is Alpha 40
				PrmCustomerDeliveryAddressLine4  is Alpha 40
				PrmCustomerStateProvinance       is Alpha 3
				PrmCustomerCity                  is Alpha 58
				PrmCustomerPostalCode			 is Alpha 12
				PrmActive						 is Alpha 1				 
				PrmTermCode						 is AlphaUpper 10	
				PrmTaxExemptCode				 is AlphaUpper 1
				PrmSalesRepresentative			 is Numeric 4
				PrmCarrier						 is Numeric 9
				PrmCustomerContactName			 is Alpha 20
				PrmTaxID						 is AlphaUpper 15
				PrmCustomerShipTo				 is Numeric 4				
			Action Rules
				LocalCustomerShipTo 				= PrmCustomerShipTo	
				LocalCompany						= 	PrmCompany
				LocalCustomer						=   PrmCustomer
				LocalFSMInboundBODTracker			=	PrmInboundTracker
				LocalTermCode      		    		= 	PrmTermCode
				LocalTaxExemptCode					=	PrmTaxExemptCode
				LocalSalesRepresentative			= 	PrmSalesRepresentative
				LocalCarrier			 			= 	PrmCarrier
				LocalAccountingEntity				= 	PrmBODAccountingEntity
				LocalDocumentID						= PrmBODDocumentID	
				LocalCustomerDeliveryAddressLine1	= PrmCustomerDeliveryAddressLine1
				LocalCustomerDeliveryAddressLine2	= PrmCustomerDeliveryAddressLine2
				LocalCustomerDeliveryAddressLine3	= PrmCustomerDeliveryAddressLine3
				LocalCustomerDeliveryAddressLine4	= PrmCustomerDeliveryAddressLine4
				LocalCustomerName					= PrmCustomerName
				LocalCustomerCountryCode			= PrmCustomerCountryCode
				LocalCustomerCity					= PrmCustomerCity
				LocalCustomerStateProvinance		= PrmCustomerStateProvinance
				LocalCustomerPostalCode				= PrmCustomerPostalCode
				LocalCustomerContactName			= PrmCustomerContactName
				LocalActive							= PrmActive
				LocalTaxID							= PrmTaxID
				ActionCode							= PrmActionCode
				if(CustomerShipToRel exists and (ActionCode = "Replace" or ActionCode = "Change"))
					invoke Update CustomerShipToRel
						resume on error
                   			Error            								= true
                        	ErrorMessage     								= error message 
	                    invoked.Company         							= LocalCompany
	                	invoked.Customer   									= LocalCustomer
						invoked.Name										= LocalCustomerName
						invoked.ShipToAddress.DeliveryAddress.AddressLine1	= LocalCustomerDeliveryAddressLine1
						invoked.ShipToAddress.DeliveryAddress.AddressLine2	= LocalCustomerDeliveryAddressLine2
						invoked.ShipToAddress.DeliveryAddress.AddressLine3	= LocalCustomerDeliveryAddressLine3
						invoked.ShipToAddress.DeliveryAddress.AddressLine4	= LocalCustomerDeliveryAddressLine4
						invoked.ShipToAddress.Municipality					= LocalCustomerCity
						invoked.ShipToAddress.StateProvince					= LocalCustomerStateProvinance
						invoked.ShipToAddress.PostalCode					= LocalCustomerPostalCode
						invoked.ShipToAddress.Country						= LocalCustomerCountryCode
		                invoked.TermCode									= LocalTermCode
		                invoked.TaxExemptCode 								= LocalTaxExemptCode
		                invoked.SalesRepresentative							= LocalSalesRepresentative	
		                invoked.Carrier										= LocalCarrier
		                invoked.TaxCode										= LocalTaxID
		                invoked.Active										= LocalActive
		                invoked.Contact										= LocalCustomerContactName
					if(Error)
						invoke Update FSMInboundBODTrackerRel
							invoked.Error 						= Error
							invoked.ErrorMessage 				= ErrorMessage
							invoked.Status						= 2
							invoked.CloseDate					= system current timestamp 
						invoke SendPShipToPartyMasterConfirmBOD
							invoked.PrmErrorMessage 			= ErrorMessage
							invoked.ShipToPartyMasterBOD      	= ShipToPartyMasterBOD
							invoked.PrmTrackerID				= LocalFSMInboundBODTracker
						invoke SendPShipToPartyMasterACKBOD
                        	invoked.PrmErrorMessage 			= ErrorMessage
                        	invoked.ShipToPartyMasterBOD  		= ShipToPartyMasterBOD
                        	invoked.PrmTrackerID				= LocalFSMInboundBODTracker
                        	invoked.PrmCompany					= LocalCompany
                        	invoked.PrmCustomer					= LocalCustomer
                        	invoked.PrmCustomerShipTo			= LocalCustomerShipTo							
					else
						invoke Update FSMInboundBODTrackerRel
							invoked.Status						= 3
							invoked.CloseDate					= system current timestamp
						invoke SendPShipToPartyMasterACKBOD
                        	invoked.PrmErrorMessage 			= "CustomerShipTo Updated Sucessfully"
                        	invoked.ShipToPartyMasterBOD      	= ShipToPartyMasterBOD
                        	invoked.PrmTrackerID				= LocalFSMInboundBODTracker
                        	invoked.PrmAckId					= true                        	
							invoked.PrmCompany					= LocalCompany
							invoked.PrmCustomer					= LocalCustomer
							invoked.PrmCustomerShipTo			= LocalCustomerShipTo							
				else
				if(CustomerShipToRel not exists and (ActionCode = "Replace" or ActionCode = "Change"))
	            	invoke CreateProcessCustomerShipTo
						invoked.ShipToPartyMasterBOD        		= ShipToPartyMasterBOD
		                invoked.PrmInboundTracker 					= LocalFSMInboundBODTracker
		                invoked.PrmCompany							= LocalCompany
		                invoked.PrmCustomer							= LocalCustomer	
		                invoked.PrmCustomerName						= LocalCustomerName
		                invoked.PrmCustomerCountryCode				= LocalCustomerCountryCode
		                invoked.PrmCustomerDeliveryAddressLine1	  	= LocalCustomerDeliveryAddressLine1
		                invoked.PrmCustomerDeliveryAddressLine2		= LocalCustomerDeliveryAddressLine2
		                invoked.PrmCustomerDeliveryAddressLine3		= LocalCustomerDeliveryAddressLine3
		                invoked.PrmCustomerDeliveryAddressLine4		= LocalCustomerDeliveryAddressLine4
		                invoked.PrmCustomerStateProvinance			= LocalCustomerStateProvinance
		                invoked.PrmCustomerCity						= LocalCustomerCity
		                invoked.PrmCustomerPostalCode				= LocalCustomerPostalCode
		                invoked.PrmActive							= LocalActive
		                invoked.PrmTermCode 						= LocalTermCode
						invoked.PrmTaxExemptCode					= LocalTaxExemptCode
						invoked.PrmSalesRepresentative				= LocalSalesRepresentative
						invoked.PrmCarrier							= LocalCarrier
						invoked.PrmCustomerContactName				= LocalCustomerContactName
						invoked.PrmBODAccountingEntity				= LocalAccountingEntity
			       		invoked.PrmBODDocumentID					= LocalDocumentID
			            invoked.PrmTaxID							= LocalTaxID
				else 
				if(CustomerShipToRel exists and (ActionCode = "Delete" ))
	            	invoke Delete CustomerShipToRel
						resume on error
		       				Error            					= true
		            		ErrorMessage     					= error message
					if(Error)
						invoke Update FSMInboundBODTrackerRel
							invoked.Error 						= Error
							invoked.ErrorMessage 				= ErrorMessage
							invoked.Status						= 2
							invoked.CloseDate					= system current timestamp
						invoke SendPShipToPartyMasterConfirmBOD
							invoked.PrmErrorMessage 			= ErrorMessage
							invoked.ShipToPartyMasterBOD      	= ShipToPartyMasterBOD
							invoked.PrmTrackerID				= LocalFSMInboundBODTracker
						invoke SendPShipToPartyMasterACKBOD
	                        invoked.PrmErrorMessage 			= ErrorMessage
	                        invoked.ShipToPartyMasterBOD      	= ShipToPartyMasterBOD
	                        invoked.PrmTrackerID				= LocalFSMInboundBODTracker
	                        invoked.PrmCompany					= LocalCompany
	                        invoked.PrmCustomer					= LocalCustomer
		                    invoked.PrmCustomerShipTo			= LocalCustomerShipTo
					if(!FSMInboundBODTrackerRel.Error)
						invoke Update FSMInboundBODTrackerRel
							invoked.Status						= 3
							invoked.CloseDate					= system current timestamp
						invoke SendPShipToPartyMasterACKBOD
		                	invoked.PrmErrorMessage 			= "CustomerShipTo Deleted Sucessfully"
		                	invoked.ShipToPartyMasterBOD      	= ShipToPartyMasterBOD
		                	invoked.PrmTrackerID				= LocalFSMInboundBODTracker
                        	invoked.PrmAckId					= true                        	
		                	invoked.PrmCompany					= LocalCompany
		                    invoked.PrmCustomer					= LocalCustomer
		                    invoked.PrmCustomerShipTo			= LocalCustomerShipTo
				else 
				if(CustomerShipToRel not exists and (ActionCode = "Delete" ))
					invoke Update FSMInboundBODTrackerRel
						invoked.Error 						= true
						invoked.ErrorMessage 				= "Unable to find CustomerShipTo of Company"+" "+LocalCompany+" "+"for Customer"+" "+LocalCustomer+" "+"for CustomerShipTo"+ " "+LocalCustomerShipTo
						invoked.Status						= 2
						invoked.CloseDate					= system current timestamp
					invoke SendPShipToPartyMasterConfirmBOD
						invoked.PrmErrorMessage 			= "Unable to find CustomerShipTo of Company"+" "+LocalCompany+" "+"for Customer"+" "+LocalCustomer+" "+"for CustomerShipTo"+ " "+LocalCustomerShipTo
						invoked.ShipToPartyMasterBOD      	= ShipToPartyMasterBOD
						invoked.PrmTrackerID				= LocalFSMInboundBODTracker
					invoke SendPShipToPartyMasterACKBOD
						invoked.PrmErrorMessage 			= "Unable to find CustomerShipTo of Company"+" "+LocalCompany+" "+"for Customer"+" "+LocalCustomer+" "+"for CustomerShipTo"+ " "+LocalCustomerShipTo
						invoked.ShipToPartyMasterBOD      	= ShipToPartyMasterBOD
						invoked.PrmTrackerID				= LocalFSMInboundBODTracker
						invoked.PrmCompany					= LocalCompany
						invoked.PrmCustomer					= LocalCustomer
						invoked.PrmCustomerShipTo			= LocalCustomerShipTo
										                    	            		        
		                    				
		SendPShipToPartyMasterACKBOD is an Instance Action
			restricted			
			Parameters
				ShipToPartyMasterBOD 					is XMLDocument
				PrmErrorMessage 						is Alpha 300
				PrmTrackerID							is Numeric 15
				PrmCompany								is Numeric 4
				PrmCustomer								is Numeric 9
				PrmCustomerShipTo						is Numeric 4
				PrmAckId								is Boolean
			Action Rules
				LocalPShipToPartyMasterXML				= ShipToPartyMasterBOD
				LocalErrorMessage						= PrmErrorMessage
				LocalTrackerID							= PrmTrackerID
				LocalCustomer							= PrmCustomer
				LocalCompany							= PrmCompany
				LocalCustomerShipTo						= PrmCustomerShipTo
				Locallid								= ShipToPartyMasterBOD select "//DataArea/ShipToPartyMaster/CustomerParty/PartyIDs/ID/@lid"				
				LocalComponentID						= ShipToPartyMasterBOD select "//ApplicationArea/Sender/ComponentID"
				LocalBODID								= ShipToPartyMasterBOD select "//ApplicationArea/BODID"
				LocalFromLogicalID						= ShipToPartyMasterBOD select "//ApplicationArea/Sender/LogicalID"
				LocalOriginalCreateDateTime				= ShipToPartyMasterBOD select "//ApplicationArea/CreationDateTime"
				LocalDocumentID							= ShipToPartyMasterBOD select "//DataArea/ShipToPartyMaster/PartyIDs/ID"
				LocalAccountingEntity		     		= ShipToPartyMasterBOD select "//DataArea/ShipToPartyMaster/CustomerParty/PartyIDs/ID/@accountingEntity"
				LocalMainUserTemplate					= "IONProcessShipToPartyMaster_AcknowledgeBOD_ST"
				if(UserTemplateRel exists)
					send ion bod
						bod is ProcessShipToPartyMasterAcknowledgeBODXML
						bod type is "Acknowledge.ShipToPartyMaster"	
						accounting entity is LocalAccountingEntity
						document id is LocalDocumentID
				
		SendPShipToPartyMasterConfirmBOD is an Instance Action
			restricted			
			Parameters
				ShipToPartyMasterBOD 	is XMLDocument
				PrmErrorMessage		    is Alpha 300
				PrmTrackerID			is Numeric 15
			Action Rules
				LocalPShipToPartyMasterXML			= ShipToPartyMasterBOD
				LocalErrorMessage					= PrmErrorMessage
				LocalTrackerID						= PrmTrackerID
				LocalFromLogicalID					= ShipToPartyMasterBOD select "//ApplicationArea/Sender/LogicalID"
				LocalComponentID					= ShipToPartyMasterBOD select "//ApplicationArea/Sender/ComponentID"
				LocalBODID							= ShipToPartyMasterBOD select "//ApplicationArea/BODID"
				LocalDocumentID						= ShipToPartyMasterBOD select "//DataArea/ShipToPartyMaster/PartyIDs/ID[1]"
				LocalAccountingEntity				= ShipToPartyMasterBOD select "//DataArea/ShipToPartyMaster/CustomerParty/PartyIDs/ID/@accountingEntity"
				LocalOriginalCreateDateTime			= ShipToPartyMasterBOD select "//ApplicationArea/CreationDateTime"
				LocalVariationID            		= ShipToPartyMasterBOD select "//DataArea/ShipToPartyMaster/CustomerParty/PartyIDs/ID/@variationID"
				LocalConfirmBOD						= "true"
				LocalMainUserTemplate				= "IONProcessShipToPartyMaster_ConfirmBOD_ST"
				if(UserTemplateRel exists)
					send ion bod
						bod is ProcessShipToPartyMasterConfirmBODXML
						bod type is "Confirm.BOD"
						accounting entity is LocalAccountingEntity
						document id is LocalDocumentID											



		ProcessSalesOrderBODImport is an Import Action
			restricted
			bod type is Process.SalesOrder			
			Parameters
				SalesOrderBOD 				is XMLDocument		
			Action Rules
				LocalBODXML					 = SalesOrderBOD
				LocalVariationID             = SalesOrderBOD select "//DataArea/SalesOrder/SalesOrderHeader/DocumentID/ID/@variationID"	
				LocalBODID                   = SalesOrderBOD select "//ApplicationArea/BODID"	
				LocalDocumentID				 = SalesOrderBOD select "//DataArea/SalesOrder/PartyIDs/ID"
				LocalAccountingEntity   	 = SalesOrderBOD select "//DataArea/SalesOrder/SalesOrderHeader/DocumentID/ID/@accountingEntity"
				LocalCrossAccountingEntity	 = FSMBODCrossReferenceDetailRel.DestinationValue
				LocalActionCode				 = SalesOrderBOD select "//DataArea/Process/ActionCriteria/ActionExpression/@actionCode"
				LocalReferenceID			 = SalesOrderBOD select "//DataArea/SalesOrder/SalesOrderHeader/DocumentID/ID"
				if(LocalCrossAccountingEntity entered)
					LocalCompany			 = FSMBODCrossReferenceCompanyDetailRel.DestinationValue
				else 
				if(DerivedDefaultCompany entered)
					LocalCompany			 = DerivedDefaultCompany
				LocalLocation 				 = FSMBODCrossReferenceLocationDetailRel.DestinationValue
				LocalProcessLevel			 = FSMBODCrossReferenceProcessDetailRel.DestinationValue
				
				if(DerivedConfigDocID = "Y")
					if(FSMBODCleanDocIDRel.DestinationValue entered)
						LocalCrossAccountingEntity  =  FSMBODCleanDocIDRel.DestinationValue
					else
						LocalCrossAccountingEntity	=  LocalAccountingEntity 
					if(DerivedConfigFEG != "Y")
						LocalAccountingEntity       = LocalCrossAccountingEntity 
					else
						if(LocalCrossAccountingEntity entered)
							LocalAccountingEntity   = LocalCrossAccountingEntity
							LocalAccountingEntity   = NativeCompany 
						else
							LocalAccountingEntity = ""
				
				if(FSMBODConfigurationProcessSalesOrderRel exists and FSMBODConfigurationProcessSalesOrderRel.Enable)
					if(FSMInboundBODTracker not entered)
						invoke Create FSMInboundBODTracker
							assign result to NewBODTracker
							invoked.Verb 					= 2
							invoked.Noun 					= "SalesOrder"
							invoked.Direction				= 2				
							invoked.BODDocumentID			= LocalDocumentID
							invoked.BODVariationID			= LocalVariationID
							invoked.BODID					= LocalBODID
							invoked.Status					= 1
							invoked.StartDate				= system current timestamp
							invoked.BODXML					= LocalBODXML
							invoked.BODAccountingEntity		= LocalAccountingEntity
							invoked.BODLocation				= LocalLocation
							initialize invoked.Error			
							initialize invoked.ErrorMessage
						LocalFSMInboundBODTracker = NewBODTracker.FSMInboundBODTracker
					else
						LocalFSMInboundBODTracker = FSMInboundBODTracker
						invoke Update FSMInboundBODTrackerRel
							invoked.BODDocumentID			= LocalDocumentID
							invoked.BODVariationID			= LocalVariationID
							invoked.BODID					= LocalBODID
							invoked.Status					= 1
							invoked.StartDate				= system current timestamp
							invoked.BODXML					= LocalBODXML
							invoked.BODAccountingEntity		= LocalAccountingEntity
							invoked.BODLocation				= LocalLocation
							initialize invoked.Error			
							initialize invoked.ErrorMessage
					if(LocalActionCode = "Add") 		
						invoke CreateCustomerOder
							invoked.SalesOrderBOD			= SalesOrderBOD
			                invoked.PrmInboundTracker 		= LocalFSMInboundBODTracker
			                invoked.PrmCompany 				= LocalCompany
			                invoked.PrmLocation				= LocalLocation
			                invoked.PrmProcessLevel 		= LocalProcessLevel
			                invoked.PrmReferenceID			= LocalReferenceID
			        else
			        	invoke UpdateCustomerOder
			        		invoked.SalesOrderBOD			= SalesOrderBOD
			                invoked.PrmInboundTracker 		= LocalFSMInboundBODTracker
			                invoked.PrmCompany 				= LocalCompany
			                invoked.PrmLocation				= LocalLocation
			                invoked.PrmProcessLevel 		= LocalProcessLevel
			                invoked.PrmReferenceID			= LocalReferenceID
			                invoked.PrmActionCode			= LocalActionCode
			    else
			    if(FSMInboundBODTracker not entered) 
					invoke Create FSMInboundBODTracker
						assign result to NewBODTracker
						invoked.Verb 					= 2
						invoked.Noun 					= "SalesOrder"	
						invoked.Direction				= 2				
						invoked.BODDocumentID			= LocalDocumentID
						invoked.BODVariationID			= LocalVariationID
						invoked.BODID					= LocalBODID
						invoked.Status					= 4
						invoked.StartDate				= system current timestamp
						invoked.BODXML					= LocalBODXML
						invoked.BODAccountingEntity		= LocalAccountingEntity
						invoked.BODLocation				= LocalLocation
						invoked.CloseDate				= system current timestamp
						invoked.Error					= true			
						invoked.ErrorMessage			= "Process SalesOrder Inbound BOD Service is not Enabled"
					LocalFSMInboundBODTracker = NewBODTracker.FSMInboundBODTracker
				else
					LocalFSMInboundBODTracker = FSMInboundBODTracker
					invoke Update FSMInboundBODTrackerRel
						invoked.BODDocumentID			= LocalDocumentID
						invoked.BODVariationID			= LocalVariationID
						invoked.BODID					= LocalBODID
						invoked.Status					= 4
						invoked.StartDate				= system current timestamp
						invoked.BODXML					= LocalBODXML
						invoked.BODAccountingEntity		= LocalAccountingEntity
						invoked.BODLocation				= LocalLocation
						invoked.CloseDate				= system current timestamp
						invoked.Error					= true			
						invoked.ErrorMessage			= "Process SalesOrder Inbound BOD Service is not Enabled"
						
		CreateCustomerOder is an Import Action 
			restricted
			Parameters
				SalesOrderBOD 			is XMLDocument
				PrmInboundTracker   	is like FSMInboundBODTracker
				PrmCompany				is Numeric 4
				PrmLocation				is AlphaUpper size 20
				PrmProcessLevel			is AlphaUpper 5
				PrmReferenceID			is Alpha 100
			Action Rules
				LocalFSMInboundBODTracker			= PrmInboundTracker
				LocalLocation						= PrmLocation
				LocalCompany						= PrmCompany
				LocalProcessLevel					= PrmProcessLevel
				LocalDocumentID						= SalesOrderBOD select "//DataArea/SalesOrder/SalesOrderHeader/CustomerParty/PartyIDs/ID"												
				LocalCurrency  						= SalesOrderBOD	select "//DataArea/SalesOrder/SalesOrderHeader/TotalAmount/@currencyID"
				LocalCustomerBillToID				= SalesOrderBOD	select "//DataArea/SalesOrder/SalesOrderHeader/BillToParty/PartyIDs/ID"
				LocalCustomerShipToID				= SalesOrderBOD	select "//DataArea/SalesOrder/SalesOrderHeader/ShipToParty/PartyIDs/ID"			
				LocalLineCount						= SalesOrderBOD	select "count(//DataArea/SalesOrder/SalesOrderLine)"								
				LocalOrderType						= DerivedDefaultOrderType
				LocalGenericDelimiter				= DerivedGenericDelimiter					
				LocalCustomer			 			= NativeCustomer
				LocalCustomerBillTo					= NativeCustomerBillTo
				LocalCustomerShipTo					= NativeCustomerShipTo
				LocalReferenceID					= PrmReferenceID
				LocalReference						= NativeReferenceID	
				LocalStatusCode						= SalesOrderBOD select "//DataArea/SalesOrder/SalesOrderHeader/Status/Code"
				if(DerivedConfigDocID = "Y")
					LocalCustomer			 	= LocalDocumentID
					LocalCustomerBillTo			= LocalCustomerBillToID
					LocalCustomerShipToID		= SalesOrderBOD	select "//DataArea/SalesOrder/SalesOrderHeader/ShipToParty/PartyIDs/ID"	
					LocalReferenceID			= SalesOrderBOD select "//DataArea/SalesOrder/SalesOrderHeader/DocumentID/ID"
					LocalCustomerShipTo			= NativeCustomerSalesShipTo 
				else
					LocalCustomer			 	= NativeCustomer
					LocalCustomerBillTo			= NativeCustomerBillTo
					LocalCustomerShipToID		= SalesOrderBOD	select "//DataArea/SalesOrder/SalesOrderHeader/ShipToParty/PartyIDs/ID"	
					LocalReferenceID			= SalesOrderBOD select "//DataArea/SalesOrder/SalesOrderHeader/DocumentID/ID"
					LocalCustomerShipTo			= NativeCustomerShipTo
			
				if(CustomerOrderRelation not exists) 
		        	invoke Create CustomerOrder
						assign result to NewCustomerOrder 
						resume on error
	                   		Error            								= true
	                        ErrorMessage     								= error message 
		                invoked.Company         							= LocalCompany
		                invoked.InventoryLocation   						= LocalLocation
						invoked.Customer									= LocalCustomer
						invoked.BillingProcessLevel							= LocalProcessLevel
						invoked.OrderEntryOrderType							= LocalOrderType
						invoked.Currency									= LocalCurrency
						invoked.CustomerBillTo								= LocalCustomerBillTo
						invoked.CustomerShipTo								= LocalCustomerShipTo
						invoked.Reference1									= LocalReferenceID
					if(Error)
						invoke Update FSMInboundBODTrackerRel
							invoked.Error 						= Error
							invoked.ErrorMessage 				= ErrorMessage
							invoked.Status						= 2
							invoked.CloseDate					= system current timestamp 
						invoke SendProcessSalesOrderConfirmBOD
							invoked.PrmErrorMessage 			= ErrorMessage
							invoked.SalesOrderBOD      			= SalesOrderBOD
							invoked.PrmTrackerID				= LocalFSMInboundBODTracker
						invoke SendProcessSalesOrderACKBOD
	                        invoked.PrmErrorMessage 			= ErrorMessage
	                        invoked.SalesOrderBOD     			= SalesOrderBOD
	                        invoked.PrmTrackerID				= LocalFSMInboundBODTracker
	                        invoked.PrmCompany					= LocalCompany
					else
	               	if(LocalLineCount > 0)
	               		invoke CreateCustomerOrderLine
	               			invoked.SalesOrderBOD			= SalesOrderBOD
	               			invoked.PrmInboundTracker 		= LocalFSMInboundBODTracker
	               			invoked.PrmCompany				= LocalCompany
				            invoked.PrmCustomerOrder		= NewCustomerOrder.CustomerOrder  
				            invoked.PrmLocation				= LocalLocation
            	else
            		invoke Update FSMInboundBODTrackerRel
							invoked.Status						= 2
							invoked.CloseDate					= system current timestamp
					invoke SendProcessSalesOrderConfirmBOD
							invoked.PrmErrorMessage 			= ErrorMessage
							invoked.SalesOrderBOD      			= SalesOrderBOD
							invoked.PrmTrackerID				= LocalFSMInboundBODTracker
					invoke SendProcessSalesOrderACKBOD
                     	invoked.PrmErrorMessage 			= "CustomerOrder arleady exists"
                     	invoked.SalesOrderBOD      			= SalesOrderBOD
                     	invoked.PrmTrackerID				= LocalFSMInboundBODTracker	
						invoked.PrmCompany					= LocalCompany
						invoked.PrmCustomerOrder			= LocalCustomerOrder

        CreateCustomerOrderLine	is an Import Action
        	restricted
			Parameters
				SalesOrderBOD 			is XMLDocument
				PrmInboundTracker   	is like FSMInboundBODTracker
				PrmCompany				is Numeric 4
				PrmCustomerOrder		is Numeric 12
				PrmLocation				is AlphaUpper size 20
			Local Fields
				LocalCustomerOrderLine		is XMLDocument				
			Action Rules
				LocalCompany				=   PrmCompany
				LocalCustomerOrder			=   PrmCustomerOrder
				LocalLocation				=   PrmLocation
				LocalFSMInboundBODTracker 	= 	PrmInboundTracker	
				LocalLineCount				= 	SalesOrderBOD	select "count(//DataArea/SalesOrder/SalesOrderLine)"
				LocalIterator 				= 	1
				LocalGenericDelimiter       = 	DerivedGenericDelimiter
				LocalRelease				=   DerivedDefaultReleaseFlag
				while (LocalLineCount >= LocalIterator)	
					LocalCustomerOrderLine		= SalesOrderBOD	select "//DataArea/SalesOrder/SalesOrderLine[<LocalIterator>]"
					LocalQuantity  				= LocalCustomerOrderLine	select "/SalesOrderLine/Quantity"
					LocalUOM	  				= LocalCustomerOrderLine	select "/SalesOrderLine/Quantity/@unitCode"
					LocalEnteredPrice  			= LocalCustomerOrderLine	select "/SalesOrderLine/UnitPrice/Amount"
					LocalUnitCost  				= LocalCustomerOrderLine	select "/SalesOrderLine/UnitPrice/Amount"
					LocalPriceOverrideIndicator = LocalCustomerOrderLine	select "/SalesOrderLine/PriceOverrideIndicator"
					LocalItemDescription  		= LocalCustomerOrderLine	select "/SalesOrderLine/Item/Description"
					LocalItemID					= LocalCustomerOrderLine	select "/SalesOrderLine/Item/ItemID/ID"	
					LocalCustomerOrderLineNum	= SalesOrderBOD	select "//DataArea/SalesOrder/SalesOrderLine[<LocalIterator>]/LineNumber"
					LocalItem					= NativeItem
					if(DerivedConfigDocID = "Y")
						LocalItem 		= LocalItemID
					else
						LocalItem		= NativeItem
						
	       			if(LocalPriceOverrideIndicator = "false")
						LocalEnteredPrice = 0
						LocalUnitCost	  = 0
					
	       			if(ItemLocationRel exists)
						LocalInventoryTracked = ItemLocationRel.InventoryTracked
						if (LocalInventoryTracked = true )
							LocalItemType	= "I"
							LocalUnitCost	= ""
						else
							LocalItemType	= "N"
							LocalUnitCost	=  ItemLocationRel.StandardCost
					else
					if(LocalItemID = LocalItem)
						LocalItemType = "X"
						
					invoke Create	CustomerOrderLine
						resume on error
		                   	Error            								= true
		                    ErrorMessage     								= error message 
			            invoked.Company         							= LocalCompany
		             	invoked.CustomerOrder   							= LocalCustomerOrder
					 	invoked.Item										= LocalItem
						invoked.OrderQuantity								= LocalQuantity
						invoked.SellUOM									    = LocalUOM
						invoked.EnteredPrice								= LocalEnteredPrice
						invoked.LineType									= LocalItemType
						invoked.ItemDescription								= LocalItemDescription
						invoked.UnitCost									= LocalUnitCost	
					if(Error)
						invoke Update FSMInboundBODTrackerRel
							invoked.Error 						= Error
							invoked.ErrorMessage 				= ErrorMessage
							invoked.Status						= 2
							invoked.CloseDate					= system current timestamp 
						invoke SendProcessSalesOrderConfirmBOD
							invoked.PrmErrorMessage 			= ErrorMessage
							invoked.SalesOrderBOD      			= SalesOrderBOD
							invoked.PrmTrackerID				= LocalFSMInboundBODTracker
						invoke SendProcessSalesOrderACKBOD
	                        invoked.PrmErrorMessage 			= ErrorMessage
	                        invoked.SalesOrderBOD     			= SalesOrderBOD
	                        invoked.PrmTrackerID				= LocalFSMInboundBODTracker	
	                        invoked.PrmCompany					= LocalCompany		                       	                        
		    			LocalIterator = LocalLineCount + 1
		    		else
		    			LocalIterator = LocalIterator + 1
						if (LocalIterator%20 = 0)
							commit transaction
						
						
		        if(LocalRelease = "Y" and !FSMInboundBODTrackerRel.Error)
					invoke Unreleased.Release CustomerOrderRel
						resume on error
	                   		Error          						= true
	                        ErrorMessage    					= error message
					if(Error)
						invoke Update FSMInboundBODTrackerRel
							invoked.Error 						= Error
							invoked.ErrorMessage 				= ErrorMessage
							invoked.Status						= 2
							invoked.CloseDate					= system current timestamp
						invoke SendProcessSalesOrderConfirmBOD
							invoked.PrmErrorMessage 			= ErrorMessage
							invoked.SalesOrderBOD      			= SalesOrderBOD
							invoked.PrmTrackerID				= LocalFSMInboundBODTracker
						invoke SendProcessSalesOrderACKBOD
	                        invoked.PrmErrorMessage 			= ErrorMessage
	                        invoked.SalesOrderBOD      			= SalesOrderBOD
	                        invoked.PrmTrackerID				= LocalFSMInboundBODTracker
	                        invoked.PrmCompany					= LocalCompany 
	                        invoked.PrmCustomerOrder			= LocalCustomerOrder                       
					else
						invoke Update FSMInboundBODTrackerRel
							invoked.Status						= 3
							invoked.CloseDate					= system current timestamp
						invoke SendProcessSalesOrderACKBOD
	                     	invoked.PrmErrorMessage 			= "Customer Order Released Sucessfully"
	                     	invoked.SalesOrderBOD      			= SalesOrderBOD
	                     	invoked.PrmTrackerID				= LocalFSMInboundBODTracker	
							invoked.PrmCompany					= LocalCompany
							invoked.PrmCustomerOrder			= LocalCustomerOrder
		 				
				if(LocalRelease != "Y" and !FSMInboundBODTrackerRel.Error)	
					invoke Update FSMInboundBODTrackerRel
						invoked.Status			= 3
						invoked.CloseDate		= system current timestamp	
					invoke SendProcessSalesOrderACKBOD
			        	invoked.PrmErrorMessage 			= "CustomerOrder Created Sucessfully"
			            invoked.SalesOrderBOD   		    = SalesOrderBOD
			            invoked.PrmTrackerID				= LocalFSMInboundBODTracker	
					    invoked.PrmCompany					= LocalCompany
					    invoked.PrmCustomerOrder			= LocalCustomerOrder
		
		UpdateCustomerOder is an Import Action 
			restricted
			Parameters
				SalesOrderBOD 			is XMLDocument
				PrmInboundTracker   	is like FSMInboundBODTracker
				PrmCompany				is Numeric 4
				PrmLocation				is AlphaUpper size 20
				PrmProcessLevel			is AlphaUpper 5
				PrmActionCode			is Alpha 10
				PrmReferenceID			is Alpha 100
			Action Rules
				LocalFSMInboundBODTracker			= PrmInboundTracker
				LocalLocation						= PrmLocation
				LocalCompany						= PrmCompany
				LocalProcessLevel					= PrmProcessLevel
				LocalDocumentID						= SalesOrderBOD select "//DataArea/SalesOrder/SalesOrderHeader/CustomerParty/PartyIDs/ID"												
				LocalCurrency  						= SalesOrderBOD	select "//DataArea/SalesOrder/SalesOrderHeader/TotalAmount/@currencyID"
				LocalCustomerBillToID				= SalesOrderBOD	select "//DataArea/SalesOrder/SalesOrderHeader/BillToParty/PartyIDs/ID"
				LocalCustomerShipToID				= SalesOrderBOD	select "//DataArea/SalesOrder/SalesOrderHeader/ShipToParty/PartyIDs/ID"			
				LocalLineCount						= SalesOrderBOD	select "count(//DataArea/SalesOrder/SalesOrderLine)"
				LocalReferenceID					= SalesOrderBOD select "//DataArea/SalesOrder/SalesOrderHeader/DocumentID/ID"
				LocalOrderType						= DerivedDefaultOrderType
				LocalGenericDelimiter				= DerivedGenericDelimiter					
				LocalCustomer			 			= NativeCustomer
				LocalCustomerBillTo					= NativeCustomerBillTo
				LocalCustomerShipTo					= NativeCustomerShipTo	
				LocalReference						= NativeReferenceID	
				LocalStatusCode						= SalesOrderBOD select "//DataArea/SalesOrder/SalesOrderHeader/Status/Code"
				LocalActionCode						= PrmActionCode
				LocalCORStatus						= UpdateCustomerOrderRel.Status
				LocalCustomerOrder					= LocalReferenceID
				if(DerivedConfigDocID = "Y")
					LocalCustomer			 	= LocalDocumentID
					LocalCustomerBillTo			= LocalCustomerBillToID
					LocalCustomerShipToID		= SalesOrderBOD	select "//DataArea/SalesOrder/SalesOrderHeader/ShipToParty/PartyIDs/ID"	
					LocalReferenceID			= SalesOrderBOD select "//DataArea/SalesOrder/SalesOrderHeader/DocumentID/ID"
					LocalCustomerShipTo			= NativeCustomerSalesShipTo 
				else
					LocalCustomer			 	= NativeCustomer
					LocalCustomerBillTo			= NativeCustomerBillTo
					LocalCustomerShipToID		= SalesOrderBOD	select "//DataArea/SalesOrder/SalesOrderHeader/ShipToParty/PartyIDs/ID"	
					LocalReferenceID			= SalesOrderBOD select "//DataArea/SalesOrder/SalesOrderHeader/DocumentID/ID"
					LocalCustomerShipTo			= NativeCustomerShipTo
					
				if(UpdateCustomerOrderRel exists)
					if((LocalActionCode = "Change" or LocalActionCode = "Replace") and LocalCORStatus = "1" and LocalStatusCode = "Open" )
		  				invoke Unreleased.Update CustomerOrderRel 
							resume on error
		                   		Error            								= true
		                        ErrorMessage     								= error message 
			                invoked.Company         							= LocalCompany
			                invoked.InventoryLocation   						= LocalLocation
							invoked.Customer									= LocalCustomer
							invoked.BillingProcessLevel							= LocalProcessLevel
							invoked.OrderEntryOrderType							= LocalOrderType
							invoked.Currency									= LocalCurrency
							invoked.CustomerBillTo								= LocalCustomerBillTo
							invoked.CustomerShipTo								= LocalCustomerShipTo
							invoked.CustomerOrder								= LocalReferenceID
						if(Error)
							invoke Update FSMInboundBODTrackerRel
								invoked.Error 						= Error
								invoked.ErrorMessage 				= ErrorMessage
								invoked.Status						= 2
								invoked.CloseDate					= system current timestamp 
							invoke SendProcessSalesOrderConfirmBOD
								invoked.PrmErrorMessage 			= ErrorMessage
								invoked.SalesOrderBOD      			= SalesOrderBOD
								invoked.PrmTrackerID				= LocalFSMInboundBODTracker
							invoke SendProcessSalesOrderACKBOD
		                        invoked.PrmErrorMessage 			= ErrorMessage
		                        invoked.SalesOrderBOD     			= SalesOrderBOD
		                        invoked.PrmTrackerID				= LocalFSMInboundBODTracker
		                        invoked.PrmCompany					= LocalCompany
	                 	else
		               	if(LocalLineCount > 0)
		               		invoke UpdateCustomerOrderLine
		               			invoked.SalesOrderBOD			= SalesOrderBOD
		               			invoked.PrmInboundTracker 		= LocalFSMInboundBODTracker
		               			invoked.PrmCompany				= LocalCompany
					            invoked.PrmCustomerOrder		= LocalReferenceID  
					            invoked.PrmLocation				= LocalLocation
		            else
			    	if((LocalActionCode = "Change" or LocalActionCode = "Replace") and LocalCORStatus = "2" and LocalStatusCode = "Deleted" )
			    		invoke Released.CancelCustomerOrder CustomerOrderRel
							resume on error
		                   		Error          						= true
		                        ErrorMessage    					= error message
						if(Error)
							invoke Update FSMInboundBODTrackerRel
								invoked.Error 						= Error
								invoked.ErrorMessage 				= ErrorMessage
								invoked.Status						= 2
								invoked.CloseDate					= system current timestamp
							invoke SendProcessSalesOrderConfirmBOD
								invoked.PrmErrorMessage 			= ErrorMessage
								invoked.SalesOrderBOD      			= SalesOrderBOD
								invoked.PrmTrackerID				= LocalFSMInboundBODTracker
							invoke SendProcessSalesOrderACKBOD
		                        invoked.PrmErrorMessage 			= ErrorMessage
		                        invoked.SalesOrderBOD      			= SalesOrderBOD
		                        invoked.PrmTrackerID				= LocalFSMInboundBODTracker
		                        invoked.PrmCompany					= LocalCompany 
		                        invoked.PrmCustomerOrder			= LocalCustomerOrder  
		                else
		                	invoke Update FSMInboundBODTrackerRel
								invoked.Status						= 3
								invoked.CloseDate					= system current timestamp
							invoke SendProcessSalesOrderACKBOD
		                     	invoked.PrmErrorMessage 			= "Customer Order Deleted Sucessfully"
		                     	invoked.SalesOrderBOD      			= SalesOrderBOD
		                     	invoked.PrmTrackerID				= LocalFSMInboundBODTracker	
								invoked.PrmCompany					= LocalCompany
								invoked.PrmCustomerOrder			= LocalCustomerOrder
					
					else
					if((LocalActionCode = "Change" or LocalActionCode = "Replace") and ((LocalCORStatus = "2" and LocalStatusCode = "Open") or  (LocalCORStatus = "1" and LocalStatusCode = "Deleted")))
						invoke Update FSMInboundBODTrackerRel
							invoked.Status			= 2
							invoked.CloseDate		= system current timestamp	
						invoke SendProcessSalesOrderConfirmBOD
							invoked.PrmErrorMessage 			= ErrorMessage
							invoked.SalesOrderBOD      			= SalesOrderBOD
							invoked.PrmTrackerID				= LocalFSMInboundBODTracker
						invoke SendProcessSalesOrderACKBOD
				        	invoked.PrmErrorMessage 			= "CustomerOrder in Released state, cannot perform Update action."
				            invoked.SalesOrderBOD   		    = SalesOrderBOD
				            invoked.PrmTrackerID				= LocalFSMInboundBODTracker	
						    invoked.PrmCompany					= LocalCompany
						    invoked.PrmCustomerOrder			= LocalCustomerOrder
						
		
		UpdateCustomerOrderLine	is an Import Action
        	restricted
			Parameters
				SalesOrderBOD 			is XMLDocument
				PrmInboundTracker   	is like FSMInboundBODTracker
				PrmCompany				is Numeric 4
				PrmCustomerOrder		is Numeric 12
				PrmLocation				is AlphaUpper size 20
			Local Fields
				LocalCustomerOrderLine		is XMLDocument				
			Action Rules
				LocalCompany				=   PrmCompany
				LocalCustomerOrder			=   PrmCustomerOrder
				LocalLocation				=   PrmLocation
				LocalFSMInboundBODTracker 	= 	PrmInboundTracker	
				LocalLineCount				= 	SalesOrderBOD	select "count(//DataArea/SalesOrder/SalesOrderLine)"
				LocalIterator 				= 	1
				LocalGenericDelimiter       = 	DerivedGenericDelimiter
				LocalRelease				=   DerivedDefaultReleaseFlag
				while (LocalLineCount >= LocalIterator)	
					LocalCustomerOrderLine		= SalesOrderBOD	select "//DataArea/SalesOrder/SalesOrderLine[<LocalIterator>]"
					LocalQuantity  				= LocalCustomerOrderLine	select "/SalesOrderLine/Quantity"
					LocalUOM	  				= LocalCustomerOrderLine	select "/SalesOrderLine/Quantity/@unitCode"
					LocalEnteredPrice  			= LocalCustomerOrderLine	select "/SalesOrderLine/UnitPrice/Amount"
					LocalUnitCost  				= LocalCustomerOrderLine	select "/SalesOrderLine/UnitPrice/Amount"
					LocalPriceOverrideIndicator = LocalCustomerOrderLine	select "/SalesOrderLine/PriceOverrideIndicator"
					LocalItemDescription  		= LocalCustomerOrderLine	select "/SalesOrderLine/Item/Description"
					LocalItemID					= LocalCustomerOrderLine	select "/SalesOrderLine/Item/ItemID/ID"	
					LocalItem					= NativeItem
					LocalCustomerOrderLineNum	= SalesOrderBOD	select "//DataArea/SalesOrder/SalesOrderLine[<LocalIterator>]/LineNumber"
					if(DerivedConfigDocID = "Y")
						LocalItem 		= LocalItemID
					else
						LocalItem		= NativeItem
						
	       			if(LocalPriceOverrideIndicator = "false")
						LocalEnteredPrice = 0
						LocalUnitCost	  = 0
					
	       			if(ItemLocationRel exists)
						LocalInventoryTracked = ItemLocationRel.InventoryTracked
						if (LocalInventoryTracked = true )
							LocalItemType	= "I"
							LocalUnitCost	= ""
						else
							LocalItemType	= "N"
							LocalUnitCost	=  ItemLocationRel.StandardCost
					else
					if(LocalItemID = LocalItem)
						LocalItemType = "X"
						
					if(CustomerOrderLineRel exists)
						invoke Unreleased.Update CustomerOrderLineRel
							resume on error
			                   	Error            								= true
			                    ErrorMessage     								= error message 
				            invoked.Company         							= LocalCompany
			             	invoked.CustomerOrder   							= LocalCustomerOrder
						 	invoked.Item										= LocalItem
							invoked.OrderQuantity								= LocalQuantity
							invoked.SellUOM									    = LocalUOM
							invoked.EnteredPrice								= LocalEnteredPrice
							invoked.LineType									= LocalItemType
							invoked.ItemDescription								= LocalItemDescription
							invoked.UnitCost									= LocalUnitCost	
						if(Error)
							invoke Update FSMInboundBODTrackerRel
								invoked.Error 						= Error
								invoked.ErrorMessage 				= ErrorMessage
								invoked.Status						= 2
								invoked.CloseDate					= system current timestamp 
							invoke SendProcessSalesOrderConfirmBOD
								invoked.PrmErrorMessage 			= ErrorMessage
								invoked.SalesOrderBOD      			= SalesOrderBOD
								invoked.PrmTrackerID				= LocalFSMInboundBODTracker
							invoke SendProcessSalesOrderACKBOD
		                        invoked.PrmErrorMessage 			= ErrorMessage
		                        invoked.SalesOrderBOD     			= SalesOrderBOD
		                        invoked.PrmTrackerID				= LocalFSMInboundBODTracker	
		                        invoked.PrmCompany					= LocalCompany		                       	                        
			    			LocalIterator = LocalLineCount + 1
			    		else
			    			LocalIterator = LocalIterator + 1
							if (LocalIterator%20 = 0)
								commit transaction		
							
					else
						invoke Create CustomerOrderLine
							resume on error
			                   	Error            								= true
			                    ErrorMessage     								= error message 
				            invoked.Company         							= LocalCompany
			             	invoked.CustomerOrder   							= LocalCustomerOrder
						 	invoked.Item										= LocalItem
							invoked.OrderQuantity								= LocalQuantity
							invoked.SellUOM									    = LocalUOM
							invoked.EnteredPrice								= LocalEnteredPrice
							invoked.LineType									= LocalItemType
							invoked.ItemDescription								= LocalItemDescription
							invoked.UnitCost									= LocalUnitCost	
						if(Error)
							invoke Update FSMInboundBODTrackerRel
								invoked.Error 						= Error
								invoked.ErrorMessage 				= ErrorMessage
								invoked.Status						= 2
								invoked.CloseDate					= system current timestamp 
							invoke SendProcessSalesOrderConfirmBOD
								invoked.PrmErrorMessage 			= ErrorMessage
								invoked.SalesOrderBOD      			= SalesOrderBOD
								invoked.PrmTrackerID				= LocalFSMInboundBODTracker
							invoke SendProcessSalesOrderACKBOD
		                        invoked.PrmErrorMessage 			= ErrorMessage
		                        invoked.SalesOrderBOD     			= SalesOrderBOD
		                        invoked.PrmTrackerID				= LocalFSMInboundBODTracker	
		                        invoked.PrmCompany					= LocalCompany		                       	                        
			    			LocalIterator = LocalLineCount + 1
			    		else
			    			LocalIterator = LocalIterator + 1
							if (LocalIterator%20 = 0)
								commit transaction		
							
		        if(LocalRelease = "Y" and !FSMInboundBODTrackerRel.Error)
					invoke Unreleased.Release CustomerOrderRel
						resume on error
	                   		Error          						= true
	                        ErrorMessage    					= error message
					if(Error)
						invoke Update FSMInboundBODTrackerRel
							invoked.Error 						= Error
							invoked.ErrorMessage 				= ErrorMessage
							invoked.Status						= 2
							invoked.CloseDate					= system current timestamp
						invoke SendProcessSalesOrderConfirmBOD
							invoked.PrmErrorMessage 			= ErrorMessage
							invoked.SalesOrderBOD      			= SalesOrderBOD
							invoked.PrmTrackerID				= LocalFSMInboundBODTracker
						invoke SendProcessSalesOrderACKBOD
	                        invoked.PrmErrorMessage 			= ErrorMessage
	                        invoked.SalesOrderBOD      			= SalesOrderBOD
	                        invoked.PrmTrackerID				= LocalFSMInboundBODTracker
	                        invoked.PrmCompany					= LocalCompany 
	                        invoked.PrmCustomerOrder			= LocalCustomerOrder                       
					else
						invoke Update FSMInboundBODTrackerRel
							invoked.Status						= 3
							invoked.CloseDate					= system current timestamp
						invoke SendProcessSalesOrderACKBOD
	                     	invoked.PrmErrorMessage 			= "Customer Order Released Sucessfully"
	                     	invoked.SalesOrderBOD      			= SalesOrderBOD
	                     	invoked.PrmTrackerID				= LocalFSMInboundBODTracker	
							invoked.PrmCompany					= LocalCompany
							invoked.PrmCustomerOrder			= LocalCustomerOrder
		 				
				if(LocalRelease != "Y" and !FSMInboundBODTrackerRel.Error)	
					invoke Update FSMInboundBODTrackerRel
						invoked.Status			= 3
						invoked.CloseDate		= system current timestamp	
					invoke SendProcessSalesOrderACKBOD
			        	invoked.PrmErrorMessage 			= "CustomerOrder Created Sucessfully"
			            invoked.SalesOrderBOD   		    = SalesOrderBOD
			            invoked.PrmTrackerID				= LocalFSMInboundBODTracker	
					    invoked.PrmCompany					= LocalCompany
					    invoked.PrmCustomerOrder			= LocalCustomerOrder         	
			                							
		SendProcessSalesOrderACKBOD is an Instance Action
			restricted			
			Parameters
				SalesOrderBOD 							is XMLDocument
				PrmErrorMessage 						is Alpha 300
				PrmTrackerID							is Numeric 15
				PrmCompany								is Alpha 40
				PrmCustomerOrder						is Alpha 40
			Action Rules
				LocalProcessSalesOrderXML				= SalesOrderBOD
				LocalErrorMessage						= PrmErrorMessage
				LocalTrackerID							= PrmTrackerID
				LocalCustomerOrder						= PrmCustomerOrder
				LocalCompany							= PrmCompany
				LocalDocumentID							= LocalCustomerOrder
				Locallid								= SalesOrderBOD	select "//DataArea/SalesOrder/SalesOrderHeader/DocumentID/ID/@lid"				
				LocalComponentID						= SalesOrderBOD select "//ApplicationArea/Sender/ComponentID"
				LocalBODID								= SalesOrderBOD select "//ApplicationArea/BODID"
				LocalFromLogicalID						= SalesOrderBOD select "//ApplicationArea/Sender/LogicalID"
				LocalOriginalCreateDateTime				= SalesOrderBOD select "//ApplicationArea/CreationDateTime"
				LocalCustomerAE	   			 			= SalesOrderBOD select "//DataArea/SalesOrder/SalesOrderHeader/DocumentID/ID/@accountingEntity"
				LocalMainUserTemplate					= "IONProcessSalesOrder_AcknowledgeBOD_ST"
				if(UserTemplateRel exists)
					send ion bod
						bod is ProcessSalesOrderAcknowledgeBODXML
						bod type is "Acknowledge.SalesOrder"	
						accounting entity is LocalCustomerAE
						document id is LocalDocumentID
				
		SendProcessSalesOrderConfirmBOD is an Instance Action
			restricted			
			Parameters
				SalesOrderBOD 			is XMLDocument
				PrmErrorMessage		    is Alpha 300
				PrmTrackerID			is Numeric 15
			Action Rules
				LocalProcessSalesOrderXML   		= SalesOrderBOD
				LocalErrorMessage					= PrmErrorMessage
				LocalTrackerID						= PrmTrackerID
				LocalComponentID					= SalesOrderBOD select "//ApplicationArea/Sender/ComponentID"
				LocalBODID							= SalesOrderBOD select "//ApplicationArea/BODID"
				LocalFromLogicalID					= SalesOrderBOD select "//ApplicationArea/Sender/LogicalID"
				LocalOriginalCreateDateTime			= SalesOrderBOD select "//ApplicationArea/CreationDateTime"
				LocalCustomerAE			   		    = SalesOrderBOD select "//DataArea/SalesOrder/SalesOrderHeader/DocumentID/ID/@accountingEntity"
				LocalVariationID            	    = SalesOrderBOD select "//DataArea/SalesOrder/SalesOrderHeader/DocumentID/ID/@variationID"	
				LocalConfirmBOD						= "true"
				LocalMainUserTemplate				= "IONProcessSalesOrder_ConfirmBOD_ST"
				if(UserTemplateRel exists)
					send ion bod
						bod is ProcessSalesOrderConfirmBODXML
						bod type is "Confirm.BOD"
						accounting entity is LocalCustomerAE
						document id is LocalDocumentID				


		ProcessBillToPartyMasterBODImport is an Import Action
			restricted
			bod type is Process.BillToPartyMaster
			Parameters
				BillToPartyMasterBOD 				is XMLDocument
			Action Rules
				LocalBODXML					 		= BillToPartyMasterBOD
				LocalDocumentID						= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/PartyIDs/ID"
				LocalCustomerPartyID		 		= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/CustomerParty/PartyIDs/ID"
				LocalGenericDelimiter				= DerivedGenericDelimiter
				LocalCustomerPartyReference	 		= NativeCustomerParty
				LocalAccountingEntity				= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/PartyIDs/ID/@accountingEntity"
				LocalCustomerBillToID				= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/PartyIDs/ID"
				LocalActionCode						= BillToPartyMasterBOD select "//DataArea/Process/ActionCriteria/ActionExpression/@actionCode"
				if(LocalActionCode != "Add" and LocalCustomerBillToID not entered)
					LocalCustomerBillToID = ""
				else
					LocalCustomerBillToID = NativeCustomerBillTo

				if(DerivedConfigDocID = "Y")
					if(FSMBODCleanDocIDRel.DestinationValue entered)
						LocalCrossAccountingEntity  =  FSMBODCleanDocIDRel.DestinationValue
					else
						LocalCrossAccountingEntity	=  LocalAccountingEntity

					if(DerivedConfigFEG != "Y")
						LocalCompany        	= LocalCrossAccountingEntity
					else
					if(DerivedConfigFEG = "Y")
						LocalAccountingEntity   = LocalCrossAccountingEntity
						LocalCompany   			= NativeCompany
					else
						LocalCompany 			= LocalCrossAccountingEntity
				else
					LocalCompany 				= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/PartyIDs/ID/@accountingEntity"

				LocalCustomer 			= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/CustomerParty/PartyIDs/ID"
				LocalAccountingEntity	= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/PartyIDs/ID/@accountingEntity"
				LocalVariationID		= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/PartyIDs/ID/@variationID"

				if(FSMBODConfigurationProcessBillToPartyMasterRel exists and FSMBODConfigurationProcessBillToPartyMasterRel.Enable)
					if(FSMInboundBODTracker not entered)
						invoke Create FSMInboundBODTracker
							assign result to NewBODTracker
							invoked.Verb 					= 2
							invoked.Noun 					= "BillToPartyMaster"
							invoked.Direction				= 2
							invoked.BODDocumentID			= LocalDocumentID
							invoked.BODID					= LocalBODID
							invoked.Company					= LocalCompany
							invoked.Customer				= LocalCustomer
							invoked.BODVariationID			= LocalVariationID
							invoked.Status					= 1
							invoked.StartDate				= system current timestamp
							invoked.BODXML					= LocalBODXML
							invoked.BODAccountingEntity		= LocalAccountingEntity
							initialize invoked.Error
							initialize invoked.ErrorMessage
						LocalFSMInboundBODTracker = NewBODTracker.FSMInboundBODTracker
					else
						LocalFSMInboundBODTracker = FSMInboundBODTracker
						invoke Update FSMInboundBODTrackerRel
							invoked.BODDocumentID			= LocalDocumentID
							invoked.BODID					= LocalBODID
							invoked.Company					= LocalCompany
							invoked.Customer				= LocalCustomer
							invoked.BODVariationID			= LocalVariationID
							invoked.Status					= 1
							invoked.StartDate				= system current timestamp
							invoked.BODXML					= LocalBODXML
							invoked.BODAccountingEntity		= LocalAccountingEntity
							initialize invoked.Error
							initialize invoked.ErrorMessage
					if(GeneralLedgerCompanyRel exists)
						LocalCustomerGroup 			= GeneralLedgerCompanyRel.CustomerBusinessGroup
						if(LocalActionCode = "Add")
							invoke CreateCustomerBillTo
								invoked.BillToPartyMasterBOD	= BillToPartyMasterBOD
				                invoked.PrmInboundTracker 		= LocalFSMInboundBODTracker
				                invoked.PrmCustomerGroup		= LocalCustomerGroup
				                invoked.PrmCustomer		 		= LocalCustomer
				                invoked.PrmCompany				= LocalCompany
				        else
				        if(CustomerBillToRel exists)
							if(LocalActionCode = "Change" or LocalActionCode = "Replace")
								invoke UpdateCustomerBillTo
									invoked.BillToPartyMasterBOD	= BillToPartyMasterBOD
					                invoked.PrmInboundTracker 		= LocalFSMInboundBODTracker
					                invoked.PrmCustomerGroup		= LocalCustomerGroup
					                invoked.PrmCustomer		 		= LocalCustomer
									invoked.PrmCustomerBillToID		= LocalCustomerBillToID
									invoked.PrmCompany				= LocalCompany
							else
							if(LocalActionCode = "Delete")
								invoke Delete CustomerBillToRel
									resume on error
										Error             							= true
				                        ErrorMessage     							= error message
								if(Error)
									LocalErrorMessage = "Deleting CustomerBillTo" +", "+"Record Key: "+LocalAccountingEntity + "-" +LocalCustomerBillToID+", "+"Message:"+ ErrorMessage
									invoke Update FSMInboundBODTrackerRel
										invoked.Error 								= Error
										invoked.ErrorMessage 						= ErrorMessage
										invoked.Status								= 2
										invoked.CloseDate							= system current timestamp
									invoke SendProcessBillToPartyMasterConfirmBOD
										invoked.PrmErrorMessage 					= LocalErrorMessage
										invoked.BillToPartyMasterBOD 				= BillToPartyMasterBOD
										invoked.PrmCompany							= LocalCompany
										invoked.PrmTrackerID						= LocalFSMInboundBODTracker
									invoke SendProcessBillToPartyMasterACKBOD
				                        invoked.PrmErrorMessage 					= LocalErrorMessage
				                        invoked.BillToPartyMasterBOD      			= BillToPartyMasterBOD
				                        invoked.PrmCompany							= LocalCompany
				                        invoked.PrmTrackerID						= LocalFSMInboundBODTracker
								else
									invoke Update FSMInboundBODTrackerRel
										invoked.Status					= 3
										invoked.CloseDate				= system current timestamp
									invoke SendProcessBillToPartyMasterACKBOD
				                        invoked.PrmErrorMessage 					= "Application_Success"
				                        invoked.BillToPartyMasterBOD      			= BillToPartyMasterBOD
				                        invoked.PrmCompany							= LocalCompany
				                        invoked.PrmTrackerID						= LocalFSMInboundBODTracker
				        else
					        if(LocalActionCode = "Change" or LocalActionCode = "Replace")
								invoke CreateCustomerBillTo
									invoked.BillToPartyMasterBOD	= BillToPartyMasterBOD
					                invoked.PrmInboundTracker 		= LocalFSMInboundBODTracker
					                invoked.PrmCustomerGroup		= LocalCustomerGroup
					                invoked.PrmCustomer		 		= LocalCustomer
					                invoked.PrmCompany				= LocalCompany
							else
								invoke Update FSMInboundBODTrackerRel
									invoked.Status									= 3
									invoked.CloseDate								= system current timestamp
					else
						LocalErrorMessage = "Finding CustomerGroup" +", "+"Record Key: "+LocalAccountingEntity + "-" +LocalCompany+", "+"Message:GeneralLedgerCompany not found for company-"+LocalCompany
						invoke Update FSMInboundBODTrackerRel
							invoked.Error 								= true
							invoked.ErrorMessage 						= LocalErrorMessage
							invoked.Status								= 2
							invoked.CloseDate							= system current timestamp
						invoke SendProcessBillToPartyMasterConfirmBOD
							invoked.PrmErrorMessage 					= LocalErrorMessage
							invoked.BillToPartyMasterBOD 				= BillToPartyMasterBOD
							invoked.PrmCompany							= LocalCompany
							invoked.PrmTrackerID						= LocalFSMInboundBODTracker
						invoke SendProcessBillToPartyMasterACKBOD
	                        invoked.PrmErrorMessage 					= LocalErrorMessage
	                        invoked.BillToPartyMasterBOD      			= BillToPartyMasterBOD
	                        invoked.PrmCompany							= LocalCompany
	                        invoked.PrmTrackerID						= LocalFSMInboundBODTracker
			    else
			    if(FSMInboundBODTracker not entered)
					invoke Create FSMInboundBODTracker
						assign result to NewBODTracker
						invoked.Verb 					= 2
						invoked.Noun 					= "BillToPartyMaster"
						invoked.Direction				= 2
						invoked.BODDocumentID			= LocalDocumentID
						invoked.BODID					= LocalBODID
						invoked.Company					= LocalCompany
						invoked.Customer				= LocalCustomer
						invoked.BODVariationID			= LocalVariationID
						invoked.Status					= 4
						invoked.StartDate				= system current timestamp
						invoked.BODXML					= LocalBODXML
						invoked.BODAccountingEntity		= LocalAccountingEntity
						invoked.CloseDate				= system current timestamp
						invoked.Error					= true
						invoked.ErrorMessage			= "Process BillToPartyMaster Inbound BOD Service is not Enabled"
					LocalFSMInboundBODTracker = NewBODTracker.FSMInboundBODTracker
				else
					LocalFSMInboundBODTracker = FSMInboundBODTracker
					invoke Update FSMInboundBODTrackerRel
						invoked.BODDocumentID			= LocalDocumentID
						invoked.BODID					= LocalBODID
						invoked.Company					= LocalCompany
						invoked.Customer				= LocalCustomer
						invoked.BODVariationID			= LocalVariationID
						invoked.Status					= 4
						invoked.StartDate				= system current timestamp
						invoked.BODXML					= LocalBODXML
						invoked.BODAccountingEntity		= LocalAccountingEntity
						invoked.CloseDate				= system current timestamp
						invoked.Error					= true
						invoked.ErrorMessage			= "Process BillToPartyMaster Inbound BOD Service is not Enabled"
						
		CreateCustomerBillTo is an Import Action
			restricted
			Parameters
				BillToPartyMasterBOD			is XMLDocument
				PrmInboundTracker 				is like FSMInboundBODTracker
				PrmCustomerGroup				is AlphaUpper size 5
				PrmCustomer						is Numeric 9
				PrmCompany						is Numeric 4
			Action Rules
				BillToPartyMasterBOD				= BillToPartyMasterBOD
				LocalFSMInboundBODTracker           = PrmInboundTracker
				LocalCustomerGroup                  = PrmCustomerGroup
				LocalCustomer                       = PrmCustomer
				LocalCompany						= PrmCompany
				LocalCustomerDeliveryAddressLine1 	= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/Location/Address[1]/AddressLine[1]"
				LocalCustomerDeliveryAddressLine2 	= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/Location/Address[1]/AddressLine[2]"
				LocalCustomerDeliveryAddressLine3 	= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/Location/Address[1]/AddressLine[3]"
				LocalCustomerDeliveryAddressLine4 	= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/Location/Address[1]/AddressLine[4]"
				LocalCustomerName					= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/Name"
				LocalCustomerCountryCode			= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/Location/Address[1]/CountryCode"
				LocalCustomerCity					= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/Location/Address[1]/CityName"
				LocalCustomerStateProvinance		= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/Location/Address[1]/CountrySubDivisionCode"
				LocalCustomerPostalCode				= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/Location/Address[1]/PostalCode"

				invoke CreateCustomerBillTo CustomerBillTo
					assign result to NewCustomerBillTo
					resume on error
						Error            								= true
                        ErrorMessage     								= error message
					invoked.CustomerGroup								= LocalCustomerGroup
					invoked.Customer									= LocalCustomer
					invoked.Name										= LocalCustomerName
					invoked.PostalAddress.Country						= LocalCustomerCountryCode
					invoked.PostalAddress.DeliveryAddress.AddressLine1	= LocalCustomerDeliveryAddressLine1
					invoked.PostalAddress.DeliveryAddress.AddressLine2	= LocalCustomerDeliveryAddressLine2
					invoked.PostalAddress.DeliveryAddress.AddressLine3	= LocalCustomerDeliveryAddressLine3
					invoked.PostalAddress.DeliveryAddress.AddressLine4	= LocalCustomerDeliveryAddressLine4
					invoked.PostalAddress.StateProvince					= LocalCustomerStateProvinance
					invoked.PostalAddress.Municipality					= LocalCustomerCity
					invoked.PostalAddress.PostalCode					= LocalCustomerPostalCode
				if(Error)
					LocalErrorMessage = "Creating CustomerBillTo" +", "+"Record Key: "+LocalAccountingEntity + "-" +LocalCustomer+", "+"Message:"+ ErrorMessage
					invoke Update FSMInboundBODTrackerRel
						invoked.Error 								= Error
						invoked.ErrorMessage 						= ErrorMessage
						invoked.Status								= 2
						invoked.CloseDate							= system current timestamp
					invoke SendProcessBillToPartyMasterConfirmBOD
						invoked.PrmErrorMessage 					= LocalErrorMessage
						invoked.BillToPartyMasterBOD 				= BillToPartyMasterBOD
						invoked.PrmCompany							= LocalCompany
						invoked.PrmTrackerID						= LocalFSMInboundBODTracker
					invoke SendProcessBillToPartyMasterACKBOD
                        invoked.PrmErrorMessage 					= LocalErrorMessage
                        invoked.BillToPartyMasterBOD      			= BillToPartyMasterBOD
                        invoked.PrmCompany							= LocalCompany
                        invoked.PrmTrackerID						= LocalFSMInboundBODTracker
				else
					LocalCustomerBillToID	= NewCustomerBillTo.CustomerBillTo
					invoke Update FSMInboundBODTrackerRel
						invoked.Status									= 3
						invoked.CloseDate								= system current timestamp
					invoke SendProcessBillToPartyMasterACKBOD
                        invoked.PrmErrorMessage 			= "Application_Success"
                        invoked.BillToPartyMasterBOD      	= BillToPartyMasterBOD
                        invoked.PrmCompany					= LocalCompany
                        invoked.PrmTrackerID				= LocalFSMInboundBODTracker

		UpdateCustomerBillTo is an Import Action
			restricted
			Parameters
				BillToPartyMasterBOD			is XMLDocument
				PrmInboundTracker 				is like FSMInboundBODTracker
				PrmCustomerGroup				is AlphaUpper size 5
				PrmCustomer						is Numeric 9
				PrmCustomerBillToID				is Alpha 30
				PrmCompany						is Numeric 4
			Action Rules
				BillToPartyMasterBOD				= BillToPartyMasterBOD
				LocalFSMInboundBODTracker           = PrmInboundTracker
				LocalCustomerGroup                  = PrmCustomerGroup
				LocalCustomer                       = PrmCustomer
				LocalCustomerBillToID				= PrmCustomerBillToID
				LocalCompany						= PrmCompany
				LocalCustomerDeliveryAddressLine1 	= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/Location/Address[1]/AddressLine[1]"
				LocalCustomerDeliveryAddressLine2 	= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/Location/Address[1]/AddressLine[2]"
				LocalCustomerDeliveryAddressLine3 	= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/Location/Address[1]/AddressLine[3]"
				LocalCustomerDeliveryAddressLine4 	= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/Location/Address[1]/AddressLine[4]"
				LocalCustomerName					= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/Name"
				LocalCustomerCountryCode			= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/Location/Address[1]/CountryCode"
				LocalCustomerCity					= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/Location/Address[1]/CityName"
				LocalCustomerStateProvinance		= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/Location/Address[1]/CountrySubDivisionCode"
				LocalCustomerPostalCode				= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/Location/Address[1]/PostalCode"

				invoke Update CustomerBillToRel
					resume on error
						Error            								= true
						ErrorMessage     								= error message
					invoked.CustomerGroup								= LocalCustomerGroup
					invoked.Customer									= LocalCustomer
					invoked.CustomerBillTo								= LocalCustomerBillToID
					invoked.Name										= LocalCustomerName
					invoked.PostalAddress.Country						= LocalCustomerCountryCode
					invoked.PostalAddress.DeliveryAddress.AddressLine1	= LocalCustomerDeliveryAddressLine1
					invoked.PostalAddress.DeliveryAddress.AddressLine2	= LocalCustomerDeliveryAddressLine2
					invoked.PostalAddress.DeliveryAddress.AddressLine3	= LocalCustomerDeliveryAddressLine3
					invoked.PostalAddress.DeliveryAddress.AddressLine4	= LocalCustomerDeliveryAddressLine4
					invoked.PostalAddress.StateProvince					= LocalCustomerStateProvinance
					invoked.PostalAddress.Municipality					= LocalCustomerCity
					invoked.PostalAddress.PostalCode					= LocalCustomerPostalCode
				if(Error)
					LocalErrorMessage = "Updating CustomerBillTo" +", "+"Record Key: "+LocalAccountingEntity + "-" +LocalCustomerBillToID+", "+"Message:"+ ErrorMessage
					invoke Update FSMInboundBODTrackerRel
						invoked.Error 								= Error
						invoked.ErrorMessage 						= ErrorMessage
						invoked.Status								= 2
						invoked.CloseDate							= system current timestamp
					invoke SendProcessBillToPartyMasterConfirmBOD
						invoked.PrmErrorMessage 					= LocalErrorMessage
						invoked.BillToPartyMasterBOD 				= BillToPartyMasterBOD
						invoked.PrmCompany							= LocalCompany
						invoked.PrmTrackerID						= LocalFSMInboundBODTracker
					invoke SendProcessBillToPartyMasterACKBOD
                        invoked.PrmErrorMessage 					= LocalErrorMessage
                        invoked.BillToPartyMasterBOD      			= BillToPartyMasterBOD
                        invoked.PrmCompany							= LocalCompany
                        invoked.PrmTrackerID						= LocalFSMInboundBODTracker
				else
					invoke Update FSMInboundBODTrackerRel
						invoked.Status									= 3
						invoked.CloseDate								= system current timestamp
					invoke SendProcessBillToPartyMasterACKBOD
                        invoked.PrmErrorMessage 			= "Application_Success"
                        invoked.BillToPartyMasterBOD      	= BillToPartyMasterBOD
                        invoked.PrmCompany					= LocalCompany
                        invoked.PrmTrackerID				= LocalFSMInboundBODTracker

		SendProcessBillToPartyMasterACKBOD is an Instance Action
			restricted
			Parameters
				BillToPartyMasterBOD 					is XMLDocument
				PrmErrorMessage 						is Alpha 300
				PrmTrackerID							is Numeric 15
				PrmCompany								is Numeric 4
			Action Rules
				LocalBODXML								= BillToPartyMasterBOD
				LocalErrorMessage						= PrmErrorMessage
				LocalTrackerID							= PrmTrackerID
				LocalCompany							= PrmCompany
				LocalOriginalApplicationArea			= BillToPartyMasterBOD select "//ApplicationArea"
				LocalDocumentID							= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/PartyIDs/ID"
				LocalComponentID						= BillToPartyMasterBOD select "//ApplicationArea/Sender/ComponentID"
				LocalBODID                  			= BillToPartyMasterBOD select "//ApplicationArea/BODID"
				Locallid								= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/CustomerParty/PartyIDs/ID/@lid"
				LocalFromLogicalID						= BillToPartyMasterBOD select "//ApplicationArea/Sender/LogicalID"
				LocalOriginalCreateDateTime				= BillToPartyMasterBOD select "//ApplicationArea/CreationDateTime"
				LocalAccountingEntity					= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/PartyIDs/ID/@accountingEntity"
				LocalMainUserTemplate					= "IONProcessBillToPartyMaster_AcknowledgeBOD_ST"
				if(UserTemplateRel exists)
					send ion bod
						bod is ProcessBillToPartyMasterAcknowledgeBODXML
						bod type is "Acknowledge.BillToPartyMaster"
						accounting entity is LocalAccountingEntity
						document id is LocalDocumentID

		SendProcessBillToPartyMasterConfirmBOD is an Instance Action
			restricted
			Parameters
				BillToPartyMasterBOD 					is XMLDocument
				PrmErrorMessage 						is Alpha 300
				PrmTrackerID							is Numeric 15
				PrmCompany								is Numeric 4
			Action Rules
				LocalBODXML   							= BillToPartyMasterBOD
				LocalErrorMessage						= PrmErrorMessage
				LocalTrackerID							= PrmTrackerID
				LocalCompany							= PrmCompany
				LocalOriginalApplicationArea			= BillToPartyMasterBOD select "//ApplicationArea"
				LocalDocumentID							= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/PartyIDs/ID"
				LocalComponentID						= BillToPartyMasterBOD select "//ApplicationArea/Sender/ComponentID"
				LocalBODID                  			= BillToPartyMasterBOD select "//ApplicationArea/BODID"
				LocalFromLogicalID						= BillToPartyMasterBOD select "//ApplicationArea/Sender/LogicalID"
				LocalOriginalCreateDateTime				= BillToPartyMasterBOD select "//ApplicationArea/CreationDateTime"
				LocalAccountingEntity					= BillToPartyMasterBOD select "//DataArea/BillToPartyMaster/PartyIDs/ID/@accountingEntity"
				LocalConfirmBOD							= "true"
				LocalMainUserTemplate					= "IONProcessBillToPartyMaster_ConfirmBOD_ST"
				if(UserTemplateRel exists)
					send ion bod
						bod is ProcessBillToPartyMasterConfirmBODXML
						bod type is "Confirm.BillToPartyMaster"
						accounting entity is LocalAccountingEntity
						document id is LocalDocumentID

