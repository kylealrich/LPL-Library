AssetPeriodClose is a BusinessTask
    owned by am

    Patterns
        implements ManualTransaction
        implements StaticJava
            Reports
                AssetPeriodCloseReport
                AssetPeriodCloseErrorReport
                AssetPeriodCloseNonPostingReport

    Parameters
    	FinanceEnterpriseGroup 
        Release                 is AlphaUpper size 1
            default label is "Update"
            States
                NoWithErrorReport  value is "N"
                YesNoErrorReport   value is "Y"
                YesWithErrorReport value is "R"
        Book
        	context of FinanceEnterpriseGroup
        BookGroup
        	context of FinanceEnterpriseGroup
        Company                 is an AssetCompany
        CompanyGroup            is a GeneralLedgerCompanyGroup
        Total                   is AlphaUpper size 1
            States
                SummarizeByAccount value is "S"
                SummarizeByAsset   value is "T"
                DetailByAccount    value is "D"
                DetailByAsset      value is "E"
        PostingDate             is Date

    Parameter Rules
        Release
        	initial value is "N"
            default to "N"
        Company
        	if (Company entered)
        		constraint (!Company.PeriodCloseRelease.No)
        			"ReleaseAssetsHasNotBeenRun"
        		constraint (CompanyGroup not entered)
        			"CompanyProvided;CompanyGroupMustBeBlank"
        	else 
        		constraint (CompanyGroup entered)
        			"CompanyOrCompanyGroupMustBeProvided"	
        CompanyGroup		
      	 	if (CompanyGroup entered)
        		for each CompanyGroup.GeneralLedgerCompanyGroupMembersRel
	       			Company = each.Company
		        		constraint (!Company.PeriodCloseRelease.No)
		        			"ReleaseAssetsHasNotBeenRunForCompany<Company>"
        		initialize Company	
        	
				        		   	 
        Total
        	initial value is "S"
            default to "S"

        PostingDate
            if (PostingDate entered 
            and Company entered)
                if (Book entered)
                    for each Company.BookCalendarsRel
                        if (each.Book = Book)
                            constraint (PostingDate > each.LastPeriodDate
                            and PostingDate <= each.CurrentPeriodDate)
                                "PostingDateMustBeInTheCurrentPeriodForBook<Book>Company<Company>"
                            end for each

                else
                    for each BookGroup.AmbgrpbookRel
                        Book = each.Book
                        for each Company.BookCalendarsRel
                            if (Book = each.Book)
                                constraint (PostingDate <= each.CurrentPeriodDate
                                and PostingDate > each.LastPeriodDate)
                                    "PostingDateMustBeInTheCurrentPeriodForBook<Book>Company<Company>"

            if (PostingDate entered
            and CompanyGroup entered)
                for each CompanyGroup.GeneralLedgerCompanyGroupMembersRel
	       			Company = each.Company
                    if (Book entered)
                        for each Company.BookCalendarsRel
                            if (each.Book = Book)
                                constraint (PostingDate > each.LastPeriodDate
                                and PostingDate <= each.CurrentPeriodDate)
                                    "PostingDateMustBeInTheCurrentPeriodForBook<Book>Company<Company>"
                                end for each

                    else
                        for each BookGroup.AmbgrpbookRel
                            Book = each.Book
                            for each Company.BookCalendarsRel
                                if (Book = each.Book)
                                    constraint (PostingDate <= each.CurrentPeriodDate
                                    and PostingDate > each.LastPeriodDate)
                                        "PostingDateMustBeInTheCurrentPeriodForBook<Book>Company<Company>"




                




    Actions
        AssetPeriodClose is a Set Action
            allow unlimited concurrency
