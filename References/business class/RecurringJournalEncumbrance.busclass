RecurringJournalEncumbrance is a BusinessClass
	owned by GeneralLedger
	prefix is RJENC
	
	Ontology
		symbolic key is RecurringJournalEncumbrance
		
	Patterns
	
	Persistent Fields
    	FinanceCodeBlock
		DimensionCode
        TransactionDate				is an ExchangeDate
		CurrencyCode				is a FromCurrency
		TransactionAmount			is a CurrencyAmount
			precision is CurrencyCode.NumberOfDecimals
		UnitsAmount
		PostingDate
		ReportCurrencyAmount		is a FinanceCurrencyAmount

	Transient Fields

	Local Fields

	Derived Fields
		DerivedTransactionLine	is a DerivedField
			type is Alpha 20

			if (RecuringTransaction)
				return RecurringJournalEncumbrance.SequenceNumber
			else
				if (RecuringBridgeFromAccount)
					return "From:"+RecurringJournalEncumbrance.SequenceNumber
				else
					if (RecuringBridgeToAccount)
						return "To:"+RecurringJournalEncumbrance.SequenceNumber

	Conditions
		RecuringBridgeFromAccount
			restricted
			when (RecurringJournalControl.RecuringBridgeExists
			and   RecurringJournalEncumbrance.IsAToCodeBlock	= 0)
		RecuringBridgeToAccount
			restricted
			when (RecurringJournalControl.RecuringBridgeExists
			and   RecurringJournalEncumbrance.IsAToCodeBlock	= 1)
		RecuringTransaction
			restricted
			when (!RecurringJournalControl.RecuringBridgeExists)

	Sets

	Relations
		GLCommitRel
			one-to-one relation to GLCommit
      		valid when (!action type.Create)
			Field Mapping uses ByOriginatingTransaction
				related.OriginatingTransaction  = reference to this instance

	Field Rules

	Rule Blocks
												
	Actions
 		Create is a Create Action
			restricted
			Exit Rules
				invoke CreateCommitment GLCommit
					invoked.HeaderUniqueID 					= RecurringJournalControl.UniqueID
					invoked.AccountingEntity				= AccountingEntity
					invoked.FinanceEnterpriseGroup			= FinanceEnterpriseGroup
					invoked.System							= "RJ"
					invoked.FinanceCodeBlock				= FinanceCodeBlock
					invoked.EntityYearPeriod				= GeneralLedgerClosePeriod.GeneralLedgerCalendarPeriod
					invoked.CurrencyCode					= CurrencyCode
					invoked.TransactionAmount				= TransactionAmount
					invoked.ReportCurrencyAmount			= ReportCurrencyAmount     
					invoked.TransactionDate					= PostingDate
					invoked.OriginatingTransaction			= reference to this instance
					invoked.DimensionCode					= DimensionCode
					invoked.TransBusinessObjectRef			= reference to RecurringJournalControl

    	Update is an Update Action
			restricted
			Exit Rules
				invoke MaintainUnreleasedCommitment GLCommitRel
					invoked.HeaderUniqueID 					= RecurringJournalControl.UniqueID
					invoked.AccountingEntity				= AccountingEntity
					invoked.FinanceEnterpriseGroup			= FinanceEnterpriseGroup
					invoked.System							= "RJ"
					invoked.FinanceCodeBlock				= FinanceCodeBlock
					invoked.EntityYearPeriod				= GeneralLedgerClosePeriod.GeneralLedgerCalendarPeriod
					invoked.CurrencyCode					= CurrencyCode
					invoked.TransactionAmount				= TransactionAmount
					invoked.ReportCurrencyAmount			= ReportCurrencyAmount     
					invoked.TransactionDate					= PostingDate
					invoked.OriginatingTransaction			= reference to this instance
					invoked.DimensionCode					= DimensionCode
					invoked.TransBusinessObjectRef			= reference to RecurringJournalControl

    	UpdateGLCommit is an Instance Action
			restricted
		    Parameters
				PrmUnprocess				is Boolean
					default label is "Unprocess"
			Action Rules
					if  (GLCommitRel exists
					and !PrmUnprocess)
						invoke UpdateReleasedCommitment GLCommitRel
							invoked.TransactionAmount												-= TransactionAmount
							invoked.ReportCurrencyAmount.FunctionalAmount.EnteredCurrencyAmount		-= ReportCurrencyAmount.FunctionalAmount.EnteredCurrencyAmount
							invoked.ReportCurrencyAmount.AlternateAmount.EnteredCurrencyAmount		-= ReportCurrencyAmount.AlternateAmount.EnteredCurrencyAmount
							invoked.ReportCurrencyAmount.AlternateAmount2.EnteredCurrencyAmount		-= ReportCurrencyAmount.AlternateAmount2.EnteredCurrencyAmount
							invoked.ReportCurrencyAmount.AlternateAmount3.EnteredCurrencyAmount		-= ReportCurrencyAmount.AlternateAmount3.EnteredCurrencyAmount
							invoked.ReportCurrencyAmount.ToFunctionalAmount.EnteredCurrencyAmount	-= ReportCurrencyAmount.ToFunctionalAmount.EnteredCurrencyAmount
							invoked.ReportCurrencyAmount.ToAlternateAmount.EnteredCurrencyAmount	-= ReportCurrencyAmount.ToAlternateAmount.EnteredCurrencyAmount
							invoked.ReportCurrencyAmount.ToAlternateAmount2.EnteredCurrencyAmount	-= ReportCurrencyAmount.ToAlternateAmount2.EnteredCurrencyAmount
							invoked.ReportCurrencyAmount.ToAlternateAmount3.EnteredCurrencyAmount	-= ReportCurrencyAmount.ToAlternateAmount3.EnteredCurrencyAmount
							invoked.ReportCurrencyAmount.ProjectAmount.EnteredCurrencyAmount		-= ReportCurrencyAmount.ProjectAmount.EnteredCurrencyAmount
							invoked.ReportCurrencyAmount.ReportAmount1.EnteredCurrencyAmount		-= ReportCurrencyAmount.ReportAmount1.EnteredCurrencyAmount
							invoked.ReportCurrencyAmount.ReportAmount2.EnteredCurrencyAmount		-= ReportCurrencyAmount.ReportAmount2.EnteredCurrencyAmount
							invoked.ReportCurrencyAmount.ReportAmount3.EnteredCurrencyAmount		-= ReportCurrencyAmount.ReportAmount3.EnteredCurrencyAmount
							invoked.ReportCurrencyAmount.ReportAmount4.EnteredCurrencyAmount		-= ReportCurrencyAmount.ReportAmount4.EnteredCurrencyAmount
							invoked.ReportCurrencyAmount.ReportAmount5.EnteredCurrencyAmount		-= ReportCurrencyAmount.ReportAmount5.EnteredCurrencyAmount

					if  (GLCommitRel exists
					and  PrmUnprocess)
						invoke ResetRJStatus GLCommitRel
							invoked.TransactionAmount												= TransactionAmount
							invoked.ReportCurrencyAmount.FunctionalAmount.EnteredCurrencyAmount		= ReportCurrencyAmount.FunctionalAmount.EnteredCurrencyAmount
							invoked.ReportCurrencyAmount.AlternateAmount.EnteredCurrencyAmount		= ReportCurrencyAmount.AlternateAmount.EnteredCurrencyAmount
							invoked.ReportCurrencyAmount.AlternateAmount2.EnteredCurrencyAmount		= ReportCurrencyAmount.AlternateAmount2.EnteredCurrencyAmount
							invoked.ReportCurrencyAmount.AlternateAmount3.EnteredCurrencyAmount		= ReportCurrencyAmount.AlternateAmount3.EnteredCurrencyAmount
							invoked.ReportCurrencyAmount.ToFunctionalAmount.EnteredCurrencyAmount	= ReportCurrencyAmount.ToFunctionalAmount.EnteredCurrencyAmount
							invoked.ReportCurrencyAmount.ToAlternateAmount.EnteredCurrencyAmount	= ReportCurrencyAmount.ToAlternateAmount.EnteredCurrencyAmount
							invoked.ReportCurrencyAmount.ToAlternateAmount2.EnteredCurrencyAmount	= ReportCurrencyAmount.ToAlternateAmount2.EnteredCurrencyAmount
							invoked.ReportCurrencyAmount.ToAlternateAmount3.EnteredCurrencyAmount	= ReportCurrencyAmount.ToAlternateAmount3.EnteredCurrencyAmount
							invoked.ReportCurrencyAmount.ProjectAmount.EnteredCurrencyAmount		= ReportCurrencyAmount.ProjectAmount.EnteredCurrencyAmount
							invoked.ReportCurrencyAmount.ReportAmount1.EnteredCurrencyAmount		= ReportCurrencyAmount.ReportAmount1.EnteredCurrencyAmount
							invoked.ReportCurrencyAmount.ReportAmount2.EnteredCurrencyAmount		= ReportCurrencyAmount.ReportAmount2.EnteredCurrencyAmount
							invoked.ReportCurrencyAmount.ReportAmount3.EnteredCurrencyAmount		= ReportCurrencyAmount.ReportAmount3.EnteredCurrencyAmount
							invoked.ReportCurrencyAmount.ReportAmount4.EnteredCurrencyAmount		= ReportCurrencyAmount.ReportAmount4.EnteredCurrencyAmount
							invoked.ReportCurrencyAmount.ReportAmount5.EnteredCurrencyAmount		= ReportCurrencyAmount.ReportAmount5.EnteredCurrencyAmount

		Purge is a Purge Action
			restricted
			Action Rules
				invoke Purge GLCommitRel
					invoked.PrmPurgeReleased		= true

	
