TrueCostRunParameterPeriod is a BusinessClass
	default label is "True\CostRunParameterPeriod"
	owned by truecost
	
	prefix is TCRPP
	
	Ontology
		symbolic key is TrueCostRunParameterPeriod
		
	Patterns
		implements DynamicCreation
	
	Persistent Fields
		SnapshotName				is like AllocationSnapshot
			default label is "ExpenseSnapshotName"
		AllocationPeriod			is a GeneralLedgerCalendarPeriod
		EndDate						is Date
		
	Local Fields
		LocalSnapshotName 			is like AllocationSnapshot
		
	Transient Fields
		TransientAllocationSourceSystem is a AllocationSourceSystem
			derive value from AllocationSourceSystem.TrueCost 
		
		TransientAllocationSnapshot	is a AllocationSnapshot
			default label is "ExpenseSnapshotName"
			derive value from SnapshotName 
			
	Derived Fields
	
	Relations
		AllocationSnapshotRel
			one-to-many relation to AllocationSnapshot
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup			= TrueCostConfiguration
				related.AllocationSourceSystem			= AllocationSourceSystem.TrueCost
			Instance Selection
				where (related.AllocationPeriod.DisplayPeriod	= AllocationPeriod.DisplayPeriod)

		RunParameterPeriodRel
			one-to-many relation to TrueCostRunParameterPeriod
			Field Mapping uses symbolic key
				related.TrueCostConfiguration			= TrueCostConfiguration
				related.TrueCostAllocationControl		= TrueCostAllocationControl
			Instance Selection
				where(related.SnapshotName				= SnapshotName)
	Field Rules
		SnapshotName
			if (TrueCostRunParameter.SourceBalanceOption.ExistingExpenseSnapshot)
				SnapshotName = TransientAllocationSnapshot
			if(action type.Update)
			    required
				    "ExpenseSnapshotNameIsRequired"
			if(TrueCostRunParameter.SourceBalanceOption.NewExpenseSnapshot)
				constraint (RunParameterPeriodRel not exists)
			    	"ExpenseSnapshotNameAlreadyExist"
		
	Actions
			
		Create is an Action
			restricted
					
			Action Rules
				if (TrueCostRunParameter.SourceBalanceOption.ExistingExpenseSnapshot)
					SnapshotName = TransientAllocationSnapshot
				
		Update is an Update Action
			Action Rules

				
		Delete is a Delete Action
			restricted
			
		Purge is a Purge Action
			restricted
				
		GenerateSnapshotName is an Instance Action
			restricted
			Parameters
				PrmTrueCostRunParameter		is Numeric 12
				PrmMonthPeriod				is AlphaUpper 12
				PrmSnapshotName				is AlphaUpper 60
				
			Action Rules
				TrueCostConfiguration		= TrueCostConfiguration
				TrueCostAllocationControl 	= TrueCostAllocationControl
				TrueCostRunParameter		= PrmTrueCostRunParameter
				SnapshotName				= PrmSnapshotName
		
