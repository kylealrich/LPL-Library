LoadInterfacedPurchaseOrders is a BusinessTask

	Parameters
		PrmFinanceEnterpriseGroup	is a FinanceEnterpriseGroup
			default label is "FinanceEnterpriseGroup"
		PrmHROrganization           is an HROrganization
			default label is "HROrganization"
		PrmRunGroup					is a RunGroup
			default label is "RunGroup"
		ProcessingOption            is Numeric 1
			States
				CSVFile				value is 1
				DatabaseFile        value is 2
		PrmCompany                  is a PurchasingCompany
			default label is "Company"
		DefaultBuyer                is a Buyer
			context of PrmHROrganization
		ReleasePurchaseOrders       is Boolean
		IncludePurchaseOrdersInError is Boolean
		PrmMoveErrorsToNewRunGroup  is Boolean
			default label is "MoveErrorsToNewRunGroup"
		PrmErrorRunGroupPrefix		is AlphaUpper 15
			default label is "ErrorRunGroupPrefix"
		PrmSpecificAction           is Numeric 1
			States
				Create              value is 1
				Update              value is 2
				Cancel              value is 3
		EnableGTINProcessing        is Boolean	

	Parameter Rules
		PrmFinanceEnterpriseGroup
			default to actor.context.FinanceEnterpriseGroup 
		PrmHROrganization
			default to actor.context.HROrganization
		PrmRunGroup
			required
				"RunGroupIsRequired"
		ProcessingOption
			required
				"ProcessingOptionIsRequired"
		ReleasePurchaseOrders
			initial value is true
		
	Actions
		LoadInterfacedPurchaseOrders is an Instance Action
			Action Rules
				if (ProcessingOption.CSVFile)
					invoke LoadInterfacedPurchaseOrders PurchaseOrderInterfaceInput
						invoked.PrmFinanceEnterpriseGroup		= PrmFinanceEnterpriseGroup
						invoked.PrmHROrganization				= PrmHROrganization           
						invoked.PrmRunGroup                     = PrmRunGroup
						invoked.PrmCompany                      = PrmCompany
						invoked.DefaultBuyer                    = DefaultBuyer
						invoked.ReleasePurchaseOrders           = ReleasePurchaseOrders
						invoked.PrmMoveErrorsToNewRunGroup      = PrmMoveErrorsToNewRunGroup  
						invoked.PrmErrorRunGroupPrefix          = PrmErrorRunGroupPrefix		
						invoked.PrmSpecificAction               = PrmSpecificAction
						invoked.EnableGTINProcessing            = EnableGTINProcessing	
						
				else
				if (ProcessingOption.DatabaseFile)
					invoke InterfacePurchaseOrders PurchaseOrderImport
						invoked.PrmFinanceEnterpriseGroup 		= PrmFinanceEnterpriseGroup 
						invoked.PrmHROrganization				= PrmHROrganization           
						invoked.PrmRunGroup                     = PrmRunGroup
						invoked.PrmCompany                      = PrmCompany
						invoked.DefaultBuyer                    = DefaultBuyer
						invoked.ReleasePurchaseOrders           = ReleasePurchaseOrders
						invoked.IncludePurchaseOrdersInError    = IncludePurchaseOrdersInError
						invoked.PrmMoveErrorsToNewRunGroup      = PrmMoveErrorsToNewRunGroup  
						invoked.PrmErrorRunGroupPrefix          = PrmErrorRunGroupPrefix		
						invoked.PrmSpecificAction               = PrmSpecificAction
						invoked.EnableGTINProcessing            = EnableGTINProcessing					
