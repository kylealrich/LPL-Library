TrueCostOperatingExpenses is a BusinessClass
	owned by truecost
	
	prefix is TCOE
	
	Ontology
		symbolic key is TrueCostOperatingExpenses
		
	Patterns
	
	Persistent Fields
		
		TrueCostConfiguration
		AccountingEntity					
		Chart									is a ReportingChart
		DepartmentStructure						is like AccountingUnitStructure
		Calendar								is a GeneralLedgerCalendar
		Period									is Date	
		OperatingExpenses						is Numeric 2
			States
				DirectDepartments				value is 1
				IndirectDepartments				value is 2
				AllocatedToCostObjects			value is 3
		ExpensesByResourceType					is Numeric 2
			States
				TotalLaborExpense				value is 4
				TotalSupplyExpense				value is 5
				TotalFacilityExpense			value is 6
				TotalEquipmentExpense			value is 7
				TotalProcessExpense				value is 8
				TotalExcludedOperatingExpense	value is 9		
		Amount									is a TotalAmount
		CalendarPeriod							is a GeneralLedgerCalendarPeriod
	Field Rules
	
	Derived Fields

		DerivedDirectDepartment is a DerivedField
			type is like TotalAmount
			if(TrueCostReportsandChartsRel.DirectDepartments < 0)
				return -1
			else
				return Amount
		DerivedIndirectDepartment is a DerivedField
			type is like TotalAmount
			if(TrueCostReportsandChartsRel.IndirectDepartments < 0)
				return -1
			else
				return Amount
				
		DerivedAllocatedToCostObject is a DerivedField
			type is like TotalAmount
			if(TrueCostReportsandChartsRel.AllocatedToCostObjects < 0)
				return -1
			else
				return Amount

		DerivedTotalLaborExpense is a DerivedField
			type is like TotalAmount
			if(TrueCostReportsandChartsRel.TotalLaborExpense < 0)
				return -1
			else
				return Amount
				
		DerivedTotalSupplyExpense is a DerivedField
			type is like TotalAmount
			if(TrueCostReportsandChartsRel.TotalSupplyExpense < 0)
				return -1
			else
				return Amount
		DerivedTotalFacilityExpense is a DerivedField
			type is like TotalAmount
			if(TrueCostReportsandChartsRel.TotalFacilityExpense < 0)
				return -1
			else
				return Amount
				
		DerivedTotalEquipmentExpense is a DerivedField
			type is like TotalAmount
			if(TrueCostReportsandChartsRel.TotalEquipmentExpense < 0)
				return -1
			else
				return Amount
		
		DerivedTotalProcessExpense is a DerivedField
			type is like TotalAmount
			if(TrueCostReportsandChartsRel.TotalProcessExpense < 0)
				return -1
			else
				return Amount
				
		DerivedTotalExcludedOperatingExpenses is a DerivedField
			type is like TotalAmount
			if(TrueCostReportsandChartsRel.TotalExcludedOperatingExpenses < 0)
				return -1
			else
				return Amount

		DerivedAmount is a ConditionalField
			type is like TotalAmount
			default label is "Amount"
			if(OperatingExpenses.IndirectDepartments)
				DerivedIndirectDepartment
			else
			if(OperatingExpenses.AllocatedToCostObjects)
				DerivedAllocatedToCostObject
			else
				-1
				
		DerivedOperatingExpensesChartsValues is a ConditionalField	
			type is like TotalAmount
			if(OperatingExpenses.IndirectDepartments)
				DerivedIndirectDepartment
			else
			if(OperatingExpenses.AllocatedToCostObjects)
				DerivedAllocatedToCostObject				
			else
				TrueCostReportsandChartsRel.DirectDepartments - TrueCostReportsandChartsRel.AllocatedToCostObjects
				
		DerivedExpenseByResourceType is a ConditionalField
			type is like TotalAmount
			if(ExpensesByResourceType.TotalLaborExpense)
				DerivedTotalLaborExpense
			else
			if(ExpensesByResourceType.TotalSupplyExpense)
				DerivedTotalSupplyExpense
			else
			if(ExpensesByResourceType.TotalFacilityExpense)
				DerivedTotalFacilityExpense
			else
			if(ExpensesByResourceType.TotalEquipmentExpense)
				DerivedTotalEquipmentExpense
			else
			if(ExpensesByResourceType.TotalProcessExpense)
				DerivedTotalProcessExpense
			else
			if(ExpensesByResourceType.TotalExcludedOperatingExpense)
				DerivedTotalExcludedOperatingExpenses
			else
				blank

		FilteredElementsAmount is a ConditionalField
			type is like TotalAmount
			if(TrueCostReportsandChartsRel.TotalOperatingExpense < 0)
				-100
			else
			if(TrueCostReportsandChartsRel.DirectDepartments = TrueCostReportsandChartsRel.AllocatedToCostObjects)
				DerivedAmount
			else
				DerivedOperatingExpensesChartsValues
				

		FilteredElementsLabel is a DerivedField
			type is Alpha 50
			if(TrueCostReportsandChartsRel.DirectDepartments = TrueCostReportsandChartsRel.AllocatedToCostObjects)
				return  "<IndirectDepartmentAndWithCostObject>"
			else
				return  "<OperatingExpensesChartLabel>"		
		
		OperatingExpensesChartLabel is a ConditionalField
			type is Alpha 50
			if(OperatingExpenses.DirectDepartments)
				"Direct Departments without Cost Objects"
			else
			if(OperatingExpenses.IndirectDepartments)
				"Indirect Departments"
			else
			if(OperatingExpenses.AllocatedToCostObjects)
				"Direct Departments Allocated to Cost Objects"
			else
				blank
		
		IndirectDepartmentAndWithCostObject is a ConditionalField
			type is Alpha 50
			if(OperatingExpenses.IndirectDepartments)
				"Indirect Departments"
			else
			if(OperatingExpenses.AllocatedToCostObjects)
				"Direct Departments Allocated to Cost Objects"
			else
				blank

		ExpensesByResourceTypeLabel is a ConditionalField
			type is Alpha 50
			if(ExpensesByResourceType.TotalLaborExpense)
				"Total Labor Expense"
			else
			if(ExpensesByResourceType.TotalSupplyExpense)
				"Total Supply Expense"
			else
			if(ExpensesByResourceType.TotalFacilityExpense)
				"Total Facility Expense"
			else
			if(ExpensesByResourceType.TotalEquipmentExpense)
				"Total Equipment Expense"
			else
			if(ExpensesByResourceType.TotalProcessExpense)
				"Total Process Expense"
			else
			if(ExpensesByResourceType.TotalExcludedOperatingExpense)
				"Total Excluded Operating Expenses"
			else
				blank

	Dimensions
		OperatingExpenses
		
		ExpensesByResourceType
	Measures
		OperatingExpenses
		Amount
	
	Relations
		TrueCostOperatingExpensesRel
			one-to-many relation to TrueCostOperatingExpenses
			Field Mapping uses symbolic key
			Instance Selection
				where(related.TrueCostConfiguration	=	TrueCostConfiguration
				and related.AccountingEntity		=	AccountingEntity
				and related.Chart					=	Chart
				and related.DepartmentStructure		=	DepartmentStructure
				and related.Calendar				=	Calendar
				and related.CalendarPeriod			=	CalendarPeriod)
				
		TrueCostReportsandChartsRel
			one-to-many relation to TrueCostReportsandCharts
			Field Mapping uses symbolic key
			Instance Selection
				where(related.TrueCostConfiguration							=	TrueCostConfiguration
				and related.TrueCostReportsandCharts.AccountingEntity		=	AccountingEntity
				and related.TrueCostReportsandCharts.Chart					=	Chart
				and related.TrueCostReportsandCharts.DepartmentStructure	=	DepartmentStructure
				and related.TrueCostReportsandCharts.Calendar				=	Calendar
				and related.TrueCostReportsandCharts.CalendarPeriod			=	CalendarPeriod)
	Actions
		Create is a Create Action
			restricted
			Entrance Rules

			Action Rules
				
		Update is an Update Action
			restricted
			Action Rules
			
		Delete is a Delete Action	
			restricted
		Purge is a Purge Action
			restricted
			
		
