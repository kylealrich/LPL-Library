AssetBookReinstatement is a BusinessClass
    owned by am
    prefix is RIB
    classic name is AMASTBKRIN

    Ontology
        symbolic key is AssetBookReinstatement
            classic set name is RIBSET1

    Patterns
        implements StaticJava
        disable AuditIndex

    Persistent Fields

        CostOfSale                     is an InternationalAmount
            classic name is BOOK-COST-SALE
        CostOfSaleOverride             is an InternationalAmount
            classic name is CST-SALE-OVRRD
        Proceeds                       is an InternationalAmount
            classic name is BOOK-PROCEEDS
        ProceedsOverride               is an InternationalAmount
            classic name is PROCEEDS-OVRRD
        GainOrLoss                     is an InternationalAmount
            classic name is GAIN-LOSS
        GainOrLossOverride             is an InternationalAmount
            classic name is GN-LS-OVERRIDE
        DeferredGainOrLoss             is an InternationalAmount
            classic name is DEFER-GN-LS
        DeferredGainOrLossOverride     is an InternationalAmount
            classic name is DEFER-OVERRIDE
        TaxCreditRecapture             is an InternationalAmount
            classic name is TC-RECAPTURE
        TaxCreditRecaptureOverride     is an InternationalAmount
            classic name is TC-OVERRIDE
        Basis                          is an InternationalAmount
            classic name is BOOK-BASIS
        TransactionNumberOfDecimals    is a CurrencyNumberOfDecimals
            classic name is TRAN-ND
        DepreciationExpense            is an InternationalAmount
            classic name is DSP-DEPR
        DepreciationExpenseOverride    is an InternationalAmount
            classic name is DSP-DEPR-OVRRD
        YearToDateDepreciation         is an InternationalAmount
            classic name is DEPR-YTD
        YearToDateDepreciationAllowed  is an InternationalAmount
            classic name is DEPR-YTD-ALLOW
        YearToDateDepreciationOverride is an InternationalAmount
            classic name is DEPR-YTD-OVRRD
        LifeToDateDepreciation         is an InternationalAmount
            classic name is DEPR-LTD
        LifeToDateDepreciationAllowed  is an InternationalAmount
            classic name is DEPR-LTD-ALLOW
        SalvageValue                   is an InternationalAmount
        FirstYearExpenseAmount         is an InternationalAmount
            classic name is YR1-EXP
        TaxCreditPropertyAmount        is an InternationalAmount
            classic name is TC-PROPERTY
        TaxCredit                      is an InternationalAmount
        ActualInsuranceValue           is an InternationalAmount
            classic name is INS-ACT-VAL
        CalculatedInsuranceValue       is an InternationalAmount
            classic name is INS-CMPTD-VAL
        CalculatedReplacementValue     is an InternationalAmount
            classic name is RPL-CMPTD-VAL
        NewAssetBasis                  is an InternationalAmount
            classic name is NEW-AST-BASIS
        CashPaid                       is an InternationalAmount
        OldAssetAdjustedBasis          is an InternationalAmount
            classic name is OLD-AST-ADJ-BS
        AmountRealized                 is an InternationalAmount
            classic name is AMT-REALIZED
        AmountGivenUp                  is an InternationalAmount
        	default label is "ForgoneDepreciation"
            classic name is AMT-GIVEN-UP
        NewAssetAdjustedBasis          is an InternationalAmount
            classic name is NEW-AST-ADJ-BS
        NewAsset                       is an Asset
        CreatedBy                      is an Operator 
        	holds pii
            classic name is CREATOR-ID
        ReinstatementDate              is Date
            classic name is REINSTATE-DATE

	Transient Fields
		TransientFromCurrency						is a FromCurrency
			derive value from PostingCurrency
			
	Local Fields		
		LocalBook						is like Book
		LocalAsset						is like Asset
		LocalFinanceEnterpriseGroup		is like FinanceEnterpriseGroup
				
    Derived Fields
		PostingCurrency is a DerivedField
			type is like FromCurrency
			if (Book.PostCurrency.Book)
				return Book.Currency
			else 
				return Asset.Currency	
        DisposedAsset                     is a StringField
            type is Alpha size 10
            restricted
            classic name is AST-DSP-ASSET
            Asset.DisposedAsset

        AssetReinstatementAssetGroup      is a StringField
            type is Alpha size 10
            restricted
            classic name is AST-ASSET-GRP
            Asset.AssetGroup

        AssetTagNumber                    is a StringField
            type is Alpha size 12
            restricted
            classic name is AST-TAG-NBR
            Asset.TagNumber

        AssetDescription                  is a StringField
            type is Alpha size 30
            restricted
            classic name is AST-DESCRIP
            Asset.Description

        AssetDisposalDate                 is a StringField
            type is Alpha size 8
            restricted
            classic name is ASD-DSP-DATE
            AmassetrinRel.DisposalDate

        AssetDisposalFullOrPartial        is a StringField
            type is Alpha size 1
            restricted
            classic name is ASD-FULL-PART
            AmassetrinRel.FullOrPartial

        AssetDisposalMethod               is a StringField
            type is Alpha size 1
            restricted
            classic name is ASD-DSP-METH
            AmassetrinRel.DisposalMethod

        AssetDisposalDisposalProperty     is a StringField
            type is Alpha size 10
            restricted
            classic name is ASD-DSP-PROP
            AmassetrinRel.DisposalProperty

        BookCurrency                      is a StringField
            type is Alpha size 5
            restricted
            Book.Currency

        AssetDisposalCreateDate           is a StringField
            type is Alpha size 8
            restricted
            classic name is DSP-CREAT-DATE
            AmassetrinRel.AssetReinstatement.CreationDate

        AssetDisposalCreateTime           is a StringField
            type is Alpha size 6
            restricted
            classic name is DSP-CREAT-TIME
            AmassetrinRel.AssetReinstatement.CreationDate time

        AssetDisposalCreatedBy            is a StringField
            type is Alpha size 10
            restricted
            classic name is DSP-CREATOR-ID
            AmassetrinRel.CreatedBy

        AssetBookDisposalBookDescription  is a StringField
            type is Alpha size 30
            restricted
            classic name is AMB-DESC
            Book.Description

        AssetBookBasis                    is a StringField
            type is Alpha size 15
            restricted
            classic name is ASB-BOOK-BASIS
            AmastbookRel.Basis

        AssetBookMethod                   is a StringField
            type is Alpha size 10
            restricted
            classic name is ASB-METHOD
            AmastbookRel.Method

        AssetBookLife                     is a StringField
            type is Alpha size 4
            restricted
            classic name is ASB-LIFE
            AmastbookRel.Life

        AssetBookLifeRemaining            is a StringField
            type is Alpha size 7
            restricted
            classic name is ASB-LIFE-REM
            AmastbookRel.LifeRemaining

        AssetBookInServiceDate            is a StringField
            type is Alpha size 8
            restricted
            classic name is ASB-INSRV-DATE
            AmastbookRel.InServiceDate

        AssetBookConvention               is a StringField
            type is Alpha size 2
            restricted
            classic name is ASB-CONVENTION
            AmastbookRel.Convention














































        LifeToDateDepreciationCalculation is a DerivedField							
            type is like InternationalAmount
            restricted
            classic name is CALC-DEPR-LTD
            return (LifeToDateDepreciation + DepreciationExpenseOverride)

        ReinstatementLifeToDateDepreciation is a DerivedField							
            type is like InternationalAmount
            restricted
            display "ABR_LTDDep<LifeToDateDepreciation>"
            display "ABR_DepExpOVRRD<DepreciationExpenseOverride>"
            return (LifeToDateDepreciation - DepreciationExpense)

        ReinstatementYearToDateDepreciation is a DerivedField							
            type is like InternationalAmount
            restricted
            display "ABR_YTDDep<YearToDateDepreciation>"
            display "ABR_DepExpOVRRD<DepreciationExpenseOverride>"
            return (YearToDateDepreciation - DepreciationExpense)
            
        DisposalNetValue                  is a DerivedField						
            type is like InternationalAmount
            restricted
            classic name is DSP-NET-VALUE
            return (AmastbookRel.Basis - LifeToDateDepreciationCalculation)

        AssetLocation                     is a StringField
            type is Alpha size 15
            restricted
            classic name is AST-LOCATION
            Asset.AssetLocation

        AssetDivision                     is a StringField
            type is Alpha size 15
            restricted
            classic name is AST-DIVISION
            Asset.AssetDivision

        AssetType                         is a StringField
            type is Alpha size 10
            restricted
            classic name is AST-TYPE
            Asset.AssetType.Type

        AssetSubtype                      is a StringField
            type is Alpha size 10
            restricted
            classic name is AST-SUBTYPE
            Asset.AssetType.SubType

    Conditions

        CostOfSaleOverriden
        	restricted
            when (CostOfSale != CostOfSaleOverride)

        DeferredGainOrLossOverriden
        	restricted
            when (DeferredGainOrLoss != DeferredGainOrLossOverride)

        Disposed
        	restricted
            when (Asset entered)

        DepreciationExpenseOverriden
        	restricted
            when (DepreciationExpense != DepreciationExpenseOverride)

        IsALikeKindExchange
        	restricted
            when (DeferredGainOrLoss entered
            or    DeferredGainOrLossOverride entered)

        ProceedOverriden
        	restricted
            when (Proceeds != ProceedsOverride)

        TaxCreditRecaptureOverriden
        	restricted
            when (TaxCreditRecapture != TaxCreditRecaptureOverride)

    Relations

        AmassetrinRel
            one-to-one relation to AssetReinstatement
            Field Mapping uses symbolic key
            	related.FinanceEnterpriseGroup			= Asset.FinanceEnterpriseGroup
                related.Asset                           = Asset
                related.AssetReinstatement.CreationDate = AssetBookReinstatement.CreationDate

        AmastbookRel
            one-to-one relation to AssetBook
            Field Mapping uses symbolic key
            	related.FinanceEnterpriseGroup	= Asset.FinanceEnterpriseGroup
                related.Asset 					= Asset
                related.Book  					= Book

        AmasttypeRel
            one-to-one relation to AssetType
            Field Mapping uses symbolic key
                related.Company           = Asset.Company
                related.AssetType.Type    = Asset.AssetType.Type
                related.AssetType.SubType = Asset.AssetType.SubType

        AmdivisionRel
            one-to-one relation to AssetDivision
            Field Mapping uses symbolic key
            	related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup 
                related.AssetDivision 			= Asset.AssetDivision

        AmlocationRel
            one-to-one relation to AssetLocation
            Field Mapping uses symbolic key
                related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
                related.AssetLocation 			= Asset.AssetLocation
                

		AssetBookPurgeRel
			one-to-many relation to AssetBook
			Field Mapping uses Set2
				related.FinanceEnterpriseGroup		= LocalFinanceEnterpriseGroup
		      	related.Book						= LocalBook
		    Instance Selection
		    	include deleted records

    Sets

        Set2
            indexed
            Sort Order
                Book
                Asset
                AssetBookReinstatement

        Set3
            indexed
            Sort Order
                Asset
                ReinstatementDate
                Book
                AssetBookReinstatement

	Actions
		Create is a Create Action

		Update is an Update Action

		Delete is a Delete Action

		Purge is a Purge Action
			restricted
			
		AssetBookReinstatementPurge is a Set Action
			restricted
			Parameters
				PrmFinanceEnterpriseGroup		is a FinanceEnterpriseGroup
				PrmAsset						is like Asset
				PrmBook							is like Book
				PrmPurgeOption					is Numeric 1
					default label is "ActionOption"
					States
						PurgeRecords 	value is 1
						ReportOnly		value is 2
		        PrmCompany                 		is like Company
		        
			Parameter Rules
				PrmFinanceEnterpriseGroup
					LocalFinanceEnterpriseGroup 		= PrmFinanceEnterpriseGroup
				PrmBook
					LocalBook 							= PrmBook
				PrmAsset
					LocalAsset 							= PrmAsset
			Local Fields
				LocalCounter					is Numeric 10
			Instance Selection
				include deleted records
				where (FinanceEnterpriseGroup			= PrmFinanceEnterpriseGroup
				and	   Book								= PrmBook
				and    Asset.Company					= PrmCompany											
				and   (PrmAsset not entered 	
				or     Asset		            		= PrmAsset))
				
				
			Action Rules
				Set Rules
					Exit Rules

				Instance Rules

					if(PrmPurgeOption.PurgeRecords)
						invoke Purge
						
