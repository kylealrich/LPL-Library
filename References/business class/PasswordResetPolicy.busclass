PasswordResetPolicy is a BusinessClass
    owned by security
    prefix is PWRP
    stored in environment
	contains environment data
	disable data area copy
		preserve target data

    Ontology
        symbolic key is PasswordResetPolicy

    Patterns
        implements CRUD
        implements SecurityCache
        disable AuditIndex

    Persistent Fields
        Description is a LSDescription
        IsPasswordResetEnabled is Boolean
			default label is "PasswordResetByEmailEnabled"
        SecurityQuestionnaire
		SecurityEmailTemplate
		NumberOfLastPasswordsToNotReuse is Integer size 4
		PasswordResetInterval is Integer size 4
		
	Relations
		PRPServiceRel is a Service set
			Instance Selection
				where (related.PasswordResetPolicy = PasswordResetPolicy)
				
	Field Rules
		IsPasswordResetEnabled
			default to true
    Rule Blocks
		PasswordResetValidation
			constraint (IsPasswordResetEnabled or SecurityQuestionnaire.IsSecurityQuestionnaireEnabled)
				"MustSelectEitherPasswordResetByEmailOrSecurityQuestionnaireEnabledOrBoth"

   	
    Actions
        Create is a Create Action
			Entrance Rules
				include PasswordResetValidation					
        Delete is a Delete Action

        Update is an Update Action
			Entrance Rules
				include PasswordResetValidation		
        ViewFullSummary is an Update Action

