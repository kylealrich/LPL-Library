InterfaceMatchInvoices is a BusinessTask

	Parameters
		PrmFinanceEnterpriseGroup   is a FinanceEnterpriseGroup
		PrmRunGroup					is a RunGroup
			default label is "RunGroup"
		ProcessingOption            is Numeric 1
			States
				CSVFile				value is 1
					default label is "EDIInterface"
				DatabaseFile        value is 2
					default label is "MatchInterface"
		PrmCompany					is a PayablesCompany
		PrmVendorGroup				is a VendorGroup	
		PrmVendor					is a Vendor
			context of PrmVendorGroup	
		PrmProcessLevel				is a PayablesProcessLevel
		PrmAuthorityCode			is a PayablesAuthorityCode
			context of PrmVendorGroup	
        InvoiceProcess          	is AlphaUpper size 1
            States
                Add         value is "A"
                AddAndMatch value is "M"
		MatchPoint					is Numeric 1
			States
				RuleGroupOne		value is 1
				RuleGroupTwo		value is 2
				RuleGroupThree		value is 3
		DefaultProcessLevel			is a PayablesProcessLevel
		DefaultAuthorityCode		is a PayablesAuthorityCode
			context of PrmVendorGroup	
		AllowMatchItemOrVendorItem	is Boolean
		    default label is "AllowMatchOnEitherItemOrVendorItem"
		EnableGLNProcessing			is Boolean
		EnableGTINProcessing		is Boolean
		IncludeInvoicesInError		is Boolean
		MoveErrorsToNewRunGroup  	is Boolean
			default label is "MoveErrorsToNewRunGroup"
		PrmErrorRunGroupPrefix		is AlphaUpper 15
			default label is "ErrorRunGroupPrefix"
		RemoveExistingMatchInterfaceInvoices is Boolean
		AutoCreateDetails				is Numeric 1
			States
 				FromPurchaseOrder		value is 2
 				FromReceipt				value is 3
				FromReceiptThenFromPO 	value is 4

	Parameter Rules
		PrmFinanceEnterpriseGroup
			required
			initial value is actor.context.FinanceEnterpriseGroup
		PrmRunGroup
			required
				"RunGroupIsRequired"
		ProcessingOption
			required
				"ProcessingOptionIsRequired"
			initial value is 2
			default to 2
		PrmCompany
			if (!PrmVendorGroup entered)		
				PrmVendorGroup = PrmCompany.PayablesCompany.VendorGroup
			if (PrmProcessLevel entered)
				required
					"CompanyRequiredWhenProcessLevelIsEntered"
		PrmVendorGroup		
			if (PrmVendor entered)
				required
					"VendorGroupRequiredWhenVendorIsEnteredWithoutCompany"
			if (PrmAuthorityCode entered)
				required
					"VendorGroupRequiredWhenAuthorityCodeIsEnteredWithoutCompany"
			constraint (!PrmCompany entered or PrmCompany.PayablesCompany.VendorGroup = PrmVendorGroup)
				"VendorGroupDifferentFromEnteredCompanyVendorGroup<PrmCompany.PayablesCompany.VendorGroup>"
        InvoiceProcess
        	required
        	initial value is "A"
        MatchPoint
        	default to 1
        	initial value is 1
		
	Actions
		InterfaceMatchInvoices is an Instance Action
		    run in background
			default label is "InterfaceInvoices"
			Action Rules
				if (ProcessingOption.CSVFile)
					invoke InterfaceInvoices EDIInvoiceMatchInterfaceInput
						invoked.PrmRunGroup					= PrmRunGroup
						invoked.PrmCompany					= PrmCompany
						invoked.PrmVendorGroup				= PrmVendorGroup		
						invoked.PrmVendor					= PrmVendor
				        invoked.InvoiceProcess				= InvoiceProcess
						invoked.MatchPoint					= MatchPoint
						invoked.AllowMatchItemOrVendorItem	= AllowMatchItemOrVendorItem
						invoked.MoveErrorsToNewRunGroup		= MoveErrorsToNewRunGroup
						invoked.PrmErrorRunGroupPrefix		= PrmErrorRunGroupPrefix
						invoked.DefaultProcessLevel			= DefaultProcessLevel
						invoked.DefaultAuthorityCode		= DefaultAuthorityCode
						invoked.EnableGLNProcessing			= EnableGLNProcessing
						invoked.EnableGTINProcessing		= EnableGTINProcessing
						invoked.RemoveExistingMatchInterfaceInvoices	= RemoveExistingMatchInterfaceInvoices
						invoked.CreateDetails				= AutoCreateDetails
				else
				if (ProcessingOption.DatabaseFile)
					invoke InterfaceInvoices MatchInvoiceImport
						invoked.PrmFinanceEnterpriseGroup	= PrmFinanceEnterpriseGroup
						invoked.PrmRunGroup					= PrmRunGroup
						invoked.PrmCompany					= PrmCompany
						invoked.PrmVendorGroup				= PrmVendorGroup	
						invoked.PrmVendor					= PrmVendor
						invoked.PrmProcessLevel				= PrmProcessLevel
						invoked.PrmAuthorityCode			= PrmAuthorityCode
						invoked.IncludeInvoicesInError		= IncludeInvoicesInError
				        invoked.InvoiceProcess				= InvoiceProcess
						invoked.MatchPoint					= MatchPoint
						invoked.AllowMatchItemOrVendorItem	= AllowMatchItemOrVendorItem
						invoked.MoveErrorsToNewRunGroup		= MoveErrorsToNewRunGroup
						invoked.PrmErrorRunGroupPrefix		= PrmErrorRunGroupPrefix
						invoked.DefaultProcessLevel			= DefaultProcessLevel
						invoked.DefaultAuthorityCode		= DefaultAuthorityCode
						invoked.AutoCreateDetails			= AutoCreateDetails
