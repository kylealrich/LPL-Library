DEPMDimensionMap is a BusinessClass
	owned by GeneralLedger
	prefix is DEPM
   
    Ontology
    	symbolic key is DEPMDimensionMap
    	
	Patterns
		implements AnalyticCube
			disable continuous update
			dynamically calculate totals
			write to base level only 
    	
    Persistent Fields
    	AccountingEntity	is a DEPMDimension
    	AccountingUnit		is a DEPMDimension	
    	Account				is a DEPMDimension
    	Project				is a DEPMDimension
    	Dimension1			is a DEPMDimension
    	Dimension2			is a DEPMDimension
     	Dimension3			is a DEPMDimension
    	Dimension4			is a DEPMDimension
     	Dimension5			is a DEPMDimension
    	Dimension6			is a DEPMDimension
     	Dimension7			is a DEPMDimension
    	Dimension8			is a DEPMDimension
     	Dimension9			is a DEPMDimension
    	Dimension10			is a DEPMDimension
    	
    	Basis				is a ReportingBasis
    
    Transient Fields

	Dimensions
		DEPMDimensionMap
			Attributes
				AccountingEntity
				AccountingUnit
				Account     
				Project
				Dimension1
				Dimension2
				Dimension3
 				Dimension4
				Dimension5
				Dimension6
				Dimension7
				Dimension8
				Dimension9
				Dimension10
				Basis
            
	Measures
		MeasureAmt        

	Field Groups
		FieldsForCubeRefresh
			AccountingEntity
			AccountingUnit
			Account     
			Project
			Dimension1
			Dimension2
			Dimension3
			Dimension4
			Dimension5
			Dimension6
			Dimension7
			Dimension8
			Dimension9
			Dimension10
			Basis
						
	Local Fields
		LocalDimension		is a DEPMDimension
	
	Derived Fields
		MeasureAmt              is a DerivedField
			type is Numeric 1
			restricted
			return blank
				
	Conditions
		HasBudgetScenarios
			restricted
			when (BudgetScenariosRel exists)
		AccountingUnitSelected
			restricted
			when (AccountingUnit entered)
		ProjectSelected
			restricted
			when (Project entered)
		Dimension1Selected
			restricted
			when (Dimension1 entered)
		Dimension2Selected
			restricted
			when (Dimension2 entered)
		Dimension3Selected
			restricted
			when (Dimension3 entered)
		Dimension4Selected
			restricted
			when (Dimension4 entered)
		Dimension5Selected
			restricted
			when (Dimension5 entered)
		Dimension6Selected
			restricted
			when (Dimension6 entered)
		Dimension7Selected
			restricted
			when (Dimension7 entered)
		Dimension8Selected
			restricted
			when (Dimension8 entered)
		Dimension9Selected
			restricted
			when (Dimension9 entered)
		Dimension10Selected
			restricted
			when (Dimension10 entered)

	Relations
		BudgetScenariosRel 
			one-to-many relation to Scenario
				Field Mapping uses symbolic key
					related.FinanceEnterpriseGroup = DEPMDimensionMap
				Instance Selection
					where (related.IsDEPMBudget)
 		CubeRel
			one-to-one relation to AnalyticCube
			Field Mapping uses AnalyticCubeSet
				related.BusinessClass = "DEPMDimensionMap"
 
	Sets

	Rule Blocks

	Field Rules
		Basis
			constraint (Basis.IsABudgetBasis)
				"BasisMustBeABudgetBasis"
			if (HasBudgetScenarios
			and old Basis entered)
				cannot be changed
					"CannotChange.EPMBudgetScenariosExist"
    	AccountingEntity
    		initial value is DEPMDimension.BPDENTITY
    		AccountingEntity = DEPMDimension.BPDENTITY
    	AccountingUnit
    		LocalDimension = AccountingUnit
			constraint (LocalDimension ! = DEPMDimension.BPDENTITY)
				"EntityDimensionIsReserved"
			constraint (LocalDimension ! = DEPMDimension.BPDACCOUNT)
				"AccountDimensionIsReserved"
			constraint (LocalDimension != AccountingEntity
			and LocalDimension != Project
			and LocalDimension != Dimension1
			and LocalDimension != Dimension2
			and LocalDimension != Dimension3
			and LocalDimension != Dimension4
			and LocalDimension != Dimension5
			and LocalDimension != Dimension6
			and LocalDimension != Dimension7
			and LocalDimension != Dimension8
			and LocalDimension != Dimension9
			and LocalDimension != Dimension10)
				"DimensionIsAlreadyMapped"
    	Account	
    		initial value is DEPMDimension.BPDACCOUNT
    		Account = DEPMDimension.BPDACCOUNT
    	Project	
    		LocalDimension = Project
			constraint (LocalDimension ! = DEPMDimension.BPDENTITY)
				"EntityDimensionIsReserved"
			constraint (LocalDimension ! = DEPMDimension.BPDACCOUNT)
				"AccountDimensionIsReserved"
			constraint (LocalDimension != AccountingEntity
			and LocalDimension != AccountingUnit
			and LocalDimension != Dimension1
			and LocalDimension != Dimension2
			and LocalDimension != Dimension3
			and LocalDimension != Dimension4
			and LocalDimension != Dimension5
			and LocalDimension != Dimension6
			and LocalDimension != Dimension7
			and LocalDimension != Dimension8
			and LocalDimension != Dimension9
			and LocalDimension != Dimension10)
				"DimensionIsAlreadyMapped"
    	Dimension1
    		LocalDimension = Dimension1
			constraint (LocalDimension ! = DEPMDimension.BPDENTITY)
				"EntityDimensionIsReserved"
			constraint (LocalDimension ! = DEPMDimension.BPDACCOUNT)
				"AccountDimensionIsReserved"
			constraint (LocalDimension != AccountingEntity
			and LocalDimension != AccountingUnit
			and LocalDimension != Project
			and LocalDimension != Dimension2
			and LocalDimension != Dimension3
			and LocalDimension != Dimension4
			and LocalDimension != Dimension5
			and LocalDimension != Dimension6
			and LocalDimension != Dimension7
			and LocalDimension != Dimension8
			and LocalDimension != Dimension9
			and LocalDimension != Dimension10)
				"DimensionIsAlreadyMapped"
    	Dimension2
    		LocalDimension = Dimension2
			constraint (LocalDimension ! = DEPMDimension.BPDENTITY)
				"EntityDimensionIsReserved"
			constraint (LocalDimension ! = DEPMDimension.BPDACCOUNT)
				"AccountDimensionIsReserved"
			constraint (LocalDimension != AccountingEntity
			and LocalDimension != AccountingUnit
			and LocalDimension != Project
			and LocalDimension != Dimension1
			and LocalDimension != Dimension3
			and LocalDimension != Dimension4
			and LocalDimension != Dimension5
			and LocalDimension != Dimension6
			and LocalDimension != Dimension7
			and LocalDimension != Dimension8
			and LocalDimension != Dimension9
			and LocalDimension != Dimension10)
				"DimensionIsAlreadyMapped"
     	Dimension3
     		LocalDimension = Dimension3
			constraint (LocalDimension ! = DEPMDimension.BPDENTITY)
				"EntityDimensionIsReserved"
			constraint (LocalDimension ! = DEPMDimension.BPDACCOUNT)
				"AccountDimensionIsReserved"
			constraint (LocalDimension != AccountingEntity
			and LocalDimension != AccountingUnit
			and LocalDimension != Project
			and LocalDimension != Dimension1
			and LocalDimension != Dimension2
			and LocalDimension != Dimension4
			and LocalDimension != Dimension5
			and LocalDimension != Dimension6
			and LocalDimension != Dimension7
			and LocalDimension != Dimension8
			and LocalDimension != Dimension9
			and LocalDimension != Dimension10)
				"DimensionIsAlreadyMapped"
    	Dimension4
    		LocalDimension = Dimension4
			constraint (LocalDimension ! = DEPMDimension.BPDENTITY)
				"EntityDimensionIsReserved"
			constraint (LocalDimension ! = DEPMDimension.BPDACCOUNT)
				"AccountDimensionIsReserved"
 			constraint (LocalDimension != AccountingEntity
			and LocalDimension != AccountingUnit
			and LocalDimension != Project
			and LocalDimension != Dimension1
			and LocalDimension != Dimension2
			and LocalDimension != Dimension3
			and LocalDimension != Dimension5
			and LocalDimension != Dimension6
			and LocalDimension != Dimension7
			and LocalDimension != Dimension8
			and LocalDimension != Dimension9
			and LocalDimension != Dimension10)
				"DimensionIsAlreadyMapped"
     	Dimension5
     		LocalDimension = Dimension5
			constraint (LocalDimension ! = DEPMDimension.BPDENTITY)
				"EntityDimensionIsReserved"
			constraint (LocalDimension ! = DEPMDimension.BPDACCOUNT)
				"AccountDimensionIsReserved"
			constraint (LocalDimension != AccountingEntity
			and LocalDimension != AccountingUnit
			and LocalDimension != Project
			and LocalDimension != Dimension1
			and LocalDimension != Dimension2
			and LocalDimension != Dimension3
			and LocalDimension != Dimension4
			and LocalDimension != Dimension6
			and LocalDimension != Dimension7
			and LocalDimension != Dimension8
			and LocalDimension != Dimension9
			and LocalDimension != Dimension10)
				"DimensionIsAlreadyMapped"
     	Dimension6
    		LocalDimension = Dimension6
			constraint (LocalDimension ! = DEPMDimension.BPDENTITY)
				"EntityDimensionIsReserved"
			constraint (LocalDimension ! = DEPMDimension.BPDACCOUNT)
				"AccountDimensionIsReserved"
			constraint (LocalDimension != AccountingEntity
			and LocalDimension != AccountingUnit
			and LocalDimension != Project
			and LocalDimension != Dimension1
			and LocalDimension != Dimension2
			and LocalDimension != Dimension3
			and LocalDimension != Dimension4
			and LocalDimension != Dimension5
			and LocalDimension != Dimension7
			and LocalDimension != Dimension8
			and LocalDimension != Dimension9
			and LocalDimension != Dimension10)
				"DimensionIsAlreadyMapped"
     	Dimension7
     		LocalDimension = Dimension7
			constraint (LocalDimension ! = DEPMDimension.BPDENTITY)
				"EntityDimensionIsReserved"
			constraint (LocalDimension ! = DEPMDimension.BPDACCOUNT)
				"AccountDimensionIsReserved"
			constraint (LocalDimension != AccountingEntity
			and LocalDimension != AccountingUnit
			and LocalDimension != Project
			and LocalDimension != Dimension1
			and LocalDimension != Dimension2
			and LocalDimension != Dimension3
			and LocalDimension != Dimension4
			and LocalDimension != Dimension5
			and LocalDimension != Dimension6
			and LocalDimension != Dimension8
			and LocalDimension != Dimension9
			and LocalDimension != Dimension10)
				"DimensionIsAlreadyMapped"
    	Dimension8
    		LocalDimension = Dimension8
			constraint (LocalDimension ! = DEPMDimension.BPDENTITY)
				"EntityDimensionIsReserved"
			constraint (LocalDimension ! = DEPMDimension.BPDACCOUNT)
				"AccountDimensionIsReserved"
			constraint (LocalDimension != AccountingEntity
			and LocalDimension != AccountingUnit
			and LocalDimension != Project
			and LocalDimension != Dimension1
			and LocalDimension != Dimension2
			and LocalDimension != Dimension3
			and LocalDimension != Dimension4
			and LocalDimension != Dimension5
			and LocalDimension != Dimension6
			and LocalDimension != Dimension7
			and LocalDimension != Dimension9
			and LocalDimension != Dimension10)
				"DimensionIsAlreadyMapped"
     	Dimension9
     		LocalDimension = Dimension9
			constraint (LocalDimension ! = DEPMDimension.BPDENTITY)
				"EntityDimensionIsReserved"
			constraint (LocalDimension ! = DEPMDimension.BPDACCOUNT)
				"AccountDimensionIsReserved"
			constraint (LocalDimension != AccountingEntity
			and LocalDimension != AccountingUnit
			and LocalDimension != Project
			and LocalDimension != Dimension1
			and LocalDimension != Dimension2
			and LocalDimension != Dimension3
			and LocalDimension != Dimension4
			and LocalDimension != Dimension5
			and LocalDimension != Dimension6
			and LocalDimension != Dimension7
			and LocalDimension != Dimension8
			and LocalDimension != Dimension10)
				"DimensionIsAlreadyMapped"
    	Dimension10
    		LocalDimension = Dimension10
			constraint (LocalDimension ! = DEPMDimension.BPDENTITY)
				"EntityDimensionIsReserved"
			constraint (LocalDimension ! = DEPMDimension.BPDACCOUNT)
				"AccountDimensionIsReserved"
			constraint (LocalDimension != AccountingEntity
			and LocalDimension != AccountingUnit
			and LocalDimension != Project
			and LocalDimension != Dimension1
			and LocalDimension != Dimension2
			and LocalDimension != Dimension3
			and LocalDimension != Dimension4
			and LocalDimension != Dimension5
			and LocalDimension != Dimension6
			and LocalDimension != Dimension7
			and LocalDimension != Dimension8
			and LocalDimension != Dimension9)
				"DimensionIsAlreadyMapped"

	Attach Rules
		
    Actions
	
    	Create is an Action
    		restricted
    		Exit Rules

		Update is an Update Action
			Entrance Rules
				if (AccountingUnit changed
				or Project changed
				or Dimension1 changed
				or Dimension2 changed
				or Dimension3 changed
				or Dimension4 changed
				or Dimension5 changed
				or Dimension6 changed
				or Dimension7 changed
				or Dimension8 changed
				or Dimension9 changed
				or Dimension10 changed)
					confirmation required
				 		"ChangingDimensionMappingMayCauseIncorrectResultsIfBudgetingHasBeenSetUp.DoYouWantToProceed?"
			Exit Rules
				if (FieldsForCubeRefresh changed)			
					if (CubeRel exists)
						invoke Refresh CubeRel in background

		Delete is a Delete Action
			restricted

		Reset is an Instance Action
			valid when (!HasBudgetScenarios)
			Action Rules
				AccountingEntity	= DEPMDimension.BPDENTITY
				Account				= DEPMDimension.BPDACCOUNT
				initialize AccountingUnit
				initialize Project
				initialize Dimension1
				initialize Dimension2
				initialize Dimension3
				initialize Dimension4
				initialize Dimension5
				initialize Dimension6
				initialize Dimension7
				initialize Dimension8
				initialize Dimension9
				initialize Dimension10
