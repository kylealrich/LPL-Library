ShipmentLoad is a BusinessClass 
    owned by wh
    prefix is SHLD

    Ontology
        symbolic key is ShipmentLoad

    Patterns 
        disable AuditIndex
    
    Persistent Fields
        OrderType
        OrderNumber         is a SourceDocumentNumeric
    
    Context Fields
        ContextWarehouseStorageLocation is a WarehouseStorageLocation

    Conditions
        CanDelete
            restricted
            when (ShipmentLoadConsolidation.Status.Unreleased
            and   LoadedLineRel not exists)
        
        ReadyForDispatch
            restricted
            when (ShipmentLoadConsolidationRel exists)

    Relations
        ShipmentLineTemplateRel
            one-to-many relation to ShipmentLoadLineTemplate
            Field Mapping uses ByWarehouseShipmentLine
                related.Company                   = Company
                related.InventoryLocation         = InventoryLocation
                related.WarehouseShipment         = WarehouseShipment
        
        LoadedLineRel
            one-to-many relation to ShipmentLoadLine
            Field Mapping uses ByShipmentLoadConsolidation
                related.Company                   = Company
                related.InventoryLocation         = InventoryLocation
                related.ShipmentLoadConsolidation = ShipmentLoadConsolidation
                related.WarehouseShipment         = WarehouseShipment
        
        ShipmentLoadConsolidationRel
            one-to-many relation to ShipmentLoadConsolidation
            Field Mapping uses symbolic key
                related.Company                   = Company
                related.InventoryLocation         = InventoryLocation
                related.ShipmentLoadConsolidation = ShipmentLoadConsolidation
            Instance Selection
                where (related.WarehouseStorageLocation = ContextWarehouseStorageLocation
                and    related.LoadReadyForDispatch)


	Field Rules
        WarehouseShipment
            required
        OrderType
            force default to WarehouseShipment.WarehouseDemand.DemandSystemCode
        OrderNumber
            force default to WarehouseShipment.WarehouseDemand.DemandDocument

	Actions		
        Create is a Create Action
            restricted

        Update is an Update Action
            valid when (ShipmentLoadConsolidation.Status.Unreleased)
            
        Delete is a Delete Action
			valid when (CanDelete)
