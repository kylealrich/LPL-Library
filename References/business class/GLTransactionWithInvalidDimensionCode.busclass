GLTransactionWithInvalidDimensionCode is a BusinessClass
	owned by GeneralLedger
	sql name is GLTxnInvalidDimCode
	prefix is GTIDC
	
	Ontology
		symbolic key is GLTransactionWithInvalidDimensionCode
		
	
	Patterns
	
	Persistent Fields
		OldDimensionCode			is a DimensionCode
        NewDimensionCode            is a DimensionCode
        TransactionStatus           is Numeric size 1
            States
                TransactionWasCorrect              value is 0
                TransactionHadMismatchedDimensions value is 1
        SummarizationWasIncorrect 		 is Boolean
        SummarizationCouldNotBeCorrected is Boolean
        Completed						 is Boolean	
		
	Local Fields
		LocalRunGroup				is AlphaUpper 30
		
	Relations
		GLTransactionInterfaceRel
			one-to-many relation to GLTransactionInterface
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup 			= FinanceEnterpriseGroup
			Instance Selection
				where (related.GLTransactionInterface.RunGroup = LocalRunGroup)	
	Field Rules
	
	Actions
		Create is an Action
			restricted
		Update is an Action
			restricted
		Delete is an Action
		
		GenerateRunGroup is a Set Action
			Parameters
				PrmFinanceEnterpriseGroup	is a FinanceEnterpriseGroup
					default label is "FinanceEnterpriseGroup"
				PrmRunGroup					is AlphaUpper 30
					default label is "CreateRunGroup"
				
			Parameter Rules
				PrmFinanceEnterpriseGroup
					required
				PrmRunGroup
					required
					LocalRunGroup = PrmRunGroup
					constraint (!GLTransactionInterfaceRel exists)
						"TransactionsAlreadyExistFor_Run_Group"
			Instance Selection
				where (FinanceEnterpriseGroup = PrmFinanceEnterpriseGroup
				and    SummarizationWasIncorrect)
			Local Fields
				LocalSequence					is Numeric 12
				LocalUpdateCount				is Numeric 4
				
			Action Rules
				Instance Rules
					if (!GeneralLedgerTransaction.GLTransactionDetailExistsRel exists)
						SummarizationCouldNotBeCorrected = true
						LocalUpdateCount 	  += 1
					else
						LocalSequence    	  += 1
						LocalUpdateCount 	  += 1
						invoke Create GLTransactionInterface
							fill in fields from this instance
							invoked.FinanceEnterpriseGroup 					= FinanceEnterpriseGroup
							invoked.GLTransactionInterface.RunGroup 		= PrmRunGroup
							invoked.GLTransactionInterface.SequenceNumber 	= LocalSequence
							invoked.AccountingEntity						= AccountingEntity
							invoked.Status									= 0
							invoked.ToAccountingEntity						= GeneralLedgerTransaction.FinanceCodeBlock.ToAccountingEntity
							invoked.AccountingUnit							= GeneralLedgerTransaction.FinanceCodeBlock.AccountingUnit        						
							invoked.AccountCode								= GeneralLedgerTransaction.FinanceCodeBlock.GeneralLedgerChartAccount
							invoked.GeneralLedgerEvent						= GeneralLedgerTransaction.GeneralLedgerEvent
							invoked.TransactionDate							= GeneralLedgerTransaction.TransactionDate
							invoked.Reference								= GeneralLedgerTransaction.Reference
							invoked.Description								= GeneralLedgerTransaction.Description
							invoked.CurrencyCode							= GeneralLedgerTransaction.CurrencyCode
							invoked.UnitsAmount								= (GeneralLedgerTransaction.UnitsAmount * -1)
							invoked.TransactionAmount						= (GeneralLedgerTransaction.TransactionAmount * -1)
							invoked.ReportCurrencyAmount.FunctionalAmount.EnteredCurrencyAmount		= (GeneralLedgerTransaction.ReportCurrencyAmount.FunctionalAmount.EnteredCurrencyAmount * -1)
							invoked.ReportCurrencyAmount.AlternateAmount.EnteredCurrencyAmount		= (GeneralLedgerTransaction.ReportCurrencyAmount.AlternateAmount.EnteredCurrencyAmount * -1)
							invoked.ReportCurrencyAmount.AlternateAmount2.EnteredCurrencyAmount		= (GeneralLedgerTransaction.ReportCurrencyAmount.AlternateAmount2.EnteredCurrencyAmount * -1)
							invoked.ReportCurrencyAmount.AlternateAmount3.EnteredCurrencyAmount		= (GeneralLedgerTransaction.ReportCurrencyAmount.AlternateAmount3.EnteredCurrencyAmount * -1)
							invoked.ReportCurrencyAmount.ToFunctionalAmount.EnteredCurrencyAmount	= (GeneralLedgerTransaction.ReportCurrencyAmount.ToFunctionalAmount.EnteredCurrencyAmount * -1)
							invoked.ReportCurrencyAmount.ToAlternateAmount.EnteredCurrencyAmount	= (GeneralLedgerTransaction.ReportCurrencyAmount.ToAlternateAmount.EnteredCurrencyAmount * -1)
							invoked.ReportCurrencyAmount.ToAlternateAmount2.EnteredCurrencyAmount	= (GeneralLedgerTransaction.ReportCurrencyAmount.ToAlternateAmount2.EnteredCurrencyAmount * -1)
							invoked.ReportCurrencyAmount.ToAlternateAmount3.EnteredCurrencyAmount	= (GeneralLedgerTransaction.ReportCurrencyAmount.ToAlternateAmount3.EnteredCurrencyAmount * -1)
							invoked.ReportCurrencyAmount.ProjectAmount.EnteredCurrencyAmount		= (GeneralLedgerTransaction.ReportCurrencyAmount.ProjectAmount.EnteredCurrencyAmount * -1)
							invoked.ReportCurrencyAmount.ReportAmount1.EnteredCurrencyAmount		= (GeneralLedgerTransaction.ReportCurrencyAmount.ReportAmount1.EnteredCurrencyAmount * -1)
							invoked.ReportCurrencyAmount.ReportAmount2.EnteredCurrencyAmount		= (GeneralLedgerTransaction.ReportCurrencyAmount.ReportAmount2.EnteredCurrencyAmount * -1)
							invoked.ReportCurrencyAmount.ReportAmount3.EnteredCurrencyAmount		= (GeneralLedgerTransaction.ReportCurrencyAmount.ReportAmount3.EnteredCurrencyAmount * -1)
							invoked.ReportCurrencyAmount.ReportAmount4.EnteredCurrencyAmount		= (GeneralLedgerTransaction.ReportCurrencyAmount.ReportAmount4.EnteredCurrencyAmount * -1)
							invoked.ReportCurrencyAmount.ReportAmount5.EnteredCurrencyAmount		= (GeneralLedgerTransaction.ReportCurrencyAmount.ReportAmount5.EnteredCurrencyAmount * -1)
							invoked.ReportCurrencyAmount.FunctionalAmount.EnteredCurrencyRate		= (GeneralLedgerTransaction.ReportCurrencyAmount.FunctionalAmount.EnteredCurrencyRate)
							invoked.ReportCurrencyAmount.AlternateAmount.EnteredCurrencyRate		= (GeneralLedgerTransaction.ReportCurrencyAmount.AlternateAmount.EnteredCurrencyRate)
							invoked.ReportCurrencyAmount.AlternateAmount2.EnteredCurrencyRate		= (GeneralLedgerTransaction.ReportCurrencyAmount.AlternateAmount2.EnteredCurrencyRate)
							invoked.ReportCurrencyAmount.AlternateAmount3.EnteredCurrencyRate		= (GeneralLedgerTransaction.ReportCurrencyAmount.AlternateAmount3.EnteredCurrencyRate)
							invoked.ReportCurrencyAmount.ToFunctionalAmount.EnteredCurrencyRate  	= (GeneralLedgerTransaction.ReportCurrencyAmount.ToFunctionalAmount.EnteredCurrencyRate)
							invoked.ReportCurrencyAmount.ToAlternateAmount.EnteredCurrencyRate	 	= (GeneralLedgerTransaction.ReportCurrencyAmount.ToAlternateAmount.EnteredCurrencyRate)
							invoked.ReportCurrencyAmount.ToAlternateAmount2.EnteredCurrencyRate		= (GeneralLedgerTransaction.ReportCurrencyAmount.ToAlternateAmount2.EnteredCurrencyRate)
							invoked.ReportCurrencyAmount.ToAlternateAmount3.EnteredCurrencyRate		= (GeneralLedgerTransaction.ReportCurrencyAmount.ToAlternateAmount3.EnteredCurrencyRate)
							invoked.ReportCurrencyAmount.ProjectAmount.EnteredCurrencyRate			= (GeneralLedgerTransaction.ReportCurrencyAmount.ProjectAmount.EnteredCurrencyRate)
							invoked.ReportCurrencyAmount.ReportAmount1.EnteredCurrencyRate			= (GeneralLedgerTransaction.ReportCurrencyAmount.ReportAmount1.EnteredCurrencyRate)
							invoked.ReportCurrencyAmount.ReportAmount2.EnteredCurrencyRate			= (GeneralLedgerTransaction.ReportCurrencyAmount.ReportAmount2.EnteredCurrencyRate)
							invoked.ReportCurrencyAmount.ReportAmount3.EnteredCurrencyRate			= (GeneralLedgerTransaction.ReportCurrencyAmount.ReportAmount3.EnteredCurrencyRate)
							invoked.ReportCurrencyAmount.ReportAmount4.EnteredCurrencyRate			= (GeneralLedgerTransaction.ReportCurrencyAmount.ReportAmount4.EnteredCurrencyRate)
							invoked.ReportCurrencyAmount.ReportAmount5.EnteredCurrencyRate			= (GeneralLedgerTransaction.ReportCurrencyAmount.ReportAmount5.EnteredCurrencyRate)
							invoked.System									= GeneralLedgerTransaction.System
							invoked.AutoReverse								= GeneralLedgerTransaction.AutoReverse
							invoked.PostingDate								= GeneralLedgerTransaction.PostingDate
							invoked.Project									= GeneralLedgerTransaction.FinanceCodeBlock.Project
							invoked.FinanceDimension1						= GeneralLedgerTransaction.FinanceCodeBlock.FinanceDimension1
							invoked.FinanceDimension2						= GeneralLedgerTransaction.FinanceCodeBlock.FinanceDimension2
							invoked.FinanceDimension3						= GeneralLedgerTransaction.FinanceCodeBlock.FinanceDimension3
							invoked.FinanceDimension4						= GeneralLedgerTransaction.FinanceCodeBlock.FinanceDimension4
							invoked.FinanceDimension5						= GeneralLedgerTransaction.FinanceCodeBlock.FinanceDimension5
							invoked.FinanceDimension6						= GeneralLedgerTransaction.FinanceCodeBlock.FinanceDimension6
							invoked.FinanceDimension7						= GeneralLedgerTransaction.FinanceCodeBlock.FinanceDimension7
							invoked.FinanceDimension8						= GeneralLedgerTransaction.FinanceCodeBlock.FinanceDimension8
							invoked.FinanceDimension9						= GeneralLedgerTransaction.FinanceCodeBlock.FinanceDimension9
							invoked.FinanceDimension10						= GeneralLedgerTransaction.FinanceCodeBlock.FinanceDimension10
							invoked.Ledger									= GeneralLedgerTransaction.FinanceCodeBlock.Ledger

									
						for each GeneralLedgerTransaction.GLTransactionDetailExistsRel
							LocalSequence    	  += 1
							LocalUpdateCount 	  += 1
							invoke Create GLTransactionInterface
								fill in fields from each
								invoked.FinanceEnterpriseGroup 					= FinanceEnterpriseGroup
								invoked.GLTransactionInterface.RunGroup 		= PrmRunGroup
								invoked.GLTransactionInterface.SequenceNumber 	= LocalSequence
								invoked.AccountingEntity						= each.AccountingEntity
        						invoked.Status									= 0
								invoked.ToAccountingEntity						= each.FinanceCodeBlock.ToAccountingEntity
								invoked.AccountingUnit							= each.FinanceCodeBlock.AccountingUnit        						
								invoked.AccountCode								= each.FinanceCodeBlock.GeneralLedgerChartAccount
								invoked.GeneralLedgerEvent						= each.GeneralLedgerEvent
								invoked.JournalCode								= each.JournalCode
								invoked.TransactionDate							= each.TransactionDate
								invoked.Reference								= each.Reference
								invoked.Description								= each.Description
								invoked.CurrencyCode							= each.CurrencyCode
								invoked.UnitsAmount								= each.UnitsAmount
								invoked.TransactionAmount						= each.TransactionAmount
								invoked.ReportCurrencyAmount					= each.ReportCurrencyAmount
								invoked.System									= each.System
								invoked.AutoReverse								= each.AutoReverse
								invoked.PostingDate								= each.PostingDate
								invoked.Project									= each.FinanceCodeBlock.Project
								invoked.FinanceDimension1						= each.FinanceCodeBlock.FinanceDimension1
								invoked.FinanceDimension2						= each.FinanceCodeBlock.FinanceDimension2
								invoked.FinanceDimension3						= each.FinanceCodeBlock.FinanceDimension3
								invoked.FinanceDimension4						= each.FinanceCodeBlock.FinanceDimension4
								invoked.FinanceDimension5						= each.FinanceCodeBlock.FinanceDimension5
								invoked.FinanceDimension6						= each.FinanceCodeBlock.FinanceDimension6
								invoked.FinanceDimension7						= each.FinanceCodeBlock.FinanceDimension7
								invoked.FinanceDimension8						= each.FinanceCodeBlock.FinanceDimension8
								invoked.FinanceDimension9						= each.FinanceCodeBlock.FinanceDimension9
								invoked.FinanceDimension10						= each.FinanceCodeBlock.FinanceDimension10
								invoked.Ledger									= each.FinanceCodeBlock.Ledger
								invoked.DocumentNumber							= each.DocumentNumber

								invoked.Resource								= each.Resource
								invoked.VendorGroupAndVendor					= each.VendorGroupAndVendor
						
						SummarizationCouldNotBeCorrected = false	
						Completed = true
						
						if (LocalUpdateCount > 100)
							commit transaction
							LocalUpdateCount = 0

						
