CalculateTaxInterface is a BusinessClass
	owned by tx
	prefix is CTXI
	sql name is CalculateTaxInterface
	
	Patterns
		implements StaticJava
		disable AuditIndex
		disable Auditing
		
	Persistent Fields

		ProgramCode					is Alpha size 100
		TaxEntity
		InvoiceCompany				is a GeneralLedgerCompany
		System						is a GeneralLedgerSystemCode
		TaxCode
		ProcessLevel
		PostalAddress				is a PostalAddressV2	
			holds pii
		Invoice
		FromPostalAddress			is a PostalAddressV2	
			holds pii
		Function					is AlphaUpper 1
		ThirdPartyFunction			is Alpha 1
		TransactionType             is AlphaUpper size 1
		TaxableAmount				is an InternationalAmount
		TaxDate						is Date
		PaymentDate					is Date
		InvoiceDate					is Date
		GeneralLedgerDate			is Date
			default label is "GlobalLedgerDate"
		ShipmentDate				is Date			

		OutputTotalTaxAmount		is an InternationalAmount
		ProductTaxCategory
		TaxDistributionCode					
		
	Local Fields
		CalculateTax
		Execute is Alpha 1
	
	Transient Fields
		TaxAmount					is an InternationalAmount
		ReturnedTaxTable			is like TaxTableField	
        ErrorNumber                 is Numeric 3
        ErrorMessage                is Alpha size 500
	Rule Blocks
		ExecuteCalculation
			initialize CalculateTax

			CalculateTax.TaxEntity				= TaxEntity
			CalculateTax.System					= System
			CalculateTax.TaxCode				= TaxCode
			CalculateTax.ProcessLevel			= ProcessLevel
			CalculateTax.Invoice				= Invoice
			CalculateTax.PostalAddress	 		= PostalAddress
			CalculateTax.FromPostalAddress		= FromPostalAddress
			CalculateTax.Function				= Function
			CalculateTax.ThirdPartyFunction 	= ThirdPartyFunction
			CalculateTax.TransactionType		= TransactionType
			CalculateTax.TaxableAmount			= TaxableAmount
			CalculateTax.TaxDate				= TaxDate
			CalculateTax.ShipmentDate			= ShipmentDate
			CalculateTax.PaymentDate			= PaymentDate
			CalculateTax.InvoiceDate			= InvoiceDate
			CalculateTax.GeneralLedgerDate		= GeneralLedgerDate
			CalculateTax.ProductTaxCategory		= ProductTaxCategory
			CalculateTax.InputTaxDistributionCode = TaxDistributionCode					
			CalculateTax.TaxAmount				= TaxAmount
			CalculateTax.LineNumber             = 1
			
			Execute = CalculateTax.ExecuteCalculateTax
			
			ErrorNumber = CalculateTax.OutputErrorNumber
			ErrorMessage = CalculateTax.OutputErrorMessage


			OutputTotalTaxAmount				= CalculateTax.OutputTotalTaxAmount
			ReturnedTaxTable					= CalculateTax.TaxTable

	Conditions
	
		SecurityGroupAllowsAccess
    		when((InvoiceCompany not entered)
    		or  (InvoiceCompany entered and InvoiceCompany.SecurityGroupAllowsAccess))
	
	Sets

		Set1
			indexed
			no duplicates
			primary
			Sort Order
				ProgramCode

	Actions

		Create is a Create Action
			Field Rules
				ProgramCode
					required
			Action Rules
				include ExecuteCalculation

		Update is an Update Action
			Action Rules
				include ExecuteCalculation

		Delete is a Delete Action

		Purge is a Purge Action

	
