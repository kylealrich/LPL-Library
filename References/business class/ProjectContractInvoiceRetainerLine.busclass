ProjectContractInvoiceRetainerLine is a BusinessClass
	sql name is "ProjConInvRetLine"
    owned by Projects
    prefix is PCIRL

    Ontology
    	part of ProjectContractInvoiceLine
    		relative key is ProjectContractRetainer
    		
	Patterns
		disable Auditing

    Persistent Fields
    	AppliedAmount			is a CurrencyAmount
			precision is ProjectContract.Currency.NumberOfDecimals
		RetainerLine			is Numeric size 4
		
	Derived Fields
				
    Conditions

    Relations
    	RetainerLineRel
    		one-to-many relation to ProjectContractInvoiceLine
    		Field Mapping uses ByProjectContractRetainer
    			related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
    			related.ProjectContract			= ProjectContract
    			related.FinanceDimension2		= FinanceDimension2
    			related.ProjectContractInvoice	= ProjectContractInvoice
    			related.ProjectContractRetainer	= ProjectContractRetainer
    			related.SequenceNumber			> SequenceNumber
				
    Sets
    	ByProjectContractRetainer
    		Sort Order
				FinanceEnterpriseGroup
				ProjectContract
				FinanceDimension2
				ProjectContractInvoice
				ProjectContractRetainer
				SequenceNumber

    Field Rules

	Actions
		Create is a Create Action
			restricted

		Delete is a Delete Action
			restricted
			
		Update is an Update Action
			restricted

		RemoveAppliedAmount is an Instance Action
			restricted
			Parameters
				PrmAppliedAmount	is like InternationalAmount
			Parameter Rules
				PrmAppliedAmount
					default to AppliedAmount
			Action Rules
				AppliedAmount -= PrmAppliedAmount
				invoke Update first RetainerLineRel
					invoked.Amount 		+= PrmAppliedAmount
					invoked.AmountRemoved = true
				invoke UpdateAppliedAmount ProjectContractRetainer
					invoked.PrmAppliedAmount = PrmAppliedAmount * -1

				
				
