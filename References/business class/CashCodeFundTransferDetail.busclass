CashCodeFundTransferDetail is a BusinessClass
    owned by cb
    prefix is CFTD

    Ontology
        symbolic key is CashCodeFundTransferDetail

    Patterns
        implements StaticJava
        disable AuditIndex

    Persistent Fields
		AccountingEntity
			default label is "<CashManagementGroup.FinanceEnterpriseGroup.AccountingEntityLabel>"
		CurrencyTable
		TransferAmount				is a CurrencyAmount 
		TransferBaseAmount			is a FinanceCurrencyAmount
		TransferAccountStructure	is a TransactionCodeBlock
		
			
	Derived Fields


	Transient Fields
		TransientFromCurrency	is a FromCurrency
			derive value from CashCode.Currency

										
    Local Fields
		LocalFromCurrency		is a FromCurrency
		LocalExchangeDate		is an ExchangeDate
		LocalPostingDate		is a PostingDate
		
    Conditions


    Relations


    Sets

                
    Rule Blocks
					                    				
                    				                		
    Field Rules
		AccountingEntity
			force default to CashLedgerFundTransferHeader.Company.OrigCompany.AccountingEntity
			required

		CurrencyTable
			force default to CashLedgerFundTransferHeader.CurrencyTable
			
		TransferAmount
			LocalFromCurrency = CashCode.Currency
			LocalExchangeDate = CashLedgerFundTransferHeader.TransferDate	
        	if (TransferAmount		changed
        	or  AccountingEntity	changed)
	       		initialize TransferBaseAmount
	        required
	        
		TransferBaseAmount
			required
			
		TransferAccountStructure
			LocalFromCurrency	= CashCode.Currency
			LocalPostingDate	= CashLedgerFundTransferHeader.PostDate
			TransferAccountStructure.GeneralLedgerChartAccount = CashLedgerFundTransferHeader.CompanyCashCode.CashAccount.GeneralLedgerChartAccount
			constraint (TransferAccountStructure.GeneralLedgerChartAccount = CashLedgerFundTransferHeader.CompanyCashCode.CashAccount.GeneralLedgerChartAccount)
				"CannotOverrideGlobalLedgerAccountAssignedToCashCode"
			required


	Actions
		Create is a Create Action
	        valid when (CashLedgerFundTransferHeader.IsUnreleased)
			Entrance Rules

            Exit Rules
				invoke UpdateHeaderAmounts CashLedgerFundTransferHeader

		Update is an Update Action
	        valid when (CashLedgerFundTransferHeader.IsUnreleased)
			Entrance Rules

            Exit Rules
				invoke UpdateHeaderAmounts CashLedgerFundTransferHeader
	
		Delete is a Delete Action		
            valid when (CashLedgerFundTransferHeader.IsUnreleased)
            Entrance Rules
			Action Rules
            Exit Rules
				invoke UpdateHeaderAmounts CashLedgerFundTransferHeader

		AdjustDetailCurrencyAmounts is an Instance Action
			default label is untranslatable
			restricted
			Parameters
				PrmCurrencyAmountAdjustment	is a DocumentCurrencyTotals
			Action Rules
				TransferBaseAmount.FunctionalAmount.EnteredCurrencyAmount 	-= PrmCurrencyAmountAdjustment.FunctionalTotal
				TransferBaseAmount.AlternateAmount.EnteredCurrencyAmount 	-= PrmCurrencyAmountAdjustment.AlternateTotal
				TransferBaseAmount.AlternateAmount2.EnteredCurrencyAmount 	-= PrmCurrencyAmountAdjustment.AlternateTotal2
				TransferBaseAmount.AlternateAmount3.EnteredCurrencyAmount 	-= PrmCurrencyAmountAdjustment.AlternateTotal3
				TransferBaseAmount.ReportAmount1.EnteredCurrencyAmount	 	-= PrmCurrencyAmountAdjustment.ReportTotal1
				TransferBaseAmount.ReportAmount2.EnteredCurrencyAmount	 	-= PrmCurrencyAmountAdjustment.ReportTotal2
				TransferBaseAmount.ReportAmount3.EnteredCurrencyAmount	 	-= PrmCurrencyAmountAdjustment.ReportTotal3
				TransferBaseAmount.ReportAmount4.EnteredCurrencyAmount		-= PrmCurrencyAmountAdjustment.ReportTotal4
				TransferBaseAmount.ReportAmount5.EnteredCurrencyAmount		-= PrmCurrencyAmountAdjustment.ReportTotal5

