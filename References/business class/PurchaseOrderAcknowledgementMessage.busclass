PurchaseOrderAcknowledgementMessage is a BusinessClass
	owned by po
	
	prefix is POAM
	sql name is POEDIAcknowledge
	
    Ontology
    	symbolic key is PurchaseOrderAcknowledgementMessage
	
	Patterns
	
	Persistent Fields
		Company         			is like Company
		PurchaseOrder   			is like PurchaseOrder
		PurchaseOrderLine 			is like PurchaseOrderLine
		PurchaseOrderRevision       is like PurchaseOrderRevision
		AddOnCharge                 is like AddOnCharge
		AcknowledgementResult       is like PurchaseOrderAcknowledgementResult
		Buyer                       is like Buyer
		Vendor                      is like Vendor
		PurchaseFromLocation        is like VendorLocation
		MessageNumber               is Numeric 3
		EDIAmount                   is like InternationalCost
		POAmount                    is like InternationalCost
		EDIAlpha                    is a Description
		POAlpha                     is a Description
		EDIDate                     is Date
		PODate                      is Date
		EDINumeric                  is Numeric size 9
		PONumeric                   is Numeric size 9
		MessageRemoved              is Boolean
		POShipDate					is Date
	
	Local Fields
		LocalSupplier                   	is like Supplier
		LocalSupplierContact            	is like SupplierSourceId	

	Derived Fields
	
		BuyerName is a DerivedField
			type is Alpha up to 230
			restricted
			return PurchaseOrderRel.Buyer.Name

		DerivedPurchaseOrder is a DerivedField
			type is Alpha 12
			restricted
			return PurchaseOrder using "%d"

		DerivedSupplierSourceId is a DerivedField
			type is like SupplierSourceId
			restricted
			if (VendorRel.SingleSupplier
			and PurchaseOrderRel.PurchaseFromLocation entered
            and PurchaseOrderRel.PurchaseFromLocation.SupplierSourceIdRel exists
            and PurchaseOrderRel.PurchaseFromLocation.NumberOfSupplierContacts = 1)
   				return PurchaseOrderRel.PurchaseFromLocation.SupplierSourceIdRel.SupplierSourceId         					 
            else
				return blank

		DerivedPODate is a DerivedField
			type is Date 
			restricted
			return PurchaseOrderRel.PurchaseOrderDate	

		EDIAmountGreaterThanPOAmount is a ComputeField
			type is Decimal size 19.3
			((EDIAmount - POAmount) * PurchaseOrderLineRel.Quantity)

		POAmountGreaterThanEDIAmount is a ComputeField
			type is Decimal size 19.3
			((POAmount - EDIAmount) * PurchaseOrderLineRel.Quantity)

		Message1 is a MessageField
			restricted
			"PurchaseOrderDateOf<EDIDate>OnAcknowledgementDoesNotMatchDateOf<PODate>OnPurchaseOrder"
			
		Message2 is a MessageField
			restricted
			"TaxAmountOf<EDIAmount>OnAcknowledgementDoesNotMatchAmountOf<POAmount>OnPurchaseOrder"
			
		Message3 is a MessageField
			restricted
			"FreightTermOf<EDIAlpha>OnAcknowledgementDoesNotMatchTermOf<POAlpha>OnPurchaseOrder"
			
		Message4 is a MessageField
			restricted
			"ShipTermOf<EDIAlpha>OnAcknowledgementDoesNotMatchTermOf<POAlpha>OnPurchaseOrder"
			
		Message5 is a MessageField
			restricted
			"DefaultEarlyDeliveryDateOf<EDIDate>OnAcknowledgementDoesNotMatchDateOf<PODate>OnPurchaseOrder"
			
		Message6 is a MessageField
			restricted
			"ShippingMethodOf<EDIAlpha>OnAcknowledgementDoesNotMatchMethodOf<POAlpha>OnPurchaseOrder"
			
		Message7 is a MessageField
			restricted
			"VendorOf<EDINumeric>OnAcknowledgementDoesNotMatchVendorOf<PONumeric>OnPurchaseOrder"
			
		Message8 is a MessageField
			restricted
			"PurchaseFromLocationOnAcknowledgementDoesNotMatchPurchaseFromLocationOnPurchaseOrder"
			
		Message9 is a MessageField
			restricted
			"VendorOf<EDINumeric>FromGLNVendorOnAcknowledgementDoesNotMatchVendorOf<PONumeric>OnPurchaseOrder"
			
		Message10 is a MessageField
			restricted
			"NoValidPurchaseOrderFoundForCompany<Company>AndPurchaseOrder<PurchaseOrder>"
			
		Message11 is a MessageField
			restricted
			"PurchaseFromLocationOf<EDIAlpha>FromGLNPurchaseFromLocationOnAcknowledgementDoesNotMatchPurchaseFromLocationOf<POAlpha>OnPurchaseOrder"
			
		Message12 is a MessageField
			restricted
			"CommodityCodeOf<EDIAlpha>OnAcknowledgementDoesNotMatchCodeOf<POAlpha>OnPurchaseOrderLine"			

		Message13 is a MessageField
			restricted
			"NoValidPurchaseOrderLineFoundForCompany<Company>AndPurchaseOrder<PurchaseOrder>AndPurchaseOrderLine<PurchaseOrderLine>"			

		Message14 is a MessageField
			restricted
			"ItemOf<EDIAlpha>OnAcknowledgementDoesNotMatchItemOf<POAlpha>OnPurchaseOrderLine"

		Message15 is a MessageField
			restricted
			"VendorItemOf<EDIAlpha>OnAcknowledgementDoesNotMatchVendorItemOf<POAlpha>OnPurchaseOrderLine;VendorItemNotUpdatedOnPO"

		Message16 is a MessageField
			restricted
			"UnitOfMeasureOf<EDIAlpha>OnAcknowledgementDoesNotMatchUnitOfMeasureOf<POAlpha>OnPurchaseOrderLine"

		Message17 is a MessageField
			restricted
			"GTINOf<EDIAlpha>OnAcknowledgementDoesNotMatchGTINOf<POAlpha>OnPurchaseOrderLine"

		Message18 is a MessageField
			restricted
			"QuantityOf<EDINumeric>OnAcknowledgementDoesNotMatchQuantityOf<PONumeric>OnPurchaseOrderLine"

		Message19 is a MessageField
			restricted
			"VendorPriceQuantityOf<EDINumeric>OnAcknowledgementDoesNotMatchVendorPriceQuantityOf<PONumeric>OnPurchaseOrderLine"
			
		Message20 is a MessageField
			restricted
			"UnitCostOf<EDIAmount>OnAcknowledgementDoesNotMatchUnitCostOf<POAmount>OnPurchaseOrderLine"
			
		Message21 is a MessageField
			restricted
			"VendorPriceUnitCostOf<EDIAmount>OnAcknowledgementDoesNotMatchVendorPriceUnitCostOf<POAmount>OnPurchaseOrderLine"
			
		Message22 is a MessageField
			restricted
			"VendorPriceUnitOfMeasureOf<EDIAlpha>OnAcknowledgementDoesNotMatchVendorPriceUnitOfMeasureOf<POAlpha>OnPurchaseOrderLine"
			
		Message23 is a MessageField
			restricted
			"StatusA_C:AcceptedAndShipped"
		
		Message24 is a MessageField
			restricted
			"StatusAR:Accepted,ReleasedForShipment"
			
		Message25 is a MessageField
			restricted
			"StatusBP:PartialBackorder"
			
		Message26 is a MessageField
			restricted
			"StatusDR:Accepted,DateRescheduled"
			
		Message27 is a MessageField
			restricted
			"StatusIA:Accepted"
			
		Message28 is a MessageField
			restricted
			"StatusIB:Backordered"
			
		Message29 is a MessageField
			restricted
			"StatusIC:Accepted,ChangesMade"
			
		Message30 is a MessageField
			restricted
			"StatusID:Deleted"
			
		Message31 is a MessageField
			restricted
			"StatusIE:Accepted,PricePending"
			
		Message32 is a MessageField
			restricted
			"StatusIF:Hold,IncompleteDescription"
			
		Message33 is a MessageField
			restricted
			"StatusIH:OnHold"
					
		Message34 is a MessageField
			restricted
			"StatusIP:Accepted,PriceChanged"
			
		Message35 is a MessageField
			restricted
			"StatusIQ:Accepted,QuantityChanged"
			
		Message36 is a MessageField
			restricted
			"StatusIR:ItemRejected"
			
		Message37 is a MessageField
			restricted
			"StatusIS:Accepted,SubstitutionMade;VendorSubstitutedItem<EDIAlpha>ForItem<POAlpha>"

		Message38 is a MessageField
			restricted
			"StatusIW:OnHold,WaiverRequired"
			
		Message39 is a MessageField
			restricted
			"StatusSP:Accepted,SchedulePending"
			
		Message40 is a MessageField
			restricted
			"<EDIAlpha>"   
			
		Message41 is a MessageField			
            restricted
			"VendorItemOf<EDIAlpha>OnAcknowledgementDoesNotMatchVendorItemOf<POAlpha>OnPurchaseOrderLine;VendorItemUpdatedOnPO"
			
		Message42 is a MessageField
			restricted
			"UnitCostOf<EDIAmount>OnAcknowledgementDoesNotMatchUnitCostOf<POAmount>OnPurchaseOrderLine;UnitCostUpdatedOnPO"

		Message43 is a MessageField
			restricted
			"AcknowledgementEarlyDeliveryDate<EDIDate>DoesNotMatchPOLineEarlyDeliveryDate<PODate>;EarlyDeliveryDateUpdatedOnPO"


		Message44 is a MessageField
			restricted
			"EarlyDeliveryDate<EDIDate>OnAcknowledgementDoesNotMatchEarlyDeliveryDateOf<PODate>OnPurchaseOrderLine;EarlyDeliveryDateNotUpdatedOnPO"

		Message45 is a MessageField
			restricted
			"AcknowledgementEarlyDeliveryDate<EDIDate>IsOutsideDeliveryToleranceDays;LateDeliveryDateUpdatedOnPO"


		Message46 is a MessageField
			restricted
			"DescriptionOf<EDIAlpha>OnAcknowledgementDoesNotMatchDescriptionOf<POAlpha>OnPurchaseOrderLine"

		Message47 is a MessageField
			restricted
			"VendorItem<EDIAlpha>DoesNotMatchVendorItem<POAlpha>OnPurchaseOrderLine"
			
		Message48 is a MessageField
			restricted
			"ACK:VendorItem<EDIAlpha>DoesNotMatchVendorItem<POAlpha>OnPurchaseOrderLine"
			
        Message49 is a MessageField
            restricted
            "StatusIS:Accepted,SubstitutionMade;VendorSubstitutedVendorItem<EDIAlpha>ForVendorItem<POAlpha>;VendorItemUpdateAllowed"

		Message50 is a MessageField
			restricted
			"ACK:Quantity<EDINumeric>FromACKDoesNotMatchQuantity<PONumeric>OnPurchaseOrderLine"

		Message51 is a MessageField
			restricted
			"ACK:Item<EDIAlpha>FromACKDoesNotMatchItem<POAlpha>OnPurchaseOrderLine"

		Message52 is a MessageField
			restricted
			"ACK:GTIN<EDIAlpha>FromACKDoesNotMatchGTIN<POAlpha>OnPurchaseOrderLine"

		Message53 is a MessageField
			restricted
			"ACK:UnitOfMeasure<EDIAlpha>FromACKDoesNotMatchUnitOfMeasure<POAlpha>OnPurchaseOrderLine"

        Message54 is a MessageField
            restricted
            "StatusIS:Accepted,SubstitutionMade;VendorSubstitutedVendorItem<EDIAlpha>ForVendorItem<POAlpha>;VendorItemUpdateNotAllowed"
            
		Message55 is a MessageField
			restricted
			"UnitOfMeasureOf<EDIAlpha>OnAcknowledgementDoesNotMatchUnitOfMeasureOf<POAlpha>OnPurchaseOrderLine;UnitCostNotUpdatedOnPO"

		Message56 is a MessageField
			restricted
			"VendorItem<EDIAlpha>OnAcknowledgementIsInactiveOrDoesNotExist;VendorItemNotUpdatedOnPO"

		Message57 is a MessageField
			restricted
			"AcknowledgementEarlyDeliveryDate<EDIDate>IsEarlierThanPODate<DerivedPODate>;CannotUpdateEarlyDeliveryDateOnPO"

		Message58 is a MessageField
			restricted
			"AcknowledgementEarlyDeliveryDate<EDIDate>DoesNotMatchPOLineEarlyDeliveryDate<PODate>;DeliveryToleranceIsDisabled;EarlyDeliveryDateOrLateDeliveryDateNotUpdatedOnPO"

		Message59 is a MessageField
			restricted
			"Item<EDIAlpha>Has<POAlpha><EstimatedAvailabilityMessage>"

		Message60 is a MessageField
			restricted
			"AcknowledgementShipDate:<EDIDate>,POShipDateUpdatedOnPOLine"

		Message61 is a MessageField
			restricted
			"AcknowledgementShipDate<EDIDate>IsEarlierThanPODate<PODate>;POShipDateNotUpdatedOnPOLine"

		Message62 is a MessageField
			restricted
			"CalculatedDeliveryDate<EDIDate>IsWithinTolerance;EarlyDeliveryDateUpdatedOnPOLine"

		Message63 is a MessageField
			restricted
			"CalculatedDeliveryDate<EDIDate>IsNotWithinTolerance;LateDeliveryDateUpdatedOnPOLine"

		Message100 is a MessageField
			restricted
			"MessageNotFound"

		MessageDisplay is a ConditionalField
			type is Alpha 250
			if (MessageNumber = 1)
				Message1
			else
			if (MessageNumber = 2)	
				Message2
			else 
			if (MessageNumber = 3)
				Message3
			else
			if (MessageNumber = 4)
				Message4
			else
			if (MessageNumber = 5)	
				Message5
			else 
			if (MessageNumber = 6)
				Message6
			else 
			if (MessageNumber = 7)
				Message7
			else
			if (MessageNumber = 8)
				Message8
			else
			if (MessageNumber = 9)	
				Message9
			else 
			if (MessageNumber = 10)
				Message10
			else 
			if (MessageNumber = 11)
				Message11
			else
			if (MessageNumber = 12)
				Message12
			else
			if (MessageNumber = 13)	
				Message13
			else 
			if (MessageNumber = 14)
				Message14
			else 
			if (MessageNumber = 15)
				Message15
			else
			if (MessageNumber = 16)
				Message16
			else
			if (MessageNumber = 17)
				Message17
			else
			if (MessageNumber = 18)
				Message18
			else 
			if (MessageNumber = 19)
				Message19
			else
			if (MessageNumber = 20)
				Message20
			else
			if (MessageNumber = 21)
				Message21
			else
			if (MessageNumber = 22)
				Message22
			else 
			if (MessageNumber = 23)
				Message23
			else 
			if (MessageNumber = 24)
				Message24
			else
			if (MessageNumber = 25)
				Message25
			else
			if (MessageNumber = 26)
				Message26
			else
			if (MessageNumber = 27)
				Message27
			else 
			if (MessageNumber = 28)
				Message28
			else
			if (MessageNumber = 29)
				Message29
			else
			if (MessageNumber = 30)
				Message30
			else 
			if (MessageNumber = 31)
				Message31
			else 
			if (MessageNumber = 32)
				Message32
			else
			if (MessageNumber = 33)
				Message33
			else
			if (MessageNumber = 34)
				Message34
			else
			if (MessageNumber = 35)
				Message35
			else 
			if (MessageNumber = 36)
				Message36
			else
			if (MessageNumber = 37)
				Message37
			else
			if (MessageNumber = 38)
				Message38
			else
			if (MessageNumber = 39)
				Message39
			else
			if (MessageNumber = 40)
				Message40
			else
			if (MessageNumber = 41)
				Message41
			else
			if (MessageNumber = 42)
				Message42
			else
			if (MessageNumber = 43)
				Message43
			else
			if (MessageNumber = 44)
				Message44
			else
			if (MessageNumber = 45)
				Message45
			else
			if (MessageNumber = 46)
				Message46
			else
			if (MessageNumber = 47)
				Message47
			else
            if (MessageNumber = 48)
				Message48
            else
            if (MessageNumber = 49)
                Message49
            else
            if (MessageNumber = 50)
                Message50
            else
            if (MessageNumber = 51)
                Message51
            else
            if (MessageNumber = 52)
                Message52
            else
            if (MessageNumber = 53)
                Message53
			else
            if (MessageNumber = 54)
                Message54
            else
            if (MessageNumber = 55)
            	Message55
            else
            if (MessageNumber = 56)
            	Message56
			else
			if (MessageNumber = 57)
				Message57
			else
			if (MessageNumber = 58)
				Message58
			else
			if (MessageNumber = 59)
				Message59
			else
			if (MessageNumber = 60)
				Message60
			else
			if (MessageNumber = 61)
				Message61
			else
			if (MessageNumber = 62)
				Message62
			else
			if (MessageNumber = 63)
				Message63
			else
				Message100
				
		CreateTimeStampWidget is a DerivedField 
			type is Alpha size 25
			return create date
		
		DerivedOneYearReplicationData is a DerivedField 
        	type is Boolean
            if ((current date - create date) <  360)
                return true
            else
                return false
		
		PurchaseOrderandLineDisplay			is a LabelField
			"PO:<PurchaseOrder>|Line:<PurchaseOrderLine>"
			
		EstimatedAvailabilityMessage 				is a DerivedField
			type is MessageField
			if (MessageNumber = 59
			and EDIDate entered)
				return EstimatedDateDetailMessage

		EstimatedDateDetailMessage 					is a MessageField
			";_Estimated_Availability_DateIs<EDIDate>"
			
	Conditions
	
		MessageNeedingAction
			restricted
			when (MessageNumber != 23
			and   MessageNumber != 24
			and   MessageNumber != 27
			and   MessageNumber != 40)
	
		HasAcknowledgementMessageNeedingAction
			restricted
			when (MessageRemoved	= false
			and  (MessageNumber	= 16
			or    MessageNumber = 22
			or    MessageNumber = 53
			or    MessageNumber = 55
			or    MessageNumber = 18
			or    MessageNumber = 19
			or    MessageNumber = 50
			or    MessageNumber = 20
			or    MessageNumber = 21
			or    MessageNumber = 15
			or    MessageNumber = 41
			or    MessageNumber = 47
			or    MessageNumber = 36
			or    MessageNumber = 44
			or    MessageNumber = 58
			or    MessageNumber = 37
			or    MessageNumber = 54))

		HasMessagesThatAreUpdateable
			restricted
			when (MessageRemoved	= false
			and  (MessageNumber	= 16
			or    MessageNumber = 22
			or    MessageNumber = 53
			or    MessageNumber = 55
			or    MessageNumber = 18
			or    MessageNumber = 19
			or    MessageNumber = 50
			or    MessageNumber = 20
			or    MessageNumber = 21))

		POLineHasContract
			restricted
			when (PurchaseOrderLineRel.Contract != blank)

		PurchaseOrderLineSourceExists
			restricted
			when (PurchaseOrderLineSourceRel exists)

		ContractDiffFromWorkingContract
			restricted
			when (ContractRel.Contract != ContractRel.WorkingContractID)
			
		HasAmountBeyondSearchAmount
			restricted
			when ((EDIAmount > POAmount
			and    EDIAmountGreaterThanPOAmount > BuyerSearchRel.SearchAcknowledgementAmount)
			or    (POAmount > EDIAmount
			and    POAmountGreaterThanEDIAmount > BuyerSearchRel.SearchAcknowledgementAmount))

		MessageNotRemoved
			restricted
			when (MessageRemoved = false)
	
		EmptyMessage10
			restricted
			when (MessageNumber = 10
			and   Company !entered
			and   PurchaseOrder !entered)
			
		HasSupplierMessage
			restricted
			when (SupplierMessageDialogRel exists)

		HasSupplierContactForPurchaseFrom
			restricted
			when (DerivedSupplierSourceId entered)

		BuyerCanCreateDialog
			restricted
			when (HasSupplier
			and   SupplierGroupRel.CanCreateDialogWithSupplier)
		
		SupplierContactHasAcknowledgementAccess
			restricted
			when (SupplierSourceIdValidRel.HasAcknowledgementAccess)

		HasSupplier
			restricted
			when (VendorRel.HasSupplier)
		
		CompanySecurityGroupAllowsAccess
			restricted
			when (actor.context.CompanySecurityGroup = blank
			or    CompanySecurityGroupMemberRel exists)
			
		SecurityGroupAllowsAccess
			restricted
			when (Company !entered
			or   (Company entered
			and   CompanySecurityGroupAllowsAccess))
	
		IsValidForActorContext	
			restricted
			when (PurchaseOrderCompanyRel.ProcurementGroup.BusinessGroup.FinanceEnterpriseGroup = actor.context.FinanceEnterpriseGroup)

	Relations
	
		PurchaseOrderRel
			one-to-one relation to PurchaseOrder
			Field Mapping uses symbolic key
				related.Company        = Company
				related.PurchaseOrder  = PurchaseOrder
	
		PurchaseOrderLineRel
			one-to-one relation to PurchaseOrderLine
			Field Mapping uses symbolic key
				related.Company        		= Company
				related.PurchaseOrder  		= PurchaseOrder
				related.PurchaseOrderLine 	= PurchaseOrderLine
				
		ContractRel
			one-to-one relation to Contract
			Field Mapping uses symbolic key
				related.ContractGroup		= PurchaseOrderCompanyRel.ProcurementGroup
				related.Contract			= PurchaseOrderLineRel.Contract

		ContractLineRel
			one-to-one relation to ContractLine
			Field Mapping uses symbolic key
				related.ContractGroup		= PurchaseOrderCompanyRel.ProcurementGroup
				related.Contract			= PurchaseOrderLineRel.Contract
				related.ContractLine		= PurchaseOrderLineRel.ContractLine

		PurchaseOrderLineSourceRel
			one-to-many relation to PurchaseOrderLineSource
			Field Mapping uses symbolic key
				related.Company        		= Company
				related.PurchaseOrder  		= PurchaseOrder
				related.PurchaseOrderLine 	= PurchaseOrderLine

		EmployeeRel
			one-to-one relation to Employee
			Field Mapping uses symbolic key
				related.HROrganization		= PurchaseOrderCompanyRel.ProcurementGroup.BusinessGroup.FinanceEnterpriseGroup.HROrganization
				related.Employee			= PurchaseOrderLineRel.Processor

		BuyerSearchRel
			one-to-one relation to Buyer
			Field Mapping uses symbolic key
				related.HROrganization		= PurchaseOrderCompanyRel.ProcurementGroup.BusinessGroup.FinanceEnterpriseGroup.HROrganization
				related.Buyer				= actor.agent(Employee).Employee

		PurchaseOrderCompanyRel
			one-to-one relation to PurchasingCompany
			Field Mapping uses symbolic key
				related.Company             = Company
		
		VendorRel
			one-to-one relation to Vendor
			Field Mapping uses symbolic key
				related.VendorGroup          = PurchaseOrderCompanyRel.ProcurementGroup
				related.Vendor               = Vendor
		
		PurchaseOrderRevisionRel
			one-to-one relation to PurchaseOrderRevision
			Field Mapping uses symbolic key
				related.Company        			= Company
				related.PurchaseOrder  			= PurchaseOrder
				related.PurchaseOrderRevision 	= PurchaseOrderRevision

		SupplierContactMessageRel 
			one-to-many relation to SupplierContactMessage
			Field Mapping uses symbolic key
				related.SupplierGroup				= PurchaseOrderCompanyRel.ProcurementGroup
 				related.Supplier					= SupplierRel.Supplier
				related.SupplierSourceId            = 1
			Instance Selection
				where (related.OriginatingCompany	= Company
				and    related.OriginatingPO		= PurchaseOrder)
				
		SupplierMessageDialogRel
			one-to-many relation to SupplierMessageDialog

			Field Mapping uses symbolic key
				related.SupplierGroup										= PurchaseOrderCompanyRel.ProcurementGroup
			Instance Selection
				where (related.SupplierContactMessage.OriginatingCompany	= Company
				and    related.SupplierContactMessage.OriginatingPO			= PurchaseOrder)



		SupplierSourceIdValidRel
			one-to-one relation to SupplierSourceId
			Field Mapping uses symbolic key
				related.SupplierGroup    = SupplierGroupRel.SupplierGroup
				related.Supplier         = LocalSupplier
				related.SupplierSourceId = LocalSupplierContact 


		PurchaseFromSupplierSourceIdRel   
			one-to-one relation to SupplierSourceId
			Field Mapping uses symbolic key
				related.SupplierGroup    = SupplierGroupRel.SupplierGroup
				related.Supplier         = SupplierRel.Supplier
				related.SupplierSourceId = DerivedSupplierSourceId  

		SupplierGroupRel
			one-to-one relation to SupplierGroup
			Field Mapping uses symbolic key
				related.SupplierGroup = PurchaseOrderCompanyRel.ProcurementGroup

		SupplierRel
			one-to-many relation to Supplier
			Field Mapping uses ByVendor
				related.SupplierGroup				= PurchaseOrderCompanyRel.ProcurementGroup
 				related.Vendor						= Vendor
 				
 		CompanySecurityGroupMemberRel
			one-to-one relation to GeneralLedgerCompanyGroupMember
			Field Mapping uses symbolic key
				related.GeneralLedgerCompanyGroup	= actor.context.CompanySecurityGroup.FinanceDimensionStructure
				related.Company                     = Company

	Sets
	
		ByAcknowledgementResult
    		Sort Order
    			AcknowledgementResult
    			Company
    			Buyer
    			Vendor
    			PurchaseFromLocation
    			PurchaseOrder
    			PurchaseOrderAcknowledgementMessage
    			
    	ByRevision
    		Sort Order
    			Company
    			PurchaseOrder
    			PurchaseOrderRevision
    			PurchaseOrderAcknowledgementMessage
    			
    	ByPurchaseOrderLine
    		Sort Order
    			Company
    			PurchaseOrder
    			PurchaseOrderLine
    			PurchaseOrderRevision
    			PurchaseOrderAcknowledgementMessage  
    			
    	ByBuyer
            indexed
            Sort Order
				MessageNumber
				MessageRemoved
                Buyer
                Company
                PurchaseOrder
                PurchaseOrderLine
                PurchaseOrderAcknowledgementMessage  			
	
	Field Rules
	
	
	Actions
	
		Create is a Create Action
			restricted
			
			Action Rules
			
				Buyer 					= PurchaseOrderRel.Buyer
				Vendor					= PurchaseOrderRel.Vendor
				PurchaseFromLocation	= PurchaseOrderRel.PurchaseFromLocation
			
		Update is an Update Action
			restricted
			
		Delete is a Delete Action
			restricted
	
		RemoveMessage is an Instance Action
			valid when (MessageNotRemoved)
			
			Action Rules
				MessageRemoved = true
				
		CreateMessageAndDialog is an Instance Action  
			default label is "StartASupplierDialog"
			valid when (BuyerCanCreateDialog)
			Parameters
				ParmSupplierGroup       is a SupplierGroup
				ParmSupplier            is a Supplier
					default label is "Supplier"
				ParmSupplierContact     is a SupplierSourceId
					default label is "SupplierContact"
				ParmDialogMessage       is Alpha size 1000
					default label is "Message"
				ParmDialogAttachment	is an Attachment
					default label is "Attachment"
				ParmPriority            is Numeric 1
					States
						Low				value is 1
						Normal			value is 2
						High			value is 3
					default label is "Priority"
				ParmResponseRequested   is Boolean
					default label is "ResponseRequired"

			Parameter Rules
				
				ParmSupplierGroup
					initial value is SupplierGroupRel.SupplierGroup
					
				ParmSupplier
					if (VendorRel.SingleSupplier)
						default to VendorRel.first SupplierRel.Supplier
				
				ParmSupplierContact
					if (VendorRel.SingleSupplier
					and DerivedSupplierSourceId entered)
						default to DerivedSupplierSourceId
					else
					if (VendorRel.SingleSupplierAndContact)
						default to VendorRel.SupplierRel.PrimaryContact.SupplierSourceId
				
				ParmDialogMessage
					required

				ParmPriority
					initial value is 2

			Local Fields
				LocalSupplierContactMessage        is a SupplierContactMessage view

			Action Rules

				if (!VendorRel.SingleSupplier)
					constraint (ParmSupplier entered)
						"MustEnterASupplier"

				if (!VendorRel.SingleSupplierAndContact)
					constraint (ParmSupplierContact entered)
						"MustEnterASupplierContact"		

				constraint (ParmSupplier.Vendor = Vendor)
					"SupplierNotValidForVendor"
				
				if (ParmSupplier entered)
					LocalSupplier        = ParmSupplier
				else
					LocalSupplier 		 = VendorRel.SupplierRel.Supplier
				LocalSupplierContact = ParmSupplierContact					
				
				constraint (SupplierSourceIdValidRel exists)
					"SupplierContactNotValidForSupplier"
				
				constraint (SupplierContactHasAcknowledgementAccess)
					"SupplierContactDoesNotHaveAccessToPurchaseOrderAcknowledgements"
				
				invoke Create SupplierContactMessage
					assign result to LocalSupplierContactMessage
					assign result to LocalSupplierContactMessage
					invoked.SupplierGroup  					= ParmSupplierGroup					
 					invoked.Supplier    			 		= ParmSupplier
					invoked.SupplierSourceId                = ParmSupplierContact 
					invoked.MessageTitle					= "Dialog for Purchase Order Acknowledgement: " + DerivedPurchaseOrder
					invoked.MessageText                     = "User Created Message and Dialog for Purchase Order Acknowledgement: " + DerivedPurchaseOrder
					invoked.Status							= 1
					invoked.Priority						= ParmPriority
					invoked.ReleaseStatus					= 2
					invoked.MessageOwner                    = Buyer
					invoked.OriginatingCompany				= Company
					invoked.OriginatingPO					= PurchaseOrder

				invoke Create SupplierMessageDialog
					assign result to LocalSupplierContactMessage
					invoked.SupplierGroup  					= ParmSupplierGroup					
 					invoked.Supplier    			 		= ParmSupplier
					invoked.SupplierSourceId                = ParmSupplierContact 
					invoked.SupplierContactMessage 			= LocalSupplierContactMessage.SupplierContactMessage
					invoked.Message                 		= ParmDialogMessage
					invoked.MessageAttachment       		= ParmDialogAttachment
					invoked.ResponseRequested       		= ParmResponseRequested	
					invoked.Origin                          = 1	
