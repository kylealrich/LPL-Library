GeneralLedgerCode is a BusinessClass
	default label is "GlobalLedgerCode"
    owned by GeneralLedger
    prefix is GLCOD
    representative text is "<GeneralLedgerCode>-<Description>"

    Ontology
        symbolic key is GeneralLedgerCode

    Patterns
    	
    Persistent Fields
        Description
        Ledger
        FinanceCodeBlock
        DimensionCode
        Active
        DateRange
		EnhancedCompare			is Boolean
		SelectedDimensions		is a DimensionsSelection
		AllDimensionCode		is Alpha 100
        
    Derived Fields
		DerivedDimensionsSelection		is a DerivedField
			type is Alpha 200
			DerivedDimensionsSelection = ""
			if(FinanceCodeBlock.ToAccountingEntity entered)
				DerivedDimensionsSelection = DerivedDimensionsSelection + "AE"
			if(FinanceCodeBlock.AccountingUnit entered)
				DerivedDimensionsSelection = DerivedDimensionsSelection + "AU"
			if(FinanceCodeBlock.GeneralLedgerChartAccount entered)
				DerivedDimensionsSelection = DerivedDimensionsSelection + "AC"
			if(FinanceCodeBlock.Project entered)
				DerivedDimensionsSelection = DerivedDimensionsSelection + "PJ"
			if(FinanceCodeBlock.FinanceDimension1 entered)
				DerivedDimensionsSelection = DerivedDimensionsSelection + "D1"
			if(FinanceCodeBlock.FinanceDimension2 entered)
				DerivedDimensionsSelection = DerivedDimensionsSelection + "D2"
			if(FinanceCodeBlock.FinanceDimension3 entered)
				DerivedDimensionsSelection = DerivedDimensionsSelection + "D3"
			if(FinanceCodeBlock.FinanceDimension4 entered)
				DerivedDimensionsSelection = DerivedDimensionsSelection + "D4"
			if(FinanceCodeBlock.FinanceDimension5 entered)
				DerivedDimensionsSelection = DerivedDimensionsSelection + "D5"
			if(FinanceCodeBlock.FinanceDimension6 entered)
				DerivedDimensionsSelection = DerivedDimensionsSelection + "D6"
			if(FinanceCodeBlock.FinanceDimension7 entered)
				DerivedDimensionsSelection = DerivedDimensionsSelection + "D7"
			if(FinanceCodeBlock.FinanceDimension8 entered)
				DerivedDimensionsSelection = DerivedDimensionsSelection + "D8"
			if(FinanceCodeBlock.FinanceDimension9 entered)
				DerivedDimensionsSelection = DerivedDimensionsSelection + "D9"
			if(FinanceCodeBlock.FinanceDimension10 entered)
				DerivedDimensionsSelection = DerivedDimensionsSelection + "D10"
			return DerivedDimensionsSelection

		DerivedAllDimensionCode		is a StringField
            type is like ResponsibilityMatrixApproval
            restricted
            FinanceCodeBlock.ToAccountingEntity.DerivedSequenceNumber
            FinanceCodeBlock.AccountingUnit.DerivedSequenceNumber
            FinanceCodeBlock.GeneralLedgerChartAccount.DerivedSequenceNumber
            FinanceCodeBlock.Project.DerivedSequenceNumber
			FinanceCodeBlock.FinanceDimension1.DerivedSequenceNumber
			FinanceCodeBlock.FinanceDimension2.DerivedSequenceNumber
			FinanceCodeBlock.FinanceDimension3.DerivedSequenceNumber
			FinanceCodeBlock.FinanceDimension4.DerivedSequenceNumber
			FinanceCodeBlock.FinanceDimension5.DerivedSequenceNumber
			FinanceCodeBlock.FinanceDimension6.DerivedSequenceNumber
			FinanceCodeBlock.FinanceDimension7.DerivedSequenceNumber
			FinanceCodeBlock.FinanceDimension8.DerivedSequenceNumber
			FinanceCodeBlock.FinanceDimension9.DerivedSequenceNumber
			FinanceCodeBlock.FinanceDimension10.DerivedSequenceNumber

		DerivedDimensionsCount is a DerivedField
			type is Numeric 2
			LocalDimCount = 20
			if(FinanceCodeBlock.ToAccountingEntity entered)
				LocalDimCount -= 1
			if(FinanceCodeBlock.AccountingUnit entered)
				LocalDimCount -= 1
			if(FinanceCodeBlock.GeneralLedgerChartAccount entered)
				LocalDimCount -= 1
			if(FinanceCodeBlock.Project entered)
				LocalDimCount -= 1
			if(FinanceCodeBlock.FinanceDimension1 entered)
				LocalDimCount -= 1
			if(FinanceCodeBlock.FinanceDimension2 entered)
				LocalDimCount -= 1
			if(FinanceCodeBlock.FinanceDimension3 entered)
				LocalDimCount -= 1
			if(FinanceCodeBlock.FinanceDimension4 entered)
				LocalDimCount -= 1
			if(FinanceCodeBlock.FinanceDimension5 entered)
				LocalDimCount -= 1
			if(FinanceCodeBlock.FinanceDimension6 entered)
				LocalDimCount -= 1
			if(FinanceCodeBlock.FinanceDimension7 entered)
				LocalDimCount -= 1
			if(FinanceCodeBlock.FinanceDimension8 entered)
				LocalDimCount -= 1
			if(FinanceCodeBlock.FinanceDimension9 entered)
				LocalDimCount -= 1
			if(FinanceCodeBlock.FinanceDimension10 entered)
				LocalDimCount -= 1
			return LocalDimCount

	Local Fields
		LocalDimSelected	is Alpha 200
		LocalDimCount		is Numeric 2

	Rule Blocks
		UpdateSelectedDimensions
			LocalDimSelected = DerivedDimensionsSelection
			if (!DimensionsSelectionRel exists)
				invoke Create DimensionsSelection
					invoked.FinanceEnterpriseGroup							= FinanceEnterpriseGroup
					invoked.DimensionsSelection.SelectionType				= "STREXC"
					invoked.DimensionsSelection.DimensionsSelection			= LocalDimSelected
					invoked.DimensionsCount									= DerivedDimensionsCount  
					invoked.Active											= true
					if (FinanceCodeBlock.ToAccountingEntity entered)
						invoked.DimensionColumns.AccountingEntityColumn		= true
					if(FinanceCodeBlock.AccountingUnit entered)
						invoked.DimensionColumns.AccountingUnitColumn		= true
					if(FinanceCodeBlock.GeneralLedgerChartAccount entered)
						invoked.DimensionColumns.AccountColumn				= true
					if(FinanceCodeBlock.Project entered)
						invoked.DimensionColumns.ProjectColumn				= true
					if(FinanceCodeBlock.FinanceDimension1 entered)
						invoked.DimensionColumns.FinanceDimension1Column	= true
					if(FinanceCodeBlock.FinanceDimension2 entered)
						invoked.DimensionColumns.FinanceDimension2Column	= true
					if(FinanceCodeBlock.FinanceDimension3 entered)
						invoked.DimensionColumns.FinanceDimension3Column	= true
					if(FinanceCodeBlock.FinanceDimension4 entered)
						invoked.DimensionColumns.FinanceDimension4Column	= true
					if(FinanceCodeBlock.FinanceDimension5 entered)
						invoked.DimensionColumns.FinanceDimension5Column	= true
					if(FinanceCodeBlock.FinanceDimension6 entered)
						invoked.DimensionColumns.FinanceDimension6Column	= true
					if(FinanceCodeBlock.FinanceDimension7 entered)
						invoked.DimensionColumns.FinanceDimension7Column	= true
					if(FinanceCodeBlock.FinanceDimension8 entered)
						invoked.DimensionColumns.FinanceDimension8Column	= true
					if(FinanceCodeBlock.FinanceDimension9 entered)
						invoked.DimensionColumns.FinanceDimension9Column	= true
					if(FinanceCodeBlock.FinanceDimension10 entered)
						invoked.DimensionColumns.FinanceDimension10Column	= true
			SelectedDimensions	= DimensionsSelectionRel.DimensionsSelection
			AllDimensionCode    = DerivedAllDimensionCode

	Conditions
			
	Relations
		GeneralLedgerCodeRel
			one-to-one relation to GeneralLedgerCode
			Field Mapping uses ByCodeBlockFields
				related.FinanceEnterpriseGroup						= FinanceEnterpriseGroup
				related.FinanceCodeBlock.Ledger						= FinanceCodeBlock.Ledger
				related.FinanceCodeBlock.ToAccountingEntity			= FinanceCodeBlock.ToAccountingEntity
				related.FinanceCodeBlock.AccountingUnit				= FinanceCodeBlock.AccountingUnit
				related.FinanceCodeBlock.GeneralLedgerChartAccount	= FinanceCodeBlock.GeneralLedgerChartAccount
				related.FinanceCodeBlock.Project					= FinanceCodeBlock.Project
				related.DimensionCode								= DimensionCode

		DimensionsSelectionRel
			one-to-one relation to DimensionsSelection
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup						= FinanceEnterpriseGroup
				related.DimensionsSelection.SelectionType			= "STREXC"
				related.DimensionsSelection.DimensionsSelection		= LocalDimSelected
	Sets
		ByCodeBlockFields
			Sort Order
				FinanceEnterpriseGroup
				FinanceCodeBlock.Ledger
				FinanceCodeBlock.ToAccountingEntity
				FinanceCodeBlock.AccountingUnit
				FinanceCodeBlock.GeneralLedgerChartAccount
				FinanceCodeBlock.Project
				DimensionCode


		ByDimensionsSelection
			Sort Order
				FinanceEnterpriseGroup
				SelectedDimensions
				AllDimensionCode
				EnhancedCompare
				FinanceCodeBlock.Ledger
				FinanceCodeBlock.ToAccountingEntity
				FinanceCodeBlock.AccountingUnit
				FinanceCodeBlock.GeneralLedgerChartAccount
				FinanceCodeBlock.Project
				DimensionCode

    Field Rules
    	Description
    		required
		DimensionCode
			force default to FinanceCodeBlock.DimensionCode
		Active
			initial value is true







    Actions
		Create is a Create Action
		    Field Rules
		    	Ledger
		    		required
					FinanceCodeBlock.Ledger	= Ledger
					DimensionCode			= FinanceCodeBlock.DimensionCode
					constraint (!GeneralLedgerCodeRel exists)
						"GlobalLedgerFinanceStructureRecordAlreadyExists"

				FinanceCodeBlock
					required

			Entrance Rules
				include UpdateSelectedDimensions
					
		Update is an Update Action
		    Field Rules
				FinanceCodeBlock
					cannot be changed

		Delete is a Delete Action
