AssetCapitalTransaction is a BusinessClass
	owned by am
	prefix is ACPT
	default label is "AssetCapitalTransaction"

	Ontology
		symbolic key is AssetCapitalTransaction


	Patterns
		implements InlineUserFields
			size is 1000	
		enable explicit context override

	Persistent Fields
		FinanceEnterpriseGroup
		JournalizeGroup
			disable Auditing
		AccountingEntity
        Status							is Numeric 1
            States
                Unreleased				value is 0
                Released	   			value is 1
                NotToBePosted			value is 8
                History					value is 9
        	disable Auditing
		PostingDate
		ControlDocumentNumber			is Alpha up to 30
		FinanceCodeBlock				is a TransactionCodeBlock
		DimensionCode
		OrganizationKeyFields			is Alpha 75
    	System							is a GeneralLedgerSystemCode
    	JournalCode						is AlphaUpper 6
		GeneralLedgerEvent
			default label is "GlobalLedgerEvent"		
        TransactionDate					is an ExchangeDate
        CurrencyCode					is a FromCurrency
        TransactionAmount				is a CurrencyAmount 
		ReportCurrencyAmount			is a FinanceCurrencyAmount
		AutoReverse						is Boolean
		Resource						is an Employee
			sql name is "FinanceResource"
		VendorGroupAndVendor 			is a GlonlyVendorGroupAndVendor
        Reference
		Description						is Alpha up to 60
		DocumentNumber					is Alpha up to 30
        UnitsAmount						
		APPaid							is AlphaUpper 1
			States
				EligibleForBilling      value is blank
				HoldForBilling          value is "H" 
		RelatedJournalTransaction		is BusinessObjectReference
			disable Auditing
		OriginatingTransaction			is BusinessObjectReference
        BaseZoneAccountingUnit			is a AccountingUnit
        BaseZoneDimension1				is a FinanceDimension1
		ZoneSystemKeyFields				is Alpha 45
        ZoneAccountingUnit				is a AccountingUnit
        	context of FinanceCodeBlock.ToAccountingEntity
        ZoneDimension1					is a FinanceDimension1
		ZoneFields						is Alpha 40
		PostingDateJournalCodeKey		is AlphaUpper 14
		PrimaryLedger					is a Ledger
		Billed							is Numeric 1
            States
                Unprocessed				value is 0
                Invoiced				value is 1
                Processed				value is 3
                Distributed				value is 4
                Hold					value is 5
 		RevenueRecognized				is Numeric 1
            States
                Unprocessed				value is 0
                Processed				value is 1
                Draft					value is 2
                Hold					value is 3
 		Capitalize						is Numeric 1
			States
				Unprocessed 			value is 0
				Processed				value is 1
				Hold					value is 2
		LaborDistribution				is Numeric 1
			States
				Unprocessed				value is 0
				Processed				value is 1
				Distributed				value is 2
		OriginalLaborTransaction		is like GLTransactionDetail
		OriginatingTransactionPeriod	is a GeneralLedgerCalendarPeriod
		OriginatingTransactionUniqueID	is UniqueID	
		DrillBackLink					is Alpha up to 500
		IndirectBurden					is Numeric 1
			States
				Unprocessed				value is 0
				Draft					value is 1
				Processed				value is 2
		CreatedByFES						is Boolean
			protected
		FESManuallyUpdated					is Boolean
			protected
		GLTObjectId						is an ObjId
		HROrganizationUnit				is Numeric size 6
			default label is "OrganizationUnit"		
		PayCode							is AlphaUpper size 20
		Job 							is Numeric size 9
		Position						is Numeric size 9
		MigStatus
		ColumnarReplicated				is Boolean
			disable Auditing
		GLTransactionDetail
			delete ignored
		Capitalized						is Boolean
		ErrorMessage					is Alpha up to 200
		AssetInterfaceOptions
			default label is "ProjectAssetInterfaceControl"

	Context Fields
		ContextAssetInterfaceOptions	is a AssetInterfaceOptions

	Local Fields
		LocalSystemAccount				is a SystemAccount
		LocalSummaryProject 			is a Project

	Derived Fields
		DerivedPostingDateJournalCodeKey is a StringField
			type is AlphaUpper 14
			restricted
			PostingDate
			JournalCode
		InterEntityPayablesAccount			is a DerivedField
			type is like GeneralLedgerChartAccount
			restricted
			LocalSystemAccount = SystemAccount.InterEntityPayables 
			if (SystemAccountRel exists)
				return first SystemAccountRel.GeneralLedgerChartAccount
			else
				LocalSystemAccount = SystemAccount.InterEntityPayablesAndReceivables 
				return first SystemAccountRel.GeneralLedgerChartAccount
		InterEntityReceivablesAccount		is a DerivedField
			type is like GeneralLedgerChartAccount
			restricted
			LocalSystemAccount = SystemAccount.InterEntityReceivables 
			if (SystemAccountRel exists)
				return first SystemAccountRel.GeneralLedgerChartAccount
			else
				LocalSystemAccount = SystemAccount.InterEntityPayablesAndReceivables 
				return first SystemAccountRel.GeneralLedgerChartAccount
		NewJournalDescription				is a DerivedField
			type is like Description
			restricted
			if (OriginatingTransactionUniqueID entered
			and SystemCodeFromJournalizeGroup	= "RJ")
				if (RecurringJournalTransactionRel exists)
					return RecurringJournalTransactionRel.RecurringJournalDescription
				else
					return RecurringJournalBridgeRel.RecurringJournalDescription
			else
				return DerivedJournalDescription
		SystemCodeFromJournalizeGroup		is a DerivedField
			type is Alpha 2
			restricted
			return JournalizeGroup[1:2] 
		DerivedJournalDescription			is a MessageField
			restricted
			"JournalCreatedByRunGroup<JournalizeGroup>"
		ZoneSystemKeyString					is a StringField
			type is Alpha 45
			restricted
			System
			":"
			BaseZoneAccountingUnit
			":"
			BaseZoneDimension1
		ZoneFieldsString					is a StringField
			type is Alpha 40
			restricted
			ZoneAccountingUnit
			":"
			ZoneDimension1
		DerivedFunctionalAmount				is a DerivedField
			type is like InternationalAmount
				precision is FinanceCodeBlock.ToAccountingEntity.FunctionalCurrency.NumberOfDecimals
			if (AccountingEntity		= FinanceCodeBlock.ToAccountingEntity)
        		return ReportCurrencyAmount.FunctionalAmount.EnteredCurrencyAmount
		    else
        		return ReportCurrencyAmount.ToFunctionalAmount.EnteredCurrencyAmount
		Debit is a DerivedField
			type is like InternationalAmount
				precision is FinanceCodeBlock.ToAccountingEntity.FunctionalCurrency.NumberOfDecimals
			if (DerivedFunctionalAmount > 0)
        		return DerivedFunctionalAmount
		    else
        		return blank
		Credit is a DerivedField
			type is like InternationalAmount
				precision is FinanceCodeBlock.ToAccountingEntity.FunctionalCurrency.NumberOfDecimals
			if (DerivedFunctionalAmount < 0)
        		return DerivedFunctionalAmount
		    else
        		return blank
		ColumnarProjectAmount is a DerivedField
			type is like InternationalAmount
				precision is FinanceCodeBlock.Project.Currency.NumberOfDecimals
       		return ReportCurrencyAmount.ProjectAmount.EnteredCurrencyAmount
		DerivedAlternateAmount				is a DerivedField
			type is like InternationalAmount
				precision is FinanceCodeBlock.ToAccountingEntity.AlternateCurrency.NumberOfDecimals
			if (AccountingEntity		= FinanceCodeBlock.ToAccountingEntity)
        		return ReportCurrencyAmount.AlternateAmount.EnteredCurrencyAmount
		    else
        		return ReportCurrencyAmount.ToAlternateAmount.EnteredCurrencyAmount
		DerivedAlternateAmount2				is a DerivedField
			type is like InternationalAmount
				precision is FinanceCodeBlock.ToAccountingEntity.AlternateCurrency2.NumberOfDecimals
			if (AccountingEntity		= FinanceCodeBlock.ToAccountingEntity)
        		return ReportCurrencyAmount.AlternateAmount2.EnteredCurrencyAmount
		    else
        		return ReportCurrencyAmount.ToAlternateAmount2.EnteredCurrencyAmount
		DerivedAlternateAmount3				is a DerivedField
			type is like InternationalAmount
				precision is FinanceCodeBlock.ToAccountingEntity.AlternateCurrency3.NumberOfDecimals
			if (AccountingEntity		= FinanceCodeBlock.ToAccountingEntity)
        		return ReportCurrencyAmount.AlternateAmount3.EnteredCurrencyAmount
		    else
        		return ReportCurrencyAmount.ToAlternateAmount3.EnteredCurrencyAmount
		DerivedFunctionalCurrencyRate		is a DerivedField
			type is like CurrencyExchangeRate
			if (AccountingEntity		= FinanceCodeBlock.ToAccountingEntity)
        		return ReportCurrencyAmount.FunctionalAmount.EnteredCurrencyRate
		    else
        		return ReportCurrencyAmount.ToFunctionalAmount.EnteredCurrencyRate
		DerivedAlternateCurrencyRate		is a DerivedField
			type is like CurrencyExchangeRate
			if (AccountingEntity		= FinanceCodeBlock.ToAccountingEntity)
        		return ReportCurrencyAmount.AlternateAmount.EnteredCurrencyRate
		    else
        		return ReportCurrencyAmount.ToAlternateAmount.EnteredCurrencyRate

		DerivedAlternate2CurrencyRate		is a DerivedField
			type is like CurrencyExchangeRate
			if (AccountingEntity		= FinanceCodeBlock.ToAccountingEntity)
        		return ReportCurrencyAmount.AlternateAmount2.EnteredCurrencyRate
		    else
        		return ReportCurrencyAmount.ToAlternateAmount2.EnteredCurrencyRate
		DerivedAlternate3CurrencyRate		is a DerivedField
			type is like CurrencyExchangeRate
			if (AccountingEntity		= FinanceCodeBlock.ToAccountingEntity)
        		return ReportCurrencyAmount.AlternateAmount3.EnteredCurrencyRate
		    else
        		return ReportCurrencyAmount.ToAlternateAmount3.EnteredCurrencyRate
        		
#ifdef module ap
		DerivedPOUniqueID is a DerivedField
			type is like UniqueID
			if (FromRNIUpdate)
				return OriginatingTransaction(PurchaseOrderLineDistributionDetail).PurchaseOrderLineDistribution.UniqueID
				
		DerivedEntityYearPeriod			is a DerivedField
			type is Year
			restricted
			return EntityLedgerCurrentPeriodRel.GeneralLedgerClosePeriod.GeneralLedgerCloseYear		
	
		DerivedCompany is a DerivedField
			type is like Company
			if (OriginatingTransaction.BusinessClassName = "PayablesInvoiceDistribution")
				return OriginatingTransaction(PayablesInvoiceDistribution).PayablesInvoice.Company
			else
				if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
					return OriginatingTransaction(InventoryTransactionLineDistribution).Company
				else
					if (OriginatingTransaction.BusinessClassName = "PurchaseOrderLineDistributionDetail")
						return OriginatingTransaction(PurchaseOrderLineDistributionDetail).PurchaseOrder.Company
					else
						return ""

		DerivedAPInvoice is a DerivedField
			type is like Invoice
			if (OriginatingTransaction.BusinessClassName = "PayablesInvoiceDistribution")
				return OriginatingTransaction(PayablesInvoiceDistribution).Invoice
			return ""
			
		DerivedAPPayablesInvoice is a DerivedField
			type is like Invoice
			if (OriginatingTransaction.BusinessClassName = "PayablesInvoiceDistribution")
				return OriginatingTransaction(PayablesInvoiceDistribution).PayablesInvoice
			return ""
			
		DerivedAPInvoiceType is a DerivedField
			type is like MatchProcessType
			if (OriginatingTransaction.BusinessClassName = "PayablesInvoiceDistribution")
				return OriginatingTransaction(PayablesInvoiceDistribution).DerivedInvoiceType
		
		DerivedAPPurchOrder is a DerivedField
			type is like PurchaseOrder
			if (OriginatingTransaction.BusinessClassName = "PayablesInvoiceDistribution")
				return OriginatingTransaction(PayablesInvoiceDistribution).PurchaseOrder
			else
				if (OriginatingTransaction.BusinessClassName = "PurchaseOrderLineDistributionDetail")
					return OriginatingTransaction(PurchaseOrderLineDistributionDetail).PurchaseOrder
				else
					if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
						return OriginatingTransaction(InventoryTransactionLineDistribution).DerivedPurchaseOrder
					else
						if (OriginatingTransaction.BusinessClassName = "VendorReturnLineDistribution")
							return OriginatingTransaction(VendorReturnLineDistribution).VendorReturnLine.OriginalPurchaseOrder
						else
							return ""
						
		DerivedInventoryLocation is a DerivedField
			type is like InventoryLocation
			if (OriginatingTransaction.BusinessClassName = "PayablesInvoiceDistribution")
				return OriginatingTransaction(PayablesInvoiceDistribution).PayablesInvoice.Location
			else
				if (OriginatingTransaction.BusinessClassName = "PurchaseOrderLineDistributionDetail")
					return OriginatingTransaction(PurchaseOrderLineDistributionDetail).PurchaseOrder.ShipToLocation
				else
					if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
						return OriginatingTransaction(InventoryTransactionLineDistribution).DerivedLocation
					else
						return ""
						
		DerivedGLTranEntityYearPeriod is a DerivedField
			type is like GeneralLedgerCalendarPeriod
			return RelatedJournalTransaction(GeneralLedgerTransaction).GeneralLedgerTransaction.GeneralLedgerCalendarPeriod
			
		DerivedAPVendor is a DerivedField
			type is MessageField
			if (OriginatingTransaction.BusinessClassName = "PayablesInvoiceDistribution")
				return OriginatingTransaction(PayablesInvoiceDistribution).DerivedVendorAndName
			else
				if (OriginatingTransaction.BusinessClassName = "PurchaseOrderLineDistributionDetail")
					return OriginatingTransaction(PurchaseOrderLineDistributionDetail).DerivedVendorAndName
				else
					if (OriginatingTransaction.BusinessClassName = "VendorReturnLineDistribution")
						return OriginatingTransaction(VendorReturnLineDistribution).VendorReturnLine.Vendor
					else
						return ""

		DerivedVendorOnly is a DerivedField
			type is like Vendor
			if (OriginatingTransaction.BusinessClassName = "PayablesInvoiceDistribution")
				return OriginatingTransaction(PayablesInvoiceDistribution).Vendor
			else
				if (OriginatingTransaction.BusinessClassName = "PurchaseOrderLineDistributionDetail")
					return OriginatingTransaction(PurchaseOrderLineDistributionDetail).PurchaseOrder.Vendor
				else
					if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
						return OriginatingTransaction(InventoryTransactionLineDistribution).DerivedVendor
					else
						if (OriginatingTransaction.BusinessClassName = "VendorReturnLineDistribution")
							return OriginatingTransaction(VendorReturnLineDistribution).VendorReturnLine.Vendor
						else
							return ""

		DerivedVendorGroupOnly is a DerivedField
			type is like VendorGroup
			if (OriginatingTransaction.BusinessClassName = "PayablesInvoiceDistribution")
				return OriginatingTransaction(PayablesInvoiceDistribution).Vendor.VendorGroup
			else
				if (OriginatingTransaction.BusinessClassName = "PurchaseOrderLineDistributionDetail")
					return OriginatingTransaction(PurchaseOrderLineDistributionDetail).PurchaseOrder.Vendor.VendorGroup
				else
					if (OriginatingTransaction.BusinessClassName = "VendorReturnLineDistribution")
						return OriginatingTransaction(VendorReturnLineDistribution).VendorReturnLine.Vendor.VendorGroup
					else
						return ""

		DerivedICDocumentType is a DerivedField
			type is like InventoryDocumentType
			if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
				return OriginatingTransaction(InventoryTransactionLineDistribution).DerivedDocumentType
			return ""
			
		DerivedRequestingLocation is a DerivedField
			type is like InventoryLocation
			if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
				if (OriginatingTransaction(InventoryTransactionLineDistribution).DerivedRequestingLocation entered)
					return OriginatingTransaction(InventoryTransactionLineDistribution).DerivedRequestingLocation
				else
					return OriginatingTransaction(InventoryTransactionLineDistribution).DerivedLocation
			else
				return ""
		
		DerivedRequisition		is a DerivedField
			type is like Requisition
			if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
				return OriginatingTransaction(InventoryTransactionLineDistribution).DerivedRequisition
			return ""
			
		DerivedRequisitionLine		is a DerivedField
			type is like RequisitionLine
			if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
				return OriginatingTransaction(InventoryTransactionLineDistribution).DerivedRequisitionLine
			return ""
			
		DerivedRequester			is a DerivedField
			type is like Requester
			if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
				return OriginatingTransaction(InventoryTransactionLineDistribution).DerivedRequester
			return ""
			
		DerivedICInventoryTransaction is a DerivedField
			type is like InventoryTransaction
			if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
				return OriginatingTransaction(InventoryTransactionLineDistribution).InventoryTransaction
			return ""
		DerivedAPItem is a DerivedField
			type is like Item
			if (OriginatingTransaction.BusinessClassName = "PayablesInvoiceDistribution")
				return OriginatingTransaction(PayablesInvoiceDistribution).DerivedItem
			else
				if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
					return OriginatingTransaction(InventoryTransactionLineDistribution).DerivedItem
				else
					if (OriginatingTransaction.BusinessClassName = "PurchaseOrderLineDistributionDetail")
						return OriginatingTransaction(PurchaseOrderLineDistributionDetail).DerivedItem
					else
						if (OriginatingTransaction.BusinessClassName = "VendorReturnLineDistribution")
							return OriginatingTransaction(VendorReturnLineDistribution).VendorReturnLine.Item
						else
							return ""
						
		DerivedAPItemType is a DerivedField
			type is like Item
			if (OriginatingTransaction.BusinessClassName = "PayablesInvoiceDistribution")
				return OriginatingTransaction(PayablesInvoiceDistribution).DerivedItemType
			else
				if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
					return "I"	
				else
					if (OriginatingTransaction.BusinessClassName = "PurchaseOrderLineDistributionDetail")
						return ""	
					else
						if (OriginatingTransaction.BusinessClassName = "VendorReturnLineDistribution")
							return OriginatingTransaction(VendorReturnLineDistribution).VendorReturnLine.ItemType
						else
							return ""
						
		DerivedAPItemDesc is a DerivedField
			type is like Description
			if (OriginatingTransaction.BusinessClassName = "PayablesInvoiceDistribution")
				return OriginatingTransaction(PayablesInvoiceDistribution).DerivedItemDescription
			else
				if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
					return OriginatingTransaction(InventoryTransactionLineDistribution).DerivedItemDescription
				else
					if (OriginatingTransaction.BusinessClassName = "PurchaseOrderLineDistributionDetail")
						return OriginatingTransaction(PurchaseOrderLineDistributionDetail).DerivedItemDescription
					else
						if (OriginatingTransaction.BusinessClassName = "VendorReturnLineDistribution")
							return OriginatingTransaction(VendorReturnLineDistribution).VendorReturnLine.Description
						else
							return ""
						
		DerivedAPTaxCode is a DerivedField
			type is like TaxCode
			if (OriginatingTransaction.BusinessClassName = "PayablesInvoiceDistribution")
				return OriginatingTransaction(PayablesInvoiceDistribution).TaxCode
			else
				if (OriginatingTransaction.BusinessClassName = "PurchaseOrderLineDistributionDetail")
					return OriginatingTransaction(PurchaseOrderLineDistributionDetail).DerivedTaxCode
				else
					if (OriginatingTransaction.BusinessClassName = "VendorReturnLineDistribution")
						return OriginatingTransaction(VendorReturnLineDistribution).VendorReturnLine.TaxCode
					else
						return ""
					
		DerivedAddOnCharge is a DerivedField
			type is like AddOnCharge
			if (OriginatingTransaction.BusinessClassName = "PayablesInvoiceDistribution")
				return OriginatingTransaction(PayablesInvoiceDistribution).AddOnCharge
			return ""

		DerivedAPQuantity is a DerivedField
			type is like Quantity
			if (OriginatingTransaction.BusinessClassName = "PayablesInvoiceDistribution")
				return OriginatingTransaction(PayablesInvoiceDistribution).DerivedQuantity
			else
				if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
					return OriginatingTransaction(InventoryTransactionLineDistribution).DerivedReceivedQuantity		
				else
					if (OriginatingTransaction.BusinessClassName = "PurchaseOrderLineDistributionDetail")
						return OriginatingTransaction(PurchaseOrderLineDistributionDetail).DerivedOrderedQuantity
					else
						if (OriginatingTransaction.BusinessClassName = "VendorReturnLineDistribution")
							return OriginatingTransaction(VendorReturnLineDistribution).VendorReturnLine.ReturnQuantity
						else
							return ""

		DerivedReceivedQuantity is a DerivedField
			type is like Quantity
			if (OriginatingTransaction.BusinessClassName = "PurchaseOrderLineDistributionDetail")
				return OriginatingTransaction(PurchaseOrderLineDistributionDetail).DerivedReceivedQuantity
			else
				if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
					return OriginatingTransaction(InventoryTransactionLineDistribution).DerivedReceivedQuantity	
				else
					return ""
				
		DerivedAPUom is a DerivedField
			type is like UnitOfMeasure
			if (OriginatingTransaction.BusinessClassName = "PayablesInvoiceDistribution")
				return OriginatingTransaction(PayablesInvoiceDistribution).DerivedUOM
			else
				if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
					return OriginatingTransaction(InventoryTransactionLineDistribution).DerivedUOM			
				else
					if (OriginatingTransaction.BusinessClassName = "PurchaseOrderLineDistributionDetail")
						return OriginatingTransaction(PurchaseOrderLineDistributionDetail).DerivedUOM
					else
						if (OriginatingTransaction.BusinessClassName = "VendorReturnLineDistribution")
							return OriginatingTransaction(VendorReturnLineDistribution).VendorReturnLine.EnteredUOM
						else
							return ""
						
		DerivedAPUnitCost is a DerivedField
			type is like UnitCost
			if (OriginatingTransaction.BusinessClassName = "PayablesInvoiceDistribution")
				return OriginatingTransaction(PayablesInvoiceDistribution).DerivedUnitCost	
			else
				if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
					return OriginatingTransaction(InventoryTransactionLineDistribution).DerivedLineUnitCost					
				else
					if (OriginatingTransaction.BusinessClassName = "PurchaseOrderLineDistributionDetail")
						return OriginatingTransaction(PurchaseOrderLineDistributionDetail).DerivedUnitCost
					else
						if (OriginatingTransaction.BusinessClassName = "VendorReturnLineDistribution")
							return OriginatingTransaction(VendorReturnLineDistribution).VendorReturnLine.UnitCost
						else
							return ""
						
		DerivedOrigICDocument is a DerivedField
			type is Numeric 10
			if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
				return OriginatingTransaction(InventoryTransactionLineDistribution).OriginatingTransactionDocument
			return ""
		DerivedOrigICLine is a DerivedField
			type is Numeric 6
			if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
				return OriginatingTransaction(InventoryTransactionLineDistribution).OriginatingTransactionLine
			return ""
		DerivedICPostingType is a DerivedField
			type is like PostingType
			if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
				return OriginatingTransaction(InventoryTransactionLineDistribution).PostingType
			return ""

		DerivedLineNumber is a DerivedField
			type is like LineNumber
			if (OriginatingTransaction.BusinessClassName = "PurchaseOrderLineDistributionDetail")
				return OriginatingTransaction(PurchaseOrderLineDistributionDetail).DerivedLineNumber
			else
				if (OriginatingTransaction.BusinessClassName = "VendorReturnLineDistribution")
					return OriginatingTransaction(VendorReturnLineDistribution).VendorReturnLine.OriginalPurchaseOrderLine
				else
					if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
						return OriginatingTransaction(InventoryTransactionLineDistribution).OriginatingTransactionLine
					else
						if (OriginatingTransaction.BusinessClassName = "PayablesInvoiceDistribution")
							return OriginatingTransaction(PayablesInvoiceDistribution).PurchaseOrderLine
						else
							return ""

		DerivedBuyer is a DerivedField
			type is like Buyer
			if (OriginatingTransaction.BusinessClassName = "PurchaseOrderLineDistributionDetail")
				return OriginatingTransaction(PurchaseOrderLineDistributionDetail).DerivedBuyer
			else
				if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
					return OriginatingTransaction(InventoryTransactionLineDistribution).DerivedBuyer
				else
					if (OriginatingTransaction.BusinessClassName = "PayablesInvoiceDistribution")
							return OriginatingTransaction(PayablesInvoiceDistribution).PurchaseOrder.Buyer
					else
						if (OriginatingTransaction.BusinessClassName = "VendorReturnLineDistribution")
							return OriginatingTransaction(VendorReturnLineDistribution).VendorReturnLine.OriginalPurchaseOrder.Buyer
						else
							return ""

		DerivedLineAmount is a DerivedField
			type is like CurrencyAmount
			if (OriginatingTransaction.BusinessClassName = "PayablesInvoiceDistribution")
				return OriginatingTransaction(PayablesInvoiceDistribution).DistributionAmount.CurrencyAmount
			else
				if (OriginatingTransaction.BusinessClassName = "PurchaseOrderLineDistributionDetail")
					return OriginatingTransaction(PurchaseOrderLineDistributionDetail).DerivedExtendedAmount
				else
					if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
						return OriginatingTransaction(InventoryTransactionLineDistribution).DerivedExtendedAmount
					else
						return ""
								

		DerivedContextMessageEntityType is a DerivedField
			type is MessageField
			restricted
			if (OriginatingTransaction.BusinessClassName = "AssetTransaction")
				return OriginatingTransaction(AssetTransaction).Asset.ContextMessageEntityType
			else
			if (OriginatingTransaction.BusinessClassName = "PayablesInvoiceDistribution")
				return OriginatingTransaction(PayablesInvoiceDistribution).PayablesInvoice.ContextMessageEntityType
			else 
			if (OriginatingTransaction.BusinessClassName = "ReceivableGLDistribution")
				return OriginatingTransaction(ReceivableGLDistribution).ReceivableInvoiceRel.ContextMessageEntityType
			else
			if (OriginatingTransaction.BusinessClassName = "BillingGLDistribution")
				return OriginatingTransaction(BillingGLDistribution).BillingInvoice.ContextMessageEntityType
			else
			if (OriginatingTransaction.BusinessClassName = "CashLedgerGLDistribution")
				return OriginatingTransaction(CashLedgerGLDistribution).CashCode.ContextMessageEntityType
			else
			if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
				return OriginatingTransaction(InventoryTransactionLineDistribution).InventoryTransaction.ContextMessageEntityType
			else
			if (OriginatingTransaction.BusinessClassName = "GeneralLedgerTransaction")
				return OriginatingTransaction(GeneralLedgerTransaction).GeneralLedgerJournalControl.ContextMessageEntityType
				
		DerivedContextMessageText is a DerivedField
			type is MessageField
			restricted
			if (OriginatingTransaction.BusinessClassName = "AssetTransaction")
				return OriginatingTransaction(AssetTransaction).Asset.ContextMessageText
			else
			if (OriginatingTransaction.BusinessClassName = "PayablesInvoiceDistribution")
				return OriginatingTransaction(PayablesInvoiceDistribution).PayablesInvoice.ContextMessageText
			else 
			if (OriginatingTransaction.BusinessClassName = "ReceivableGLDistribution")
				return OriginatingTransaction(ReceivableGLDistribution).ReceivableInvoiceRel.ContextMessageText
			else
			if (OriginatingTransaction.BusinessClassName = "BillingGLDistribution")
				return OriginatingTransaction(BillingGLDistribution).BillingInvoice.ContextMessageText
			else
			if (OriginatingTransaction.BusinessClassName = "CashLedgerGLDistribution")
				return OriginatingTransaction(CashLedgerGLDistribution).CashCode.ContextMessageText
			else
			if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
				return OriginatingTransaction(InventoryTransactionLineDistribution).InventoryTransactionLine.ContextMessageText
			else
			if (OriginatingTransaction.BusinessClassName = "GeneralLedgerTransaction")
				return OriginatingTransaction(GeneralLedgerTransaction).GeneralLedgerJournalControl.ContextMessageText
				

		DerivedId1 is a DerivedField
			type is Alpha 10
			if (OriginatingTransaction.BusinessClassName = "AssetTransaction")
				return OriginatingTransaction(AssetTransaction).FinanceEnterpriseGroup
			else
			if (OriginatingTransaction.BusinessClassName = "PayablesInvoiceDistribution")
				return OriginatingTransaction(PayablesInvoiceDistribution).Company
			else 
			if (OriginatingTransaction.BusinessClassName = "ReceivableGLDistribution")
				return OriginatingTransaction(ReceivableGLDistribution).ReceivableInvoiceRel.Company
			else
			if (OriginatingTransaction.BusinessClassName = "BillingGLDistribution")
				return OriginatingTransaction(BillingGLDistribution).Company
			else
			if (OriginatingTransaction.BusinessClassName = "CashLedgerGLDistribution")
				return OriginatingTransaction(CashLedgerGLDistribution).CashManagementGroup
			else
			if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
				return OriginatingTransaction(InventoryTransactionLineDistribution).InventoryLocation
			else
			if (OriginatingTransaction.BusinessClassName = "GeneralLedgerTransaction")
				return OriginatingTransaction(GeneralLedgerTransaction).FinanceEnterpriseGroup
				
		DerivedId2 is a DerivedField
			type is Alpha 20
			if (OriginatingTransaction.BusinessClassName = "AssetTransaction")
				return OriginatingTransaction(AssetTransaction).Asset
			else
			if (OriginatingTransaction.BusinessClassName = "PayablesInvoiceDistribution")
				return OriginatingTransaction(PayablesInvoiceDistribution).PayablesInvoice
			else 
			if (OriginatingTransaction.BusinessClassName = "ReceivableGLDistribution")
				return OriginatingTransaction(ReceivableGLDistribution).ReceivableInvoiceRel.ReceivableInvoiceType
			else
			if (OriginatingTransaction.BusinessClassName = "BillingGLDistribution")
				return OriginatingTransaction(BillingGLDistribution).BillingInvoice.InvoicePrefix
			else
			if (OriginatingTransaction.BusinessClassName = "CashLedgerGLDistribution")
				return OriginatingTransaction(CashLedgerGLDistribution).CashCode
			else
			if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
				return OriginatingTransaction(InventoryTransactionLineDistribution).InventoryTransaction
			else
			if (OriginatingTransaction.BusinessClassName = "GeneralLedgerTransaction")
				return JournalizeGroup
				
		DerivedId3 is a DerivedField
			type is Alpha 20
			if (OriginatingTransaction.BusinessClassName = "PayablesInvoiceDistribution")
				return OriginatingTransaction(PayablesInvoiceDistribution).Vendor
			else 
			if (OriginatingTransaction.BusinessClassName = "ReceivableGLDistribution")
				return OriginatingTransaction(ReceivableGLDistribution).ReceivableInvoiceRel.ReceivableInvoice
			else
			if (OriginatingTransaction.BusinessClassName = "BillingGLDistribution")
				return OriginatingTransaction(BillingGLDistribution).BillingInvoice.InvoiceNumber
			else
			if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
				return OriginatingTransaction(InventoryTransactionLineDistribution).TransactionSystemCode
			else
			if (OriginatingTransaction.BusinessClassName = "GeneralLedgerTransaction")
				return OriginatingTransaction(GeneralLedgerTransaction).AccountingEntity
			else
				return blank
		
		DerivedId4 is a DerivedField
			type is Alpha 22
			if (OriginatingTransaction.BusinessClassName = "PayablesInvoiceDistribution")
				return OriginatingTransaction(PayablesInvoiceDistribution).Invoice
			else
			if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
				return OriginatingTransaction(InventoryTransactionLineDistribution).InventoryTransactionLine.WarehouseShipment
			else
			if (OriginatingTransaction.BusinessClassName = "GeneralLedgerTransaction")
				return OriginatingTransaction(GeneralLedgerTransaction).GeneralLedgerJournalControl.PostingDate
			else
				return blank
				
		DerivedId5 is a DerivedField
			type is Alpha 6
			if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
				return OriginatingTransaction(InventoryTransactionLineDistribution).InventoryTransactionLine.LineNumber
			else
				return blank
				
		DerivedId6 is a DerivedField
			type is Alpha 3
			if (OriginatingTransaction.BusinessClassName = "InventoryTransactionLineDistribution")
				return OriginatingTransaction(InventoryTransactionLineDistribution).InventoryTransactionLine.ComponentSequence
			else
				return blank
#endif
#ifdef module po
		DerivedPOLine is a DerivedField
			type is like PurchaseOrderLine
			if (OriginatingTransaction.BusinessClassName = "PurchaseOrderLineDistributionDetail")
				return OriginatingTransaction(PurchaseOrderLineDistributionDetail).PurchaseOrderLine
			else
				return ""
		
		DerivedPurchaseLoc is a DerivedField
			type is like PurchaseFromLocation
			if (OriginatingTransaction.BusinessClassName = "PurchaseOrderLineDistributionDetail")
				return OriginatingTransaction(PurchaseOrderLineDistributionDetail).PurchaseOrderLine.PurchaseFromLocation									
			else
				return ""
		
		DerivedRNIQuantity is a DerivedField
			type is like Quantity
			if (OriginatingTransaction.BusinessClassName = "PurchaseOrderLineDistributionDetail")
				return OriginatingTransaction(PurchaseOrderLineDistributionDetail).PurchaseOrderLine.DerivedReceivedNotInvoicedQuantity
			else
				return ""
				
		DerivedWorkOrderNum is a DerivedField
			type is Alpha 30
			if (OriginatingTransaction.BusinessClassName = "PurchaseOrderLineDistributionDetail")
				return OriginatingTransaction(PurchaseOrderLineDistributionDetail).PurchaseOrderLine.EAMWorkOrder
			else
				return ""
				
		DerivedProjectNum is a DerivedField
			type is Alpha 20
			if (OriginatingTransaction.BusinessClassName = "PurchaseOrderLineDistributionDetail")
				return OriginatingTransaction(PurchaseOrderLineDistributionDetail).PurchaseOrderLine.EAMWorkOrder.ProjectID			
			else
				return ""
#endif

	Relations
		EntityLedgerCurrentPeriodRel
			one-to-one relation to EntityLedgerPeriod
			Field Mapping uses ByEntityLedger
				related.FinanceEnterpriseGroup		= FinanceEnterpriseGroup
				related.AccountingEntity			= FinanceCodeBlock.ToAccountingEntity
				related.Ledger						= FinanceCodeBlock.Ledger
				related.GeneralLedgerClosePeriod	= FinanceCodeBlock.ToAccountingEntity.CurrentPeriod
		SystemAccountRel
			one-to-many relation to GeneralLedgerChartAccount
			Field Mapping uses BySystemAccount
				related.FinanceEnterpriseGroup				= FinanceEnterpriseGroup
		FinanceDimension1Rel
			one-to-one relation to FinanceDimension1Hierarchy
			Field Mapping uses BySystemDimensionInStructure
				related.FinanceEnterpriseGroup				= FinanceEnterpriseGroup
				related.FinanceDimension1Structure			= FinanceEnterpriseGroup.EnterpriseDim1Structure
		FinanceDimension2Rel
			one-to-one relation to FinanceDimension2Hierarchy
			Field Mapping uses BySystemDimensionInStructure
				related.FinanceEnterpriseGroup				= FinanceEnterpriseGroup
				related.FinanceDimension2Structure			= FinanceEnterpriseGroup.EnterpriseDim2Structure
		FinanceDimension3Rel
			one-to-one relation to FinanceDimension3Hierarchy
			Field Mapping uses BySystemDimensionInStructure
				related.FinanceEnterpriseGroup				= FinanceEnterpriseGroup
				related.FinanceDimension3Structure			= FinanceEnterpriseGroup.EnterpriseDim3Structure
		FinanceDimension4Rel
			one-to-one relation to FinanceDimension4Hierarchy
			Field Mapping uses BySystemDimensionInStructure
				related.FinanceEnterpriseGroup				= FinanceEnterpriseGroup
				related.FinanceDimension4Structure			= FinanceEnterpriseGroup.EnterpriseDim4Structure
		FinanceDimension5Rel
			one-to-one relation to FinanceDimension5Hierarchy
			Field Mapping uses BySystemDimensionInStructure
				related.FinanceEnterpriseGroup				= FinanceEnterpriseGroup
				related.FinanceDimension5Structure			= FinanceEnterpriseGroup.EnterpriseDim5Structure
		FinanceDimension6Rel
			one-to-one relation to FinanceDimension6Hierarchy
			Field Mapping uses BySystemDimensionInStructure
				related.FinanceEnterpriseGroup				= FinanceEnterpriseGroup
				related.FinanceDimension6Structure			= FinanceEnterpriseGroup.EnterpriseDim6Structure
		FinanceDimension7Rel
			one-to-one relation to FinanceDimension7Hierarchy
			Field Mapping uses BySystemDimensionInStructure
				related.FinanceEnterpriseGroup				= FinanceEnterpriseGroup
				related.FinanceDimension7Structure			= FinanceEnterpriseGroup.EnterpriseDim7Structure
		FinanceDimension8Rel
			one-to-one relation to FinanceDimension8Hierarchy
			Field Mapping uses BySystemDimensionInStructure
				related.FinanceEnterpriseGroup				= FinanceEnterpriseGroup
				related.FinanceDimension8Structure			= FinanceEnterpriseGroup.EnterpriseDim8Structure
		FinanceDimension9Rel
			one-to-one relation to FinanceDimension9Hierarchy
			Field Mapping uses BySystemDimensionInStructure
				related.FinanceEnterpriseGroup				= FinanceEnterpriseGroup
				related.FinanceDimension9Structure			= FinanceEnterpriseGroup.EnterpriseDim9Structure
		FinanceDimension10Rel
			one-to-one relation to FinanceDimension10Hierarchy
			Field Mapping uses BySystemDimensionInStructure
				related.FinanceEnterpriseGroup				= FinanceEnterpriseGroup
				related.FinanceDimension10Structure			= FinanceEnterpriseGroup.EnterpriseDim10Structure
		EnterpriseZoneFinanceDimension1Rel
			one-to-one relation to FinanceDimension1Hierarchy
			Field Mapping uses ByEnterpriseZoneDimensionInStructure
				related.FinanceEnterpriseGroup		= FinanceEnterpriseGroup
				related.FinanceDimension1Structure	= FinanceEnterpriseGroup.EnterpriseDim1Structure

		DefaultZoneFinanceDimension1Rel
			one-to-one relation to FinanceDimension1Hierarchy
			Field Mapping uses ByDefaultZoneDimensionInStructure
				related.FinanceEnterpriseGroup		= FinanceEnterpriseGroup
				related.FinanceDimension1Structure	= FinanceEnterpriseGroup.EnterpriseDim1Structure
		GLCommitRel
			one-to-one relation to GLCommit
			Field Mapping uses ByOriginatingTransaction
				related.OriginatingTransaction  = OriginatingTransaction
		RecurringJournalTransactionRel
			one-to-one relation to RecurringJournalTransaction
			Field Mapping uses ByUniqueID
				related.UniqueID		  = OriginatingTransactionUniqueID
		RecurringJournalBridgeRel
			one-to-one relation to RecurringJournalBridge
			Field Mapping uses ByUniqueID
				related.UniqueID		  = OriginatingTransactionUniqueID
		OriginalLaborTransactionRel
			one-to-one relation to GLTransactionDetail
			Field Mapping uses symbolic key
				related.GLTransactionDetail = OriginalLaborTransaction
				
    	ProjectContractInvoiceRevenueRel is a ProjectContractInvoiceLine set
    		Instance Selection
    			where (related.ProjectContractInvoice.InvoiceType.RevenueRecognition
    			and    related.FeeCode not entered)
    			
    	ProjectContractInvoiceBillRel is a ProjectContractInvoiceLine set
    		Instance Selection
    			where (related.ProjectContractInvoice.InvoiceType.Bill
    			and    related.FeeCode not entered)

    	ProjectContractInvoiceRevenueFeesRel is a ProjectContractInvoiceLine set
    		Instance Selection
    			where (related.ProjectContractInvoice.InvoiceType.RevenueRecognition
    			and    related.FeeCode entered)
    			
    	ProjectContractInvoiceBillFeesRel is a ProjectContractInvoiceLine set
    		Instance Selection
    			where (related.ProjectContractInvoice.InvoiceType.Bill
    			and    related.FeeCode entered)

		ProjectContractPartialBillRel is a ProjectContractPartialTransaction set
			Instance Selection
				where (related.RecordType.Bill)

		ProjectContractPartialRevenueRel is a ProjectContractPartialTransaction set
			Instance Selection
				where (related.RecordType.Revenue)

		AccountingEntitySecurityGroupMemberRel
			one-to-one relation to AccountingEntityGroupMember
			Field Mapping uses part of key
				related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
				related.AccountingEntityGroup	= actor.context.AccountingEntitySecurityGroup.FinanceDimensionStructure
				related.AccountingEntity		= AccountingEntity
				
		SystemClosingControlRJRel
			one-to-one relation to SystemClosingControl
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup 		= FinanceEnterpriseGroup
				related.AccountingEntity	 		= AccountingEntity
				related.GeneralLedgerSystemCode		= "RJ"			
				
#ifdef module ap
		GLProcurementExpenseRel
			one-to-one relation to GLProcurementExpense
			Field Mapping uses ByGLTranSource
				related.GLTranSource			= reference to this instance
#endif
		ProjectFundingSourceRel
			one-to-one relation to ProjectFundingSource
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
				related.ProjectContract			= FinanceCodeBlock.Project.ParentDisplayContractRel.Project
				related.FinanceDimension2		= FinanceCodeBlock.FinanceDimension2

		ProjectWithinSummaryRel
			one-to-one relation to ProjectShadow
    		Field Mapping uses BySummaryProject
				related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
    			related.SummaryProject			= LocalSummaryProject
				related.Project					= FinanceCodeBlock.Project

		ProjectAssetInterfaceRunGroupRel
			one-to-many relation to ProjectAssetInterface
			Field Mapping uses ByRunGroup
				related.FinanceEnterpriseGroup 	= FinanceEnterpriseGroup
				related.AssetInterfaceOptions	= ContextAssetInterfaceOptions

		GLTransactionDetailRel
			one-to-one relation to GLTransactionDetail
			Field Mapping uses symbolic key
				related.GLTransactionDetail 		= GLTransactionDetail

	Conditions

#ifdef module ap
		FromRNIUpdate
			when (System = "PO"
			and   GeneralLedgerEvent = "PO"
			and   Reference = "ReceivedNotInvoiced")

		MatchesValidSystems
			when (System = "AP"
			or    System = "IC"
			or    System = "PO")

		NotSystemTransactionEvents
			when (!GeneralLedgerEvent = "CB"
			and   !GeneralLedgerEvent = "AB"
			and   !GeneralLedgerEvent = "JE"
			and   !GeneralLedgerEvent = "ZB"
			and   !GeneralLedgerEvent = "ES")
#endif
 		UseOriginatingTransaction
 			when (OriginatingTransaction entered
 			and   !DrillBackLink entered)
 		UseDrillBackLink
 			when (DrillBackLink entered)
		GLProcessingSystems
			restricted
			when (System 	= "GL"
			or    System	= "RJ"
			or    System 	= "CA")
		ExpenseReportSystems
			restricted
			when ((System = "AP"
			or     System = "IC"
			or     System = "PO")
			and	  (!SystemTransactionEvents)
			and   (!OriginatingTransaction.BusinessClassName = "GLTransactionDetail"))
		SystemTransactionEvents
			restricted
			when (GeneralLedgerEvent = "CB"
			or    GeneralLedgerEvent = "AB"
			or    GeneralLedgerEvent = "JE"
			or    GeneralLedgerEvent = "ZB"
			or    GeneralLedgerEvent = "ES")
		ExcludedProjectEvents
			restricted
			when (System = "AR"
			and   GeneralLedgerEvent != "RV")
		GLGeneratedRecords
			restricted
			when (OriginatingTransaction.BusinessClassName = "GLTransactionDetail"
			or    OriginatingTransaction.BusinessClassName = "GeneralLedgerTransaction")
		AccountingUnitSelected
			restricted
        	when (FinanceEnterpriseGroup.AccountingUnitLabel entered)
		ProjectEntry
			restricted
        	when (FinanceEnterpriseGroup.ProjectLabel entered)
		FinanceDimension1Entry
			restricted
        	when (actor.context.FinanceEnterpriseGroup.FinanceDimension1Label entered)
			
		EligibleToHoldBilling	
			restricted
			when (FinanceCodeBlock.Project.IsActivePostingAndBillable
			and   Billed.Unprocessed)

		EligibleToHoldRevenue	
			restricted
			when (FinanceCodeBlock.Project.IsActivePostingAndRevenue
			and   RevenueRecognized.Unprocessed)

		EligibleForBillingHold
			restricted
			when (FinanceCodeBlock.Project.IsActivePostingAndBillable
			and   FinanceCodeBlock.Project.ParentDisplayContractRel.ProjectContract.RevenueRecognition.Combined
			and  (Billed.Unprocessed
			or    Billed.Hold)
			and  !ExcludedProjectEvents
			and   IsPosted)

		EligibleForRevenueHold
			restricted
			when (FinanceCodeBlock.Project.IsActivePostingAndRevenue
			and   FinanceCodeBlock.Project.ParentDisplayContractRel.ProjectContract.RevenueRecognition.Separate
			and  (RevenueRecognized.Unprocessed
			or    RevenueRecognized.Hold)
			and   !Billed.Distributed
			and   !ExcludedProjectEvents
			and   IsPosted)
		
		FESExcludedEvent
			restricted
			when (GeneralLedgerEvent = "AR"
			or    GeneralLedgerEvent = "BI"
			or    GeneralLedgerEvent = "BIR"
			or    GeneralLedgerEvent = "RE"
			or    GeneralLedgerEvent = "RER"
			or    GeneralLedgerEvent = "BD"
			or    GeneralLedgerEvent = "LR"
			or    GeneralLedgerEvent = "PJ"
			or    GeneralLedgerEvent = "PL"
			or    GeneralLedgerEvent = "RI")
			
		IsPosted
			restricted
			when (RelatedJournalTransaction(GeneralLedgerTransaction).Status.Posted)
		HasBurdens
			restricted
			when ((IndirectBurden.Draft
			or     IndirectBurden.Processed)
			and    System != "PS")
		IsBurden
			restricted
			when (GeneralLedgerEvent = "IB"
			or    GeneralLedgerEvent = "RB")
		ProjectContractInvoiceBillRelExists
			restricted
			when (ProjectContractInvoiceBillRel exists)
		ProjectContractInvoiceRevenueRelExists
			restricted
			when (ProjectContractInvoiceRevenueRel exists)
 		IsContextFEG
 			restricted
 			when (FinanceEnterpriseGroup = actor.context.FinanceEnterpriseGroup)

		SecurityGroupAllowsAccess
			restricted
			when (AccountingEntity.SecurityGroupAllowsAccess)

		UnProcessedBilled
			when (Billed.Unprocessed
			or    Billed.Hold)
		UnProcessedCapitalized
			when (Capitalize.Unprocessed
			or    Capitalize.Hold)
		ProjectUnProcessedCapitalized
			when (FinanceCodeBlock.Project.Capital
			and   Capitalize.Unprocessed)
		ProjectHoldCapitalized
			when (FinanceCodeBlock.Project.Capital
			and   Capitalize.Hold)
		UnProcessedLaborDistribution
			when (LaborDistribution.Unprocessed)
		UnProcessedIndirectBurden
			when (IndirectBurden.Unprocessed) 
		IsSystemPR
			when (System = "PR"
			and  (GeneralLedgerEvent = "PL"
			or    GeneralLedgerEvent = "PJ"
			or    GeneralLedgerEvent = "LR"
			or    GeneralLedgerEvent = "BD"))
		IsNotValidGeneralLedgerEvent
			when (GeneralLedgerEvent = "AR"
			or    GeneralLedgerEvent = "BI"
			or    GeneralLedgerEvent = "BIR"
			or    GeneralLedgerEvent = "IB"
			or    GeneralLedgerEvent = "OS"
			or    GeneralLedgerEvent = "PE"
			or    GeneralLedgerEvent = "RB"
			or    GeneralLedgerEvent = "RE"
			or    GeneralLedgerEvent = "RER")
		EligibleToTransfer	
			when (UnProcessedBilled
			and   UnProcessedCapitalized
			and   UnProcessedLaborDistribution
			and   UnProcessedIndirectBurden
			and   !IsSystemPR
			and   !IsNotValidGeneralLedgerEvent)
			
		PendingFESTransactionDetail
			when (FinanceCodeBlock.Project.ParentDisplayContract entered
			and	  FinanceCodeBlock.Project.ParentDisplayContractRel.Project.ProjectContract.FrontEndSplitsEnabled	
			and   !FinanceCodeBlock.Project.ExcludeFromFES
			and   FinanceCodeBlock.FinanceDimension2 = blank)

		ValidForDraft
			restricted
			when (ContextAssetInterfaceOptions entered
			and Capitalize.Unprocessed)

	Sets
		TransactionsByProject
			Sort Order
				FinanceEnterpriseGroup
				FinanceCodeBlock.Project
				Capitalized
				PostingDate	descending
				AssetCapitalTransaction
		
		TransactionsByAccountingUnit
			Sort Order
				FinanceEnterpriseGroup
				AccountingEntity
				FinanceCodeBlock.AccountingUnit
				Capitalized
				PostingDate	descending
				AssetCapitalTransaction

		ByEntityProject
			Sort Order
				FinanceEnterpriseGroup
				AccountingEntity
				FinanceCodeBlock.Project
				PostingDate descending
				AssetCapitalTransaction

		ByCapitalizeTransactions
			Sort Order
				FinanceEnterpriseGroup
				FinanceCodeBlock.Project
				Capitalize
				AssetCapitalTransaction

	Actions
		Create is a Create Action
			restricted
			bypass field rules
		
		Update is an Update Action
			restricted
		
		Delete is a Delete Action
			restricted
		
		CapitalizeUpdates is an Instance Action
			restricted
			Parameters
				CapitalizePrm	is Numeric 1
					States
						Unprocessed value is 0
						Processed	value is 1
						Hold		value is 2
				CapitalizedPrm is Boolean
			Action Rules
				Capitalize = CapitalizePrm
				Capitalized = CapitalizedPrm

		PutOnHold is an Instance Action
			valid when (Capitalize.Unprocessed)
			default label is "Put_On_Hold"
			Action Rules
				Capitalize = 2

		RemoveFromHold is an Instance Action
			restricted
			Action Rules
				Capitalize = 0

		RemoveCapitalizationHold is an Instance Action
			valid when (Capitalize.Hold)
			default label is "Remove_Capitalization_Hold"
			Action Rules
				Capitalize = 0

		HoldCapitalizableTransactions is a Set Action
			restricted
			Parameters
                PrmFinanceEnterpriseGroup	is like FinanceEnterpriseGroup
                PrmProject					is like Project
				SelectionGroup				is a AssetCapitalTransaction group
				DateSelection				is Numeric size 1
					States
						Transaction			value is 1
						Posting				value is 2
				DateRange
			Instance Selection
				where (FinanceEnterpriseGroup = PrmFinanceEnterpriseGroup
				and    FinanceCodeBlock.Project = PrmProject
				and    Status.History
				and    Capitalize.Unprocessed
				and  ((DateSelection.Transaction
				and    TransactionDate within DateRange)
				or    (DateSelection.Posting
				and    PostingDate within DateRange)
				or     DateSelection not entered))
			Sort Order is TransactionsByProject
			Action Rules
				Instance Rules
					if ((SelectionGroup entered
					and  AssetCapitalTransaction within SelectionGroup)
					or   SelectionGroup not entered)
						invoke PutOnHold

		RemoveHoldFromCapitalizableTransactions is a Set Action
			restricted
			Parameters
                PrmFinanceEnterpriseGroup	is like FinanceEnterpriseGroup
                PrmProject					is like Project
				SelectionGroup				is a AssetCapitalTransaction group
				DateSelection				is Numeric size 1
					States
						Transaction			value is 1
						Posting				value is 2
				DateRange
			Instance Selection
				where (FinanceEnterpriseGroup = PrmFinanceEnterpriseGroup
				and    FinanceCodeBlock.Project = PrmProject
				and    Status.History
				and    Capitalize.Hold
				and  ((DateSelection.Transaction
				and    TransactionDate within DateRange)
				or    (DateSelection.Posting
				and    PostingDate within DateRange)
				or     DateSelection not entered))
			Sort Order is TransactionsByProject
			Action Rules
				Instance Rules
					if ((SelectionGroup entered
					and  AssetCapitalTransaction within SelectionGroup)
					or   SelectionGroup not entered)
						invoke RemoveFromHold
		
		Purge is a Purge Action
			restricted


		DraftProjectAssetInterfaceSet is a Set Action
			default label is "DraftProjectInterface"
			completion message is "DraftProjectInterfaceCompleted"
			synchronized on untranslatable:"AssetCapitalTransaction_DraftProjectAssetInterfaceSet_<PrmFinanceEnterpriseGroup>_<PrmProject>"
			restricted
			Parameters
				PrmFinanceEnterpriseGroup	is a FinanceEnterpriseGroup
				PrmAssetInterfaceOptions	is a AssetInterfaceOptions
				PrmProject					is a Project
				PrmOverrideProject			is a Project
					default label is "OverrideProject"
				PrmDateRange				is a DateRange
				PrmDateType					is Numeric size 1
					default label is "Date"
					States
						Transaction			value is 0
						Posting				value is 1
				PrmCapitalTransactionQualifier	is a AssetCapitalTransaction group
				PrmSummaryCode				is AlphaUpper size 30
					default label is "SummaryCode"
				PrmDraftRunGroup			is Numeric size 8
				PrmToAccountingEntity		is a ToAccountingEntity
					default label is "<actor.context.FinanceEnterpriseGroup.AccountingEntityLabel>"	
				PrmAccountingUnit			is a AccountingUnit
					default label is "<actor.context.FinanceEnterpriseGroup.AccountingUnitLabel>"
				PrmGeneralLedgerChartAccount is a GeneralLedgerChartAccount
					default label is "<actor.context.FinanceEnterpriseGroup.AccountLabel>"		
				PrmFinanceDimension1		is a FinanceDimension1
					default label is "<actor.context.FinanceEnterpriseGroup.FinanceDimension1Label>"
				PrmFinanceDimension2		is a FinanceDimension2
					default label is "<actor.context.FinanceEnterpriseGroup.FinanceDimension2Label>"
				PrmFinanceDimension3		is a FinanceDimension3
					default label is "<actor.context.FinanceEnterpriseGroup.FinanceDimension3Label>"
				PrmFinanceDimension4		is a FinanceDimension4
					default label is "<actor.context.FinanceEnterpriseGroup.FinanceDimension4Label>"
				PrmFinanceDimension5		is a FinanceDimension5
					default label is "<actor.context.FinanceEnterpriseGroup.FinanceDimension5Label>"
				PrmFinanceDimension6		is a FinanceDimension6
					default label is "<actor.context.FinanceEnterpriseGroup.FinanceDimension6Label>"
				PrmFinanceDimension7		is a FinanceDimension7
					default label is "<actor.context.FinanceEnterpriseGroup.FinanceDimension7Label>"
				PrmFinanceDimension8		is a FinanceDimension8
					default label is "<actor.context.FinanceEnterpriseGroup.FinanceDimension8Label>"
				PrmFinanceDimension9		is a FinanceDimension9
					default label is "<actor.context.FinanceEnterpriseGroup.FinanceDimension9Label>"
				PrmFinanceDimension10		is a FinanceDimension10
					default label is "<actor.context.FinanceEnterpriseGroup.FinanceDimension10Label>"
				PrmTransactionDate          is Date
					default label is "TransactionDate"

			Parameter Rules
				PrmProject
					if (PrmProject.ProjectType.Summary)
						LocalSummaryProject	= PrmProject

			Local Fields
  				RecordCount					is Numeric 8
  				LocalDraftRunGroup			is Numeric size 8
				LocalErrorOccurred			is Boolean
				LocalErrorMessage			is Alpha 200

			Instance Selection
				where (FinanceEnterpriseGroup	= PrmFinanceEnterpriseGroup
				and	Capitalize.Unprocessed
				and	ReportCurrencyAmount.ProjectAmount.EnteredCurrencyAmount entered
				and ((PrmDateType.Transaction
				and TransactionDate within PrmDateRange)
				or (PrmDateType.Posting
				and PostingDate within PrmDateRange))
				and	((PrmProject.ProjectType.Posting
				and FinanceCodeBlock.Project = PrmProject)
				or	(PrmProject.ProjectType.Summary
				and	ProjectWithinSummaryRel exists))
				and	(PrmToAccountingEntity not entered
				or	(PrmToAccountingEntity entered
				and FinanceCodeBlock.ToAccountingEntity = PrmToAccountingEntity))
				and	(PrmAccountingUnit not entered
				or (PrmAccountingUnit entered
				and FinanceCodeBlock.AccountingUnit = PrmAccountingUnit))
				and	(PrmGeneralLedgerChartAccount not entered
				or (PrmGeneralLedgerChartAccount entered
				and FinanceCodeBlock.GeneralLedgerChartAccount = PrmGeneralLedgerChartAccount))
				and	(PrmFinanceDimension1 not entered
				or	(PrmFinanceDimension1 entered
				and FinanceCodeBlock.FinanceDimension1 = PrmFinanceDimension1))
				and	(PrmFinanceDimension2 not entered
				or	(PrmFinanceDimension2 entered
				and FinanceCodeBlock.FinanceDimension2 = PrmFinanceDimension2))
				and	(PrmFinanceDimension3 not entered
				or	(PrmFinanceDimension3 entered
				and FinanceCodeBlock.FinanceDimension3 = PrmFinanceDimension3))
				and	(PrmFinanceDimension4 not entered
				or	(PrmFinanceDimension4 entered
				and FinanceCodeBlock.FinanceDimension4 = PrmFinanceDimension4))
				and	(PrmFinanceDimension5 not entered
				or	(PrmFinanceDimension5 entered
				and FinanceCodeBlock.FinanceDimension5 = PrmFinanceDimension5))
				and	(PrmFinanceDimension6 not entered
				or	(PrmFinanceDimension6 entered
				and FinanceCodeBlock.FinanceDimension6 = PrmFinanceDimension6))
				and	(PrmFinanceDimension7 not entered
				or	(PrmFinanceDimension7 entered
				and FinanceCodeBlock.FinanceDimension7 = PrmFinanceDimension7))
				and	(PrmFinanceDimension8 not entered
				or	(PrmFinanceDimension8 entered
				and FinanceCodeBlock.FinanceDimension8 = PrmFinanceDimension8))
				and	(PrmFinanceDimension9 not entered
				or	(PrmFinanceDimension9 entered
				and FinanceCodeBlock.FinanceDimension9 = PrmFinanceDimension9))
				and	(PrmFinanceDimension10 not entered
				or	(PrmFinanceDimension10 entered
				and FinanceCodeBlock.FinanceDimension10 = PrmFinanceDimension10))
				and AssetCapitalTransaction within PrmCapitalTransactionQualifier)

			Action Rules
				Set Rules
				Instance Rules
					initialize LocalErrorOccurred
					initialize LocalErrorMessage
					initialize ErrorMessage
					initialize AssetInterfaceOptions
					invoke Create ProjectAssetInterface
						resume on error
							LocalErrorOccurred = true
							LocalErrorMessage = error message
						if(PrmAssetInterfaceOptions.AssetCompany.CopyUserFields)
							fill in user fields from this instance
						invoked.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
						invoked.AssetInterfaceOptions	= PrmAssetInterfaceOptions
						invoked.AssetCapitalTransaction = AssetCapitalTransaction
						if (GLTransactionDetailRel exists)
							invoked.GLTransactionDetail		= GLTransactionDetail
						invoked.AccountingEntity	= FinanceCodeBlock.ToAccountingEntity
						invoked.AccountingUnit		= FinanceCodeBlock.AccountingUnit
						if (PrmOverrideProject entered)
							invoked.Project			= PrmOverrideProject
						else
							invoked.Project			= FinanceCodeBlock.Project
						invoked.FinanceDimension1	= FinanceCodeBlock.FinanceDimension1
						invoked.FinanceDimension2	= FinanceCodeBlock.FinanceDimension2
						invoked.FinanceDimension3	= FinanceCodeBlock.FinanceDimension3
						invoked.FinanceDimension4	= FinanceCodeBlock.FinanceDimension4
						invoked.FinanceDimension5	= FinanceCodeBlock.FinanceDimension5
						invoked.FinanceDimension6	= FinanceCodeBlock.FinanceDimension6
						invoked.FinanceDimension7	= FinanceCodeBlock.FinanceDimension7
						invoked.FinanceDimension8	= FinanceCodeBlock.FinanceDimension8
						invoked.FinanceDimension9	= FinanceCodeBlock.FinanceDimension9
						invoked.FinanceDimension10	= FinanceCodeBlock.FinanceDimension10
						invoked.RunGroup			= PrmDraftRunGroup
						invoked.SummaryCode			= PrmSummaryCode
						if (PrmTransactionDate entered)
							invoked.TransactionDate     = PrmTransactionDate
						else
							invoked.TransactionDate     = AssetCapitalTransaction.TransactionDate

					if(LocalErrorOccurred)
						ErrorMessage			= LocalErrorMessage
						AssetInterfaceOptions	= PrmAssetInterfaceOptions
					else
						Capitalize = 1
						Capitalized = true

		ClearError is an Instance Action
			valid when (ErrorMessage entered)
			Action Rules
				initialize ErrorMessage

		DraftProjectInterface is an Instance Action
			valid when (ValidForDraft)
			default label is "Draft_Project_Interface"
			Parameters
				PrmFinanceEnterpriseGroup	is a FinanceEnterpriseGroup
					default label is "FinanceEnterpriseGroup"
				PrmSummaryCode				is AlphaUpper size 30
					default label is "SummaryCode"
				PrmOverrideProject			is a Project
					default label is "OverrideProject"
				PrmTransactionDate          is Date
					default label is "OverrideTransactionDate"
			
			Parameter Rules
				PrmFinanceEnterpriseGroup
					initial value is FinanceEnterpriseGroup

				PrmSummaryCode
					if(ContextAssetInterfaceOptions.IsValidForPostWIPToProject)
						cannot be entered
							"SummaryCodeCannotBeAssignedWhenWorkInProcessAccountNotEntered"
					if (FinanceEnterpriseGroup.FundAccounting)
						cannot be entered
							"SummaryCodeCannotBeAssignedWhenUsingFundAccounting"
					if (PrmOverrideProject entered)
						required
							"MustEnterSummaryCodeIfOverrideProjectIsEntered"

				PrmOverrideProject
					if (ContextAssetInterfaceOptions.PostingType
					and PrmOverrideProject not entered
					and PrmSummaryCode entered)
						default to FinanceCodeBlock.Project
					if (PrmSummaryCode entered
					and ContextAssetInterfaceOptions.SummaryType)
						required
							"MustEnterOverrideProjectIfSummaryCodeIsEnteredForSummaryLevelProject"
					constraint (PrmOverrideProject.ProjectType.Posting)
						"OverrideProjectMustBePostingTypeOnly"
					constraint (PrmOverrideProject.Capital)
						"MustBeACapital<FinanceEnterpriseGroup.ProjectLabel>"
					constraint (PrmOverrideProject.ProjectStatus.AllowCapitalization)
						"<FinanceEnterpriseGroup.ProjectLabel>StatusMustAllowCapitalization"

				PrmTransactionDate
					if(PrmSummaryCode entered
					and ContextAssetInterfaceOptions.PurchaseDate not entered)
						required
							"MustEnterTransactionDateWhenSummaryCodeIsEntered"

			Action Rules
				invoke Create ProjectAssetInterface
					if(ContextAssetInterfaceOptions.AssetCompany.CopyUserFields)
						fill in user fields from this instance
					invoked.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
					invoked.AssetInterfaceOptions	= ContextAssetInterfaceOptions
					invoked.AssetCapitalTransaction = AssetCapitalTransaction
					if (GLTransactionDetailRel exists)
						invoked.GLTransactionDetail		= GLTransactionDetail
					invoked.AccountingEntity	= FinanceCodeBlock.ToAccountingEntity
					invoked.AccountingUnit		= FinanceCodeBlock.AccountingUnit
					if (PrmOverrideProject entered)
						invoked.Project			= PrmOverrideProject
					else
						invoked.Project				= FinanceCodeBlock.Project
					invoked.FinanceDimension1	= FinanceCodeBlock.FinanceDimension1
					invoked.FinanceDimension2	= FinanceCodeBlock.FinanceDimension2
					invoked.FinanceDimension3	= FinanceCodeBlock.FinanceDimension3
					invoked.FinanceDimension4	= FinanceCodeBlock.FinanceDimension4
					invoked.FinanceDimension5	= FinanceCodeBlock.FinanceDimension5
					invoked.FinanceDimension6	= FinanceCodeBlock.FinanceDimension6
					invoked.FinanceDimension7	= FinanceCodeBlock.FinanceDimension7
					invoked.FinanceDimension8	= FinanceCodeBlock.FinanceDimension8
					invoked.FinanceDimension9	= FinanceCodeBlock.FinanceDimension9
					invoked.FinanceDimension10	= FinanceCodeBlock.FinanceDimension10
					invoked.RunGroup			= last ProjectAssetInterfaceRunGroupRel.RunGroup + 1
					invoked.SummaryCode			= PrmSummaryCode
					if( PrmTransactionDate entered)
						invoked.TransactionDate     = PrmTransactionDate
					else
						invoked.TransactionDate     = AssetCapitalTransaction.TransactionDate

				Capitalize = 1
				Capitalized = true
