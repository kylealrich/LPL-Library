SourcingStatus is a BusinessClass
    owned by ss
    prefix is STAU

    Ontology
    	symbolic key is SourcingStatus
    
	Derived Fields
		DraftMessage is a MessageField
			restricted
			"Draft"
		
		PendingEventApprovalMessage is a MessageField
			restricted
			"PendingEventApproval"
		
		PendingOpenMessage is a MessageField
			restricted
			"PendingOpen"
		
		AmendmentInProgressMessage is a MessageField
			restricted
			"AmendmentInProgress"
			
		PreviewMessage is a MessageField
			restricted
			"Preview"
			
		PendingAwardMessage is a MessageField
			restricted
			"PendingAward"
			
		OpenMessage is a MessageField
			restricted
			"Open"
		
		DraftType is a MessageField
			restricted
			"<DraftMessage>_-_<StatusCount>"

		PendingEventApprovalType is a MessageField
			restricted
			"<PendingEventApprovalMessage>_-_<StatusCount>"

		PendingOpenType is a MessageField
			restricted
			"<PendingOpenMessage>_-_<StatusCount>"

		AmendmentType is a MessageField
			restricted
			"<AmendmentInProgressMessage>_-_<StatusCount>"

		PreviewType is a MessageField
			restricted
			"<PreviewMessage>_-_<StatusCount>"

		PendingAwardType is a MessageField
			restricted
			"<PendingAwardMessage>_-_<StatusCount>"

		OpenType is a MessageField
			restricted
			"<OpenMessage>_-_<StatusCount>"

		RQDraftType is a MessageField
			restricted
			"<DraftMessage>_-_<StatusCountFromRQ>"

		RQPendingEventApprovalType is a MessageField
			restricted
			"<PendingEventApprovalMessage>_-_<StatusCountFromRQ>"

		RQPendingOpenType is a MessageField
			restricted
			"<PendingOpenMessage>_-_<StatusCountFromRQ>"

		RQAmendmentType is a MessageField
			restricted
			"<AmendmentInProgressMessage>_-_<StatusCountFromRQ>"

		RQPreviewType is a MessageField
			restricted
			"<PreviewMessage>_-_<StatusCountFromRQ>"

		RQPendingAwardType is a MessageField
			restricted
			"<PendingAwardMessage>_-_<StatusCountFromRQ>"

		RQOpenType is a MessageField
			restricted
			"<OpenMessage>_-_<StatusCountFromRQ>"
		
		RQType is a ConditionalField
			type is Alpha 35
			restricted
			if (SourcingStatus.Draft)
				RQDraftType
			else
			if (SourcingStatus.PendingEventApproval)
				RQPendingEventApprovalType
			else
			if (SourcingStatus.PendingOpen)
				RQPendingOpenType
			else
			if (SourcingStatus.AmendmentInProgress)
				RQAmendmentType
			else
			if (SourcingStatus.Preview)
				RQPreviewType
			else
			if (SourcingStatus.PendingAward)
				RQPendingAwardType
			else
			if (SourcingStatus.Open)
				RQOpenType
			else
				blank
		
		Type is a ConditionalField
			type is Alpha 35
			if (SourcingStatus.Draft)
				DraftType
			else
			if (SourcingStatus.PendingEventApproval)
				PendingEventApprovalType
			else
			if (SourcingStatus.PendingOpen)
				PendingOpenType
			else
			if (SourcingStatus.AmendmentInProgress)
				AmendmentType
			else
			if (SourcingStatus.Preview)
				PreviewType
			else
			if (SourcingStatus.PendingAward)
				PendingAwardType
			else
			if (SourcingStatus.Open)
				OpenType
			else
				blank

		StatusCount is a ComputeField
			type is Numeric 5
			(instance count of SourcingEventRel)
			
		StatusCountFromRQ is a ComputeField
			type is Numeric 5
			restricted
			(instance count of SourcingEventFromRequisitionsRel)

	Relations

		SourcingEventRel
			one-to-many relation to SourcingEvent
			Field Mapping uses ByStatus
				related.Company = Company
			Instance Selection
				where (related.IsEvent
				and	   related.NumericDerivedStatus	= SourcingStatus
				and  ((!ActorContextBuyerRel exists
				and    !ActorContextCategoryRel exists)
				or     (related.Buyer = actor.context.Buyer
				and    !ActorContextCategoryRel exists)
				or    ((related.Category = any actor.context.Category
				and     related.Category entered
				and    !ActorContextBuyerRel exists)
				and   ((related.SubCategory = any actor.context.SubCategory)
				or     (related.SubCategory entered
				and    !ActorContextSubCategoryRel exists)
				or     (!related.SubCategory entered)))
				or    ((related.Category = any actor.context.Category
				and     related.Category entered
				and     related.Buyer = actor.context.Buyer)
				and   ((related.SubCategory = any actor.context.SubCategory)
				or     (related.SubCategory entered
				and    !ActorContextSubCategoryRel exists)
				or    (!related.SubCategory entered)))))
			
		SourcingEventFromRequisitionsRel      
			one-to-many relation to SourcingEvent
			Field Mapping uses ByStatus
				related.Company = Company
			Instance Selection
				where (related.NumericDerivedStatus	= SourcingStatus
				and    related.FromRequisition)
		
		ActorContextBuyerRel
			one-to-many relation to ActorContext
			Field Mapping uses symbolic key
				related.Actor             = actor
			Instance Selection
				where (related.ContextProperty.KeyField   = "Buyer")
				
		ActorContextCategoryRel
			one-to-many relation to ActorContext
			Field Mapping uses symbolic key
				related.Actor             = actor
			Instance Selection
				where (related.ContextProperty.KeyField   = "Category")
			
		ActorContextSubCategoryRel
			one-to-many relation to ActorContext
			Field Mapping uses symbolic key
				related.Actor             = actor
			Instance Selection
				where (related.ContextProperty.KeyField   = "SubCategory")
				
	Actions
		Create is an Action
			restricted
		Update is an Action
			restricted
		Delete is an Action 
			restricted
