CSVOutputHeader is a BusinessClass
	owned by ap
	prefix is CSVH

	Ontology
		symbolic key is CSVOutputHeader

	Patterns
		implements StaticJava
		disable AuditIndex

	Persistent Fields
		ProgramName	is Alpha size 50
		FileName	is Alpha size 50
		CSVFile		is an Attachment
		CreateDate	is TimeStamp

	Transient Fields

	Local Fields

	Derived Fields
		TotalRecordCount is a ComputeField
			type is Numeric 10	
			(instance count of CSVOutputDetail set)

	Conditions
		RecordExists
			restricted
			when (CSVOutputHeader exists)

		HasCSVAttachement
			restricted
			when (CSVFile entered)

	Relations

	Sets
		ByCreateDate
			Sort Order
				CreateDate				descending
				VendorGroup
				FileName
				CSVOutputHeader

	Field Rules
		CreateDate
			default to current timestamp

	Actions
		Create is a Create Action

		Update is an Update Action

		Delete is a Delete Action

		Purge is a Purge Action
			restricted

		CreateCSVFiles is an Instance Action
			Action Rules
				trigger "CSVOutputFile" PA service
					resume on error
					title is "CreateCSVOutputFile"
					Variables
						VendorGroup
						CSVOutputHeader
						FileName

		PurgeCSVOutputHeaders is a Set Action
			run in foreground
			completion message is "PurgeCSVOutputHeaderHasCompleted"
			Parameters
				PrmVendorGroup	is a VendorGroup

			Parameter Rules
				PrmVendorGroup
					required
			Instance Selection
				where  (VendorGroup = PrmVendorGroup)

			Action Rules
				Instance Rules
					invoke Purge
