FileCreationSetup is a BusinessClass
    owned by filecreation
    prefix is FCSET

	Ontology
		symbolic key is FileCreationSetup

    Patterns
	    implements LightweightAuditing
        disable EffectiveDated
		disable AsOfDateProcessing

    Persistent Fields
		Description						is Alpha 60
    	FieldSeparator					is Alpha 3
    	TabSeparator					is Boolean
    	IncludeSeparatorAtBeginningOfRow	is Boolean
    	FieldDelimiter					is Alpha 3
		ExportFile
		FlowToProcessFile				is a PfiServiceDefinition
		Active							is Boolean
		FileName						is Alpha 150
			Text Variables
				FileTimeStamp			
		AppendTimestampToFileName		is Boolean
		FileNameTimeStampFormat			is Alpha 40
			default label is "TimeStampFormat"
		LastTimeStamp					is TimeStamp
			disable Auditing
		AllRecords						is Boolean
		SendOneRecordPerEffectiveDate	is Boolean
		FileHeaderText					is Text					
		EligibilityGroup			is Alpha 30
			restricted
		DCKey							is Alpha 60
		AutomaticallySendFileToION		is Boolean
		IONDocumentName					is Alpha 200
		IONInstanceCount				is Numeric 1
			States
				RecordCount				value is 0
				RowCount				value is 1
		IONSource						is Alpha 150
			Text Variables
				FileName
		IONDocumentID					is Alpha 150
			Text Variables
				FileName
		ActionBackgroundGroup			is UniqueID
			disable Auditing
		FileType						is Numeric 1
			States
				Separated				value is 0
				FixedLength				value is 1		
		FileSegmentLimit			is Numeric 1
			States
				NoLimit				value is 0
				NumberOfRecords		value is 1
				NumberOfMegabytes	value is 2
		NumberOfRecordsBeforeNewFile	is Numeric 7
		NumberOfMegabytesBeforeNewFile	    is Numeric 4
		TurnOffRecordAuditing			is Boolean
		GenerationBehaviorForNoOutput				is Numeric 1
			States
				GenerateNoFileRecord				value is 0
				GenerateFileRecordWithNoDocument	value is 1
				GenerateFileRecordWithDocument		value is 2
		ThreadingMethod			is Numeric 1
			States
				SingleThreaded				value is 0
				IndividualFilesPerThread	value is 1
				MergedFileForThreads		value is 2
		UseForTesting					is Boolean
		DoNotIncludeHeader				is Boolean
		DoNotIncludeTrailer				is Boolean
		TestingEmailTo					is Text
			default label is "To"
		TestingEmailFrom				is an EmailAddress
			default label is "From"
		LastTestFailed					is Boolean
			disable Auditing
		LastGeneration  				is TimeStamp
			disable Auditing
		LastGenerationSequence          is Numeric 4
			disable Auditing
		SortFieldArray		
		SortSourceFieldOne				is Alpha 100 
			is related value for BaseBusinessClass
		SortSourceFieldTwo				is Alpha 100
			is related value for BaseBusinessClass
		SortSourceFieldThree			is Alpha 100
			is related value for BaseBusinessClass
		SortSourceFieldFour				is Alpha 100
			is related value for BaseBusinessClass
		SortSourceFieldFive				is Alpha 100
			is related value for BaseBusinessClass
		SortSourceFieldSix				is Alpha 100
			is related value for BaseBusinessClass
		SortSourceFieldSeven			is Alpha 100
			is related value for BaseBusinessClass
		SortSourceFieldEight			is Alpha 100
			is related value for BaseBusinessClass
		SortSourceFieldNine				is Alpha 100
			is related value for BaseBusinessClass
		SortSourceFieldTen				is Alpha 100
			is related value for BaseBusinessClass
		SortSourceFieldEleven			is Alpha 100
			is related value for BaseBusinessClass
		SortSourceFieldTwelve			is Alpha 100
			is related value for BaseBusinessClass
		ExcludeSeparatorWhenEmpty		is Boolean
			default label is "ExcludeFieldSeparatorForBlankColumnsAtTheEnd"
		RecordEndOfLineCharacter		is Alpha 1
		OverrideNumberOfThreads			is Numeric 3
			default label is "NumberOfThreads"
		EndOfLineCharacter				is Numeric 1
			States
				ServerDefault	value is 0
				CarriageReturn	value is 1
				LineFeed		value is 2
				Both			value is 3
		OutputTextForBlankDocument		is Text
		ValidationReportTimeStamp			is TimeStamp
			disable Auditing
		ValidationReport				is a FileCreationAttachment
			disable Auditing
		ValidationReportText			is RichText
			disable Auditing
		MappingsDocument				is a FileCreationAttachment
			disable Auditing
		MappingsDocumentTimeStamp			is TimeStamp
			disable Auditing
		SetupExportFile				is a FileCreationAttachment
			disable Auditing
		SetupExportTimeStamp			is TimeStamp
			disable Auditing
		ValidateRequiredFields     		is Boolean
		ValidateLength			   		is Boolean
		ValidateCharacters  			is Boolean
		CharacterCheck					is Numeric 2
			States
				UserDefined  			value is 1
				NonASCII 				value is 2
		CharacterExpression				is Alpha 50
		ErrorHandling					is Numeric 1
			States
				Off									value is 0
				ProcessWithWarning					value is 1
				MoveToError							value is 2
		UseAuditInformation					is Boolean
		RegenerateMappingsFlag				is Numeric 1
			disable Auditing
			States
				NotNeeded  		value is 0
				Regenerating    value is 1
				Needed			value is 2
		DisableDynamicRowProcessing			is Boolean
		FileMimeType						is Numeric 1
			default label is "MIME_Type"
			States
				PlainText 	value is 0
				CSV 		value is 1

	Field Groups

		FieldsNeededForRegenerateMappings
			FieldSeparator
			TabSeparator	
			IncludeSeparatorAtBeginningOfRow
			FieldDelimiter
			ExportFile
			FileName
			AppendTimestampToFileName
			FileNameTimeStampFormat
			FileHeaderText
			ExcludeSeparatorWhenEmpty
			RecordEndOfLineCharacter
			EndOfLineCharacter
			ValidateRequiredFields
			ValidateLength
			ValidateCharacters
			CharacterCheck
			CharacterExpression
			ErrorHandling
			DisableDynamicRowProcessing

	Transient Fields
		PayablesInvoiceGroupSelection           is a PayablesInvoice group in subject FileCreationPayablesInvoice
			default label is "EligibilityGroup"
			derive value from PayablesInvoiceDerivedEligibilityGroup
		GeneralLedgerTransactionGroupSelection           is a GeneralLedgerTransaction group in subject FileCreationGeneralLedgerTransaction
			default label is "EligibilityGroup"
			derive value from GeneralLedgerTransactionDerivedEligibilityGroup
		PurchaseOrderLineGroupSelection           is a PurchaseOrderLine group in subject FileCreationPurchaseOrderLine
			default label is "EligibilityGroup"
			derive value from PurchaseOrderLineDerivedEligibilityGroup
		InventoryLocationGroupSelection         is a InventoryLocation group in subject FileCreationInventoryLocation
			default label is "EligibilityGroup"
			derive value from InventoryLocationDerivedEligibilityGroup
		InventoryTransactionLineGroupSelection	is a InventoryTransactionLine group in subject FileCreationInventoryTransactionLine
			default label is "EligibilityGroup"
			derive value from InventoryTransactionLineDerivedEligibilityGroup
		GeneralLedgerTotalGroupSelection           is a GeneralLedgerTotal group in subject FileCreationGeneralLedgerTotal
			default label is "EligibilityGroup"
			derive value from GeneralLedgerTotalDerivedEligibilityGroup
		GLTransactionDetailGroupSelection           is a GLTransactionDetail group in subject FileCreationGLTransactionDetail
			default label is "EligibilityGroup"
			derive value from GLTransactionDetailDerivedEligibilityGroup
		VendorGroupSelection           is a Vendor group in subject FileCreationVendor
			default label is "EligibilityGroup"
			derive value from VendorDerivedEligibilityGroup
		AssetGroupSelection           is a Asset group in subject FileCreationAsset
			default label is "EligibilityGroup"
			derive value from AssetDerivedEligibilityGroup
		ScenarioGroupSelection           is a Scenario group in subject FileCreationScenario
			default label is "EligibilityGroup"
			derive value from ScenarioDerivedEligibilityGroup
		GeneralLedgerChartAccountGroupSelection           is a GeneralLedgerChartAccount group in subject FileCreationGeneralLedgerChartAccount
			default label is "EligibilityGroup"
			derive value from GeneralLedgerChartAccountDerivedEligibilityGroup
		BinGroupGroupSelection           is a BinGroup group in subject FileCreationBinGroup
			default label is "EligibilityGroup"
			derive value from BinGroupDerivedEligibilityGroup
		ContractGroupSelection           is a Contract group in subject FileCreationContract
			default label is "EligibilityGroup"
			derive value from ContractDerivedEligibilityGroup
		ItemGroupSelection         is a Item group in subject FileCreationItem
			default label is "EligibilityGroup"
			derive value from ItemDerivedEligibilityGroup
		RequesterRequestingLocationGroupSelection         is a RequesterRequestingLocation group in subject FileCreationRequesterRequestingLocation
			default label is "EligibilityGroup"
			derive value from RequesterRequestingLocationDerivedEligibilityGroup
		PurchaseOrderGroupSelection           is a PurchaseOrder group in subject FileCreationPurchaseOrder
			default label is "EligibilityGroup"
			derive value from PurchaseOrderDerivedEligibilityGroup
		GeneralLedgerJournalControlGroupSelection           is a GeneralLedgerJournalControl group in subject FileCreationGeneralLedgerJournalControl
			default label is "EligibilityGroup"
			derive value from GeneralLedgerJournalControlDerivedEligibilityGroup
		PrmOneToMany			is Boolean
			default label is "OneToMany"
		PrmOneToManyBusinessClassPayablesInvoice is a OneToManyBusinessClassPayablesInvoice
		PrmOneToManyBusinessClassGeneralLedgerChartAccount is a OneToManyBusinessClassGeneralLedgerChartAccount
		PrmOneToManyBusinessClassAsset			is a OneToManyBusinessClassAsset
		PrmOneToManyBusinessClassBinGroup		is a OneToManyBusinessClassBinGroup
		PrmOneToManyBusinessClassContract		is a OneToManyBusinessClassContract
		PrmOneToManyBusinessClassPurchaseOrder	is a OneToManyBusinessClassPurchaseOrder
		PrmOneToManyBusinessClassVendor			is a OneToManyBusinessClassVendor
		PrmRowDescription				 	is Alpha 60
			default label is "RowDescription"
		BuildTimeStampFormat	is Boolean
		DateFormat				is Numeric 1
			States
				YYMMDD		value is 0
					default label is untranslatable
				MMDDYY		value is 1
					default label is untranslatable
				DDMMYY		value is 2
					default label is untranslatable
		IncludeCentury			is Boolean	
		IncludeHours			is Boolean
		IncludeMinutes			is Boolean
		IncludeSeconds			is Boolean
		IncludeMilliseconds		is Boolean
		CoreFiles is Numeric 2
			States
				PayablesInvoice							value is 1
				InventoryLocation						value is 2
				GLTransactionDetail						value is 3
				GeneralLedgerTransaction				value is 4
				GeneralLedgerTotal						value is 5
				Asset									value is 6
				InventoryTransactionLine				value is 7
				PurchaseOrderLine						value is 8
				Vendor									value is 9
				Scenario								value is 10
				GeneralLedgerChartAccount				value is 11
				BinGroup								value is 12
				Contract								value is 13
				Item									value is 14
				RequesterRequestingLocation				value is 15
				PurchaseOrder							value is 16
				GeneralLedgerJournalControl				value is 33
		SelectSourceFileByCategory is Boolean
		IsSortingFieldsIncluded		is Boolean
		IsRecordCountersIncluded	is Boolean
		IsRowConditionsIncluded		is Boolean
		IsDataMappingsIncluded		is Boolean


	Local Fields
		LocalFinanceEnterpriseGroup		is like FinanceEnterpriseGroup
		LocalFileCreationSetup 	is like FileCreationSetup
		LocalFileCreationSetup2	is like FileCreationSetup
		LocalPurgeDate			is TimeStamp
		SetupView	is a FileCreationSetup view
		RowView		is a FileCreationRowDetail view		
		ColumnView	is a FileCreationColumnDetail view
		RecordView  is a FileCreationRecord view		
		LocalRow	is like FileCreationRowDetail
		LocalRow2	is like FileCreationRowDetail
		LocalColumn	is like FileCreationColumnDetail
		LocalDataMapping is like FileCreationDataMapping
		I1			is Numeric 4
		I2			is Numeric 4
		CurrentSystemTimeStamp		is TimeStamp
		TempText					is Text
		ChangedFieldsLocal			is Text
		ArraySize					is Numeric 4
		AllChangedFieldsArray
		LocalKey1					is Alpha 40
		LocalKey2					is Alpha 40
		LocalKey3					is Alpha 40
		LocalKey4					is Alpha 40
		LocalKey5					is Alpha 40
		LocalKey6					is Alpha 40
		LocalKey7					is Alpha 30
		LocalKey8					is Alpha 30
		LocalKey9					is Alpha 30
		LocalKey10					is Alpha 70
		LocalKey11					is Alpha 30
		LocalSystemTimeStamp		is TimeStamp
		LocalTransactionId			is Numeric 13
		PfiServiceVariableKey		is Alpha 50
		TempFileName				is Text
			Text Variables
				FileTimeStamp		value is LocalAlpha
		LocalCommitCounter			is Numeric 2	
		LocalErrorMessage			is Text	
		LocalJavaFormat				is Alpha 40
		LocalAlpha					is Alpha 100
		LocalTimeFormat				is Alpha 40
		LocalThreadGroupID			is UniqueID
		LocalMergedFileSystemTimeStamp	is TimeStamp
		LocalMergedFileSequenceNumber	is Numeric 4
		FileView						is a FileCreationFile view
		LocalTimeStamp				is TimeStamp
		LocalSequenceNumber			is Numeric 4
		FileCreationSetupArray
		LocalIONDocumentName		is Alpha 200
		LocalOldIONDocumentName		is Alpha 200
		ErrorMessage				is Text
		IsError						is Boolean

		LocalQueue is like AsyncQueueDefinition
		LocalStatus is like AsyncTriggerStatus
		LocalDCKey					is Alpha 60
		LocalDCKeyRow				is Alpha 60
		LocalDCKeyColumn			is Alpha 60
		LocalDCKeyDataMapping		is Alpha 150
		LinkedSetupDCKey			is Alpha 60
		LinkedRowDCKey				is Alpha 60
		LocalSubtotalLevel			is Numeric 2
		LocalValidFormat				is Text
		LocalReplaceInvalidsWith		is Text
		LocalReplaceValue				is Text
		
			
	Rule Blocks

				
	Derived Fields
		FileNameOnly is a DerivedField
			type is Alpha 150
			restricted
			initialize I1
			while (I1 <= 70)
				if (FileName[I1] = ".")
					return FileName[1:I1-1]
				if (FileName[I1] = " ")
					return FileName
				increment I1
			
			return FileName
			
		FileNameExtention is a DerivedField
			type is Alpha 10
			restricted
			initialize I1
			while (I1 <= 50)
				if (FileName[I1] = ".")
					return FileName[I1:50]
				increment I1
			
			return blank
						
		CurrentTimeStamp is a DerivedField 
			type is Alpha 20
			CurrentSystemTimeStamp = system current timestamp
			return CurrentSystemTimeStamp using "%1$tY%1$tm%1$td%1$tH%1$tM%1$tS%1$tL"
	
		CalculatedFileName is a DerivedField
			type is Text
			default label is "FileName"
			if (FileNameTimeStampFormat entered)
				LocalJavaFormat = FileNameTimeStampFormat
			else
				LocalJavaFormat = "%1$tY%1$tm%1$td%1$tH%1$tM%1$tS%1$tL"
			CurrentSystemTimeStamp = system current timestamp
			LocalAlpha = CurrentSystemTimeStamp using "<LocalJavaFormat>"		
			if (AppendTimestampToFileName)
				return FileNameOnly + LocalAlpha + FileNameExtention
			else
				TempFileName = FileName
				return TempFileName text
				

		PayablesInvoiceUsesPayablesInvoiceDistribution  is a DerivedField
			type is Boolean
			if (ExportFile.PayablesInvoice)
				for each FileCreationRowDetail set
					if (each.LinkedRow not entered)
						if (each.OneToManyBusinessClassPayablesInvoice.PayablesInvoiceDistribution)
							return true
					else
						if (each.LinkedRow.OneToManyBusinessClassPayablesInvoice.PayablesInvoiceDistribution)
							return true

		PayablesInvoiceUsesPayablesInvoicePayment  is a DerivedField
			type is Boolean
			if (ExportFile.PayablesInvoice)
				for each FileCreationRowDetail set
					if (each.LinkedRow not entered)
						if (each.OneToManyBusinessClassPayablesInvoice.PayablesInvoicePayment)
							return true
					else
						if (each.LinkedRow.OneToManyBusinessClassPayablesInvoice.PayablesInvoicePayment)
							return true

		PayablesInvoiceUsesPayablesInvoiceAddOnCharge  is a DerivedField
			type is Boolean
			if (ExportFile.PayablesInvoice)
				for each FileCreationRowDetail set
					if (each.LinkedRow not entered)
						if (each.OneToManyBusinessClassPayablesInvoice.PayablesInvoiceAddOnCharge)
							return true
					else
						if (each.LinkedRow.OneToManyBusinessClassPayablesInvoice.PayablesInvoiceAddOnCharge)
							return true

		GeneralLedgerChartAccountUsesReportingChartAccount  is a DerivedField
			type is Boolean
			if (ExportFile.GeneralLedgerChartAccount)
				for each FileCreationRowDetail set
					if (each.LinkedRow not entered)
						if (each.OneToManyBusinessClassGeneralLedgerChartAccount.ReportingChartAccount)
							return true
					else
						if (each.LinkedRow.OneToManyBusinessClassGeneralLedgerChartAccount.ReportingChartAccount)
							return true
		
		AssetUsesAssetBook is a DerivedField
			type is Boolean
			if (ExportFile.Asset)
				for each FileCreationRowDetail set
					if (each.LinkedRow not entered)
						if (each.OneToManyBusinessClassAsset.AssetBook)
							return true
					else
						if (each.LinkedRow.OneToManyBusinessClassAsset.AssetBook)
							return true

		BinGroupUsesBinGroupDetail is a DerivedField
			type is Boolean
			if (ExportFile.BinGroup)
				for each FileCreationRowDetail set
					if (each.LinkedRow not entered)
						if (each.OneToManyBusinessClassBinGroup.BinGroupDetail)
							return true
					else
						if (each.LinkedRow.OneToManyBusinessClassBinGroup.BinGroupDetail)
							return true

		ContractUsesContractLine is a DerivedField
			type is Boolean
			if (ExportFile.Contract)
				for each FileCreationRowDetail set
					if (each.LinkedRow not entered)
						if (each.OneToManyBusinessClassContract.ContractLine)
							return true
					else
						if (each.LinkedRow.OneToManyBusinessClassContract.ContractLine)
							return true

		PurchaseOrderUsesPurchaseOrderLine is a DerivedField
			type is Boolean
			if (ExportFile.PurchaseOrder)
				for each FileCreationRowDetail set
					if (each.LinkedRow not entered)
						if (each.OneToManyBusinessClassPurchaseOrder.PurchaseOrderLine)
							return true
					else
						if (each.LinkedRow.OneToManyBusinessClassPurchaseOrder.PurchaseOrderLine)
							return true

		VendorUsesVendorLocation is a DerivedField
			type is Boolean
			if (ExportFile.Vendor)
				for each FileCreationRowDetail set
					if (each.LinkedRow not entered)
						if (each.OneToManyBusinessClassVendor.VendorLocation)
							return true
					else
						if (each.LinkedRow.OneToManyBusinessClassVendor.VendorLocation)
							return true


		AsyncQueueFileCreationUtilityActions is a DerivedField	
			type is Alpha 50
			restricted
			return "FSMFileCreationUtilityActions"
			
		AsyncQueueHCMCustomerUpdateActions is a DerivedField	
			type is Alpha 50
			restricted
			return "HCMCustomerUpdateActions"

		PfiServiceFinanceEnterpriseGroupExists is a DerivedField
			type is Boolean
			PfiServiceVariableKey = "FinanceEnterpriseGroup"
			if PfiServiceVariableRel exists
				return true

		PfiServiceFileCreationSetupExists is a DerivedField
			type is Boolean
			PfiServiceVariableKey = "FileCreationSetup"
			if PfiServiceVariableRel exists
				return true
			
		PfiServiceSequenceNumberExists is a DerivedField
			type is Boolean
			PfiServiceVariableKey = "SequenceNumber"
			if PfiServiceVariableRel exists
				return true

		PfiServiceSystemTimeStampExists is a DerivedField
			type is Boolean
			PfiServiceVariableKey = "SystemTimeStamp"
			if PfiServiceVariableRel exists
				return true

		RowCount is a DerivedField
			type is Numeric 4
			return instance count of FileCreationRowDetail set
			
		ColumnCount is a DerivedField
			type is Numeric 4
			return instance count of FileCreationColumnDetail set
        					
        ConfigMaxFileSizeOverride is a DerivedField	
			type is Numeric 4
			restricted
			return config.HCM_FCU_Max_File_Size_Override 
        					
        MaxFileSize is a DerivedField	
        	type is Numeric 4
        	restricted
        	if (ConfigMaxFileSizeOverride != blank)
        		return ConfigMaxFileSizeOverride
        	else
        		return 500

		AsyncSynchronizedGroup is a DerivedField
			type is Alpha 100
			AsyncSynchronizedGroup = "File Creation Setup Generate File Threaded " + FinanceEnterpriseGroup + " " + FileCreationSetup
			return AsyncSynchronizedGroup
			
		GeneratePreviewRecordsAsyncSynchronizedGroup is a DerivedField
			type is Alpha 100
			GeneratePreviewRecordsAsyncSynchronizedGroup = "File Creation Setup Generate Preview Records " + FinanceEnterpriseGroup
			return GeneratePreviewRecordsAsyncSynchronizedGroup
			
		NextTimeToGenerate is a DerivedField
			type is TimeStamp
			for each AsyncRequestRel
				if (each.TimeToExec > system current timestamp
				and ((NextTimeToGenerate entered
				and each.TimeToExec < NextTimeToGenerate)
				or  NextTimeToGenerate not entered))
					NextTimeToGenerate = each.TimeToExec
			return NextTimeToGenerate
			
			
		NextTimeToGeneratePreviewRecords is a DerivedField
			type is TimeStamp
			for each GeneratePreviewRecordsAsyncRequestRel
				if (each.TimeToExec > system current timestamp
				and ((NextTimeToGeneratePreviewRecords entered
				and each.TimeToExec < NextTimeToGeneratePreviewRecords)
				or  NextTimeToGeneratePreviewRecords not entered))
					NextTimeToGeneratePreviewRecords = each.TimeToExec
			return NextTimeToGeneratePreviewRecords
			
		NumberOfScheduledJobs is a ComputeField
			type is Numeric 3
			(instance count of AsyncRequestRel)
			
		NumberOfScheduledJobsGeneratePreviewRecords is a ComputeField
			type is Numeric 3
			(instance count of GeneratePreviewRecordsAsyncRequestRel)

		CalculateTimeStampFormat is a DerivedField
			type is Alpha 40
			restricted

			initialize LocalJavaFormat

			if (IncludeCentury)
				if (DateFormat.YYMMDD)
					LocalJavaFormat = "%1$tY%1$tm%1$td"
				else
				if (DateFormat.MMDDYY)
					LocalJavaFormat = "%1$tm%1$td%1$tY"
				else
				if (DateFormat.DDMMYY)
					LocalJavaFormat = "%1$td%1$tm%1$tY"
			else
				if (DateFormat.YYMMDD)
					LocalJavaFormat = "%1$ty%1$tm%1$td"
				else
				if (DateFormat.MMDDYY)
					LocalJavaFormat = "%1$tm%1$td%1$ty"
				else
				if (DateFormat.DDMMYY)
					LocalJavaFormat = "%1$td%1$tm%1$ty"

			initialize LocalTimeFormat
			if (IncludeHours)
				LocalTimeFormat = "%1$tH"
			if (IncludeMinutes)
				LocalTimeFormat += "%1$tM"
			if (IncludeSeconds)
				LocalTimeFormat += "%1$tS"
			if (IncludeMilliseconds)
				LocalTimeFormat += "%1$tL"
					
			LocalJavaFormat += LocalTimeFormat
			return LocalJavaFormat  
			        		
        CalculateExportFileValue is a DerivedField
        	type is Numeric 3 
			if (CoreFiles entered)
				if (CoreFiles.PayablesInvoice)
					return 1
				else
				if (CoreFiles.InventoryLocation)
					return 2
				else
				if (CoreFiles.GLTransactionDetail)
					return 3
				else  
				if (CoreFiles.GeneralLedgerTransaction)
					return 4	
				else
				if (CoreFiles.GeneralLedgerTotal)
					return 5
				else
				if (CoreFiles.Asset)
					return 6
				else
				if (CoreFiles.InventoryTransactionLine)
					return 7
				else  
				if (CoreFiles.PurchaseOrderLine)
					return 8
				else
				if (CoreFiles.Vendor)
					return 9
				else
				if (CoreFiles.Scenario)
					return 10
				else
				if (CoreFiles.GeneralLedgerChartAccount)
					return 11
				else
				if (CoreFiles.BinGroup)
					return 12
				else
				if (CoreFiles.Contract)
					return 13
				else
				if (CoreFiles.Item)
					return 14
				else
				if (CoreFiles.RequesterRequestingLocation)
					return 15
				else
				if (CoreFiles.PurchaseOrder)
					return 16
				else
				if (CoreFiles.GeneralLedgerJournalControl)
					return 33

		WorkunitTitle is a DerivedField
			type is Alpha 100
			WorkunitTitle = Description + ":" + FileCreationSetup
			return WorkunitTitle

		PayablesInvoiceDerivedEligibilityGroup is a DerivedField
			type is Alpha 30
			if (ExportFile.PayablesInvoice)
				return EligibilityGroup
			else
				return blank
		InventoryLocationDerivedEligibilityGroup is a DerivedField
			type is Alpha 30
			if (ExportFile.InventoryLocation)
				return EligibilityGroup
			else
				return blank

		InventoryTransactionLineDerivedEligibilityGroup is a DerivedField
			type is Alpha 30
			if (ExportFile.InventoryTransactionLine)
				return EligibilityGroup
			else
				return blank

		GeneralLedgerTransactionDerivedEligibilityGroup is a DerivedField
			type is Alpha 30
			if (ExportFile.GeneralLedgerTransaction)
				return EligibilityGroup
			else
				return blank

		PurchaseOrderLineDerivedEligibilityGroup is a DerivedField
			type is Alpha 30
			if (ExportFile.PurchaseOrderLine)
				return EligibilityGroup
			else
				return blank
				
		GeneralLedgerTotalDerivedEligibilityGroup is a DerivedField
			type is Alpha 30
			if (ExportFile.GeneralLedgerTotal)
				return EligibilityGroup
			else
				return blank
				
		GLTransactionDetailDerivedEligibilityGroup is a DerivedField
			type is Alpha 30
			if (ExportFile.GLTransactionDetail)
				return EligibilityGroup
			else
				return blank

		VendorDerivedEligibilityGroup is a DerivedField
			type is Alpha 30
			if (ExportFile.Vendor)
				return EligibilityGroup
			else
				return blank

		AssetDerivedEligibilityGroup is a DerivedField
			type is Alpha 30
			if (ExportFile.Asset)
				return EligibilityGroup
			else
				return blank
		
		ScenarioDerivedEligibilityGroup is a DerivedField
			type is Alpha 30
			if (ExportFile.Scenario)
				return EligibilityGroup
			else
				return blank
		
		GeneralLedgerChartAccountDerivedEligibilityGroup is a DerivedField
			type is Alpha 30
			if (ExportFile.GeneralLedgerChartAccount)
				return EligibilityGroup
			else
				return blank
		
		BinGroupDerivedEligibilityGroup is a DerivedField
			type is Alpha 30
			if (ExportFile.BinGroup)
				return EligibilityGroup
			else
				return blank

		ContractDerivedEligibilityGroup is a DerivedField
			type is Alpha 30
			if (ExportFile.Contract)
				return EligibilityGroup
			else
				return blank
			
		ItemDerivedEligibilityGroup is a DerivedField
			type is Alpha 30
			if (ExportFile.Item)
				return EligibilityGroup
			else
				return blank
		
		RequesterRequestingLocationDerivedEligibilityGroup is a DerivedField
			type is Alpha 30
			if (ExportFile.RequesterRequestingLocation)
				return EligibilityGroup
			else
				return blank

		PurchaseOrderDerivedEligibilityGroup is a DerivedField
			type is Alpha 30
			if (ExportFile.PurchaseOrder)
				return EligibilityGroup
			else
				return blank

		GeneralLedgerJournalControlDerivedEligibilityGroup is a DerivedField
			type is Alpha 30
			if (ExportFile.GeneralLedgerJournalControl)
				return EligibilityGroup
			else
				return blank

		FailedWorkUnitCount is a ComputeField
			type is Numeric 3
			(instance count of FailedWorkUnitRel)
			
		PreviewRecordCount is a ComputeField
			type is Numeric 9
			(instance count of FileCreationRecordsNotProcessed)
			
		ProcessedRecordCount is a ComputeField
			type is Numeric 9
			(instance count of FileCreationRecordsProcessed)
			
		OldestRecord is a DerivedField
			type is TimeStamp
			return first FileCreationRecordsProcessed.SystemTimeStamp
			
		TriggersInError is a DerivedField
			type is Numeric 5
			TriggersInError = TriggersFailedToStartCount + TriggersLostWhilePendingCount + TriggersLostWhileInProgressCount + TriggersTerminatedAbnormallyCount
			return TriggersInError
		
		TriggersFailedToStartCount is a ComputeField
			type is Numeric 4
			(instance count of AsyncActionTriggerFailedToStartRel)
			
		TriggersLostWhilePendingCount is a ComputeField
			type is Numeric 4
			(instance count of AsyncActionTriggerLostWhilePendingRel)
			
		TriggersLostWhileInProgressCount is a ComputeField
			type is Numeric 4
			(instance count of AsyncActionTriggerLostWhileInProgressRel)
			
		TriggersTerminatedAbnormallyCount is a ComputeField
			type is Numeric 4
			(instance count of AsyncActionTriggerTerminatedAbnormallyRel)

		BaseRelation is a DerivedField
			type is Alpha 50
			restricted
			if (ExportFile.PayablesInvoice)
				return "PayablesInvoiceRel."
			else
			if (ExportFile.GeneralLedgerTransaction)
				return "GeneralLedgerTransactionRel."
			else
			if (ExportFile.PurchaseOrderLine)
				return "PurchaseOrderLineRel."
			else
			if (ExportFile.InventoryLocation)
				return "InventoryLocationRel."
			else
			if (ExportFile.InventoryTransactionLine)
				return "InventoryTransactionLineRel."
			else
			if (ExportFile.GeneralLedgerTotal)
				return "GeneralLedgerTotalRel."
			else
			if (ExportFile.GLTransactionDetail)
				return "GLTransactionDetailRel."
			else
			if (ExportFile.Vendor)
				return "VendorRel."
			else
			if (ExportFile.Asset)
				return "AssetRel."
			else
			if (ExportFile.Scenario)
				return "ScenarioRel."
			else
			if (ExportFile.GeneralLedgerChartAccount)
				return "GeneralLedgerChartAccountRel."
			else
			if (ExportFile.BinGroup)
				return "BinGroupRel."
			else
			if (ExportFile.Contract)
				return "ContractRel."
			else
			if (ExportFile.Item)
				return "ItemRel."
			else
			if (ExportFile.RequesterRequestingLocation)
				return "RequesterRequestingLocationRel."
			else
			if (ExportFile.PurchaseOrder)
				return "PurchaseOrderRel."
			else
			if (ExportFile.GeneralLedgerJournalControl)
				return "GeneralLedgerJournalControlRel."

		BaseBusinessClass is a DerivedField
			type is Alpha 50
			restricted
			if (ExportFile.PayablesInvoice)
				return "PayablesInvoice"
			else
			if (ExportFile.GeneralLedgerTransaction)
				return "GeneralLedgerTransaction"
			else
			if (ExportFile.PurchaseOrderLine)
				return "PurchaseOrderLine"
			else
			if (ExportFile.InventoryLocation)
				return "InventoryLocation"
			else
			if (ExportFile.InventoryTransactionLine)
				return "InventoryTransactionLine"
			else
			if (ExportFile.GeneralLedgerTotal)
				return "GeneralLedgerTotal"
			else
			if (ExportFile.GLTransactionDetail)
				return "GLTransactionDetail"
			else
			if (ExportFile.Vendor)
				return "Vendor"
			else
			if (ExportFile.Asset)
				return "Asset"
			else
			if (ExportFile.Scenario)
				return "Scenario"
			else
			if (ExportFile.GeneralLedgerChartAccount)
				return "GeneralLedgerChartAccount"
			else
			if (ExportFile.BinGroup)
				return "BinGroup"
			else
			if (ExportFile.Contract)
				return "Contract"
			else
			if (ExportFile.Item)
				return "Item"
			else
			if (ExportFile.RequesterRequestingLocation)
				return "RequesterRequestingLocation"
			else
			if (ExportFile.PurchaseOrder)
				return "PurchaseOrder"
			else
			if (ExportFile.GeneralLedgerJournalControl)
				return "GeneralLedgerJournalControl"

		SortFieldOneSubtotalRows is a DerivedField
			type is Numeric 3
			LocalAlpha = SortSourceFieldOne
			LocalSubtotalLevel = 1
			return instance count of FileCreationRowSubtotalRel
			
		SortFieldTwoSubtotalRows is a DerivedField
			type is Numeric 3
			LocalAlpha = SortSourceFieldTwo
			LocalSubtotalLevel = 2
			return instance count of FileCreationRowSubtotalRel
			
		SortFieldThreeSubtotalRows is a DerivedField
			type is Numeric 3
			LocalAlpha = SortSourceFieldThree
			LocalSubtotalLevel = 3
			return instance count of FileCreationRowSubtotalRel
		
		SortFieldFourSubtotalRows is a DerivedField
			type is Numeric 3
			LocalAlpha = SortSourceFieldFour
			LocalSubtotalLevel = 4
			return instance count of FileCreationRowSubtotalRel
		
		SortFieldFiveSubtotalRows is a DerivedField
			type is Numeric 3
			LocalAlpha = SortSourceFieldFive
			LocalSubtotalLevel = 5
			return instance count of FileCreationRowSubtotalRel
			
		SortFieldSixSubtotalRows is a DerivedField
			type is Numeric 3
			LocalAlpha = SortSourceFieldSix
			LocalSubtotalLevel = 6
			return instance count of FileCreationRowSubtotalRel
			
		SortFieldSevenSubtotalRows is a DerivedField
			type is Numeric 3
			LocalAlpha = SortSourceFieldSeven
			LocalSubtotalLevel = 7
			return instance count of FileCreationRowSubtotalRel
			
		SortFieldEightSubtotalRows is a DerivedField
			type is Numeric 3
			LocalAlpha = SortSourceFieldEight
			LocalSubtotalLevel = 8
			return instance count of FileCreationRowSubtotalRel
			
		SortFieldNineSubtotalRows is a DerivedField
			type is Numeric 3
			LocalAlpha = SortSourceFieldNine
			LocalSubtotalLevel = 9
			return instance count of FileCreationRowSubtotalRel
			
		SortFieldTenSubtotalRows is a DerivedField
			type is Numeric 3
			LocalAlpha = SortSourceFieldTen
			LocalSubtotalLevel = 10
			return instance count of FileCreationRowSubtotalRel
			
		SortFieldElevenSubtotalRows is a DerivedField
			type is Numeric 3
			LocalAlpha = SortSourceFieldEleven
			LocalSubtotalLevel = 11
			return instance count of FileCreationRowSubtotalRel
			
		SortFieldTwelveSubtotalRows is a DerivedField
			type is Numeric 3
			LocalAlpha = SortSourceFieldTwelve
			LocalSubtotalLevel = 12
			return instance count of FileCreationRowSubtotalRel
			
		ColumnsThatOutputTotalCount is a ComputeField
			type is Numeric 3
			(instance count of FileCreationColumnDetailOutputtedTotalRel)		
			
		TotalSortLength is a DerivedField
			type is Numeric 3
			restricted
			for each SortFieldArray.SortField
				TotalSortLength += each.Length
			return TotalSortLength
			
		DerivedEndOfLineCharacter is a DerivedField
			type is Alpha 2
			restricted		
			if (EndOfLineCharacter.CarriageReturn)
				return CarriageReturnNative	
			if (EndOfLineCharacter.LineFeed)
				return LineFeedNative	
			if (EndOfLineCharacter.Both)
				return CarriageReturnNative + LineFeedNative	
			return NewLine2

		ReplacedValue is a NativeField
			type is Text
			restricted

		NewLine2 is a NativeField
			type is Alpha 2

		CarriageReturnNative		is a NativeField
			type is Alpha 1
			restricted

		LineFeedNative				is a NativeField
			type is Alpha 1
			restricted

		Tab		is a NativeField 
			type is Alpha 1

		
		EligibilityGroupSubject is a DerivedField
			type is Text
			default label is "Subject"
			if (PayablesInvoiceType)
				return "FileCreationPayablesInvoice"
			if (GeneralLedgerTransactionType)
				return "FileCreationGeneralLedgerTransaction"
			if (PurchaseOrderLineType)
				return "FileCreationPurchaseOrderLine"
			if (InventoryLocationType)
				return "FileCreationInventoryLocation"
			if (InventoryTransactionLineType)
				return "FileCreationInventoryTransactionLine"
			if (GeneralLedgerTotalType)
				return "FileCreationGeneralLedgerTotal"
			if (GLTransactionDetailType)
				return "FileCreationGLTransactionDetail"
			if (VendorType)
				return "FileCreationVendor"
			if (AssetType)
				return "FileCreationAsset"
			if (ScenarioType)
				return "FileCreationScenario"
			if (GeneralLedgerChartAccountType)
				return "FileCreationGeneralLedgerChartAccount"
			if (BinGroupType)
				return "FileCreationBinGroup"
			if (ContractType)
				return "FileCreationContract"
			if (ItemType)
				return "FileCreationItem"
			if (RequesterRequestingLocationType)
				return "FileCreationRequesterRequestingLocation"
			if (PurchaseOrderType)
				return "FileCreationPurchaseOrder"
			if (GeneralLedgerJournalControlType)
				return "FileCreationGeneralLedgerJournalControl"

		EligibilityGroupBusinessClass is a DerivedField
			type is Text
			default label is "Business_Class"
			if (PayablesInvoiceType)
				return "PayablesInvoice"
			if (GeneralLedgerTransactionType)
				return "GeneralLedgerTransaction"
			if (PurchaseOrderLineType)
				return "PurchaseOrderLine"
			if (InventoryLocationType)
				return "InventoryLocation"
			if (InventoryTransactionLineType)
				return "InventoryTransactionLine"
			if (GeneralLedgerTotalType)
				return "GeneralLedgerTotal"
			if (GLTransactionDetailType)
				return "GLTransactionDetail"
			if (VendorType)
				return "Vendor"
			if (AssetType)
				return "Asset"
			if (ScenarioType)
				return "Scenario"
			if (GeneralLedgerChartAccountType)
				return "GeneralLedgerChartAccount"
			if (BinGroupType)
				return "BinGroup"
			if (ContractType)
				return "Contract"
			if (ItemType)
				return "Item"
			if (RequesterRequestingLocationType)
				return "RequesterRequestingLocation"
			if (PurchaseOrderType)
				return "PurchaseOrder"
			if (GeneralLedgerJournalControlType)
				return "GeneralLedgerJournalControl"
			
	Conditions

		PayablesInvoiceType
			when (ExportFile.PayablesInvoice)
		
		GeneralLedgerTransactionType
			when (ExportFile.GeneralLedgerTransaction)

		PurchaseOrderLineType
			when (ExportFile.PurchaseOrderLine)
			
		InventoryLocationType
			when (ExportFile.InventoryLocation)

		InventoryTransactionLineType
			when (ExportFile.InventoryTransactionLine)

		GeneralLedgerTotalType
			when (ExportFile.GeneralLedgerTotal)
			
		GLTransactionDetailType
			when (ExportFile.GLTransactionDetail)

		VendorType
			when (ExportFile.Vendor)
		
		AssetType
			when (ExportFile.Asset)
		
		ScenarioType
			when (ExportFile.Scenario)
		
		GeneralLedgerChartAccountType
			when (ExportFile.GeneralLedgerChartAccount)

		BinGroupType
			when (ExportFile.BinGroup)

		ContractType
			when (ExportFile.Contract)

		ItemType
			when (ExportFile.Item)

		RequesterRequestingLocationType
			when (ExportFile.RequesterRequestingLocation)

		PurchaseOrderType
			when (ExportFile.PurchaseOrder)

		GeneralLedgerJournalControlType
			when (ExportFile.GeneralLedgerJournalControl)

		ApplicationBusinessClass
			when (ExportFile.PayablesInvoice
			or ExportFile.GeneralLedgerTransaction
			or ExportFile.PurchaseOrderLine
			or ExportFile.InventoryLocation
			or ExportFile.InventoryTransactionLine
			or ExportFile.GeneralLedgerTotal
			or ExportFile.GLTransactionDetail
			or ExportFile.Vendor
			or ExportFile.Asset
			or ExportFile.Scenario
			or ExportFile.GeneralLedgerChartAccount
			or ExportFile.BinGroup
			or ExportFile.Contract
			or ExportFile.Item
			or ExportFile.RequesterRequestingLocation
			or ExportFile.PurchaseOrder
			or ExportFile.GeneralLedgerJournalControl)
			
		FieldSeparatorEntered
			restricted
			when (FieldSeparator entered
			or    TabSeparator)
			
		MappingsExist
			restricted
			when (FileCreationRowDetail set exists
			and  (FileCreationColumnDetail set exists
			or    LinkedRowRel exists))
	

		SupportsOneToMany
			restricted
			when (ExportFile.PayablesInvoice
			or ExportFile.GeneralLedgerChartAccount
			or ExportFile.Asset
			or ExportFile.BinGroup
			or ExportFile.Contract
			or ExportFile.PurchaseOrder
			or ExportFile.Vendor)
			
		GeneratePreviewRecordsValid
			restricted
			when (ApplicationBusinessClass
			and   Active)
			
		DisplayKey3
			restricted
			when (false)

		DisplayKey4
			restricted
			when (false)
			
		DisplayKey5
			restricted
			when (false)		


		AtLeastOneRowHasColumnsWithAdditionalRowMappings
			restricted
			when (any FileCreationRowDetail set.ColumnsUseAdditionalRowMappings)
	
		RecordExists
			restricted
			when (FileCreationSetup entered)
	
		SendToProcessFlow
			restricted
			when (FlowToProcessFile entered)
			
		GenerateFileThreadedIsValid
			restricted
			when (Active)
		
		DisplayFileProcessing
			restricted
			when (!UseForTesting)
			
		GenerateFileValid
			restricted
			when (Active
			and   !UseForTesting)
			
		UsesProcessFlow
			restricted
			when (FlowToProcessFile entered)
		
		FileTypeIsFixedLength
			restricted
			when (FileType.FixedLength)

		FileTypeIsSeparated
			restricted
			when (FileType.Separated)				
			
		DisplayGenerateFileThreaded
			restricted
			when (Active
			and   ((ApplicationBusinessClass
			and     FileCreationRecordsNotProcessed exists)))				
			
		WorkUnitErrorsExist
			when (FailedWorkUnitCount > 0)
		
		TriggerErrorsExist
			when (TriggersInError > 0)
			
		ShowRecordSelectionOptionsTab
			when (PayablesInvoiceType
			or GeneralLedgerTransactionType
			or PurchaseOrderLineType
			or InventoryLocationType
			or InventoryTransactionLineType
			or GeneralLedgerTotalType
			or GLTransactionDetailType
			or VendorType
			or AssetType
			or ScenarioType
			or GeneralLedgerChartAccountType
			or BinGroupType
			or ContractType
			or ItemType
			or RequesterRequestingLocationType
			or PurchaseOrderType
			or GeneralLedgerJournalControlType)
			
		DisplaySortField2
			when (SortSourceFieldOne entered
			or    SortSourceFieldThree entered
			or    SortSourceFieldFour entered
			or    SortSourceFieldFive entered
			or    SortSourceFieldSix entered
			or    SortSourceFieldSeven entered
			or    SortSourceFieldEight entered
			or    SortSourceFieldNine entered
			or    SortSourceFieldTen entered
			or    SortSourceFieldEleven entered
			or    SortSourceFieldTwelve entered)
			
		DisplaySortField3
			when (SortSourceFieldTwo entered
			or    SortSourceFieldFour entered
			or    SortSourceFieldFive entered
			or    SortSourceFieldSix entered
			or    SortSourceFieldSeven entered
			or    SortSourceFieldEight entered
			or    SortSourceFieldNine entered
			or    SortSourceFieldTen entered
			or    SortSourceFieldEleven entered
			or    SortSourceFieldTwelve entered)
			
		DisplaySortField4
			when (SortSourceFieldThree entered
			or    SortSourceFieldFive entered
			or    SortSourceFieldSix entered
			or    SortSourceFieldSeven entered
			or    SortSourceFieldEight entered
			or    SortSourceFieldNine entered
			or    SortSourceFieldTen entered
			or    SortSourceFieldEleven entered
			or    SortSourceFieldTwelve entered)
			
		DisplaySortField5
			when (SortSourceFieldFour entered
			or    SortSourceFieldSix entered
			or    SortSourceFieldSeven entered
			or    SortSourceFieldEight entered
			or    SortSourceFieldNine entered
			or    SortSourceFieldTen entered
			or    SortSourceFieldEleven entered
			or    SortSourceFieldTwelve entered)
			
		DisplaySortField6
			when (SortSourceFieldFive entered
			or    SortSourceFieldSeven entered
			or    SortSourceFieldEight entered
			or    SortSourceFieldNine entered
			or    SortSourceFieldTen entered
			or    SortSourceFieldEleven entered
			or    SortSourceFieldTwelve entered)
			
		DisplaySortField7
			when (SortSourceFieldSix entered
			or    SortSourceFieldEight entered
			or    SortSourceFieldNine entered
			or    SortSourceFieldTen entered
			or    SortSourceFieldEleven entered
			or    SortSourceFieldTwelve entered)
			
		DisplaySortField8
			when (SortSourceFieldSeven entered
			or    SortSourceFieldNine entered
			or    SortSourceFieldTen entered
			or    SortSourceFieldEleven entered
			or    SortSourceFieldTwelve entered)
			
		DisplaySortField9
			when (SortSourceFieldEight entered
			or    SortSourceFieldTen entered
			or    SortSourceFieldEleven entered
			or    SortSourceFieldTwelve entered)
			
		DisplaySortField10
			when (SortSourceFieldNine entered
			or    SortSourceFieldEleven entered
			or    SortSourceFieldTwelve entered)
			
		DisplaySortField11
			when (SortSourceFieldTen entered
			or    SortSourceFieldTwelve entered)
			
		DisplaySortField12
			when (SortSourceFieldEleven entered)

		GenerateBlankDocument
			when (GenerationBehaviorForNoOutput.GenerateFileRecordWithDocument)

		ExportFileExists
			restricted
			when (ValidationReport.File entered
			or    MappingsDocument.File entered
			or    SetupExportFile.File entered)

		ValidationReportFileEntered
			restricted
			when (ValidationReport.File entered)

		MappingsDocumentFileEntered
			restricted
			when (MappingsDocument.File entered)

		SetupExportFileEntered
			restricted
			when (SetupExportFile.File entered)

		
		UseDynamicRowProcessing
			restricted
			when (FinanceEnterpriseGroup.FSM2404003FileCreationDynamicRowProcessingEnabled
			and   not DisableDynamicRowProcessing)
			
	Relations

		FileCreationSetupRel
			one-to-many relation to FileCreationSetup
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup				= actor.context.FinanceEnterpriseGroup
		FileCreationSetupOTORel
			one-to-one relation to FileCreationSetup
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup				= LocalFinanceEnterpriseGroup
				related.FileCreationSetup			= LocalFileCreationSetup
			
		FileCreationSetupDCKeyRel
			one-to-many relation to FileCreationSetup
			Field Mapping uses ByDCKey
				related.FinanceEnterpriseGroup				= LocalFinanceEnterpriseGroup
				related.DCKey						= LocalDCKey
			
		FileCreationFileRel
			one-to-many relation to FileCreationFile
			Field Mapping uses ByTimeStamp
				related.FinanceEnterpriseGroup		= FinanceEnterpriseGroup
				related.FileCreationSetup	= FileCreationSetup
				
		LastFileGeneratedRel
			one-to-many relation to FileCreationFile
			Field Mapping uses ByTimeStamp
				related.FinanceEnterpriseGroup		= FinanceEnterpriseGroup
				related.FileCreationSetup	= FileCreationSetup
				related.SystemTimeStamp		= LastGeneration
				related.SequenceNumber		= LastGenerationSequence

		FileCreationRowDetailOTORel
			one-to-one relation to FileCreationRowDetail
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup				= LocalFinanceEnterpriseGroup
				related.FileCreationSetup			= LocalFileCreationSetup
				related.FileCreationRowDetail		= LocalRow

		FileCreationRowDCKeyRel
			one-to-many relation to FileCreationRowDetail
			Field Mapping uses ByDCKey
				related.FinanceEnterpriseGroup				= LocalFinanceEnterpriseGroup
				related.FileCreationSetup			= LocalFileCreationSetup
				related.DCKey						= LocalDCKeyRow

		FileCreationLinkedSetupDCKeyRel
			one-to-many relation to FileCreationSetup
			Field Mapping uses ByDCKey
				related.FinanceEnterpriseGroup				= LocalFinanceEnterpriseGroup
				related.DCKey						= LinkedSetupDCKey

		FileCreationLinkedRowDCKeyRel
			one-to-many relation to FileCreationRowDetail
			Field Mapping uses ByDCKey
				related.FinanceEnterpriseGroup				= LocalFinanceEnterpriseGroup
				related.FileCreationSetup			= LocalFileCreationSetup2
				related.DCKey						= LinkedRowDCKey

		FileCreationRowDetailOTO2Rel
			one-to-one relation to FileCreationRowDetail
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup				= LocalFinanceEnterpriseGroup
				related.FileCreationSetup			= LocalFileCreationSetup2
				related.FileCreationRowDetail		= LocalRow2

		FileCreationRowDetailByRowRel
			one-to-many relation to FileCreationRowDetail
			Field Mapping uses ByRowOrder
				related.FinanceEnterpriseGroup			= FinanceEnterpriseGroup
				related.FileCreationSetup		= FileCreationSetup
				related.RowOrder				= LocalRow
				
		FileCreationRowDetailRel
			one-to-many relation to FileCreationRowDetail
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup			= LocalFinanceEnterpriseGroup
				related.FileCreationSetup		= LocalFileCreationSetup
				
		FileCreationLocalColumnDetailRel
			one-to-many relation to FileCreationColumnDetail
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup			= LocalFinanceEnterpriseGroup
				related.FileCreationSetup		= LocalFileCreationSetup
				related.FileCreationRowDetail	= LocalRow
				
		FileCreationLocalDataMappingRel
			one-to-many relation to FileCreationDataMapping
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup				= LocalFinanceEnterpriseGroup
				related.FileCreationSetup			= LocalFileCreationSetup
				related.FileCreationRowDetail		= LocalRow
				related.FileCreationColumnDetail	= LocalColumn
				
		FileCreationRowDetailSetRel is a FileCreationRowDetail(FileCreationSetup) set
		
		FileCreationRowDetailLocalRel
			one-to-many relation to FileCreationRowDetail
			Field Mapping uses ByRowOrder
				related.FinanceEnterpriseGroup			= FinanceEnterpriseGroup
				related.FileCreationSetup		= LocalFileCreationSetup
				
		FileCreationColumnDetailOTORel
			one-to-one relation to FileCreationColumnDetail
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup				= LocalFinanceEnterpriseGroup
				related.FileCreationSetup			= LocalFileCreationSetup
				related.FileCreationRowDetail		= LocalRow
				related.FileCreationColumnDetail	= LocalColumn
							
		FileCreationColumnDCKeyRel
			one-to-many relation to FileCreationColumnDetail
			Field Mapping uses ByDCKey
				related.FinanceEnterpriseGroup				= LocalFinanceEnterpriseGroup
				related.FileCreationSetup			= LocalFileCreationSetup
				related.FileCreationRowDetail		= LocalRow
				related.DCKey						= LocalDCKeyColumn

		FileCreationColumnDetailRel
			one-to-many relation to FileCreationColumnDetail
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup			= FinanceEnterpriseGroup
				related.FileCreationSetup		= FileCreationSetup
				related.FileCreationRowDetail	= LocalRow
		
		FileCreationColumnDetailLocalRel
			one-to-many relation to FileCreationColumnDetail
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup			= FinanceEnterpriseGroup
				related.FileCreationSetup		= LocalFileCreationSetup
				related.FileCreationRowDetail	= LocalRow
		
		FileCreationDataMappingOTORel
			one-to-one relation to FileCreationDataMapping
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup				= LocalFinanceEnterpriseGroup
				related.FileCreationSetup			= LocalFileCreationSetup
				related.FileCreationRowDetail		= LocalRow
				related.FileCreationColumnDetail	= LocalColumn
				related.FileCreationDataMapping		= LocalDataMapping
							
		FileCreationDataMappingDCKeyRel
			one-to-many relation to FileCreationDataMapping
			Field Mapping uses ByDCKey
				related.FinanceEnterpriseGroup				= LocalFinanceEnterpriseGroup
				related.FileCreationSetup			= LocalFileCreationSetup
				related.FileCreationRowDetail		= LocalRow
				related.FileCreationColumnDetail	= LocalColumn
				related.DCKey						= LocalDCKeyDataMapping

		FileCreationDataMappingRel
			one-to-many relation to FileCreationDataMapping
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup				= FinanceEnterpriseGroup
				related.FileCreationSetup			= FileCreationSetup
				related.FileCreationRowDetail		= LocalRow
				related.FileCreationColumnDetail	= LocalColumn
				
		FileCreationDataMappingLocalRel
			one-to-many relation to FileCreationDataMapping
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup				= FinanceEnterpriseGroup
				related.FileCreationSetup			= LocalFileCreationSetup
				related.FileCreationRowDetail		= LocalRow
				related.FileCreationColumnDetail	= LocalColumn
				
		FileCreationColumnDetailWithDataMappingRel
			one-to-many relation to FileCreationColumnDetail
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup				= FinanceEnterpriseGroup
				related.FileCreationSetup			= FileCreationSetup
			Instance Selection
				where (related.DataMappingsExist = true)

		FileCreationRecordPurgeRel 
			one-to-many relation to FileCreationRecord
			Field Mapping uses ByTimeStamp
				related.FinanceEnterpriseGroup		= LocalFinanceEnterpriseGroup
				related.FileCreationSetup	= LocalFileCreationSetup
			Instance Selection
				where (related.SystemTimeStamp <= LocalPurgeDate
				and    related.Status.Processed)
				
		FileCreationFilePurgeRel 
			one-to-many relation to FileCreationFile
			Field Mapping uses ByTimeStamp
				related.FinanceEnterpriseGroup		= LocalFinanceEnterpriseGroup
				related.FileCreationSetup	= LocalFileCreationSetup
			Instance Selection
				where (related.SystemTimeStamp <= LocalPurgeDate
				and    related.BaselineTest		= false)
				
		FileCreationFileThreadRel
			one-to-many relation to FileCreationFile
			Field Mapping uses ByThreadGroupID	
				related.FinanceEnterpriseGroup		= FinanceEnterpriseGroup
				related.FileCreationSetup	= FileCreationSetup
				related.ThreadGroupID		= LocalThreadGroupID
				
		MergedFileCreationFileRel
			one-to-one relation to FileCreationFile
			Field Mapping uses ByTimeStamp	
				related.FinanceEnterpriseGroup		= FinanceEnterpriseGroup
				related.FileCreationSetup	= FileCreationSetup
				related.SystemTimeStamp		= LocalMergedFileSystemTimeStamp
				related.SequenceNumber		= LocalMergedFileSequenceNumber
				
		FileCreationFileUpdateRel
			one-to-one relation to FileCreationFile
			Field Mapping uses ByTimeStamp	
				related.FinanceEnterpriseGroup		= FinanceEnterpriseGroup
				related.FileCreationSetup	= FileCreationSetup
				related.SystemTimeStamp		= LocalTimeStamp
				related.SequenceNumber		= LocalSequenceNumber
				
		MergedLastFileCreationRecordRel
			one-to-many relation to FileCreationRecord
			Field Mapping uses ByRunSystemTimeStamp
				related.FinanceEnterpriseGroup		= FinanceEnterpriseGroup
				related.FileCreationSetup	= FileCreationSetup
				related.RunSystemTimeStamp	= LocalMergedFileSystemTimeStamp
		
		FileCreationRecordsNotProcessed
			one-to-many relation to FileCreationRecord
			Field Mapping uses ByStatus
				related.FinanceEnterpriseGroup			= FinanceEnterpriseGroup
				related.FileCreationSetup		= FileCreationSetup
			Instance Selection
				where(related.Status.NotProcessed
				or	  related.Status.Error)
				
		FileCreationRecordsProcessed 
			one-to-many relation to FileCreationRecord
			Field Mapping uses ByStatus
				related.FinanceEnterpriseGroup			= FinanceEnterpriseGroup
				related.FileCreationSetup		= FileCreationSetup
				related.Status					= 3

		FileCreationRecordRel
			one-to-one relation to FileCreationRecord
			Field Mapping uses ByTimeStamp			
				related.FinanceEnterpriseGroup		= FinanceEnterpriseGroup
				related.FileCreationSetup	= FileCreationSetup
				related.Key1				= LocalKey1
				related.Key2				= LocalKey2
				related.Key3				= LocalKey3
				related.Key4				= LocalKey4
				related.Key5				= LocalKey5
				related.Key6				= LocalKey6
				related.Key7				= LocalKey7
				related.Key8				= LocalKey8
				related.Key9				= LocalKey9
				related.Key10				= LocalKey10
				related.Key11				= LocalKey11
				related.SystemTimeStamp		= LocalSystemTimeStamp
				related.TransactionId		= LocalTransactionId
				
		PfiServiceVariableRel
			one-to-one relation to PfiServiceVariable
			Field Mapping uses symbolic key
				related.PfiServiceDefinition	= FlowToProcessFile
				related.PfiServiceVariable		= PfiServiceVariableKey
				
		LinkedRowRel
			one-to-many relation to FileCreationRowDetail
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup 		= FinanceEnterpriseGroup
				related.FileCreationSetup   = FileCreationSetup
			Instance Selection
				where (related.LinkedRow entered)
				
		LinkedSetupRel
			one-to-many relation to FileCreationRowDetail
			Field Mapping uses ByLinkedSetup
				related.FinanceEnterpriseGroup = FinanceEnterpriseGroup
				related.LinkedSetup    = FileCreationSetup
			Instance Selection
				where (related.LinkedSetup.ExportFile != FileCreationSetup.ExportFile)
				
		LinkedRowSelectRel
			one-to-many relation to FileCreationRowDetail
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup = FinanceEnterpriseGroup
				related.FileCreationSetup = FileCreationSetup
			Instance Selection
				where (related.Subtotal = false)
			
		IONDocumentRel
			one-to-many relation to IONDocument
			Field Mapping uses symbolic key
				related.IONDocument = LocalIONDocumentName
				
		OldIONDocumentRel
			one-to-many relation to IONDocument
			Field Mapping uses symbolic key
				related.IONDocument = LocalOldIONDocumentName
				
		FileCreationSetupSameIONDocumentRel
			one-to-many relation to FileCreationSetup
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup = FinanceEnterpriseGroup
			Instance Selection
				where (related.IONDocumentName = IONDocumentName
				and    related.IONDocumentName entered
				and    related.FileCreationSetup != FileCreationSetup
				and    related.AutomaticallySendFileToION	= true)
				
		FileCreationSetupOldIONDocumentRel
			one-to-many relation to FileCreationSetup
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup = FinanceEnterpriseGroup
			Instance Selection
				where (related.IONDocumentName = LocalOldIONDocumentName
				and    related.IONDocumentName entered
				and    related.FileCreationSetup != FileCreationSetup
				and    related.AutomaticallySendFileToION	= true)
				
		FileCreationTestRel
			one-to-many relation to FileCreationTest
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup 	  = FinanceEnterpriseGroup
				related.FileCreationSetup = FileCreationSetup
				
		BaselineFileCreationFileRel
			one-to-many relation to FileCreationFile
			Field Mapping uses ByTimeStamp
				related.FinanceEnterpriseGroup		= FinanceEnterpriseGroup
				related.FileCreationSetup	= FileCreationSetup
			Instance Selection
				where (related.BaselineTest 	= true)
				
		AsyncRequestRel
			one-to-many relation to AsyncActionRequest
			Field Mapping uses ByGroup
				related.Group       	   = "filecreation"
				related.ImplementingClass  = "FileCreationSetup"
				related.AsyncAction = "GenerateFileThreaded"
			Instance Selection
				where (related.SynchronizedGroup = AsyncSynchronizedGroup
				and	   (related.IsScheduled					= true
				or		related.PendingScheduling			= true))
				
		GeneratePreviewRecordsAsyncRequestRel
			one-to-many relation to AsyncActionRequest
			Field Mapping uses ByGroup
				related.Group       	   = "filecreation"
				related.ImplementingClass  = "FileCreationSetup"
				related.AsyncAction = "GeneratePreviewRecords"
			Instance Selection
				where (related.SynchronizedGroup			= GeneratePreviewRecordsAsyncSynchronizedGroup
				and    related.MappingField2     			= FileCreationSetup
				and	   (related.IsScheduled					= true
				or		related.PendingScheduling			= true))
				
		AsyncActionTriggerLostWhilePendingRel
			one-to-many relation to AsyncActionTrigger
			Field Mapping uses AsyncActionTriggerByStatus
				related.Status = 3 
			Instance Selection
				where ((related.AsyncActionRequest.InvokedFrom.SynchronizedGroup = AsyncSynchronizedGroup
				or     (related.AsyncActionRequest.InvokedFrom.SynchronizedGroup = GeneratePreviewRecordsAsyncSynchronizedGroup
				and     related.AsyncActionRequest.InvokedFrom.MappingField2     = FileCreationSetup))
				and    related.AsyncActionRequest.Group 	  = "filecreation"
				and   (related.AsyncActionRequest.AsyncAction = "GenerateFileThreaded"
				or     related.AsyncActionRequest.AsyncAction = "GenerateFileThread"
				or     related.AsyncActionRequest.AsyncAction = "GeneratePreviewRecords"
				or     related.AsyncActionRequest.AsyncAction = "GeneratePreviewRecordsForRunGroup"))
				
		AsyncActionTriggerFailedToStartRel
			one-to-many relation to AsyncActionTrigger
			Field Mapping uses AsyncActionTriggerByStatus
				related.Status = 4 
			Instance Selection
				where ((related.AsyncActionRequest.InvokedFrom.SynchronizedGroup = AsyncSynchronizedGroup
				or     (related.AsyncActionRequest.InvokedFrom.SynchronizedGroup = GeneratePreviewRecordsAsyncSynchronizedGroup
				and     related.AsyncActionRequest.InvokedFrom.MappingField2     = FileCreationSetup))
				and    related.AsyncActionRequest.Group 	  = "filecreation"
				and   (related.AsyncActionRequest.AsyncAction = "GenerateFileThreaded"
				or     related.AsyncActionRequest.AsyncAction = "GenerateFileThread"
				or     related.AsyncActionRequest.AsyncAction = "GeneratePreviewRecords"
				or     related.AsyncActionRequest.AsyncAction = "GeneratePreviewRecordsForRunGroup"))
				
		AsyncActionTriggerLostWhileInProgressRel
			one-to-many relation to AsyncActionTrigger
			Field Mapping uses AsyncActionTriggerByStatus
				related.Status = 6 
			Instance Selection
				where ((related.AsyncActionRequest.InvokedFrom.SynchronizedGroup = AsyncSynchronizedGroup
				or     (related.AsyncActionRequest.InvokedFrom.SynchronizedGroup = GeneratePreviewRecordsAsyncSynchronizedGroup
				and     related.AsyncActionRequest.InvokedFrom.MappingField2     = FileCreationSetup))
				and    related.AsyncActionRequest.Group 	  = "filecreation"
				and   (related.AsyncActionRequest.AsyncAction = "GenerateFileThreaded"
				or     related.AsyncActionRequest.AsyncAction = "GenerateFileThread"
				or     related.AsyncActionRequest.AsyncAction = "GeneratePreviewRecords"
				or     related.AsyncActionRequest.AsyncAction = "GeneratePreviewRecordsForRunGroup"))
				
		AsyncActionTriggerTerminatedAbnormallyRel
			one-to-many relation to AsyncActionTrigger
			Field Mapping uses AsyncActionTriggerByStatus
				related.Status = 7 
			Instance Selection
				where ((related.AsyncActionRequest.InvokedFrom.SynchronizedGroup = AsyncSynchronizedGroup
				or     (related.AsyncActionRequest.InvokedFrom.SynchronizedGroup = GeneratePreviewRecordsAsyncSynchronizedGroup
				and     related.AsyncActionRequest.InvokedFrom.MappingField2     = FileCreationSetup))
				and    related.AsyncActionRequest.Group 	  = "filecreation"
				and   (related.AsyncActionRequest.AsyncAction = "GenerateFileThreaded"
				or     related.AsyncActionRequest.AsyncAction = "GenerateFileThread"
				or     related.AsyncActionRequest.AsyncAction = "GeneratePreviewRecords"
				or     related.AsyncActionRequest.AsyncAction = "GeneratePreviewRecordsForRunGroup"))
				
		WorkUnitRel
			one-to-many relation to PfiWorkunit
			Field Mapping uses ByServDefFlowDefFlowVersionWorkunit
				related.ServiceDefinition = FlowToProcessFile
			Instance Selection
				where (related.WorkTitle = WorkunitTitle)
				
		FailedWorkUnitRel
			one-to-many relation to PfiWorkunit
			Field Mapping uses ByServDefFlowDefFlowVersionWorkunit
				related.ServiceDefinition = FlowToProcessFile
			Instance Selection
				where (related.WorkTitle = WorkunitTitle
				and    related.Status.Failed)

		AsyncActionTriggerRel
    		one-to-many relation to AsyncActionTrigger
    		Field Mapping uses Queued
    			related.AsyncQueueDefinition	= LocalQueue
    			related.Status					= LocalStatus
				
		FileCreationRowSubtotalRel
			one-to-many relation to FileCreationRowDetail
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup = FinanceEnterpriseGroup
				related.FileCreationSetup = FileCreationSetup
			Instance Selection
				where (related.SubtotalField = LocalAlpha
				and    related.SubtotalLevel = LocalSubtotalLevel
				and    related.SubtotalField entered)
				
				
		FileCreationColumnDetailOutputtedTotalRel
			one-to-many relation to FileCreationColumnDetail
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup = FinanceEnterpriseGroup
				related.FileCreationSetup = FileCreationSetup
			Instance Selection
				where (related.TotalForRow entered
				and    related.TotalForColumn entered)
				
		FileCreationRecordSortToBeRegeneratedRel
			one-to-many relation to FileCreationRecord
			Field Mapping uses BySortKey
				related.SortKey   			= "SORTKEYNEEDSTOBEREGENERATEDWILLHAPPENAUTOMATICALLY"
				related.FinanceEnterpriseGroup		= FinanceEnterpriseGroup
				related.FileCreationSetup	= FileCreationSetup
				
		IONConnectionRel
			one-to-one relation to IONConnection
			Field Mapping uses symbolic key
				related.IONConnection = 2

		FileCreationTemporaryRel
			one-to-many relation to FileCreationTemporary
			Field Mapping uses ByTimeStamp
				related.FinanceEnterpriseGroup 		= FinanceEnterpriseGroup
				related.FileCreationSetup   = FileCreationSetup

		
		FileCreationColumnDetailAdditionalRecordMappingRel
			one-to-many relation to FileCreationColumnDetail
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup  = FinanceEnterpriseGroup 
				related.FileCreationSetup 		= FileCreationSetup
			Instance Selection
				where (related.AdditionalRowMapping1Entered)

	Field Rules
				
		Description
			required

		Active
			constraint (MappingsExist)
				"SetupCannotBeActivatedIfMappingsHaveNotBeenDefined"
			
			constraint (FileName entered)
				"SetupCannotBeActivatedIfFileNameHasNotBeenEntered"	

	    FieldSeparator
			if (FileType.FixedLength)
				initialize FieldSeparator
			if (TabSeparator)
				force default to Tab	
				
				
    	IncludeSeparatorAtBeginningOfRow
			if (FileType.FixedLength)
				initialize IncludeSeparatorAtBeginningOfRow

			constraint (FieldSeparatorEntered)
				"FieldCannotBeSelectedUnlessFieldSeparatorIsEntered"

    	FieldDelimiter
			if (FileType.FixedLength)
				initialize FieldDelimiter

		ExportFile
			constraint (LinkedSetupRel not exists)
				"SetupIsLinkedToAnotherRow;CannotChangeExportFile"
							
		DCKey
			cannot be changed

		FileNameTimeStampFormat
			default to "%1$tY%1$tm%1$td%1$tH%1$tM%1$tS%1$tL"
			
			LocalAlpha = CurrentSystemTimeStamp using "<FileNameTimeStampFormat>"
			if (LocalAlpha contains "*Bad JavaFormat*")
				constraint (false)
					"TimeStampFormatIsInvalid"
			
		FlowToProcessFile
			constraint (PfiServiceFinanceEnterpriseGroupExists
			and			PfiServiceFileCreationSetupExists
			and			PfiServiceSystemTimeStampExists
			and			PfiServiceSequenceNumberExists)
				"Finance_Enterprise_Group,_File_Creation_Setup,_System_Time_StampAnd_Sequence_NumberVariablesMustExistForTheServiceAssociatedWithSpecifiedProcessFile."
			constraint (AutomaticallySendFileToION not entered)
				"AFlowCannotBeSelectedIfFileIsBeingSentToION"
		
		AutomaticallySendFileToION
			constraint (FlowToProcessFile not entered)
				"TheFileCannotBeSentToIONIfAFlowIsSelected"
				
			if (AutomaticallySendFileToION
			and IONConnectionRel.Status != 1)
				confirmation required
					"AHealthyIMSConnectionIsRequiredToAutomaticallySendFilesToION,Proceed?"
		
		IONDocumentName
			if (AutomaticallySendFileToION entered)
				required
				
		NumberOfRecordsBeforeNewFile
			if (FileSegmentLimit.NumberOfRecords)
				required
				
		NumberOfMegabytesBeforeNewFile	
			if (FileSegmentLimit.NumberOfMegabytes)
				required
			constraint (NumberOfMegabytesBeforeNewFile <= 500)
				"NumberOfMegabytesBeforeNewFileCannotExceed500" 
				
		FileSegmentLimit
			constraint (not ThreadingMethod.MergedFileForThreads)
				"CannotSegmentAThreadedFileThatIsMerged" 
				
		ThreadingMethod
			if (FileCreationRecordsNotProcessed exists)
				cannot be changed
					"CannotModifyThreadingWhenUnprocessedRecordsExist"
				
		PayablesInvoiceGroupSelection
			if (PayablesInvoiceGroupSelection entered
			and ExportFile.PayablesInvoice)
				EligibilityGroup = PayablesInvoiceGroupSelection

		GeneralLedgerTransactionGroupSelection
			if (GeneralLedgerTransactionGroupSelection entered
			and ExportFile.GeneralLedgerTransaction)
				EligibilityGroup = GeneralLedgerTransactionGroupSelection

		PurchaseOrderLineGroupSelection
			if (PurchaseOrderLineGroupSelection entered
			and ExportFile.PurchaseOrderLine)
				EligibilityGroup = PurchaseOrderLineGroupSelection
				
		InventoryLocationGroupSelection
			if (InventoryLocationGroupSelection entered
			and ExportFile.InventoryLocation)
				EligibilityGroup = InventoryLocationGroupSelection

		InventoryTransactionLineGroupSelection
			if (InventoryTransactionLineGroupSelection entered
			and ExportFile.InventoryTransactionLine)
				EligibilityGroup = InventoryTransactionLineGroupSelection
		
		GeneralLedgerTotalGroupSelection
			if (GeneralLedgerTotalGroupSelection entered
			and ExportFile.GeneralLedgerTotal)
				EligibilityGroup = GeneralLedgerTotalGroupSelection
		
		GLTransactionDetailGroupSelection
			if (GLTransactionDetailGroupSelection entered
			and ExportFile.GLTransactionDetail)
				EligibilityGroup = GLTransactionDetailGroupSelection
		
		VendorGroupSelection
			if (VendorGroupSelection entered
			and ExportFile.Vendor)
				EligibilityGroup = VendorGroupSelection

		AssetGroupSelection
			if (AssetGroupSelection entered
			and ExportFile.Asset)
				EligibilityGroup = AssetGroupSelection
		
		ScenarioGroupSelection
			if (ScenarioGroupSelection entered
			and ExportFile.Scenario)
				EligibilityGroup = ScenarioGroupSelection
		
		GeneralLedgerChartAccountGroupSelection
			if (GeneralLedgerChartAccountGroupSelection entered
			and ExportFile.GeneralLedgerChartAccount)
				EligibilityGroup = GeneralLedgerChartAccountGroupSelection
		
		BinGroupGroupSelection
			if (BinGroupGroupSelection entered
			and ExportFile.BinGroup)
				EligibilityGroup = BinGroupGroupSelection

		ContractGroupSelection
			if (ContractGroupSelection entered
			and ExportFile.Contract)
				EligibilityGroup = ContractGroupSelection

		ItemGroupSelection
			if (ItemGroupSelection entered
			and ExportFile.Item)
				EligibilityGroup = ItemGroupSelection

		RequesterRequestingLocationGroupSelection
			if (RequesterRequestingLocationGroupSelection entered
			and ExportFile.RequesterRequestingLocation)
				EligibilityGroup = RequesterRequestingLocationGroupSelection
		
		PurchaseOrderGroupSelection
			if (PurchaseOrderGroupSelection entered
			and ExportFile.PurchaseOrder)
				EligibilityGroup = PurchaseOrderGroupSelection
		
		GeneralLedgerJournalControlGroupSelection
			if (GeneralLedgerJournalControlGroupSelection entered
			and ExportFile.GeneralLedgerJournalControl)
				EligibilityGroup = GeneralLedgerJournalControlGroupSelection
				
		EligibilityGroup
			if (ExportFile changed)
				initialize EligibilityGroup 
				
		SortFieldArray
			
			if (FileCreationRecordsNotProcessed exists)
				cannot be changed
					"CannotModifySortingWhenUnprocessedRecordsExist"
					
			constraint (TotalSortLength <= 240)
				"TotalLengthAcrossSortFieldsCannotExceed240"
				
			if (SortFieldArray.SortField[1].FieldDataType entered
			or  SortFieldArray.SortField[1].Length entered)
				constraint (SortSourceFieldOne entered)
					"SourceFieldMustBeEntered"
			if (SortFieldArray.SortField[2].FieldDataType entered
			or  SortFieldArray.SortField[2].Length entered)
				constraint (SortSourceFieldTwo entered)
					"SourceFieldMustBeEntered"
			if (SortFieldArray.SortField[3].FieldDataType entered
			or  SortFieldArray.SortField[3].Length entered)
				constraint (SortSourceFieldThree entered)
					"SourceFieldMustBeEntered"
			if (SortFieldArray.SortField[4].FieldDataType entered
			or  SortFieldArray.SortField[4].Length entered)
				constraint (SortSourceFieldFour entered)
					"SourceFieldMustBeEntered"
			if (SortFieldArray.SortField[5].FieldDataType entered
			or  SortFieldArray.SortField[5].Length entered)
				constraint (SortSourceFieldFive entered)
					"SourceFieldMustBeEntered"
			if (SortFieldArray.SortField[6].FieldDataType entered
			or  SortFieldArray.SortField[6].Length entered)
				constraint (SortSourceFieldSix entered)
					"SourceFieldMustBeEntered"
			if (SortFieldArray.SortField[7].FieldDataType entered
			or  SortFieldArray.SortField[7].Length entered)
				constraint (SortSourceFieldSeven entered)
					"SourceFieldMustBeEntered"
			if (SortFieldArray.SortField[8].FieldDataType entered
			or  SortFieldArray.SortField[8].Length entered)
				constraint (SortSourceFieldEight entered)
					"SourceFieldMustBeEntered"
			if (SortFieldArray.SortField[9].FieldDataType entered
			or  SortFieldArray.SortField[9].Length entered)
				constraint (SortSourceFieldNine entered)
					"SourceFieldMustBeEntered"
			if (SortFieldArray.SortField[10].FieldDataType entered
			or  SortFieldArray.SortField[10].Length entered)
				constraint (SortSourceFieldTen entered)
					"SourceFieldMustBeEntered"
			if (SortFieldArray.SortField[11].FieldDataType entered
			or  SortFieldArray.SortField[11].Length entered)
				constraint (SortSourceFieldEleven entered)
					"SourceFieldMustBeEntered"
			if (SortFieldArray.SortField[12].FieldDataType entered
			or  SortFieldArray.SortField[12].Length entered)
				constraint (SortSourceFieldTwelve entered)
					"SourceFieldMustBeEntered"
					
		ExcludeSeparatorWhenEmpty
			if (FileType.FixedLength)
				initialize ExcludeSeparatorWhenEmpty

			constraint (FieldSeparatorEntered)
				"FieldCannotBeSelectedUnlessFieldSeparatorIsEntered"

		RecordEndOfLineCharacter
			if (FileType.FixedLength)
				initialize RecordEndOfLineCharacter
					
		SortSourceFieldOne
		
			constraint (SortFieldArray.SortField[1].FieldDataType entered)
				"DataTypeMustBeEntered"
				
			constraint (SortFieldArray.SortField[1].Length entered)
				"LengthMustBeEntered"
				
			if (FileCreationRecordsNotProcessed exists)
				cannot be changed
					"CannotModifySortingWhenUnprocessedRecordsExist"
					
			if (SortSourceFieldOne changed
			and SortSourceFieldOne = blank)
				initialize SortFieldArray.SortField[1].FieldDataType
				initialize SortFieldArray.SortField[1].Length
				LocalAlpha 		   = old SortSourceFieldOne
				LocalSubtotalLevel = 1
				constraint (FileCreationRowSubtotalRel not exists)
					"CannotClearWhileSubtotalRowExists"
				
			if (SortSourceFieldOne changed
			and SortSourceFieldOne entered)
				LocalAlpha 		   = old SortSourceFieldOne
				LocalSubtotalLevel = 1
				for each FileCreationRowSubtotalRel
					invoke Update each
						invoked.SubtotalField = SortSourceFieldOne
					
		SortSourceFieldTwo
		
			constraint (SortFieldArray.SortField[2].FieldDataType entered)
				"DataTypeMustBeEntered"
				
			constraint (SortFieldArray.SortField[2].Length entered)
				"LengthMustBeEntered"
		
			if (FileCreationRecordsNotProcessed exists)
				cannot be changed
					"CannotModifySortingWhenUnprocessedRecordsExist"
					
			if (SortSourceFieldTwo changed
			and SortSourceFieldTwo = blank)
				initialize SortFieldArray.SortField[2].FieldDataType
				initialize SortFieldArray.SortField[2].Length
				LocalAlpha 		   = old SortSourceFieldTwo
				LocalSubtotalLevel = 2
				constraint (FileCreationRowSubtotalRel not exists)
					"CannotClearWhileSubtotalRowExists"
					
			if (SortSourceFieldTwo changed
			and SortSourceFieldTwo entered)
				LocalAlpha 		   = old SortSourceFieldTwo
				LocalSubtotalLevel = 2
				for each FileCreationRowSubtotalRel
					invoke Update each
						invoked.SubtotalField = SortSourceFieldTwo
		
		SortSourceFieldThree
		
			constraint (SortFieldArray.SortField[3].FieldDataType entered)
				"DataTypeMustBeEntered"
				
			constraint (SortFieldArray.SortField[3].Length entered)
				"LengthMustBeEntered"
		
			if (FileCreationRecordsNotProcessed exists)
				cannot be changed
					"CannotModifySortingWhenUnprocessedRecordsExist"
					
			if (SortSourceFieldThree changed
			and SortSourceFieldThree = blank)
				initialize SortFieldArray.SortField[3].FieldDataType
				initialize SortFieldArray.SortField[3].Length
				LocalAlpha 		   = old SortSourceFieldThree
				LocalSubtotalLevel = 3
				constraint (FileCreationRowSubtotalRel not exists)
					"CannotClearWhileSubtotalRowExists"
					
			if (SortSourceFieldThree changed
			and SortSourceFieldThree entered)
				LocalAlpha 		   = old SortSourceFieldThree
				LocalSubtotalLevel = 3
				for each FileCreationRowSubtotalRel
					invoke Update each
						invoked.SubtotalField = SortSourceFieldThree
		
		SortSourceFieldFour
		
			constraint (SortFieldArray.SortField[4].FieldDataType entered)
				"DataTypeMustBeEntered"
				
			constraint (SortFieldArray.SortField[4].Length entered)
				"LengthMustBeEntered"
		
			if (FileCreationRecordsNotProcessed exists)
				cannot be changed
					"CannotModifySortingWhenUnprocessedRecordsExist"
					
			if (SortSourceFieldFour changed
			and SortSourceFieldFour = blank)
				initialize SortFieldArray.SortField[4].FieldDataType
				initialize SortFieldArray.SortField[4].Length
				LocalAlpha 		   = old SortSourceFieldFour
				LocalSubtotalLevel = 4
				constraint (FileCreationRowSubtotalRel not exists)
					"CannotClearWhileSubtotalRowExists"
					
			if (SortSourceFieldFour changed
			and SortSourceFieldFour entered)
				LocalAlpha 		   = old SortSourceFieldFour
				LocalSubtotalLevel = 4
				for each FileCreationRowSubtotalRel
					invoke Update each
						invoked.SubtotalField = SortSourceFieldFour
		
		SortSourceFieldFive
		
			constraint (SortFieldArray.SortField[5].FieldDataType entered)
				"DataTypeMustBeEntered"
				
			constraint (SortFieldArray.SortField[5].Length entered)
				"LengthMustBeEntered"
		
			if (FileCreationRecordsNotProcessed exists)
				cannot be changed
					"CannotModifySortingWhenUnprocessedRecordsExist"
					
			if (SortSourceFieldFive changed
			and SortSourceFieldFive = blank)
				initialize SortFieldArray.SortField[5].FieldDataType
				initialize SortFieldArray.SortField[5].Length
				LocalAlpha 		   = old SortSourceFieldFive
				LocalSubtotalLevel = 5
				constraint (FileCreationRowSubtotalRel not exists)
					"CannotClearWhileSubtotalRowExists"
					
			if (SortSourceFieldFive changed
			and SortSourceFieldFive entered)
				LocalAlpha 		   = old SortSourceFieldFive
				LocalSubtotalLevel = 5
				for each FileCreationRowSubtotalRel
					invoke Update each
						invoked.SubtotalField = SortSourceFieldFive
		
		SortSourceFieldSix
		
			constraint (SortFieldArray.SortField[6].FieldDataType entered)
				"DataTypeMustBeEntered"
				
			constraint (SortFieldArray.SortField[6].Length entered)
				"LengthMustBeEntered"
		
			if (FileCreationRecordsNotProcessed exists)
				cannot be changed
					"CannotModifySortingWhenUnprocessedRecordsExist"
					
			if (SortSourceFieldSix changed
			and SortSourceFieldSix = blank)
				initialize SortFieldArray.SortField[6].FieldDataType
				initialize SortFieldArray.SortField[6].Length	
				LocalAlpha 		   = old SortSourceFieldSix
				LocalSubtotalLevel = 6
				constraint (FileCreationRowSubtotalRel not exists)
					"CannotClearWhileSubtotalRowExists"
					
			if (SortSourceFieldSix changed
			and SortSourceFieldSix entered)
				LocalAlpha 		   = old SortSourceFieldSix
				LocalSubtotalLevel = 6
				for each FileCreationRowSubtotalRel
					invoke Update each
						invoked.SubtotalField = SortSourceFieldSix	
			
		
		SortSourceFieldSeven
		
			constraint (SortFieldArray.SortField[7].FieldDataType entered)
				"DataTypeMustBeEntered"
				
			constraint (SortFieldArray.SortField[7].Length entered)
				"LengthMustBeEntered"
		
			if (FileCreationRecordsNotProcessed exists)
				cannot be changed
					"CannotModifySortingWhenUnprocessedRecordsExist"
					
			if (SortSourceFieldSeven changed
			and SortSourceFieldSeven = blank)
				initialize SortFieldArray.SortField[7].FieldDataType
				initialize SortFieldArray.SortField[7].Length
				LocalAlpha 		   = old SortSourceFieldSeven
				LocalSubtotalLevel = 7
				constraint (FileCreationRowSubtotalRel not exists)
					"CannotClearWhileSubtotalRowExists"
					
			if (SortSourceFieldSeven changed
			and SortSourceFieldSeven entered)
				LocalAlpha 		   = old SortSourceFieldSeven
				LocalSubtotalLevel = 7
				for each FileCreationRowSubtotalRel
					invoke Update each
						invoked.SubtotalField = SortSourceFieldSeven
		
		SortSourceFieldEight
		
			constraint (SortFieldArray.SortField[8].FieldDataType entered)
				"DataTypeMustBeEntered"
				
			constraint (SortFieldArray.SortField[8].Length entered)
				"LengthMustBeEntered"
		
			if (FileCreationRecordsNotProcessed exists)
				cannot be changed
					"CannotModifySortingWhenUnprocessedRecordsExist"
					
			if (SortSourceFieldEight changed
			and SortSourceFieldEight = blank)
				initialize SortFieldArray.SortField[8].FieldDataType
				initialize SortFieldArray.SortField[8].Length
				LocalAlpha 		   = old SortSourceFieldEight
				LocalSubtotalLevel = 8
				constraint (FileCreationRowSubtotalRel not exists)
					"CannotClearWhileSubtotalRowExists"
					
			if (SortSourceFieldEight changed
			and SortSourceFieldEight entered)
				LocalAlpha 		   = old SortSourceFieldEight
				LocalSubtotalLevel = 8
				for each FileCreationRowSubtotalRel
					invoke Update each
						invoked.SubtotalField = SortSourceFieldEight
		
		SortSourceFieldNine
		
			constraint (SortFieldArray.SortField[9].FieldDataType entered)
				"DataTypeMustBeEntered"
				
			constraint (SortFieldArray.SortField[9].Length entered)
				"LengthMustBeEntered"
		
			if (FileCreationRecordsNotProcessed exists)
				cannot be changed
					"CannotModifySortingWhenUnprocessedRecordsExist"
					
			if (SortSourceFieldNine changed
			and SortSourceFieldNine = blank)
				initialize SortFieldArray.SortField[9].FieldDataType
				initialize SortFieldArray.SortField[9].Length
				LocalAlpha 		   = old SortSourceFieldNine
				LocalSubtotalLevel = 9
				constraint (FileCreationRowSubtotalRel not exists)
					"CannotClearWhileSubtotalRowExists"
					
			if (SortSourceFieldNine changed
			and SortSourceFieldNine entered)
				LocalAlpha 		   = old SortSourceFieldNine
				LocalSubtotalLevel = 9
				for each FileCreationRowSubtotalRel
					invoke Update each
						invoked.SubtotalField = SortSourceFieldNine
		
		SortSourceFieldTen
		
			constraint (SortFieldArray.SortField[10].FieldDataType entered)
				"DataTypeMustBeEntered"
				
			constraint (SortFieldArray.SortField[10].Length entered)
				"LengthMustBeEntered"
		
			if (FileCreationRecordsNotProcessed exists)
				cannot be changed
					"CannotModifySortingWhenUnprocessedRecordsExist"
					
			if (SortSourceFieldTen changed
			and SortSourceFieldTen = blank)
				initialize SortFieldArray.SortField[10].FieldDataType
				initialize SortFieldArray.SortField[10].Length
				LocalAlpha 		   = old SortSourceFieldTen
				LocalSubtotalLevel = 10
				constraint (FileCreationRowSubtotalRel not exists)
					"CannotClearWhileSubtotalRowExists"
					
			if (SortSourceFieldTen changed
			and SortSourceFieldTen entered)
				LocalAlpha 		   = old SortSourceFieldTen
				LocalSubtotalLevel = 10
				for each FileCreationRowSubtotalRel
					invoke Update each
						invoked.SubtotalField = SortSourceFieldTen
		
		SortSourceFieldEleven
		
			constraint (SortFieldArray.SortField[11].FieldDataType entered)
				"DataTypeMustBeEntered"
				
			constraint (SortFieldArray.SortField[11].Length entered)
				"LengthMustBeEntered"
		
			if (FileCreationRecordsNotProcessed exists)
				cannot be changed
					"CannotModifySortingWhenUnprocessedRecordsExist"
					
			if (SortSourceFieldEleven changed
			and SortSourceFieldEleven = blank)
				initialize SortFieldArray.SortField[11].FieldDataType
				initialize SortFieldArray.SortField[11].Length
				LocalAlpha 		   = old SortSourceFieldEleven
				LocalSubtotalLevel = 11
				constraint (FileCreationRowSubtotalRel not exists)
					"CannotClearWhileSubtotalRowExists"
					
			if (SortSourceFieldEleven changed
			and SortSourceFieldEleven entered)
				LocalAlpha 		   = old SortSourceFieldEleven
				LocalSubtotalLevel = 11
				for each FileCreationRowSubtotalRel
					invoke Update each
						invoked.SubtotalField = SortSourceFieldEleven
		
		SortSourceFieldTwelve
		
			constraint (SortFieldArray.SortField[12].FieldDataType entered)
				"DataTypeMustBeEntered"
				
			constraint (SortFieldArray.SortField[12].Length entered)
				"LengthMustBeEntered"
		
			if (FileCreationRecordsNotProcessed exists)
				cannot be changed
					"CannotModifySortingWhenUnprocessedRecordsExist"
					
			if (SortSourceFieldTwelve changed
			and SortSourceFieldTwelve = blank)
				initialize SortFieldArray.SortField[12].FieldDataType
				initialize SortFieldArray.SortField[12].Length
				LocalAlpha 		   = old SortSourceFieldTwelve
				LocalSubtotalLevel = 12
				constraint (FileCreationRowSubtotalRel not exists)
					"CannotClearWhileSubtotalRowExists"

			if (SortSourceFieldTwelve changed
			and SortSourceFieldTwelve entered)
				LocalAlpha 		   = old SortSourceFieldTwelve
				LocalSubtotalLevel = 12
				for each FileCreationRowSubtotalRel
					invoke Update each
						invoked.SubtotalField = SortSourceFieldTwelve
						
		OverrideNumberOfThreads
			constraint (OverrideNumberOfThreads > 1)
				"Number_Of_ThreadsMustBeGreaterThan1For_MultithreadedSelection"
			default to 2
				
		TabSeparator
			if (!TabSeparator
			and TabSeparator changed)
				initialize FieldSeparator

		OutputTextForBlankDocument
			if (not GenerateBlankDocument)
				force default to blank

		CharacterExpression
			if (CharacterCheck.NonASCII)
				force default to "[^\x00-\x7F]"

		ErrorHandling
			if (ErrorHandling.Off)
				initialize ValidateRequiredFields     		
				initialize ValidateLength			   		
				initialize ValidateCharacters  			
				initialize CharacterCheck				
				initialize CharacterExpression

		ValidateCharacters
			if (!ValidateCharacters)
				initialize CharacterCheck
				initialize CharacterExpression

		FileMimeType
			if (FileMimeType.CSV)
				constraint (FileType.Separated)
					"FileTypeMustBeSeparated"

	Sets
		ByExportFile
			indexed
			Sort Order
				FinanceEnterpriseGroup
				ExportFile
				FileCreationSetup
				
		ByDCKey
			indexed
			Sort Order
				FinanceEnterpriseGroup
				DCKey
				FileCreationSetup

	Audit Entry Rules
		if (UseDynamicRowProcessing
		and	!RegenerateMappingsFlag.Needed
		and FieldsNeededForRegenerateMappings changed)
			RegenerateMappingsFlag = RegenerateMappingsFlag.Needed
				
	Actions
				
		Create is a Create Action
			
			Exit Rules
				if (AutomaticallySendFileToION)
					LocalIONDocumentName = IONDocumentName
					if (IONDocumentRel not exists)
						invoke Create IONDocument
							invoked.IONDocument = IONDocumentName
							invoked.Send 		= true

		CreateSetup is a Create Action
			default label is "Create"
							
		Update is an Update Action
			
			Exit Rules
				LocalIONDocumentName = IONDocumentName
				LocalOldIONDocumentName = old IONDocumentName
				
				if (AutomaticallySendFileToION
				and (AutomaticallySendFileToION changed
				or   IONDocumentName changed)
				and IONDocumentRel not exists)
					invoke Create IONDocument
						invoked.IONDocument = IONDocumentName
						invoked.Send 		= true
				
				if (!AutomaticallySendFileToION
				and AutomaticallySendFileToION changed
				and FileCreationSetupSameIONDocumentRel not exists
				and IONDocumentRel exists)	
					invoke Delete IONDocumentRel
				
				if (IONDocumentName changed
				and AutomaticallySendFileToION
				and FileCreationSetupOldIONDocumentRel not exists
				and OldIONDocumentRel exists)
					invoke Delete OldIONDocumentRel
					
				if ((SortSourceFieldOne changed
				and SortSourceFieldOne = blank)
				or (SortSourceFieldTwo changed
				and SortSourceFieldTwo = blank)
				or (SortSourceFieldThree changed
				and SortSourceFieldThree = blank)
				or (SortSourceFieldFour changed
				and SortSourceFieldFour = blank)
				or (SortSourceFieldFive changed
				and SortSourceFieldFive = blank)
				or (SortSourceFieldSix changed
				and SortSourceFieldSix = blank)
				or (SortSourceFieldSeven changed
				and SortSourceFieldSeven = blank)
				or (SortSourceFieldEight changed
				and SortSourceFieldEight = blank)
				or (SortSourceFieldNine changed
				and SortSourceFieldNine = blank)
				or (SortSourceFieldTen changed
				and SortSourceFieldTen = blank)
				or (SortSourceFieldEleven changed
				and SortSourceFieldEleven = blank))
					invoke CollapseSortFields
											
			Action Rules
				if (ExportFile changed 
				and MappingsExist)
					confirmation required
						"ChangingTheSourceFileCouldCauseErrors._PleaseVerifyAllFieldsUsedInTheMappingsExistInTheSelectedSourceFile._ProceedWithChange?"
				
					
		CollapseSortFields is an Update Action
			restricted
			Local Fields
				TempSortFieldArray
			Action Rules
				I1 = 1
				if (SortSourceFieldOne entered)
					include FileGeneration.SetTempSortField
						replace SortSourceField with SortSourceFieldOne 
						replace Index with 1
				if (SortSourceFieldTwo entered)
					include FileGeneration.SetTempSortField
						replace SortSourceField with SortSourceFieldTwo 
						replace Index with 2
				if (SortSourceFieldThree entered)
					include FileGeneration.SetTempSortField
						replace SortSourceField with SortSourceFieldThree 
						replace Index with 3
				if (SortSourceFieldFour entered)
					include FileGeneration.SetTempSortField
						replace SortSourceField with SortSourceFieldFour
						replace Index with 4 
				if (SortSourceFieldFive entered)
					include FileGeneration.SetTempSortField
						replace SortSourceField with SortSourceFieldFive
						replace Index with 5
				if (SortSourceFieldSix entered)
					include FileGeneration.SetTempSortField
						replace SortSourceField with SortSourceFieldSix
						replace Index with 6 
				if (SortSourceFieldSeven entered)
					include FileGeneration.SetTempSortField
						replace SortSourceField with SortSourceFieldSeven
						replace Index with 7 
				if (SortSourceFieldEight entered)
					include FileGeneration.SetTempSortField
						replace SortSourceField with SortSourceFieldEight
						replace Index with 8 
				if (SortSourceFieldNine entered)
					include FileGeneration.SetTempSortField
						replace SortSourceField with SortSourceFieldNine
						replace Index with 9 
				if (SortSourceFieldTen entered)
					include FileGeneration.SetTempSortField
						replace SortSourceField with SortSourceFieldTen
						replace Index with 10 
				if (SortSourceFieldEleven entered)
					include FileGeneration.SetTempSortField
						replace SortSourceField with SortSourceFieldEleven 
						replace Index with 11
				if (SortSourceFieldTwelve entered)
					include FileGeneration.SetTempSortField
						replace SortSourceField with SortSourceFieldTwelve
						replace Index with 12
				initialize SortFieldArray
				I2 = I1
				I1 = 1
				while (I1 < I2)
					if (I1 = 1)
						include FileGeneration.SetSortField
							replace SortSourceField with SortSourceFieldOne
					if (I1 = 2)
						include FileGeneration.SetSortField
							replace SortSourceField with SortSourceFieldTwo
					if (I1 = 3)
						include FileGeneration.SetSortField
							replace SortSourceField with SortSourceFieldThree
					if (I1 = 4)
						include FileGeneration.SetSortField
							replace SortSourceField with SortSourceFieldFour
					if (I1 = 5)
						include FileGeneration.SetSortField
							replace SortSourceField with SortSourceFieldFive
					if (I1 = 6)
						include FileGeneration.SetSortField
							replace SortSourceField with SortSourceFieldSix
					if (I1 = 7)
						include FileGeneration.SetSortField
							replace SortSourceField with SortSourceFieldSeven
					if (I1 = 8)
						include FileGeneration.SetSortField
							replace SortSourceField with SortSourceFieldEight
					if (I1 = 9)
						include FileGeneration.SetSortField
							replace SortSourceField with SortSourceFieldNine
					if (I1 = 10)
						include FileGeneration.SetSortField
							replace SortSourceField with SortSourceFieldTen
					if (I1 = 11)
						include FileGeneration.SetSortField
							replace SortSourceField with SortSourceFieldEleven
					if (I1 = 12)
						include FileGeneration.SetSortField
							replace SortSourceField with SortSourceFieldTwelve
																																																											
		Delete is a Delete Action
			Exit Rules
				LocalIONDocumentName = IONDocumentName
				if (FileCreationSetupSameIONDocumentRel not exists
				and IONDocumentRel exists)
					invoke Delete IONDocumentRel	

		Activate is an Instance Action
			valid when (MappingsExist)			
			restricted

			Action Rules
				Active = true
				
		Deactivate is an Instance Action
			restricted
			
			Action Rules
				Active = false
				
		GeneratePreviewRecords is an Instance Action
			valid when (GeneratePreviewRecordsValid)
			run in background
			synchronized on untranslatable:"FileCreationSetup_GeneratePreviewRecords_<FinanceEnterpriseGroup>"
			Queue Mapping Fields	
				FinanceEnterpriseGroup
				FileCreationSetup 

			Parameters
				FinanceEnterpriseGroup
				FileCreationSetup
				GenerateFileAfterCreatingPreviewRecords		is Boolean

			Local Fields
				LocalRunGroup			is Numeric 3
				LocalCurrentTimeStamp	is TimeStamp
				LocalBackgroundGroup1	is Alpha 200
				LocalBackgroundGroup2	is Alpha 200
				LocalBackgroundGroup3	is Alpha 200
				LastBackgroundGroup		is Alpha 200

			Rule Blocks
				InvokeGeneratePreviewRecords
					while (LocalRunGroup < OverrideNumberOfThreads)
						invoke GeneratePreviewRecordsForRunGroup {ApplicationBusinessClass} in background group (LocalBackgroundGroup1)
							run after ActionBackgroundGroup
							invoked.FinanceEnterpriseGroupPrm		= FinanceEnterpriseGroup
							invoked.FileCreationSetupPrm	= FileCreationSetup
							invoked.BeginTimeStamp			= LastTimeStamp
							invoked.EndTimeStamp			= LocalCurrentTimeStamp
							invoked.AllRecords				= AllRecords
							invoked.PrmNumberOfRunGroups	= OverrideNumberOfThreads
							invoked.PrmRunGroup	   			= LocalRunGroup
						increment LocalRunGroup

				InvokeOTMGeneratePreviewRecords
					LastBackgroundGroup = LocalBackgroundGroup2
					initialize LocalRunGroup
					while (LocalRunGroup < OverrideNumberOfThreads)
						invoke GeneratePreviewRecordsForRunGroup {OTMBusinessClass} in background group (LocalBackgroundGroup2)
							run after background group(LocalBackgroundGroup1)
							invoked.FinanceEnterpriseGroupPrm		= FinanceEnterpriseGroup
							invoked.FileCreationSetupPrm	= FileCreationSetup
							invoked.BeginTimeStamp			= LastTimeStamp
							invoked.EndTimeStamp			= LocalCurrentTimeStamp
							invoked.PrmNumberOfRunGroups	= OverrideNumberOfThreads
							invoked.PrmRunGroup	   			= LocalRunGroup
						increment LocalRunGroup

				FileCreationCheckOtherPayablesInvoiceChanges
					if (FileCreationSetup.PayablesInvoiceUsesPayablesInvoiceDistribution)
						include InvokeOTMGeneratePreviewRecords
							replace OTMBusinessClass with PayablesInvoiceDistribution		
					if (FileCreationSetup.PayablesInvoiceUsesPayablesInvoicePayment)
						include InvokeOTMGeneratePreviewRecords
							replace OTMBusinessClass with PayablesInvoicePayment
					if (FileCreationSetup.PayablesInvoiceUsesPayablesInvoiceAddOnCharge)
						include InvokeOTMGeneratePreviewRecords
							replace OTMBusinessClass with PayablesInvoiceAddOnCharge										
				
				FileCreationCheckOtherGeneralLedgerChartAccountChanges
					if (FileCreationSetup.GeneralLedgerChartAccountUsesReportingChartAccount)
						include InvokeOTMGeneratePreviewRecords
							replace OTMBusinessClass with ReportingChartAccount

				FileCreationCheckOtherAssetChanges
					if (FileCreationSetup.AssetUsesAssetBook)
						include InvokeOTMGeneratePreviewRecords
							replace OTMBusinessClass with AssetBook		

				FileCreationCheckOtherBinGroupChanges
					if (FileCreationSetup.BinGroupUsesBinGroupDetail)
						include InvokeOTMGeneratePreviewRecords
							replace OTMBusinessClass with BinGroupDetail		

				FileCreationCheckOtherContractChanges
					if (FileCreationSetup.ContractUsesContractLine)
						include InvokeOTMGeneratePreviewRecords
							replace OTMBusinessClass with ContractLine
				
				FileCreationCheckOtherPurchaseOrderChanges
					if (FileCreationSetup.PurchaseOrderUsesPurchaseOrderLine)
						include InvokeOTMGeneratePreviewRecords
							replace OTMBusinessClass with PurchaseOrderLine
				
				FileCreationCheckOtherVendorChanges
					if (FileCreationSetup.VendorUsesVendorLocation)
						include InvokeOTMGeneratePreviewRecords
							replace OTMBusinessClass with VendorLocation	

			Entrance Rules
				LocalCurrentTimeStamp	= system current timestamp

			Action Rules
				LocalBackgroundGroup1	= "GeneratePreviewRecords_"    + FinanceEnterpriseGroup +"_" + FileCreationSetup +"_" + system current timestamp
				LocalBackgroundGroup2	= "GeneratePreviewRecordsOTM_" + FinanceEnterpriseGroup +"_" + FileCreationSetup +"_" + system current timestamp
				LocalBackgroundGroup3	= "GrabAuditInformation_" + FinanceEnterpriseGroup +"_" + FileCreationSetup +"_" + system current timestamp
				LastBackgroundGroup		= LocalBackgroundGroup1
				if (ExportFile.PayablesInvoice)
					include InvokeGeneratePreviewRecords
						replace ApplicationBusinessClass with PayablesInvoice
				else
				if (ExportFile.GeneralLedgerTransaction)
					include InvokeGeneratePreviewRecords
						replace ApplicationBusinessClass with GeneralLedgerTransaction
				else
				if (ExportFile.PurchaseOrderLine)
					include InvokeGeneratePreviewRecords
						replace ApplicationBusinessClass with PurchaseOrderLine
				else
				if (ExportFile.InventoryTransactionLine)
					include InvokeGeneratePreviewRecords
						replace ApplicationBusinessClass with InventoryTransactionLine
				else
				if (ExportFile.InventoryLocation)
					include InvokeGeneratePreviewRecords
						replace ApplicationBusinessClass with InventoryLocation
				else
				if (ExportFile.GeneralLedgerTotal)
					include InvokeGeneratePreviewRecords
						replace ApplicationBusinessClass with GeneralLedgerTotal	
				else
				if (ExportFile.GLTransactionDetail)
					include InvokeGeneratePreviewRecords
						replace ApplicationBusinessClass with GLTransactionDetail
				else
				if (ExportFile.Vendor)
					include InvokeGeneratePreviewRecords
						replace ApplicationBusinessClass with Vendor
				else
				if (ExportFile.Asset)
					include InvokeGeneratePreviewRecords
						replace ApplicationBusinessClass with Asset
				else
				if (ExportFile.Scenario)
					include InvokeGeneratePreviewRecords
						replace ApplicationBusinessClass with Scenario
				else
				if (ExportFile.GeneralLedgerChartAccount)
					include InvokeGeneratePreviewRecords
						replace ApplicationBusinessClass with GeneralLedgerChartAccount
				else
				if (ExportFile.BinGroup)
					include InvokeGeneratePreviewRecords
						replace ApplicationBusinessClass with BinGroup
				else
				if (ExportFile.Contract)
					include InvokeGeneratePreviewRecords
						replace ApplicationBusinessClass with Contract
				else
				if (ExportFile.Item)
					include InvokeGeneratePreviewRecords
						replace ApplicationBusinessClass with Item
				else
				if (ExportFile.RequesterRequestingLocation)
					include InvokeGeneratePreviewRecords
						replace ApplicationBusinessClass with RequesterRequestingLocation
				else
				if (ExportFile.PurchaseOrder)
					include InvokeGeneratePreviewRecords
						replace ApplicationBusinessClass with PurchaseOrder
				else
				if (ExportFile.GeneralLedgerJournalControl)
					include InvokeGeneratePreviewRecords
						replace ApplicationBusinessClass with GeneralLedgerJournalControl
						
				if (not AllRecords
				and LastTimeStamp entered)
					if (ExportFile.PayablesInvoice)
						include FileCreationCheckOtherPayablesInvoiceChanges
					else
					if (ExportFile.GeneralLedgerChartAccount)
						include FileCreationCheckOtherGeneralLedgerChartAccountChanges
					else
					if (ExportFile.Asset)
						include FileCreationCheckOtherAssetChanges
					else
					if (ExportFile.BinGroup)
						include FileCreationCheckOtherBinGroupChanges
					else
					if (ExportFile.Contract)
						include FileCreationCheckOtherContractChanges
					else
					if (ExportFile.PurchaseOrder)
						include FileCreationCheckOtherPurchaseOrderChanges
					else
					if (ExportFile.Vendor)
						include FileCreationCheckOtherVendorChanges

				if (UseAuditInformation)
					initialize LocalRunGroup
					while (LocalRunGroup < OverrideNumberOfThreads)
						invoke GrabAuditInformationThread FileCreationRecord in background group (LocalBackgroundGroup3)
							run after background group(LastBackgroundGroup)
							invoked.FinanceEnterpriseGroupPrm		= FinanceEnterpriseGroup
							invoked.FileCreationSetupPrm	= FileCreationSetup
							invoked.BeginTimeStamp			= LastTimeStamp
							invoked.EndTimeStamp			= LocalCurrentTimeStamp
							invoked.PrmNumberOfThreads		= OverrideNumberOfThreads
							invoked.PrmThread	   			= LocalRunGroup
						LocalRunGroup += 1
					LastBackgroundGroup = LocalBackgroundGroup3

				invoke UpdateTimeStamp in background
					run after background group(LastBackgroundGroup)
					invoked.PrmTimeStamp	= LocalCurrentTimeStamp

				if (GenerateFileAfterCreatingPreviewRecords)
					invoke GenerateFileThreaded in background
						run after background group(LastBackgroundGroup)

				ActionBackgroundGroup	= current action background group id

		BuildTimeStampFormat is an Instance Action
			restricted
			valid when (RecordExists)
			Parameters
				DateFormat				is Numeric 1
					States
						YYMMDD		value is 0
							default label is untranslatable
						MMDDYY		value is 1
							default label is untranslatable
						DDMMYY		value is 2
							default label is untranslatable
				IncludeCentury			is Boolean	
				IncludeHours			is Boolean
				IncludeMinutes			is Boolean
				IncludeSeconds			is Boolean
				IncludeMilliseconds		is Boolean
			
			Action Rules
				initialize LocalJavaFormat

				if (IncludeCentury)
					if (DateFormat.YYMMDD)
						LocalJavaFormat = "%1$tY%1$tm%1$td"
					else
					if (DateFormat.MMDDYY)
						LocalJavaFormat = "%1$tm%1$td%1$tY"
					else
					if (DateFormat.DDMMYY)
						LocalJavaFormat = "%1$td%1$tm%1$tY"
				else
					if (DateFormat.YYMMDD)
						LocalJavaFormat = "%1$ty%1$tm%1$td"
					else
					if (DateFormat.MMDDYY)
						LocalJavaFormat = "%1$tm%1$td%1$ty"
					else
					if (DateFormat.DDMMYY)
						LocalJavaFormat = "%1$td%1$tm%1$ty"

				initialize LocalTimeFormat
				if (IncludeHours)
					LocalTimeFormat = "%1$tH"
				if (IncludeMinutes)
					LocalTimeFormat += "%1$tM"
				if (IncludeSeconds)
					LocalTimeFormat += "%1$tS"
				if (IncludeMilliseconds)
					LocalTimeFormat += "%1$tL"
						
				LocalJavaFormat += LocalTimeFormat
				FileNameTimeStampFormat = LocalJavaFormat  
															
		UpdateTimeStamp is an Instance Action
			restricted

			Parameters
				PrmTimeStamp	is TimeStamp

			Action Rules
				LastTimeStamp	= PrmTimeStamp
					
		GenerateFileThreaded is an Instance Action
			default label is "Generate_File"
			valid when (GenerateFileThreadedIsValid)
			run in background
			synchronized on untranslatable:"FileCreationSetup_GenerateFileThreaded_<FinanceEnterpriseGroup>_<FileCreationSetup>"
			
			Parameters
				SystemTimeStampPrm		is TimeStamp
					default label is "SystemTimeStamp"
				SequenceNumberPrm		is Numeric 4
					default label is "SequenceNumber"
				ProcessRegeneratedFileWithProcessFlow	is Boolean
				SendRegeneratedFileToION				is Boolean
				GroupedSystemTimeStampPrm				is TimeStamp
					default label is "GroupedSystemTimeStamp"
				GroupedSequenceNumberPrm					is Numeric 4
					default label is "GroupedSequenceNumber"
				GroupedSystemTimeStampRegenPrm  			is TimeStamp
					default label is "RegeneratedGroupedSystemTimeStamp"
				GroupedSequenceNumberRegenPrm   			is Numeric 4
					default label is "RegeneratedGroupedSequenceNumber"
				Regenerated									is Boolean
				PrmNumberOfThreads							is Numeric 3
				PrmGeneratedWithSortThread					is Boolean

			Local Fields
				LocalThread				is Numeric 3
				LocalNumberOfThreads	is Numeric 3
				LocalCurrentTimeStamp	is TimeStamp
				LocalBackgroundGroup1	is Alpha 200
				LocalBackgroundGroup2	is Alpha 200
				LocalBackgroundGroup3   is Alpha 200
				LocalActionRequestID 	is UniqueID

			Action Rules
				if (UseDynamicRowProcessing)
					if (RegenerateMappingsFlag.Needed)	
						RegenerateMappingsFlag = RegenerateMappingsFlag.Regenerating	
						invoke PurgeMappings FileCreationRowDynamicMapping
							assign async action request id to LocalActionRequestID 
							invoked.FinanceEnterpriseGroupPrm = FinanceEnterpriseGroup
							invoked.FileCreationSetupPrm = FileCreationSetup
						for each FileCreationRowDetail set
							if (!each.Header
							and !each.Trailer
							and !each.Subtotal)
								if (each.LinkedSetup not entered
								and	each.LinkedRow not entered)
									invoke CreateDynamicRowLPL FileCreationColumnDetail in background group (LocalBackgroundGroup3)
										run after LocalActionRequestID
										invoked.FinanceEnterpriseGroupPrm = FinanceEnterpriseGroup
										invoked.FileCreationSetupPrm = FileCreationSetup
										invoked.FileCreationRowDetailPrm = each.FileCreationRowDetail
										invoked.TargetFileCreationSetupPrm	= FileCreationSetup
										invoked.TargetFileCreationRowDetailPrm	= each.FileCreationRowDetail
								else
									invoke CreateDynamicRowLPL FileCreationColumnDetail in background group (LocalBackgroundGroup3)
										run after LocalActionRequestID
										invoked.FinanceEnterpriseGroupPrm = FinanceEnterpriseGroup
										invoked.FileCreationSetupPrm = each.LinkedSetup
										invoked.FileCreationRowDetailPrm = each.LinkedRow
										invoked.TargetFileCreationSetupPrm	= FileCreationSetup
										invoked.TargetFileCreationRowDetailPrm	= each.FileCreationRowDetail
						invoke SetRegenerateMappingsFlagToNotNeeded in background
							assign async action request id to ActionBackgroundGroup
							run after background group(LocalBackgroundGroup3)
						
				initialize LocalThread
				if (ThreadingMethod.SingleThreaded
				and not Regenerated)
					invoke GenerateFileThread FileCreationRecord 
						run after ActionBackgroundGroup
						invoked.FinanceEnterpriseGroupPrm		= FinanceEnterpriseGroup
						invoked.FileCreationSetupPrm	= FileCreationSetup
						invoked.PrmNumberOfThreads		= 1
						invoked.PrmThread				= LocalThread
				else
					if (PrmNumberOfThreads entered)
						LocalNumberOfThreads = PrmNumberOfThreads
					else
					if (OverrideNumberOfThreads entered)
						LocalNumberOfThreads = OverrideNumberOfThreads

					LocalBackgroundGroup1	= "GenerateFileThreaded_" + FinanceEnterpriseGroup +"_" + FileCreationSetup +"_" + system current timestamp
					LocalBackgroundGroup2	= "SetThread"  + FinanceEnterpriseGroup +"_" + FileCreationSetup +"_" + system current timestamp
					LocalCurrentTimeStamp = system current timestamp

					if (ThreadingMethod.MergedFileForThreads
					or  Regenerated)
						invoke Create FileCreationFile
							assign result to FileView
							invoked.FinanceEnterpriseGroup			= FinanceEnterpriseGroup
							invoked.FileCreationSetup				= FileCreationSetup
							invoked.SystemTimeStamp					= LocalCurrentTimeStamp 
							invoked.FileOutput						= ""
							invoked.NumberOfThreads					= LocalNumberOfThreads
							invoked.MergedFile						= true
							if (SortSourceFieldOne entered)
								invoked.GeneratedWithSortThread = true


					if (not Regenerated
					and SortSourceFieldOne entered)
						invoke SetThread FileCreationSortThread in background group (LocalBackgroundGroup2)
							run after ActionBackgroundGroup
							invoked.PrmFinanceEnterpriseGroup		= FinanceEnterpriseGroup
							invoked.PrmFileCreationSetup	= FileCreationSetup
							invoked.PrmOverrideNumberOfThreads  = OverrideNumberOfThreads

					while (LocalThread < LocalNumberOfThreads)
						if (SortSourceFieldOne entered)
							invoke GenerateFileThread FileCreationRecord in background group (LocalBackgroundGroup1)
								run after background group(LocalBackgroundGroup2)
								invoked.FinanceEnterpriseGroupPrm		= FinanceEnterpriseGroup
								invoked.FileCreationSetupPrm			= FileCreationSetup
								invoked.PrmNumberOfThreads				= LocalNumberOfThreads
								invoked.PrmThread	   					= LocalThread
								invoked.PrmThreadGroupID				= FileView.UniqueID
								invoked.SystemTimeStampPrm				= SystemTimeStampPrm
								invoked.SequenceNumberPrm				= SequenceNumberPrm
								invoked.GroupedSystemTimeStampRegenPrm  = GroupedSystemTimeStampRegenPrm
								invoked.GroupedSequenceNumberRegenPrm   = GroupedSequenceNumberRegenPrm
								invoked.GroupedSystemTimeStampPrm       = GroupedSystemTimeStampPrm
								invoked.GroupedSequenceNumberPrm        = GroupedSequenceNumberPrm
								invoked.PrmGeneratedWithSortThread		= PrmGeneratedWithSortThread
								if (ThreadingMethod.MergedFileForThreads
								or  Regenerated)
									invoked.PrmMergedFileStamp	= LocalCurrentTimeStamp
									invoked.PrmMergedSequenceNumber = FileView.SequenceNumber
							LocalThread += 1
						else
							invoke GenerateFileThread FileCreationRecord in background group (LocalBackgroundGroup1)
								run after ActionBackgroundGroup
								invoked.FinanceEnterpriseGroupPrm				= FinanceEnterpriseGroup
								invoked.FileCreationSetupPrm			= FileCreationSetup
								invoked.PrmNumberOfThreads				= LocalNumberOfThreads
								invoked.PrmThread	   					= LocalThread
								invoked.PrmThreadGroupID				= FileView.UniqueID
								invoked.SystemTimeStampPrm				= SystemTimeStampPrm
								invoked.SequenceNumberPrm				= SequenceNumberPrm
								invoked.GroupedSystemTimeStampRegenPrm  = GroupedSystemTimeStampRegenPrm
								invoked.GroupedSequenceNumberRegenPrm   = GroupedSequenceNumberRegenPrm
								invoked.GroupedSystemTimeStampPrm       = GroupedSystemTimeStampPrm
								invoked.GroupedSequenceNumberPrm        = GroupedSequenceNumberPrm
								invoked.PrmGeneratedWithSortThread		= PrmGeneratedWithSortThread
								if (ThreadingMethod.MergedFileForThreads
								or  Regenerated)
									invoked.PrmMergedFileStamp	= LocalCurrentTimeStamp
									invoked.PrmMergedSequenceNumber = FileView.SequenceNumber
							LocalThread += 1

					if (ThreadingMethod.MergedFileForThreads
					or  Regenerated)
						invoke MergeFiles in background
							run after background group(LocalBackgroundGroup1)
							invoked.PrmThreadGroupID					= FileView.UniqueID
							invoked.PrmMergedFileSystemTimeStamp		= FileView.SystemTimeStamp
							invoked.PrmMergedFileSequenceNumber			= FileView.SequenceNumber
							invoked.ProcessRegeneratedFileWithProcessFlow	= ProcessRegeneratedFileWithProcessFlow
							invoked.SendRegeneratedFileToION				= SendRegeneratedFileToION
							invoked.Regenerated								= Regenerated
							invoked.SystemTimeStampPrm					= SystemTimeStampPrm
							invoked.SequenceNumberPrm					= SequenceNumberPrm
							invoked.PrmGeneratedWithSortThread 			= PrmGeneratedWithSortThread
						
						if (SystemTimeStampPrm entered)						
							LocalTimeStamp				= SystemTimeStampPrm
							LocalSequenceNumber 		= SequenceNumberPrm
							invoke UpdateRegenerationFields FileCreationFileUpdateRel
								invoked.NewFileTimeStamp 	= FileView.SystemTimeStamp
								invoked.NewSequenceNumber	= FileView.SequenceNumber
						
		MergeFiles is an Instance Action
			restricted
			run in background
			
			Parameters
				PrmThreadGroupID				is UniqueID
				PrmMergedFileSystemTimeStamp	is TimeStamp
				PrmMergedFileSequenceNumber		is Numeric 4
				ProcessRegeneratedFileWithProcessFlow	is Boolean
				SendRegeneratedFileToION				is Boolean
				Regenerated								is Boolean
				SystemTimeStampPrm				is TimeStamp
				SequenceNumberPrm				is Numeric 4
				PrmGeneratedWithSortThread      is Boolean
				
			Local Fields
				LocalMimeType 					is Text
				FileName						is Alpha 150
					Text Variables
						FileTimeStamp
				LocalRecordCountTotal1			is Numeric 12
				LocalRecordCountTotal2			is Numeric 12
				LocalRecordCountTotal3			is Numeric 12
				LocalRecordCountTotal4			is Numeric 12
				LocalRecordCountTotal5			is Numeric 12
				LocalRecordCountTotal6			is Numeric 12
				LocalTotalRowsOutputted			is Numeric 12
				LocalTotalRecordsOutputted		is Numeric 12
				LocalTotalFileOutput			is Text
				LocalFileCreationTotalArray     is a FileCreationTotalArray
				LocalTotalArraySet				is Boolean
				LocalCounter					is Numeric 3
				
			Action Rules
				LocalThreadGroupID 					= PrmThreadGroupID
				LocalMergedFileSystemTimeStamp		= PrmMergedFileSystemTimeStamp
				LocalMergedFileSequenceNumber		= PrmMergedFileSequenceNumber
				if (FileMimeType.PlainText)
					LocalMimeType 						= "text/plain"
				if (FileMimeType.CSV)
					LocalMimeType 						= "text/csv"
				FileName 							= CalculatedFileName
				for each FileCreationFileThreadRel 
					LocalRecordCountTotal1			+= each.RecordCount1
					LocalRecordCountTotal2			+= each.RecordCount2
					LocalRecordCountTotal3			+= each.RecordCount3
					LocalRecordCountTotal4			+= each.RecordCount4
					LocalRecordCountTotal5			+= each.RecordCount5
					LocalRecordCountTotal6			+= each.RecordCount6
					LocalTotalRowsOutputted			+= each.RowsOutputted
					LocalTotalRecordsOutputted		+= each.RecordsOutputted
					LocalTotalFileOutput			+= each.FileOutput
					if (!LocalTotalArraySet
					and each.FileCreationTotalArray.FileCreationTotal[1].Setup entered)
						LocalFileCreationTotalArray = each.FileCreationTotalArray
						LocalTotalArraySet = true
					else
						LocalCounter = 1
						while (LocalCounter <= 100)
							LocalFileCreationTotalArray.FileCreationTotal[LocalCounter].Total += each.FileCreationTotalArray.FileCreationTotal[LocalCounter].Total	
							LocalCounter += 1
						
				invoke Update MergedFileCreationFileRel
					invoked.FileOutput	   		=  LocalTotalFileOutput
					
				invoke GenerateHeaderAndTrailer last MergedLastFileCreationRecordRel 
					invoked.PrmMergedFileSystemTimeStamp			= PrmMergedFileSystemTimeStamp
					invoked.PrmMergedFileSequenceNumber				= PrmMergedFileSequenceNumber
					invoked.PrmRecordCount1							= LocalRecordCountTotal1
					invoked.PrmRecordCount2							= LocalRecordCountTotal2
					invoked.PrmRecordCount3							= LocalRecordCountTotal3
					invoked.PrmRecordCount4							= LocalRecordCountTotal4
					invoked.PrmRecordCount5							= LocalRecordCountTotal5
					invoked.PrmRecordCount6							= LocalRecordCountTotal6
					invoked.PrmFileName								= CalculatedFileName
					invoked.PrmFileCreationTotalArray				= LocalFileCreationTotalArray			
				
				invoke UpdateRecordCount MergedFileCreationFileRel
					invoked.TotalRowCount			= LocalTotalRowsOutputted
					invoked.TotalRecordCount		= LocalTotalRecordsOutputted
					invoked.FileName				= FileName	
					invoked.FileMimeType			= LocalMimeType
					if (Regenerated)
						invoked.Regenerated								= Regenerated
						invoked.ProcessRegeneratedFileWithProcessFlow	= ProcessRegeneratedFileWithProcessFlow
						invoked.SendRegeneratedFileToION				= SendRegeneratedFileToION

				if (!Regenerated
				and SortSourceFieldOne entered)
					invoke SetFile FileCreationSortThread
						invoked.PrmFinanceEnterpriseGroup		= FinanceEnterpriseGroup
						invoked.PrmFileCreationSetup	= FileCreationSetup
						invoked.PrmFileSystemTimeStamp	= PrmMergedFileSystemTimeStamp
						invoked.PrmFileSequenceNumber  = PrmMergedFileSequenceNumber
				
				if (PrmGeneratedWithSortThread
				and Regenerated)
					invoke SetFileRegenerated FileCreationSortThread
						invoked.PrmFinanceEnterpriseGroup		= FinanceEnterpriseGroup
						invoked.PrmFileCreationSetup	= FileCreationSetup
						invoked.PrmFileSystemTimeStamp	= PrmMergedFileSystemTimeStamp
						invoked.PrmFileSequenceNumber   = PrmMergedFileSequenceNumber
						invoked.SystemTimeStampPrm 		= SystemTimeStampPrm
						invoked.SequenceNumberPrm 		= SequenceNumberPrm
			Exit Rules
				
				for each FileCreationFileThreadRel	
					invoke Purge each	
				
			

		CopySetup is an Instance Action
			Parameters
	        	NewFinanceEnterpriseGroup	is a FinanceEnterpriseGroup
	        		default label is "FinanceEnterpriseGroup"
				NewDescription		is Alpha 60
	        		default label is "Description"
			
			Parameter Rules
				NewFinanceEnterpriseGroup
					initial value is FinanceEnterpriseGroup
					required
					
			Action Rules
				invoke Create FileCreationSetup
					assign result to SetupView
					fill in fields from this instance
						except invoked.DCKey
						except invoked.LastTimeStamp
						except invoked.ActionBackgroundGroup
						except invoked.LastGeneration
						except invoked.LastGenerationSequence
					invoked.FinanceEnterpriseGroup				= NewFinanceEnterpriseGroup
					invoked.Description							= NewDescription
					invoked.Active								= false
					
				for each FileCreationRowDetail set
					invoke Create FileCreationRowDetail
						assign result to RowView
						fill in fields from each
							except invoked.FinanceEnterpriseGroup
							except invoked.FileCreationSetup
							except invoked.DCKey
						invoked.FinanceEnterpriseGroup			= NewFinanceEnterpriseGroup
						invoked.FileCreationSetup				= SetupView.FileCreationSetup

					LocalRow	= each.FileCreationRowDetail
					for each FileCreationColumnDetailRel
						invoke ImportCreate FileCreationColumnDetail
							assign result to ColumnView
							fill in fields from each
								except invoked.FinanceEnterpriseGroup
								except invoked.FileCreationSetup
								except invoked.FileCreationRowDetail
								except invoked.DCKey
							invoked.FinanceEnterpriseGroup					= NewFinanceEnterpriseGroup
							invoked.FileCreationSetup				= SetupView.FileCreationSetup
							invoked.FileCreationRowDetail			= RowView.FileCreationRowDetail
						include FileGeneration.CommitCounter50
						LocalColumn	= each.FileCreationColumnDetail	
						for each FileCreationDataMappingRel
							invoke Create FileCreationDataMapping
								fill in fields from each
									except invoked.FinanceEnterpriseGroup
									except invoked.FileCreationSetup
									except invoked.FileCreationRowDetail
									except invoked.FileCreationColumnDetail
									except invoked.DCKey
								invoked.FinanceEnterpriseGroup			= NewFinanceEnterpriseGroup
								invoked.FileCreationSetup				= SetupView.FileCreationSetup
								invoked.FileCreationRowDetail			= RowView.FileCreationRowDetail
								invoked.FileCreationColumnDetail		= ColumnView.FileCreationColumnDetail

		PurgeFileCreationRecordOrFile is a Set Action
			synchronized on untranslatable:"FileCreationSetup_PurgeFileCreationRecordOrFile_<PrmFinanceEnterpriseGroup>"
			run in background
			confirmation required
				"Warning:ThisWillPermanentlyDeleteTheSelectedRecords.DoYouWantToContinue?"
			Parameters
				PrmFinanceEnterpriseGroup			is an FinanceEnterpriseGroup
					default label is "FinanceEnterpriseGroup" 				
				PrmFileCreationSetup 		is a FileCreationSetup
					default label is "FileCreationSetup"
				AllFileCreationSetup 		is Boolean
				PurgeRecords 				is Boolean
				PurgeFiles					is Boolean
				PurgeDate					is TimeStamp
				PurgeLapseRecords			is a UnitsAndUnitType
										
			Parameter Rules		
				PrmFileCreationSetup
					if (not AllFileCreationSetup)
						required
							"SelectEitherAllFileCreationSetupOrSpecificFileCreationSetup"
							
					constraint (not AllFileCreationSetup)
						"FileCreationSetupMustNotBeEnteredIfSelectAllFileCreationSetupIsSelected"
				
				PurgeRecords	
					if (not PurgeFiles)
						required
							"SelectEitherPurgeRecordOrPurgeFileOrBoth"
				PurgeDate				
					if (PurgeLapseRecords not entered)
						required
							"SelectEitherPurgeDateOrPurgeRecordOlderThan"
					constraint (PurgeLapseRecords not entered)
						"DateMustNotBeEnteredIfPurgeRecordsOlderThanIsEntered"
						
				PurgeLapseRecords
					constraint (PurgeLapseRecords.Units > 0)
						"UnitsCannotBeNegative"
						
					if (PurgeLapseRecords.UnitType.Days)
						PurgeDate = system current corporate date - PurgeLapseRecords.Units as days
					else
					if (PurgeLapseRecords.UnitType.Months)
						PurgeDate = system current corporate date - PurgeLapseRecords.Units as months
					else	
					if (PurgeLapseRecords.UnitType.Years)
						PurgeDate = system current corporate date - PurgeLapseRecords.Units as years
			
			Local Fields
				LocalThread				is Numeric 3
				NumberOfThreads			is Numeric 3
				LocalBackgroundGroup	is Alpha 200		
			
			Instance Selection
				where (FinanceEnterpriseGroup = PrmFinanceEnterpriseGroup
				and (FileCreationSetup = PrmFileCreationSetup
				or   PrmFileCreationSetup not entered)
				and not UseForTesting)
							
			Action Rules
				Instance Rules	
					
					LocalBackgroundGroup	= "PurgeFileCreationRecordOrFile" + "_"  + system current timestamp
					NumberOfThreads = OverrideNumberOfThreads

					initialize LocalThread						
					if (PurgeRecords)
						while (LocalThread < NumberOfThreads)
							invoke PurgeRecords FileCreationRecord in background group(LocalBackgroundGroup)
								invoked.PrmFinanceEnterpriseGroup 		= PrmFinanceEnterpriseGroup
								invoked.PrmFileCreationSetup 	= FileCreationSetup
								invoked.PrmPurgeDate			= PurgeDate
								invoked.NumberOfThreads			= NumberOfThreads
								invoked.Thread					= LocalThread
							increment LocalThread

							
					if (PurgeFiles)
						initialize LocalThread
						while (LocalThread < NumberOfThreads)
							invoke PurgeFiles FileCreationFile
								run after background group(LocalBackgroundGroup)
								invoked.PrmFinanceEnterpriseGroup 		= PrmFinanceEnterpriseGroup
								invoked.PrmFileCreationSetup 	= FileCreationSetup
								invoked.PrmPurgeDate			= PurgeDate
								invoked.NumberOfThreads			= NumberOfThreads
								invoked.Thread					= LocalThread
							increment LocalThread
		
		RunRegressionTesting is a Set Action
		
			Parameters
				PurgeUnits						is Numeric size 5
	    		PurgeUnitType					is Numeric size 2
	    		  	States
		        		Days				value is 01
		        		Months				value is 02
		        		Years				value is 03
				
			Parameter Rules
				
				PurgeUnits
					constraint (PurgeUnits > 0)
						"UnitsCannotBeNegative"
					initial value is 1
					if (PurgeUnits entered)
						constraint (PurgeUnitType entered)
							"MustEnterAUnitTypeWithUnits"
					
				PurgeUnitType
					initial value is PurgeUnitType.Months 
					if (PurgeUnitType entered)
						constraint (PurgeUnits entered)
							"MustEnterUnitsWithUnitType"
				
			
			Local Fields
				LocalBackgroundGroup	is Alpha 200
				PurgeDate				is TimeStamp
				
			Instance Selection
				where (UseForTesting
				and    BaselineFileCreationFileRel exists)
				
			Action Rules
				
				Set Rules
				
					Entrance Rules
						LocalBackgroundGroup = "RunRegressionTesting_" + FinanceEnterpriseGroup + "_" + system current timestamp					
					
					Exit Rules
						if (PurgeUnitType.Days)
							PurgeDate = system current corporate date - PurgeUnits as days
						
						if (PurgeUnitType.Months)
							PurgeDate = system current corporate date - PurgeUnits as months
						
						if (PurgeUnitType.Years)
							PurgeDate = system current corporate date - PurgeUnits as years
						invoke PurgeTestFileCreationFile FileCreationFile
							run after background group(LocalBackgroundGroup)
							invoked.PurgeDatePrm	= PurgeDate
					
					
				Instance Rules
					if (last FileCreationFileRel.NumberOfThreads entered)
						invoke RegenerateFileThreaded last FileCreationFileRel in background group(LocalBackgroundGroup)
							resume on error 
								ErrorMessage = error message
								IsError		 = true
						if (IsError)
							invoke Create FileCreationTest
								invoked.FinanceEnterpriseGroup		= FinanceEnterpriseGroup
								invoked.FileCreationSetup 	= FileCreationSetup
								invoked.SystemTimeStamp		= system current timestamp
								invoked.Message 			= ErrorMessage
								invoked.Status       		= 2 
					else
						invoke Create FileCreationTest
							invoked.FinanceEnterpriseGroup		= FinanceEnterpriseGroup
							invoked.FileCreationSetup 	= FileCreationSetup
							invoked.SystemTimeStamp		= system current timestamp
							invoked.Status       		= 2 
								
						
								
		CreateTestSetup is a Create Action
			default label is "Create"
			Action Rules
				UseForTesting = true
				
		AddEmailForTesting is an Instance Action
			valid when (UseForTesting)
			Parameters
				EntryType	is Numeric 1
					States
						Employee			value is 0
						EmailAddress		value is 1
				EmailPrm 		is an EmailAddress
					default label is "Email"
				EmployeePrm 	is an Employee
					default label is "Employee"
				
			Action Rules
				if (EntryType.Employee
				and EmployeePrm entered)
					if (EmployeePrm.UseForWorkEmail not exists)
						confirmation required
							"EmployeeCurrentlyHasNoWorkEmail;Continue?"
					if (TestingEmailTo not entered)
						TestingEmailTo += EmployeePrm
					else
						TestingEmailTo += "," + EmployeePrm
				if (EntryType.EmailAddress
				and EmailPrm entered)
					if (TestingEmailTo not entered)
						TestingEmailTo = EmailPrm
					else
						TestingEmailTo += "," + EmailPrm
						
		ClearEmail is an Instance Action
			valid when (UseForTesting)
			Action Rules
				initialize TestingEmailTo						
		
		CopySetupToTest is an Import Action
			
			Parameters
	        	NewFinanceEnterpriseGroup	is a FinanceEnterpriseGroup
	        		default label is "FinanceEnterpriseGroup"
				NewDescription		is Alpha 60
	        		default label is "Description"
	        	FileCreationSetupPrm	is a FileCreationSetup
	        		default label is "FileCreationSetup"
			
			Parameter Rules
				NewFinanceEnterpriseGroup
					initial value is actor.context.FinanceEnterpriseGroup
					required
					
			Action Rules
				invoke Create FileCreationSetup
					assign result to SetupView
					fill in fields from FileCreationSetupPrm
						except invoked.DCKey
						except invoked.FinanceEnterpriseGroup
						except invoked.FileCreationSetup
						except invoked.Description
						except invoked.UseForTesting
						except invoked.FlowToProcessFile
						except invoked.AutomaticallySendFileToION
						except invoked.IONDocumentName
						except invoked.IONInstanceCount
						except invoked.IONDocumentID
						except invoked.IONSource
						except invoked.LastTimeStamp
						except invoked.ActionBackgroundGroup
						except invoked.LastGeneration
						except invoked.LastGenerationSequence
					invoked.FinanceEnterpriseGroup						= NewFinanceEnterpriseGroup
					invoked.Description							= NewDescription
					invoked.Active								= false
					invoked.UseForTesting						= true
					invoked.FlowToProcessFile					= blank
					invoked.AutomaticallySendFileToION			= false
					invoked.IONDocumentName						= blank
					invoked.IONInstanceCount					= 0
					invoked.IONDocumentID						= blank
					invoked.IONSource							= blank
				
				LocalFinanceEnterpriseGroup	   = FileCreationSetupPrm.FinanceEnterpriseGroup	
				LocalFileCreationSetup = FileCreationSetupPrm
				for each FileCreationRowDetailRel
					invoke Create FileCreationRowDetail
						assign result to RowView
						fill in fields from each
							except invoked.FinanceEnterpriseGroup
							except invoked.FileCreationSetup
							except invoked.DCKey
						invoked.FinanceEnterpriseGroup					= NewFinanceEnterpriseGroup
						invoked.FileCreationSetup				= SetupView.FileCreationSetup

					LocalRow	= each.FileCreationRowDetail
					for each FileCreationLocalColumnDetailRel
						invoke ImportCreate FileCreationColumnDetail
							assign result to ColumnView
							fill in fields from each
								except invoked.FinanceEnterpriseGroup
								except invoked.FileCreationSetup
								except invoked.FileCreationRowDetail
								except invoked.DCKey
							invoked.FinanceEnterpriseGroup					= NewFinanceEnterpriseGroup
							invoked.FileCreationSetup				= SetupView.FileCreationSetup
							invoked.FileCreationRowDetail			= RowView.FileCreationRowDetail						
						LocalColumn	= each.FileCreationColumnDetail							
						for each FileCreationLocalDataMappingRel
							invoke Create FileCreationDataMapping
								fill in fields from each
									except invoked.FinanceEnterpriseGroup
									except invoked.FileCreationSetup
									except invoked.FileCreationRowDetail
									except invoked.FileCreationColumnDetail
									except invoked.DCKey
								invoked.FinanceEnterpriseGroup					= NewFinanceEnterpriseGroup
								invoked.FileCreationSetup				= SetupView.FileCreationSetup
								invoked.FileCreationRowDetail			= RowView.FileCreationRowDetail
								invoked.FileCreationColumnDetail		= ColumnView.FileCreationColumnDetail
						include FileGeneration.CommitCounter50


		QueueFailedFileCreationUtilityActions is a Set Action
			disable checkpoint
			Queue Mapping Fields
				AsyncQueueFileCreationUtilityActions

			Parameters
				AsyncQueue			is an AsyncQueueDefinition
			Local Fields
				Counter			is Numeric 4
			Instance Selection
				where (false)
			Action Rules
				Empty Set Rules
					LocalQueue = AsyncQueue
					LocalStatus = 7 
					for each AsyncActionTriggerRel
						Counter += 1

                        if(	each.AsyncActionRequest.AsyncAction = "GenerateFileThreaded"
						or     each.AsyncActionRequest.AsyncAction = "GenerateFileThread"
						or     each.AsyncActionRequest.AsyncAction = "GeneratePreviewRecordsForRunGroup"
						or     each.AsyncActionRequest.AsyncAction = "GeneratePreviewRecords")

							log untranslatable:"FSM\Log:\Attempt\Requeue:\Status:<each.Status>,Action:<each.AsyncActionRequest.Name>,Time:<each.Started>,Error\Message:<each.ErrorMessage>"
	                    	invoke TerminatedAbnormally.Requeue each
	                          	resume on error
	                          	
                        else
                            log untranslatable:"FSM\Log:\Generate\Files\Log:\Status:<each.Status>,Action:<each.AsyncActionRequest.Name>,Time:<each.Started>,Error\Message:<each.ErrorMessage>,Exception:<each.Result>"  
                        if (Counter > 9999)
                            end for each
										
		UpdateLastGeneration is an Instance Action
			restricted
			run in background
			Parameters
				PrmSystemTimeStamp				is TimeStamp
				PrmSequenceNumber				is Numeric 4
			Action Rules
				LastGeneration			= PrmSystemTimeStamp
				LastGenerationSequence	= PrmSequenceNumber	
				
		CreateSubtotalRowOne is an Instance Action
			valid when (SortSourceFieldOne entered) 
			default label is "AddRow"
			Parameters
				PrmDescription	is Alpha 60
					default label is "RowDescription"
				PrmSubtotalPlacement					is Numeric 1
					default label is "SubtotalPlacement"
		    		States
		    			Header			value is 0
		    			Trailer			value is 1
			
			Action Rules
				invoke Create FileCreationRowDetail
					invoked.FinanceEnterpriseGroup = FinanceEnterpriseGroup
					invoked.FileCreationSetup = FileCreationSetup
					invoked.Subtotal = true
					invoked.SubtotalLevel = 1
					invoked.Description = PrmDescription
					invoked.SubtotalField = SortSourceFieldOne
					invoked.SubtotalPlacement = PrmSubtotalPlacement
					
					
		CreateSubtotalRowTwo is an Instance Action
			valid when (SortSourceFieldTwo entered)
			default label is "AddRow"
			Parameters
				PrmDescription	is Alpha 60
					default label is "RowDescription"
				PrmSubtotalPlacement					is Numeric 1
					default label is "SubtotalPlacement"
		    		States
		    			Header			value is 0
		    			Trailer			value is 1
			
			Action Rules
				invoke Create FileCreationRowDetail
					invoked.FinanceEnterpriseGroup = FinanceEnterpriseGroup
					invoked.FileCreationSetup = FileCreationSetup
					invoked.Subtotal = true
					invoked.SubtotalLevel = 2
					invoked.Description = PrmDescription
					invoked.SubtotalField = SortSourceFieldTwo
					invoked.SubtotalPlacement = PrmSubtotalPlacement
					
		CreateSubtotalRowThree is an Instance Action
			valid when (SortSourceFieldThree entered)
			default label is "AddRow"
			Parameters
				PrmDescription	is Alpha 60
					default label is "RowDescription"
				PrmSubtotalPlacement					is Numeric 1
					default label is "SubtotalPlacement"
		    		States
		    			Header			value is 0
		    			Trailer			value is 1
			
			Action Rules
				invoke Create FileCreationRowDetail
					invoked.FinanceEnterpriseGroup = FinanceEnterpriseGroup
					invoked.FileCreationSetup = FileCreationSetup
					invoked.Subtotal = true
					invoked.SubtotalLevel = 3
					invoked.Description = PrmDescription
					invoked.SubtotalField = SortSourceFieldThree
					invoked.SubtotalPlacement = PrmSubtotalPlacement
					
		CreateSubtotalRowFour is an Instance Action
			valid when (SortSourceFieldFour entered)
			default label is "AddRow"
			Parameters
				PrmDescription	is Alpha 60
					default label is "RowDescription"
				PrmSubtotalPlacement					is Numeric 1
					default label is "SubtotalPlacement"
		    		States
		    			Header			value is 0
		    			Trailer			value is 1
			
			Action Rules
				invoke Create FileCreationRowDetail
					invoked.FinanceEnterpriseGroup = FinanceEnterpriseGroup
					invoked.FileCreationSetup = FileCreationSetup
					invoked.Subtotal = true
					invoked.SubtotalLevel = 4
					invoked.Description = PrmDescription
					invoked.SubtotalField = SortSourceFieldFour
					invoked.SubtotalPlacement = PrmSubtotalPlacement
					
		CreateSubtotalRowFive is an Instance Action
			valid when (SortSourceFieldFive entered)
			default label is "AddRow"
			Parameters
				PrmDescription	is Alpha 60
					default label is "RowDescription"
				PrmSubtotalPlacement					is Numeric 1
					default label is "SubtotalPlacement"
		    		States
		    			Header			value is 0
		    			Trailer			value is 1
			
			Action Rules
				invoke Create FileCreationRowDetail
					invoked.FinanceEnterpriseGroup = FinanceEnterpriseGroup
					invoked.FileCreationSetup = FileCreationSetup
					invoked.Subtotal = true
					invoked.SubtotalLevel = 5
					invoked.Description = PrmDescription
					invoked.SubtotalField = SortSourceFieldFive
					invoked.SubtotalPlacement = PrmSubtotalPlacement
					
		CreateSubtotalRowSix is an Instance Action
			valid when (SortSourceFieldSix entered)
			default label is "AddRow"
			Parameters
				PrmDescription	is Alpha 60
					default label is "RowDescription"
				PrmSubtotalPlacement					is Numeric 1
					default label is "SubtotalPlacement"
		    		States
		    			Header			value is 0
		    			Trailer			value is 1
			
			Action Rules
				invoke Create FileCreationRowDetail
					invoked.FinanceEnterpriseGroup = FinanceEnterpriseGroup
					invoked.FileCreationSetup = FileCreationSetup
					invoked.Subtotal = true
					invoked.SubtotalLevel = 6
					invoked.Description = PrmDescription
					invoked.SubtotalField = SortSourceFieldSix
					invoked.SubtotalPlacement = PrmSubtotalPlacement
					
		CreateSubtotalRowSeven is an Instance Action
			valid when (SortSourceFieldSeven entered)
			default label is "AddRow"
			Parameters
				PrmDescription	is Alpha 60
					default label is "RowDescription"
				PrmSubtotalPlacement					is Numeric 1
					default label is "SubtotalPlacement"
		    		States
		    			Header			value is 0
		    			Trailer			value is 1
			
			Action Rules
				invoke Create FileCreationRowDetail
					invoked.FinanceEnterpriseGroup = FinanceEnterpriseGroup
					invoked.FileCreationSetup = FileCreationSetup
					invoked.Subtotal = true
					invoked.SubtotalLevel = 7
					invoked.Description = PrmDescription
					invoked.SubtotalField = SortSourceFieldSeven
					invoked.SubtotalPlacement = PrmSubtotalPlacement
					
		CreateSubtotalRowEight is an Instance Action
			valid when (SortSourceFieldEight entered)
			default label is "AddRow"
			Parameters
				PrmDescription	is Alpha 60
					default label is "RowDescription"
				PrmSubtotalPlacement					is Numeric 1
					default label is "SubtotalPlacement"
		    		States
		    			Header			value is 0
		    			Trailer			value is 1
			
			Action Rules
				invoke Create FileCreationRowDetail
					invoked.FinanceEnterpriseGroup = FinanceEnterpriseGroup
					invoked.FileCreationSetup = FileCreationSetup
					invoked.Subtotal = true
					invoked.SubtotalLevel = 8
					invoked.Description = PrmDescription
					invoked.SubtotalField = SortSourceFieldEight
					invoked.SubtotalPlacement = PrmSubtotalPlacement
					
		CreateSubtotalRowNine is an Instance Action
			valid when (SortSourceFieldNine entered)
			default label is "AddRow"
			Parameters
				PrmDescription	is Alpha 60
					default label is "RowDescription"
				PrmSubtotalPlacement					is Numeric 1
					default label is "SubtotalPlacement"
		    		States
		    			Header			value is 0
		    			Trailer			value is 1
			
			Action Rules
				invoke Create FileCreationRowDetail
					invoked.FinanceEnterpriseGroup = FinanceEnterpriseGroup
					invoked.FileCreationSetup = FileCreationSetup
					invoked.Subtotal = true
					invoked.SubtotalLevel = 9
					invoked.Description = PrmDescription
					invoked.SubtotalField = SortSourceFieldNine
					invoked.SubtotalPlacement = PrmSubtotalPlacement
					
		CreateSubtotalRowTen is an Instance Action
			valid when (SortSourceFieldTen entered)
			default label is "AddRow"
			Parameters
				PrmDescription	is Alpha 60
					default label is "RowDescription"
				PrmSubtotalPlacement					is Numeric 1
					default label is "SubtotalPlacement"
		    		States
		    			Header			value is 0
		    			Trailer			value is 1
			
			Action Rules
				invoke Create FileCreationRowDetail
					invoked.FinanceEnterpriseGroup = FinanceEnterpriseGroup
					invoked.FileCreationSetup = FileCreationSetup
					invoked.Subtotal = true
					invoked.SubtotalLevel = 10
					invoked.Description = PrmDescription
					invoked.SubtotalField = SortSourceFieldTen
					invoked.SubtotalPlacement = PrmSubtotalPlacement
					
		CreateSubtotalRowEleven is an Instance Action
			valid when (SortSourceFieldEleven entered)
			default label is "AddRow"
			Parameters
				PrmDescription	is Alpha 60
					default label is "RowDescription"
				PrmSubtotalPlacement					is Numeric 1
					default label is "SubtotalPlacement"
		    		States
		    			Header			value is 0
		    			Trailer			value is 1
			
			Action Rules
				invoke Create FileCreationRowDetail
					invoked.FinanceEnterpriseGroup = FinanceEnterpriseGroup
					invoked.FileCreationSetup = FileCreationSetup
					invoked.Subtotal = true
					invoked.SubtotalLevel = 11
					invoked.Description = PrmDescription
					invoked.SubtotalField = SortSourceFieldEleven
					invoked.SubtotalPlacement = PrmSubtotalPlacement
					
		CreateSubtotalRowTwelve is an Instance Action
			valid when (SortSourceFieldTwelve entered)
			default label is "AddRow"
			Parameters
				PrmDescription	is Alpha 60
					default label is "RowDescription"
				PrmSubtotalPlacement					is Numeric 1
					default label is "SubtotalPlacement"
		    		States
		    			Header			value is 0
		    			Trailer			value is 1
			
			Action Rules
				invoke Create FileCreationRowDetail
					invoked.FinanceEnterpriseGroup = FinanceEnterpriseGroup
					invoked.FileCreationSetup = FileCreationSetup
					invoked.Subtotal = true
					invoked.SubtotalLevel = 12
					invoked.Description = PrmDescription
					invoked.SubtotalField = SortSourceFieldTwelve
					invoked.SubtotalPlacement = PrmSubtotalPlacement
				
		FormatVariable is an Instance Action
			restricted

			Parameters
				PrmValidFormat				is Text
				PrmReplaceInvalidsWith		is Text
				PrmReplaceValue				is Text
			
			Action Rules
				LocalValidFormat			= PrmValidFormat
				LocalReplaceInvalidsWith	= PrmReplaceInvalidsWith
				LocalReplaceValue			= PrmReplaceValue

		ClearEligibilityGroup is an Instance Action

			Action Rules
				initialize EligibilityGroup

		
		ValidateRecords is an Instance Action
			run in background
			synchronized on untranslatable:"FileCreationSetup_ValidateRecords_<FinanceEnterpriseGroup>_<FileCreationSetup>"
			Parameters
				ValidateRequiredFields     		is Boolean
				ValidateLength			   		is Boolean
				ValidateCharacters  			is Boolean
				CharacterCheck					is Numeric 2
					States
						NonASCII  			value is 0
						UserDefined 		value is 1
				CharacterExpression				is Alpha 50
				PrmFinanceEnterpriseGroup is an FinanceEnterpriseGroup
                    default label is "FinanceEnterpriseGroup"

			Parameter Rules

				PrmFinanceEnterpriseGroup
					force default to FinanceEnterpriseGroup

				CharacterExpression
					if (ValidateCharacters)
						required
					if (CharacterCheck.NonASCII)
						force default to "[^\x00-\x7F]"

			Local Fields
				LocalThread				is Numeric 3
				LocalNumberOfThreads	is Numeric 3
				LocalBackgroundGroup1	is Alpha 200

			Action Rules
				LocalBackgroundGroup1	= "ValidateRecords_" + FinanceEnterpriseGroup +"_" + FileCreationSetup +"_" + system current timestamp
				LocalNumberOfThreads 	= OverrideNumberOfThreads
				initialize LocalThread
				while (LocalThread < LocalNumberOfThreads)
					invoke ValidateRecordsThread FileCreationRecord in background group (LocalBackgroundGroup1)
						invoked.FileCreationSetupPrm  	  	  = FileCreationSetup	 	
						invoked.FinanceEnterpriseGroupPrm     = FinanceEnterpriseGroup		
						invoked.ValidateRequiredFields        =	ValidateRequiredFields	
						invoked.ValidateLength			   	  =	ValidateLength
						invoked.ValidateCharacters  		  =	ValidateCharacters	
						invoked.CharacterCheck				  =	CharacterCheck	
						invoked.CharacterExpression			  =	CharacterExpression	
						invoked.PrmThread					  = LocalThread	
						invoked.PrmNumberOfThreads			  = LocalNumberOfThreads
					LocalThread += 1

				invoke MergeValidationReport in background
					run after background group(LocalBackgroundGroup1)
					invoked.ValidateLength			   	  =	ValidateLength
					invoked.ValidateCharacters  		  =	ValidateCharacters	
					invoked.ValidateRequiredFields		  =	ValidateRequiredFields
			


		MergeValidationReport is an Instance Action
			restricted
			Parameters
				ValidateRequiredFields     		is Boolean
				ValidateLength			   		is Boolean
				ValidateCharacters  			is Boolean

			Local Fields
				LocalCharacterCheckValidation   is RichText
				LocalLengthCheckValidation		is RichText
				LocalRequiredCheckValidation    is RichText
				LocalValidationReport			is RichText

			Action Rules
				ValidationReportTimeStamp 	= system current timestamp
				if (ValidateCharacters)	
					LocalCharacterCheckValidation += "<body><h3 style=\"font-weight:bold;text-align:center\">Character Check Validation</h3><table style=\"table-layout:fixed;width:100%;border-collapse:collapse\"><tbody><tr><th style=\"width:33%;font-weight:bold;font-size:15px;padding:20px;letter-spacing:2px;text-align:center\">Record</th><th style=\"width:34%;font-weight:bold;font-size:15px;padding:20px;letter-spacing:2px;text-align:center\">Column</th><th style=\"width:33%;font-weight:bold;font-size:15px;padding:20px;letter-spacing:2px;text-align:center\">Field Value</th></tr></tbody>"
				if (ValidateLength)	
					LocalLengthCheckValidation += "<body><h3 style=\"font-weight:bold;text-align:center\">Length Validation</h3><table style=\"table-layout:fixed;width:100%;border-collapse:collapse\"><tbody><tr><th style=\"width:25%;font-weight:bold;font-size:15px;padding:20px;letter-spacing:2px;text-align:center\">Record</th><th style=\"width:25%;font-weight:bold;font-size:15px;padding:20px;letter-spacing:2px;text-align:center\">Column</th><th style=\"width:25%;font-weight:bold;font-size:15px;padding:20px;letter-spacing:2px;text-align:center\">Truncated Value</th><th style=\"width:25%;font-weight:bold;font-size:15px;padding:20px;letter-spacing:2px;text-align:center\">Original Length</th></tr></tbody>"
				if (ValidateRequiredFields)
					LocalRequiredCheckValidation += "<body><h3 style=\"font-weight:bold;text-align:center\">Required Field Validation</h3><table style=\"table-layout:fixed;width:100%;border-collapse:collapse\"><tbody><tr><th style=\"width:50%;font-weight:bold;font-size:15px;padding:20px;letter-spacing:2px;text-align:center\">Record</th><th style=\"width:50%;font-weight:bold;font-size:15px;padding:20px;letter-spacing:2px;text-align:center\">Column</th></tr></tbody>"
				for each FileCreationTemporaryRel
					if (ValidateCharacters) 
						LocalCharacterCheckValidation += each.CharacterCheckValidation
					if (ValidateLength)
						LocalLengthCheckValidation += each.LengthCheckValidation
					if (ValidateRequiredFields)
						LocalRequiredCheckValidation += each.RequiredCheckValidation
				LocalValidationReport = "<html><body><header><h1 style=\"text-align:center\">Validation Report " + ValidationReportTimeStamp + "</h1><h2 style=\"text-align:center\">" + Description + " (" + FileCreationSetup + ")" + "</h2></header></body></html><br/>"
				if (ValidateCharacters)
					LocalCharacterCheckValidation += "</table></body><br />"
					LocalValidationReport += LocalCharacterCheckValidation
				if (ValidateLength)
					LocalLengthCheckValidation += "</table></body><br />"
					LocalValidationReport += LocalLengthCheckValidation
				if (ValidateRequiredFields)
					LocalRequiredCheckValidation += "</table></body><br />"
					LocalValidationReport += LocalRequiredCheckValidation
				ValidationReportText = LocalValidationReport
				ValidationReport.File	= ValidationReportSummaryLink as pdf in landscape
				ValidationReport.Title  = Description + "_Validation.pdf"
				ValidationReport.MimeType = "application/pdf"
				invoke Purge FileCreationTemporaryRel
				initialize ValidationReportText

		PrintMappings is an Instance Action
 			valid when (MappingsExist)
 			run in background
 			synchronized on untranslatable:"FileCreationSetup_PrintMappings_<FinanceEnterpriseGroup>_<FileCreationSetup>"
 
 			Parameters
 				PageOrientation 			is Numeric size 1
 					States
 						Landscape		value is 1
 						Portrait  		value is 2
 				IncludeSortingFields		is Boolean
 				IncludeRecordCounters		is Boolean
 				IncludeRowConditions		is Boolean
 				IncludeDataMappings			is Boolean
 				
 			Parameter Rules
 				PageOrientation
 					initial value is 1
 				IncludeSortingFields
 					initial value is true
 				IncludeRowConditions
 					initial value is true
 				IncludeRecordCounters
 					initial value is true
 				IncludeDataMappings
 					initial value is true
 			
 			Entrance Rules
 				IsSortingFieldsIncluded 	= IncludeSortingFields
 				IsRecordCountersIncluded 	= IncludeRecordCounters
 				IsRowConditionsIncluded 	= IncludeRowConditions
 				IsDataMappingsIncluded 		= IncludeDataMappings
 				MappingsDocumentTimeStamp 	= system current timestamp
 			
 			Action Rules
 				if (FileCreationColumnDetailWithDataMappingRel exists
 				and IncludeDataMappings)
 					for each FileCreationColumnDetailWithDataMappingRel
 						invoke Create TempFileCreationColumn
 							invoked.FinanceEnterpriseGroup   = each.FinanceEnterpriseGroup
 							invoked.FileCreationSetup		 = each.FileCreationSetup
 							invoked.FileCreationRowDetail    = each.FileCreationRowDetail
 							invoked.FileCreationColumnDetail = each.FileCreationColumnDetail
 
 				if (PageOrientation.Portrait)
 					MappingsDocument.File	= MappingsDocumentSummaryLink as pdf in portrait font offset is -2
 				if (PageOrientation.Landscape)
 					MappingsDocument.File	= MappingsDocumentSummaryLink as pdf in landscape font offset is -2
 				MappingsDocument.Title		= Description + "_Mappings.pdf"
 				MappingsDocument.MimeType	= "application/pdf"

		ExportSetup is an Instance Action
			
			Parameters
				SelectSeparator			is Alpha 2
					default label is "Separator"
					States
						Pipe			value is "|"
						Caret			value is "^"
						DoublePipe		value is "||"
						DoubleCaret		value is "^^"
				IncludeLinkedSetups		is Boolean
			
			Parameter Rules
				SelectSeparator
					initial value is SelectSeparator.DoubleCaret
					required
					if (SelectSeparator.Caret
					or SelectSeparator.DoubleCaret)
						IsSeparatorSimilar = FieldSeparator like "*^*"
					else
						IsSeparatorSimilar = FieldSeparator like "*|*"

					constraint (not IsSeparatorSimilar)
						"CannotHaveSimilarCharactersToFieldSeparator"

			Local Fields
				IsSeparatorSimilar					is Boolean
				NewLine								is Alpha 2
				TempText							is Text
				MainSetupText						is Text
				LinkedSetupText						is Text
				LinkedSetupHeaderText				is Text
				Separator							is Alpha 2
				ExportFileLocal						is Numeric 2
				IONInstanceCountLocal				is Numeric 1			
				FileTypeLocal						is Numeric 1
				FileSegmentLimitLocal				is Numeric 1
				GenerationBehaviorForNoOutputLocal	is Numeric 1
				LastTimeStampValue					is Alpha 20
				OneToManyBusinessClassPayablesInvoiceLocal			is Numeric 2
				OneToManyBusinessClassGeneralLedgerChartAccountLocal is Numeric 2
				OneToManyBusinessClassAssetLocal is Numeric 2
				OneToManyBusinessClassBinGroupLocal is Numeric 2
				OneToManyBusinessClassContractLocal is Numeric 2
				OneToManyBusinessClassPurchaseOrderLocal is Numeric 2
				OneToManyBusinessClassVendorLocal	is Numeric 2
				OneToManySequenceNumberStartingValueLocal			is Numeric 2
				RowCondition1CompareFile			is Numeric 1
				RowCondition1CompareOperator		is Numeric 2
				RowCondition1DataType				is Numeric 1
				RowCondition1DateValue				is Alpha 8
				RowCondition1TimeValue				is Alpha 4
				RowCondition1TimeStampValue			is Alpha 20
				RowCondition1CompareType			is Numeric 1
				RowCondition2CompareFile			is Numeric 1
				RowCondition2CompareOperator		is Numeric 2
				RowCondition2DataType				is Numeric 1
				RowCondition2DateValue				is Alpha 8
				RowCondition2TimeValue				is Alpha 4
				RowCondition2TimeStampValue			is Alpha 20
				RowCondition2CompareType			is Numeric 1
				RowConditionOperatorLocal			is Numeric 1
				OneToManyRowCondition1CompareFile	is Numeric 1
				OneToManyRowCondition1CompareOperator	is Numeric 2
				OneToManyRowCondition1DataType		is Numeric 1
				OneToManyRowCondition1DateValue		is Alpha 8
				OneToManyRowCondition1TimeValue		is Alpha 4
				OneToManyRowCondition1TimeStampValue	is Alpha 20
				OneToManyRowCondition1CompareType	is Numeric 1
				OneToManyRowCondition2CompareFile	is Numeric 1
				OneToManyRowCondition2CompareOperator	is Numeric 2
				OneToManyRowCondition2DataType		is Numeric 1
				OneToManyRowCondition2DateValue		is Alpha 8
				OneToManyRowCondition2TimeValue		is Alpha 4
				OneToManyRowCondition2TimeStampValue	is Alpha 20
				OneToManyRowCondition2CompareType	is Numeric 1
				OneToManyRowConditionOperatorLocal	is Numeric 1
				ExtendedCondition1CompareFile		is Numeric 1
				ExtendedCondition1CompareOperator	is Numeric 2
				ExtendedCondition1DataType			is Numeric 1
				ExtendedCondition1DateValue			is Alpha 8
				ExtendedCondition1TimeValue			is Alpha 4
				ExtendedCondition1TimeStampValue	is Alpha 20
				ExtendedCondition1CompareType		is Numeric 1
				ExtendedCondition2CompareFile		is Numeric 1
				ExtendedCondition2CompareOperator	is Numeric 2
				ExtendedCondition2DataType			is Numeric 1
				ExtendedCondition2DateValue			is Alpha 8
				ExtendedCondition2TimeValue			is Alpha 4
				ExtendedCondition2TimeStampValue	is Alpha 20
				ExtendedCondition2CompareType		is Numeric 1
				ExtendedConditionOperatorLocal		is Numeric 1
				DataTypeLocal						is Numeric 1
				InputOptionLocal					is Numeric 1
				DataMappingOptionLocal				is Numeric 1
				DefaultDateLocal					is Alpha 8
				DefaultTimeLocal					is Alpha 4
				DefaultTimeStampLocal				is Alpha 20
				CompareTypeLocal					is Numeric 1
				DateFromValueLocal					is Alpha 8
				TimeFromValueLocal					is Alpha 4
				DateToValueLocal					is Alpha 8
				TimeToValueLocal					is Alpha 4
				LocalLinkedSetup					is like FileCreationSetup
				ThreadingMethodLocal				is Numeric 1				
				CommentsLocal						is Text
				FileHeaderTextLocal					is Text
				DefaultTextLocal					is Text
				SortSourceFieldOneDataTypeLocal		is Numeric 1
				SortSourceFieldTwoDataTypeLocal		is Numeric 1
				SortSourceFieldThreeDataTypeLocal	is Numeric 1
				SortSourceFieldFourDataTypeLocal	is Numeric 1
				SortSourceFieldFiveDataTypeLocal	is Numeric 1
				SortSourceFieldSixDataTypeLocal		is Numeric 1
				SortSourceFieldSevenDataTypeLocal	is Numeric 1
				SortSourceFieldEightDataTypeLocal	is Numeric 1
				SortSourceFieldNineDataTypeLocal	is Numeric 1
				SortSourceFieldTenDataTypeLocal		is Numeric 1
				SortSourceFieldElevenDataTypeLocal	is Numeric 1
				SortSourceFieldTwelveDataTypeLocal	is Numeric 1
				SubtotalPlacementLocal				is Numeric 1
				DateAdjustmentOperatorLocal			is Numeric 1
				EndOfLineCharacterLocal				is Numeric 1
				OutputTextForBlankDocumentLocal		is Text
				FileMimeTypeLocal					is Numeric 1
			Rule Blocks
				GetSetupDetails
					for each {RowRelation}
						OneToManyBusinessClassPayablesInvoiceLocal			= each.OneToManyBusinessClassPayablesInvoice
						OneToManyBusinessClassGeneralLedgerChartAccountLocal = each.OneToManyBusinessClassGeneralLedgerChartAccount
						OneToManyBusinessClassAssetLocal					= each.OneToManyBusinessClassAsset
						OneToManyBusinessClassBinGroupLocal					= each.OneToManyBusinessClassBinGroup
						OneToManyBusinessClassContractLocal					= each.OneToManyBusinessClassContract
						OneToManyBusinessClassPurchaseOrderLocal			= each.OneToManyBusinessClassPurchaseOrder
						OneToManyBusinessClassVendorLocal					= each.OneToManyBusinessClassVendor
						OneToManySequenceNumberStartingValueLocal			= each.OneToManySequenceNumberStartingValue
						RowCondition1CompareFile							= each.RowCondition1.CompareFile
						RowCondition1CompareOperator						= each.RowCondition1.CompareOperator
						RowCondition1DataType								= each.RowCondition1.FieldDataType
						RowCondition1CompareType							= each.RowCondition1.CompareType
						SubtotalPlacementLocal								= each.SubtotalPlacement
						if (each.RowCondition1.DateValue entered)
							RowCondition1DateValue	= each.RowCondition1.DateValue using "%1$tY%1$tm%1$td"
						else
							RowCondition1DateValue	= ""									
						if (each.RowCondition1.TimeValue entered)
							RowCondition1TimeValue	= each.RowCondition1.TimeValue using "%1$tI%1$tM"
						else
							RowCondition1TimeValue	= ""									
						if (each.RowCondition1.TimeStampValue entered)
							RowCondition1TimeStampValue	= each.RowCondition1.TimeStampValue using "%1$tY%1$tm%1$td%1$tH%1$tM%1$tS%1$tL"
						else
							RowCondition1TimeStampValue	= ""									
						RowCondition2CompareFile							= each.RowCondition2.CompareFile
						RowCondition2CompareOperator						= each.RowCondition2.CompareOperator
						RowCondition2DataType								= each.RowCondition2.FieldDataType
						RowCondition2CompareType							= each.RowCondition2.CompareType
						if (each.RowCondition2.DateValue entered)
							RowCondition2DateValue	= each.RowCondition2.DateValue using "%1$tY%1$tm%1$td"
						else
							RowCondition2DateValue	= ""									
						if (each.RowCondition2.TimeValue entered)
							RowCondition2TimeValue	= each.RowCondition2.TimeValue using "%1$tI%1$tM"
						else
							RowCondition2TimeValue	= ""									
						if (each.RowCondition2.TimeStampValue entered)
							RowCondition2TimeStampValue	= each.RowCondition2.TimeStampValue using "%1$tY%1$tm%1$td%1$tH%1$tM%1$tS%1$tL"
						else
							RowCondition2TimeStampValue	= ""									
						RowConditionOperatorLocal							= each.RowConditionOperator
						OneToManyRowCondition1CompareFile					= each.OneToManyCondition1.CompareFile
						OneToManyRowCondition1CompareOperator				= each.OneToManyCondition1.CompareOperator
						OneToManyRowCondition1DataType						= each.OneToManyCondition1.FieldDataType
						OneToManyRowCondition1CompareType					= each.OneToManyCondition1.CompareType
						if (each.OneToManyCondition1.DateValue entered)
							OneToManyRowCondition1DateValue	= each.OneToManyCondition1.DateValue using "%1$tY%1$tm%1$td"
						else
							OneToManyRowCondition1DateValue	= ""									
						if (each.OneToManyCondition1.TimeValue entered)
							OneToManyRowCondition1TimeValue	= each.OneToManyCondition1.TimeValue using "%1$tI%1$tM"
						else
							OneToManyRowCondition1TimeValue	= ""									
						if (each.OneToManyCondition1.TimeStampValue entered)
							OneToManyRowCondition1TimeStampValue	= each.OneToManyCondition1.TimeStampValue using "%1$tY%1$tm%1$td%1$tH%1$tM%1$tS%1$tL"
						else
							OneToManyRowCondition1TimeStampValue	= ""									
						OneToManyRowCondition2CompareFile					= each.OneToManyCondition2.CompareFile
						OneToManyRowCondition2CompareOperator				= each.OneToManyCondition2.CompareOperator
						OneToManyRowCondition2DataType						= each.OneToManyCondition2.FieldDataType
						OneToManyRowCondition2CompareType					= each.OneToManyCondition2.CompareType
						if (each.OneToManyCondition2.DateValue entered)
							OneToManyRowCondition2DateValue	= each.OneToManyCondition2.DateValue using "%1$tY%1$tm%1$td"
						else
							OneToManyRowCondition2DateValue	= ""									
						if (each.OneToManyCondition2.TimeValue entered)
							OneToManyRowCondition2TimeValue	= each.OneToManyCondition2.TimeValue using "%1$tI%1$tM"
						else
							OneToManyRowCondition2TimeValue	= ""									
						if (each.OneToManyCondition2.TimeStampValue entered)
							OneToManyRowCondition2TimeStampValue	= each.OneToManyCondition2.TimeStampValue using "%1$tY%1$tm%1$td%1$tH%1$tM%1$tS%1$tL"
						else
							OneToManyRowCondition2TimeStampValue	= ""									
						OneToManyRowConditionOperatorLocal					= each.OneToManyRowConditionOperator
						ExtendedCondition1CompareFile						= each.ExtendedCondition1.CompareFile
						ExtendedCondition1CompareOperator					= each.ExtendedCondition1.CompareOperator
						ExtendedCondition1DataType							= each.ExtendedCondition1.FieldDataType
						ExtendedCondition1CompareType						= each.ExtendedCondition1.CompareType
						if (each.ExtendedCondition1.DateValue entered)
							ExtendedCondition1DateValue	= each.ExtendedCondition1.DateValue using "%1$tY%1$tm%1$td"
						else
							ExtendedCondition1DateValue	= ""									
						if (each.ExtendedCondition1.TimeValue entered)
							ExtendedCondition1TimeValue	= each.ExtendedCondition1.TimeValue using "%1$tI%1$tM"
						else
							ExtendedCondition1TimeValue	= ""									
						if (each.ExtendedCondition1.TimeStampValue entered)
							ExtendedCondition1TimeStampValue	= each.ExtendedCondition1.TimeStampValue using "%1$tY%1$tm%1$td%1$tH%1$tM%1$tS%1$tL"
						else
							ExtendedCondition1TimeStampValue	= ""									
						ExtendedCondition2CompareFile						= each.ExtendedCondition2.CompareFile
						ExtendedCondition2CompareOperator					= each.ExtendedCondition2.CompareOperator
						ExtendedCondition2DataType							= each.ExtendedCondition2.FieldDataType
						ExtendedCondition2CompareType						= each.ExtendedCondition2.CompareType
						if (each.ExtendedCondition2.DateValue entered)
							ExtendedCondition2DateValue	= each.ExtendedCondition2.DateValue using "%1$tY%1$tm%1$td"
						else
							ExtendedCondition2DateValue	= ""									
						if (each.ExtendedCondition2.TimeValue entered)
							ExtendedCondition2TimeValue	= each.ExtendedCondition2.TimeValue using "%1$tI%1$tM"
						else
							ExtendedCondition2TimeValue	= ""									
						if (each.ExtendedCondition2.TimeStampValue entered)
							ExtendedCondition2TimeStampValue	= each.ExtendedCondition2.TimeStampValue using "%1$tY%1$tm%1$td%1$tH%1$tM%1$tS%1$tL"
						else
							ExtendedCondition2TimeStampValue	= ""									
						ExtendedConditionOperatorLocal						= each.ExtendedRowConditionOperator
						
						TempText += "2" + Separator + FinanceEnterpriseGroup + Separator + each.FileCreationSetup + Separator + each.FileCreationRowDetail + Separator + each.Description + Separator + each.RowOrder + Separator + each.Header + Separator + each.Trailer + Separator + each.OneToMany + Separator
						TempText += OneToManyBusinessClassPayablesInvoiceLocal + Separator 
						TempText += OneToManySequenceNumberStartingValueLocal + Separator + each.DoNotResetOneToManySequenceNumber + Separator
						TempText += each.ExtendsOneToManyRow + Separator + each.IncludeInRecordCount1 + Separator + each.IncludeInRecordCount2 + Separator + each.IncludeInRecordCount3 + Separator + each.RecordHasBeenChanged + Separator 
						TempText += RowCondition1CompareFile + Separator + RowCondition1CompareOperator + Separator + RowCondition1DataType + Separator + each.RowCondition1.AlphaValue + Separator + each.RowCondition1.NumericValue + Separator + each.RowCondition1.DecimalValue using "%024.8f" + Separator 
						TempText += RowCondition1DateValue + Separator + RowCondition1TimeValue + Separator + each.RowCondition1.TextValue + Separator + each.RowCondition1.BooleanValue + Separator + RowCondition1TimeStampValue + Separator + each.CompareField1 + Separator  
						TempText += RowCondition2CompareFile + Separator + RowCondition2CompareOperator + Separator + RowCondition2DataType + Separator + each.RowCondition2.AlphaValue + Separator + each.RowCondition2.NumericValue + Separator + each.RowCondition2.DecimalValue using "%024.8f" + Separator 
						TempText += RowCondition2DateValue + Separator + RowCondition2TimeValue + Separator + each.RowCondition2.TextValue + Separator + each.RowCondition2.BooleanValue + Separator + RowCondition2TimeStampValue + Separator + each.CompareField2 + Separator + RowConditionOperatorLocal + Separator 
						TempText += OneToManyRowCondition1CompareFile + Separator + OneToManyRowCondition1CompareOperator + Separator + OneToManyRowCondition1DataType + Separator + each.OneToManyCondition1.AlphaValue + Separator + each.OneToManyCondition1.NumericValue + Separator + each.OneToManyCondition1.DecimalValue using "%024.8f" + Separator 
						TempText += OneToManyRowCondition1DateValue + Separator + OneToManyRowCondition1TimeValue + Separator + each.OneToManyCondition1.TextValue + Separator + each.OneToManyCondition1.BooleanValue + Separator + OneToManyRowCondition1TimeStampValue + Separator + each.OneToManyCompareField1 + Separator  
						TempText += OneToManyRowCondition2CompareFile + Separator + OneToManyRowCondition2CompareOperator + Separator + OneToManyRowCondition2DataType + Separator + each.OneToManyCondition2.AlphaValue + Separator + each.OneToManyCondition2.NumericValue + Separator + each.OneToManyCondition2.DecimalValue using "%024.8f" + Separator 
						TempText += OneToManyRowCondition2DateValue + Separator + OneToManyRowCondition2TimeValue + Separator + each.OneToManyCondition2.TextValue + Separator + each.OneToManyCondition2.BooleanValue + Separator + OneToManyRowCondition2TimeStampValue + Separator + each.OneToManyCompareField2 + Separator + OneToManyRowConditionOperatorLocal + Separator 					
						TempText += ExtendedCondition1CompareFile + Separator + ExtendedCondition1CompareOperator + Separator + ExtendedCondition1DataType + Separator + each.ExtendedCondition1.AlphaValue + Separator + each.ExtendedCondition1.NumericValue + Separator + each.ExtendedCondition1.DecimalValue using "%024.8f" + Separator 
						TempText += ExtendedCondition1DateValue + Separator + ExtendedCondition1TimeValue + Separator + each.ExtendedCondition1.TextValue + Separator + each.ExtendedCondition1.BooleanValue + Separator + ExtendedCondition1TimeStampValue + Separator + each.ExtendedCompareField1 + Separator  
						TempText += ExtendedCondition2CompareFile + Separator + ExtendedCondition2CompareOperator + Separator + ExtendedCondition2DataType + Separator + each.ExtendedCondition2.AlphaValue + Separator + each.ExtendedCondition2.NumericValue + Separator + each.ExtendedCondition2.DecimalValue using "%024.8f" + Separator 
						TempText += ExtendedCondition2DateValue + Separator + ExtendedCondition2TimeValue + Separator + each.ExtendedCondition2.TextValue + Separator + each.ExtendedCondition2.BooleanValue + Separator + ExtendedCondition2TimeStampValue + Separator + each.ExtendedCompareField2 + Separator + ExtendedConditionOperatorLocal + Separator 
						TempText += each.DCKey + Separator + each.LinkedSetup + Separator + each.LinkedRow + Separator + each.Disable + Separator + RowCondition1CompareType + Separator + each.ComparedToField1 + Separator + RowCondition2CompareType + Separator + each.ComparedToField2 + Separator
						TempText += OneToManyRowCondition1CompareType + Separator + each.OneToManyComparedToField1 + Separator + OneToManyRowCondition2CompareType + Separator + each.OneToManyComparedToField2 + Separator + ExtendedCondition1CompareType + Separator + each.ExtendedComparedToField1 + Separator 
						TempText += ExtendedCondition2CompareType + Separator + each.ExtendedComparedToField2 + Separator + each.LinkedSetup.DCKey + Separator + each.LinkedRow.DCKey + Separator + each.Subtotal + Separator + each.SubtotalField + Separator + each.SubtotalLevel + Separator + SubtotalPlacementLocal + Separator
						TempText += each.IncludeInRecordCount4 + Separator + each.IncludeInRecordCount5 + Separator + each.IncludeInRecordCount6 + Separator + OneToManyBusinessClassGeneralLedgerChartAccountLocal + Separator + OneToManyBusinessClassAssetLocal + Separator + OneToManyBusinessClassBinGroupLocal + Separator + OneToManyBusinessClassContractLocal + Separator + OneToManyBusinessClassPurchaseOrderLocal + Separator + OneToManyBusinessClassVendorLocal + NewLine

						if ({IncludeLinked})
							if (each.LinkedSetup entered
							and each.LinkedRow entered
							and I1 <= 20)
								LocalLinkedSetup = each.LinkedSetup
								if (I1 = 0)
									LinkedSetupHeaderText = "0"
									I2 = 1
								else
									I2 = 1
									for each (Array) FileCreationSetupArray.SetupGroup
										if (each (Array).Setup = LocalLinkedSetup)
											end for each
										I2 += 1
								LinkedSetupHeaderText += Separator + each.LinkedSetup + Separator + each.LinkedRow 
								if (I2 > I1)
									I1 += 1
									FileCreationSetupArray.SetupGroup[I1].Setup = each.LinkedSetup
		
						LocalRow	= each.FileCreationRowDetail
						for each {ColumnRelation}
							invoke FormatVariable FileCreationSetup
								invoked.PrmValidFormat			= FileCreationSetup.LineFeedNative
								invoked.PrmReplaceInvalidsWith	= "~***~"
								invoked.PrmReplaceValue			= each.Comments
							CommentsLocal = FileCreationSetup.ReplacedValue

							invoke FormatVariable FileCreationSetup
								invoked.PrmValidFormat			= FileCreationSetup.LineFeedNative
								invoked.PrmReplaceInvalidsWith	= "~***~"
								invoked.PrmReplaceValue			= each.DefaultText
							DefaultTextLocal = FileCreationSetup.ReplacedValue

							DataTypeLocal									= each.FieldDataType
							InputOptionLocal								= each.InputOption
							DataMappingOptionLocal							= each.DataMappingOption
							DateAdjustmentOperatorLocal						= each.DateAdjustmentOperator
							if (each.DefaultDate entered)
								DefaultDateLocal	= each.DefaultDate using "%1$tY%1$tm%1$td"
							else
								DefaultDateLocal	= ""									
							if (each.DefaultTime entered)
								DefaultTimeLocal	= each.DefaultTime using "%1$tI%1$tM"
							else
								DefaultTimeLocal	= ""															
							if (each.DefaultTimeStamp entered)
								DefaultTimeStampLocal	= each.DefaultTimeStamp using "%1$tY%1$tm%1$td%1$tH%1$tM%1$tS%1$tL"
							else
								DefaultTimeStampLocal	= ""									
							TempText += "3" + Separator + FinanceEnterpriseGroup + Separator + each.FileCreationSetup + Separator + each.FileCreationRowDetail + Separator + each.FileCreationColumnDetail + Separator + each.FieldName + Separator + each.Description + Separator + each.ColumnOrder + Separator + DataTypeLocal + Separator
							TempText += each.Length + Separator + InputOptionLocal + Separator 
							TempText += each.SourceRelation + Separator + each.SourceFields + Separator + each.NumberOfSourceFields + Separator + CommentsLocal + Separator + each.ShowAlphaDefaultField + Separator + each.DefaultAlpha + Separator + each.DefaultNumeric + Separator + each.DefaultDecimal using "%024.8f" + Separator
							TempText += DefaultDateLocal + Separator + DefaultTimeLocal + Separator + each.DefaultBoolean + Separator + DefaultTextLocal + Separator + DefaultTimeStampLocal + Separator + each.UseCurrentSystemDate + Separator + each.UseCurrentSystemTime + Separator
							TempText += each.UseCurrentSystemTimeStamp + Separator + each.ConvertToUpperCase + Separator + each.TruncateToLength + Separator + each.SubstringStart + Separator + each.SubstringEnd + Separator + each.FileName + Separator + each.OneToMany + Separator
							TempText += each.OneToManySequenceNumber + Separator + each.RecordCount1 + Separator + each.RecordCount2 + Separator + each.RecordCount3 + Separator + each.JavaFormat + Separator + each.ReplacementRegularExpression + Separator + each.ReplacementReplaceWith + Separator
							TempText += DataMappingOptionLocal + Separator + each.RecordHasBeenChanged + Separator 
							TempText += each.DCKey + Separator + each.FixedLengthFieldRange.BeginPosition + Separator + each.FixedLengthFieldRange.EndPosition + Separator
							TempText += each.FixedLengthFieldRangeArray.FixedLengthFieldRange[1].BeginPosition + Separator + each.FixedLengthFieldRangeArray.FixedLengthFieldRange[1].EndPosition + Separator
							TempText += each.FixedLengthFieldRangeArray.FixedLengthFieldRange[2].BeginPosition + Separator + each.FixedLengthFieldRangeArray.FixedLengthFieldRange[2].EndPosition + Separator
							TempText += each.FixedLengthFieldRangeArray.FixedLengthFieldRange[3].BeginPosition + Separator + each.FixedLengthFieldRangeArray.FixedLengthFieldRange[3].EndPosition + Separator
							TempText += each.FixedLengthFieldRangeArray.FixedLengthFieldRange[4].BeginPosition + Separator + each.FixedLengthFieldRangeArray.FixedLengthFieldRange[4].EndPosition + Separator
							TempText += each.FixedLengthFieldRangeArray.FixedLengthFieldRange[5].BeginPosition + Separator + each.FixedLengthFieldRangeArray.FixedLengthFieldRange[5].EndPosition + Separator
							TempText += each.FixedLengthFieldRangeArray.FixedLengthFieldRange[6].BeginPosition + Separator + each.FixedLengthFieldRangeArray.FixedLengthFieldRange[6].EndPosition + Separator
							TempText += each.FixedLengthFieldRangeArray.FixedLengthFieldRange[7].BeginPosition + Separator + each.FixedLengthFieldRangeArray.FixedLengthFieldRange[7].EndPosition + Separator
							TempText += each.FixedLengthFieldRangeArray.FixedLengthFieldRange[8].BeginPosition + Separator + each.FixedLengthFieldRangeArray.FixedLengthFieldRange[8].EndPosition + Separator
							TempText += each.FixedLengthFieldRangeArray.FixedLengthFieldRange[9].BeginPosition + Separator + each.FixedLengthFieldRangeArray.FixedLengthFieldRange[9].EndPosition + Separator
							TempText += each.FixedLengthFieldRangeArray.FixedLengthFieldRange[10].BeginPosition + Separator + each.FixedLengthFieldRangeArray.FixedLengthFieldRange[10].EndPosition + Separator
							TempText += each.FixedLengthFieldRangeArray.FixedLengthFieldRange[11].BeginPosition + Separator + each.FixedLengthFieldRangeArray.FixedLengthFieldRange[11].EndPosition + Separator
							TempText += each.FixedLengthFieldRangeArray.FixedLengthFieldRange[12].BeginPosition + Separator + each.FixedLengthFieldRangeArray.FixedLengthFieldRange[12].EndPosition + Separator
							TempText += each.FixedLengthFieldRangeArray.FixedLengthFieldRange[13].BeginPosition + Separator + each.FixedLengthFieldRangeArray.FixedLengthFieldRange[13].EndPosition + Separator
							TempText += each.FixedLengthFieldRangeArray.FixedLengthFieldRange[14].BeginPosition + Separator + each.FixedLengthFieldRangeArray.FixedLengthFieldRange[14].EndPosition + Separator
							TempText += each.FixedLengthFieldRangeArray.FixedLengthFieldRange[15].BeginPosition + Separator + each.FixedLengthFieldRangeArray.FixedLengthFieldRange[15].EndPosition + Separator
							TempText += each.FixedLengthFieldRangeArray.FixedLengthFieldRange[16].BeginPosition + Separator + each.FixedLengthFieldRangeArray.FixedLengthFieldRange[16].EndPosition + Separator
							TempText += each.FixedLengthFieldRangeArray.FixedLengthFieldRange[17].BeginPosition + Separator + each.FixedLengthFieldRangeArray.FixedLengthFieldRange[17].EndPosition + Separator
							TempText += each.FixedLengthFieldRangeArray.FixedLengthFieldRange[18].BeginPosition + Separator + each.FixedLengthFieldRangeArray.FixedLengthFieldRange[18].EndPosition + Separator						
							TempText += each.FixedLengthFieldRangeArray.FixedLengthFieldRange[19].BeginPosition + Separator + each.FixedLengthFieldRangeArray.FixedLengthFieldRange[19].EndPosition + Separator
							TempText += each.TotalThisColumn + Separator + each.TotalForRow + Separator + each.TotalForColumn + Separator 
							TempText += each.RecordCount4 + Separator + each.RecordCount5 + Separator + each.RecordCount6 + Separator
							TempText += each.ApplyAdjustment + Separator + DateAdjustmentOperatorLocal + Separator + each.DateAdjustment + NewLine
			
							LocalColumn	= each.FileCreationColumnDetail	
							for each {DataMappingRelation}
								CompareTypeLocal = each.CompareType
								if (each.DateFromValue entered)
									DateFromValueLocal	= each.DateFromValue using "%1$tY%1$tm%1$td"
								else
									DateFromValueLocal	= ""									
								if (each.TimeFromValue entered)
									TimeFromValueLocal	= each.TimeFromValue using "%1$tI%1$tM"
								else
									TimeFromValueLocal	= ""									
								if (each.DateToValue entered)
									DateToValueLocal	= each.DateToValue using "%1$tY%1$tm%1$td"
								else
									DateToValueLocal	= ""									
								if (each.TimeToValue entered)
									TimeToValueLocal	= each.TimeToValue using "%1$tI%1$tM"
								else
									TimeToValueLocal	= ""									
								TempText += "4" + Separator + FinanceEnterpriseGroup + Separator + each.FileCreationSetup + Separator + each.FileCreationRowDetail + Separator + each.FileCreationColumnDetail + Separator + each.FileCreationDataMapping + Separator + each.Description + Separator + each.MappingOrder + Separator
								TempText += CompareTypeLocal + Separator + each.AlphaFromValue + Separator + DateFromValueLocal + Separator + each.DecimalFromValue using "%024.8f" + Separator + each.NumericFromValue + Separator + TimeFromValueLocal + Separator + each.BooleanFromValue + Separator + each.AlphaToValue + Separator
								TempText += DateToValueLocal + Separator + each.DecimalToValue using "%024.8f" + Separator + each.NumericToValue + Separator + TimeToValueLocal + Separator + each.RecordHasBeenChanged + Separator + each.DCKey + Separator + each.DefaultMapping + NewLine
								
			Action Rules
				NewLine					= FileCreationSetup.NewLine2
				Separator 				= SelectSeparator
				ExportFileLocal			= ExportFile
				IONInstanceCountLocal	= IONInstanceCount
				FileTypeLocal			= FileType
				FileSegmentLimitLocal	= FileSegmentLimit
				GenerationBehaviorForNoOutputLocal 	= GenerationBehaviorForNoOutput
				SortSourceFieldOneDataTypeLocal		= SortFieldArray.SortField[1].FieldDataType
				SortSourceFieldTwoDataTypeLocal		= SortFieldArray.SortField[2].FieldDataType
				SortSourceFieldThreeDataTypeLocal	= SortFieldArray.SortField[3].FieldDataType
				SortSourceFieldFourDataTypeLocal	= SortFieldArray.SortField[4].FieldDataType
				SortSourceFieldFiveDataTypeLocal	= SortFieldArray.SortField[5].FieldDataType
				SortSourceFieldSixDataTypeLocal		= SortFieldArray.SortField[6].FieldDataType
				SortSourceFieldSevenDataTypeLocal	= SortFieldArray.SortField[7].FieldDataType
				SortSourceFieldEightDataTypeLocal	= SortFieldArray.SortField[8].FieldDataType
				SortSourceFieldNineDataTypeLocal	= SortFieldArray.SortField[9].FieldDataType
				SortSourceFieldTenDataTypeLocal		= SortFieldArray.SortField[10].FieldDataType
				SortSourceFieldElevenDataTypeLocal	= SortFieldArray.SortField[11].FieldDataType
				SortSourceFieldTwelveDataTypeLocal	= SortFieldArray.SortField[12].FieldDataType
				EndOfLineCharacterLocal             = EndOfLineCharacter
				FileMimeTypeLocal					= FileMimeType
				if (LastTimeStamp entered)
					LastTimeStampValue	= LastTimeStamp
				else
					LastTimeStampValue	= ""
				ThreadingMethodLocal		= ThreadingMethod								
				I1 						= 0
				
				invoke FormatVariable FileCreationSetup
					invoked.PrmValidFormat			= FileCreationSetup.LineFeedNative
					invoked.PrmReplaceInvalidsWith	= "~***~"
					invoked.PrmReplaceValue			= FileHeaderText
				FileHeaderTextLocal = FileCreationSetup.ReplacedValue

				invoke FormatVariable FileCreationSetup
					invoked.PrmValidFormat			= FileCreationSetup.LineFeedNative
					invoked.PrmReplaceInvalidsWith	= "~***~"
					invoked.PrmReplaceValue			= OutputTextForBlankDocument
				OutputTextForBlankDocumentLocal = FileCreationSetup.ReplacedValue


				TempText = "1" + Separator + FinanceEnterpriseGroup + Separator + FileCreationSetup + Separator 
				TempText += Description + Separator + FieldSeparator + Separator + IncludeSeparatorAtBeginningOfRow + Separator + FieldDelimiter + Separator + ExportFileLocal + Separator + FlowToProcessFile + Separator + Active + Separator
				TempText += FileName + Separator + AppendTimestampToFileName + Separator + FileNameTimeStampFormat + Separator + LastTimeStampValue + Separator + AllRecords + Separator  
				TempText += FileHeaderTextLocal + Separator
				TempText += DCKey + Separator + AutomaticallySendFileToION + Separator + IONDocumentName + Separator + IONInstanceCountLocal + Separator + IONSource + Separator + IONDocumentID + Separator
				TempText += FileTypeLocal + Separator + FileSegmentLimitLocal + Separator + NumberOfRecordsBeforeNewFile + Separator + NumberOfMegabytesBeforeNewFile + Separator
				TempText += TurnOffRecordAuditing + Separator + GenerationBehaviorForNoOutputLocal + Separator + ThreadingMethodLocal + Separator 
				TempText += ExcludeSeparatorWhenEmpty + Separator + RecordEndOfLineCharacter + Separator
				TempText += SortSourceFieldOne + Separator + SortSourceFieldOneDataTypeLocal + Separator + SortFieldArray.SortField[1].Length + Separator + SortSourceFieldTwo + Separator + SortSourceFieldTwoDataTypeLocal + Separator + SortFieldArray.SortField[2].Length + Separator
				TempText += SortSourceFieldThree + Separator + SortSourceFieldThreeDataTypeLocal + Separator + SortFieldArray.SortField[3].Length + Separator + SortSourceFieldFour + Separator + SortSourceFieldFourDataTypeLocal + Separator + SortFieldArray.SortField[4].Length + Separator
				TempText += SortSourceFieldFive + Separator + SortSourceFieldFiveDataTypeLocal + Separator + SortFieldArray.SortField[5].Length + Separator + SortSourceFieldSix + Separator + SortSourceFieldSixDataTypeLocal + Separator + SortFieldArray.SortField[6].Length + Separator
				TempText += SortSourceFieldSeven + Separator + SortSourceFieldSevenDataTypeLocal + Separator + SortFieldArray.SortField[7].Length + Separator + SortSourceFieldEight + Separator + SortSourceFieldEightDataTypeLocal + Separator + SortFieldArray.SortField[8].Length + Separator
				TempText += SortSourceFieldNine + Separator + SortSourceFieldNineDataTypeLocal + Separator + SortFieldArray.SortField[9].Length + Separator + SortSourceFieldTen + Separator + SortSourceFieldTenDataTypeLocal + Separator + SortFieldArray.SortField[10].Length + Separator
				TempText += SortSourceFieldTen + Separator + SortSourceFieldElevenDataTypeLocal + Separator + SortFieldArray.SortField[11].Length + Separator + SortSourceFieldTwelve + Separator + SortSourceFieldTwelveDataTypeLocal + Separator + SortFieldArray.SortField[12].Length + Separator
				TempText += OverrideNumberOfThreads + Separator + TabSeparator + Separator + EndOfLineCharacterLocal + Separator + OutputTextForBlankDocumentLocal + Separator + UseAuditInformation + Separator + FileMimeTypeLocal + NewLine

				include GetSetupDetails
					replace RowRelation with FileCreationRowDetail set
					replace IncludeLinked with IncludeLinkedSetups
					replace ColumnRelation with FileCreationColumnDetailRel
					replace DataMappingRelation with FileCreationDataMappingRel

				MainSetupText = TempText

				if (I1 > 0)
					TempText = ""
					for each FileCreationSetupArray.SetupGroup
						if (each.Setup = 0)
							end for each
						LocalFinanceEnterpriseGroup 	= FinanceEnterpriseGroup
						LocalFileCreationSetup	= each.Setup 
						ExportFileLocal			= FileCreationSetupOTORel.ExportFile
						IONInstanceCountLocal	= FileCreationSetupOTORel.IONInstanceCount
						FileTypeLocal			= FileCreationSetupOTORel.FileType
						FileSegmentLimitLocal	= FileCreationSetupOTORel.FileSegmentLimit
						GenerationBehaviorForNoOutputLocal 	= FileCreationSetupOTORel.GenerationBehaviorForNoOutput
						SortSourceFieldOneDataTypeLocal		= FileCreationSetupOTORel.SortFieldArray.SortField[1].FieldDataType
						SortSourceFieldTwoDataTypeLocal		= FileCreationSetupOTORel.SortFieldArray.SortField[2].FieldDataType
						SortSourceFieldThreeDataTypeLocal	= FileCreationSetupOTORel.SortFieldArray.SortField[3].FieldDataType
						SortSourceFieldFourDataTypeLocal	= FileCreationSetupOTORel.SortFieldArray.SortField[4].FieldDataType
						SortSourceFieldFiveDataTypeLocal	= FileCreationSetupOTORel.SortFieldArray.SortField[5].FieldDataType
						SortSourceFieldSixDataTypeLocal		= FileCreationSetupOTORel.SortFieldArray.SortField[6].FieldDataType
						SortSourceFieldSevenDataTypeLocal	= FileCreationSetupOTORel.SortFieldArray.SortField[7].FieldDataType
						SortSourceFieldEightDataTypeLocal	= FileCreationSetupOTORel.SortFieldArray.SortField[8].FieldDataType
						SortSourceFieldNineDataTypeLocal	= FileCreationSetupOTORel.SortFieldArray.SortField[9].FieldDataType
						SortSourceFieldTenDataTypeLocal		= FileCreationSetupOTORel.SortFieldArray.SortField[10].FieldDataType
						SortSourceFieldElevenDataTypeLocal	= FileCreationSetupOTORel.SortFieldArray.SortField[11].FieldDataType
						SortSourceFieldTwelveDataTypeLocal	= FileCreationSetupOTORel.SortFieldArray.SortField[12].FieldDataType
						EndOfLineCharacterLocal             = FileCreationSetupOTORel.EndOfLineCharacter
						if (FileCreationSetupOTORel.LastTimeStamp entered)
							LastTimeStampValue	= FileCreationSetupOTORel.LastTimeStamp
						else
							LastTimeStampValue	= ""	
						ThreadingMethodLocal		= FileCreationSetupOTORel.ThreadingMethod									
						
						invoke FormatVariable FileCreationSetup
							invoked.PrmValidFormat			= FileCreationSetup.LineFeedNative
							invoked.PrmReplaceInvalidsWith	= "~***~"
							invoked.PrmReplaceValue			= FileCreationSetupOTORel.FileHeaderText
						FileHeaderTextLocal = FileCreationSetup.ReplacedValue

						invoke FormatVariable FileCreationSetup
							invoked.PrmValidFormat			= FileCreationSetup.LineFeedNative
							invoked.PrmReplaceInvalidsWith	= "~***~"
							invoked.PrmReplaceValue			= OutputTextForBlankDocument
						OutputTextForBlankDocumentLocal = FileCreationSetup.ReplacedValue

						TempText = "1" + Separator + FinanceEnterpriseGroup + Separator + FileCreationSetupOTORel.FileCreationSetup + Separator 
						TempText += FileCreationSetupOTORel.Description + Separator + FileCreationSetupOTORel.FieldSeparator + Separator + FileCreationSetupOTORel.IncludeSeparatorAtBeginningOfRow + Separator + FileCreationSetupOTORel.FieldDelimiter + Separator + ExportFileLocal + Separator + FileCreationSetupOTORel.FlowToProcessFile + Separator + FileCreationSetupOTORel.Active + Separator
						TempText += FileCreationSetupOTORel.FileName + Separator + FileCreationSetupOTORel.AppendTimestampToFileName + Separator + FileCreationSetupOTORel.FileNameTimeStampFormat + Separator + LastTimeStampValue + Separator + FileCreationSetupOTORel.AllRecords + Separator
						TempText += FileHeaderTextLocal + Separator 
						TempText += FileCreationSetupOTORel.DCKey + Separator + FileCreationSetupOTORel.AutomaticallySendFileToION + Separator + FileCreationSetupOTORel.IONDocumentName + Separator + IONInstanceCountLocal + Separator + FileCreationSetupOTORel.IONSource + Separator + FileCreationSetupOTORel.IONDocumentID + Separator
						TempText += FileTypeLocal + Separator + FileSegmentLimitLocal + Separator + FileCreationSetupOTORel.NumberOfRecordsBeforeNewFile + Separator + FileCreationSetupOTORel.NumberOfMegabytesBeforeNewFile + Separator
						TempText += FileCreationSetupOTORel.TurnOffRecordAuditing + Separator + GenerationBehaviorForNoOutputLocal + Separator + ThreadingMethodLocal + Separator
						TempText += FileCreationSetupOTORel.ExcludeSeparatorWhenEmpty + Separator + FileCreationSetupOTORel.RecordEndOfLineCharacter + NewLine
						TempText += FileCreationSetupOTORel.SortSourceFieldOne + Separator + SortSourceFieldOneDataTypeLocal + Separator + FileCreationSetupOTORel.SortFieldArray.SortField[1].Length + Separator + FileCreationSetupOTORel.SortSourceFieldTwo + Separator + SortSourceFieldTwoDataTypeLocal + Separator + FileCreationSetupOTORel.SortFieldArray.SortField[2].Length + Separator
						TempText += FileCreationSetupOTORel.SortSourceFieldThree + Separator + SortSourceFieldThreeDataTypeLocal + Separator + FileCreationSetupOTORel.SortFieldArray.SortField[3].Length + Separator + FileCreationSetupOTORel.SortSourceFieldFour + Separator + SortSourceFieldFourDataTypeLocal + Separator + FileCreationSetupOTORel.SortFieldArray.SortField[4].Length + Separator
						TempText += FileCreationSetupOTORel.SortSourceFieldFive + Separator + SortSourceFieldFiveDataTypeLocal + Separator + FileCreationSetupOTORel.SortFieldArray.SortField[5].Length + Separator + FileCreationSetupOTORel.SortSourceFieldSix + Separator + SortSourceFieldSixDataTypeLocal + Separator + FileCreationSetupOTORel.SortFieldArray.SortField[6].Length + Separator
						TempText += FileCreationSetupOTORel.SortSourceFieldSeven + Separator + SortSourceFieldSevenDataTypeLocal + Separator + FileCreationSetupOTORel.SortFieldArray.SortField[7].Length + Separator + FileCreationSetupOTORel.SortSourceFieldEight + Separator + SortSourceFieldEightDataTypeLocal + Separator + FileCreationSetupOTORel.SortFieldArray.SortField[8].Length + Separator
						TempText += FileCreationSetupOTORel.SortSourceFieldNine + Separator + SortSourceFieldNineDataTypeLocal + Separator + FileCreationSetupOTORel.SortFieldArray.SortField[9].Length + Separator + FileCreationSetupOTORel.SortSourceFieldTen + Separator + SortSourceFieldTenDataTypeLocal + Separator + FileCreationSetupOTORel.SortFieldArray.SortField[10].Length + Separator
						TempText += FileCreationSetupOTORel.SortSourceFieldTen + Separator + SortSourceFieldElevenDataTypeLocal + Separator + FileCreationSetupOTORel.SortFieldArray.SortField[11].Length + Separator + FileCreationSetupOTORel.SortSourceFieldTwelve + Separator + SortSourceFieldTwelveDataTypeLocal + Separator + FileCreationSetupOTORel.SortFieldArray.SortField[12].Length + Separator
						TempText += FileCreationSetupOTORel.OverrideNumberOfThreads + Separator + FileCreationSetupOTORel.TabSeparator + Separator + EndOfLineCharacterLocal + Separator + OutputTextForBlankDocumentLocal + NewLine

						include GetSetupDetails
							replace RowRelation with FileCreationRowDetailLocalRel
							replace IncludeLinked with false
							replace ColumnRelation with FileCreationColumnDetailLocalRel
							replace DataMappingRelation with FileCreationDataMappingLocalRel
	
					LinkedSetupText = TempText
				
				if (I1 > 0)					
					SetupExportFile.File	= LinkedSetupHeaderText + NewLine + LinkedSetupText + MainSetupText
				else
					SetupExportFile.File	= MainSetupText

				SetupExportTimeStamp		= system current timestamp
				SetupExportFile.Title		= Description + "_SetupExport.txt"
				SetupExportFile.MimeType	= "text/plain"

		ImportSetup is an Import Action
						
			Parameters
				FinanceEnterpriseGroup
				SetupExport				is BinaryDocument
				CreateNewSetup			is Boolean

				ImportOption			is Numeric 1
					States
						Default				value is 0
						CreateNewSetup		value is 1
						UpdateExisting		value is 2

				UpdateExistingSetup		is a FileCreationSetup
				Separator				is Alpha 2
					States
						Pipe			value is "|"
						Caret			value is "^"
						DoublePipe		value is "||"
						DoubleCaret		value is "^^"
				EndOfLineCharacter		is Numeric 1
					States
						ServerDefault	value is 0
						CarriageReturn	value is 1
						LineFeed		value is 2
						Both			value is 3
							default label is "CarriageReturnAndLineFeed"
						Automatic		value is 4
				ExcludeClientFields 	is Boolean

			Parameter Rules
				FinanceEnterpriseGroup
					required

				SetupExport
					required
					
				CreateNewSetup
					constraint (!CreateNewSetup
					or UpdateExistingSetup not entered)
						"NewSetupCannotBeSelectedIfUpdateExistingSetupIsSelected"

					if (CreateNewSetup
					and ImportOption.Default)
						ImportOption = ImportOption.CreateNewSetup

					if (!ImportOption.CreateNewSetup	
					and	UpdateExistingSetup not entered)
						required "EitherCreateNewSetupOrUpdateExistingSetupMustBeSelected"

				ImportOption
					if (ImportOption.CreateNewSetup)
						constraint (UpdateExistingSetup not entered)
							"NewSetupCannotBeSelectedIfUpdateExistingSetupIsSelected"
						
					if (UpdateExistingSetup not entered)
						constraint (ImportOption.CreateNewSetup)
							"EitherCreateNewSetupOrUpdateExistingSetupMustBeSelected"

					if (ImportOption.UpdateExisting)
						IgnoreDeltas = true
						

				UpdateExistingSetup
					constraint (not ImportOption.CreateNewSetup)
						"NewSetupCannotBeSelectedIfUpdateExistingSetupIsSelected"

					if (UpdateExistingSetup entered)
						ImportOption = ImportOption.UpdateExisting
						IgnoreDeltas = true
						
				Separator
					initial value is Separator.DoubleCaret
					required
				

			Local Fields
				SplitSeparator						is Alpha 4
				NewLine								is Alpha 2
				TempText							is Text
				Row									is Text
				RowType								is Numeric 1
					States
						Linked			value is 0
						Setup			value is 1
						Row				value is 2
						Column			value is 3
						DataMapping		value is 4
				LinkedSetupsExist					is Boolean					
				LinkedBoolean						is Boolean					
				FileCreationSetupOriginal			is like FileCreationSetup
				FileCreationRowDetailOriginal		is like FileCreationRowDetail
				IgnoreDeltas						is Boolean
				TargetsDeliveredContent				is Boolean

				Description							is Alpha 60
		    	FieldSeparator						is Alpha 3
		    	IncludeSeparatorAtBeginningOfRow	is Boolean
		    	FieldDelimiter						is Alpha 3
				ExportFile
				FlowToProcessFile					is like PfiServiceDefinition
				Active								is Boolean
				FileName							is Alpha 150
				AppendTimestampToFileName			is Boolean
				FileNameTimeStampFormat				is Alpha 40
				LastTimeStamp						is TimeStamp
				AllRecords							is Boolean
				FileHeaderText						is Text					
				AutomaticallySendFileToION			is Boolean
				IONDocumentName						is Alpha 200
				IONInstanceCount					is Numeric 1
				IONSource							is Alpha 150
				IONDocumentID						is Alpha 150
				FileType							is Numeric 1
				FileSegmentLimit					is Numeric 1
				NumberOfRecordsBeforeNewFile		is Numeric 7
				NumberOfMegabytesBeforeNewFile	    is Numeric 4
				TurnOffRecordAuditing				is Boolean
				GenerationBehaviorForNoOutput		is Numeric 1
				ThreadingMethod						is Numeric 1
				ExcludeSeparatorWhenEmpty			is Boolean
				RecordEndOfLineCharacter			is Alpha 1
				SortFieldArray		
				SortSourceFieldOne					is Alpha 100 
				SortSourceFieldTwo					is Alpha 100
				SortSourceFieldThree				is Alpha 100
				SortSourceFieldFour					is Alpha 100
				SortSourceFieldFive					is Alpha 100
				SortSourceFieldSix					is Alpha 100
				SortSourceFieldSeven				is Alpha 100
				SortSourceFieldEight				is Alpha 100
				SortSourceFieldNine					is Alpha 100
				SortSourceFieldTen					is Alpha 100
				SortSourceFieldEleven				is Alpha 100
				SortSourceFieldTwelve				is Alpha 100
				OverrideNumberOfThreads				is Numeric 3
				TabSeparator						is Boolean
				EndOfLineCharacter					is Numeric 1 
				UseAuditInformation					is Boolean
				FileMimeType						is Numeric 1



		    	RowOrder								is Numeric 4
		    	Header									is Boolean
		    	Trailer									is Boolean
		    	OneToMany								is Boolean
		    	OneToManyBusinessClassPayablesInvoice
		    	OneToManyBusinessClassGeneralLedgerChartAccount
				OneToManyBusinessClassAsset
				OneToManyBusinessClassBinGroup
				OneToManyBusinessClassContract
				OneToManyBusinessClassPurchaseOrder
				OneToManyBusinessClassVendor
				OneToManySequenceNumberStartingValue	is Numeric 1
				DoNotResetOneToManySequenceNumber		is Boolean
				ExtendsOneToManyRow						is like FileCreationRowDetail
		    	IncludeInRecordCount1					is Boolean
		    	IncludeInRecordCount2					is Boolean
		    	IncludeInRecordCount3					is Boolean
		    	IncludeInRecordCount4					is Boolean
		    	IncludeInRecordCount5					is Boolean
		    	IncludeInRecordCount6					is Boolean
				RecordHasBeenChanged					is Boolean

				CompareFile1							is Numeric 1
				CompareOperator1						is Numeric 2
				DataType1								is Numeric 1
				AlphaValue1								is Alpha 200
				NumericValue1							is Numeric 17
				DecimalValue1							is Decimal 24.8
				DateValue1								is Date
				TimeValue1								is Time
				TextValue1								is Text
				BooleanValue1							is Boolean
				TimeStampValue1							is TimeStamp

				CompareField1							is Alpha 100
				ComparedToField1						is Alpha 100
				CompareType1							is Numeric 1

				CompareFile2							is Numeric 1
				CompareOperator2						is Numeric 2
				DataType2								is Numeric 1
				AlphaValue2								is Alpha 200
				NumericValue2							is Numeric 17
				DecimalValue2							is Decimal 24.8
				DateValue2								is Date
				TimeValue2								is Time
				TextValue2								is Text
				BooleanValue2							is Boolean
				TimeStampValue2							is TimeStamp

				CompareField2							is Alpha 100
				ComparedToField2						is Alpha 100
				CompareType2							is Numeric 1
				RowConditionOperator 					is Numeric 1

				OTMCompareFile1							is Numeric 1
				OTMCompareOperator1						is Numeric 2
				OTMDataType1							is Numeric 1
				OTMAlphaValue1							is Alpha 200
				OTMNumericValue1						is Numeric 17
				OTMDecimalValue1						is Decimal 24.8
				OTMDateValue1							is Date
				OTMTimeValue1							is Time
				OTMTextValue1							is Text
				OTMBooleanValue1						is Boolean
				OTMTimeStampValue1						is TimeStamp

				OneToManyCompareField1					is Alpha 100
				OneToManyComparedToField1				is Alpha 100
				OneToManyCompareType1					is Numeric 1

				OTMCompareFile2							is Numeric 1
				OTMCompareOperator2						is Numeric 2
				OTMDataType2							is Numeric 1
				OTMAlphaValue2							is Alpha 200
				OTMNumericValue2						is Numeric 17
				OTMDecimalValue2						is Decimal 24.8
				OTMDateValue2							is Date
				OTMTimeValue2							is Time
				OTMTextValue2							is Text
				OTMBooleanValue2						is Boolean
				OTMTimeStampValue2						is TimeStamp

	 			OneToManyCompareField2					is Alpha 100
				OneToManyComparedToField2				is Alpha 100
				OneToManyCompareType2					is Numeric 1
				OneToManyRowConditionOperator 		is Numeric 1

				ExtendedCompareFile1					is Numeric 1
				ExtendedCompareOperator1				is Numeric 2
				ExtendedDataType1						is Numeric 1
				ExtendedAlphaValue1						is Alpha 200
				ExtendedNumericValue1					is Numeric 17
				ExtendedDecimalValue1					is Decimal 24.8
				ExtendedDateValue1						is Date
				ExtendedTimeValue1						is Time
				ExtendedTextValue1						is Text
				ExtendedBooleanValue1					is Boolean
				ExtendedTimeStampValue1					is TimeStamp

				ExtendedCompareField1					is Alpha 100
				ExtendedComparedToField1				is Alpha 100
				ExtendedCompareType1					is Numeric 1

				ExtendedCompareFile2					is Numeric 1
				ExtendedCompareOperator2				is Numeric 2
				ExtendedDataType2						is Numeric 1
				ExtendedAlphaValue2						is Alpha 200
				ExtendedNumericValue2					is Numeric 17
				ExtendedDecimalValue2					is Decimal 24.8
				ExtendedDateValue2						is Date
				ExtendedTimeValue2						is Time
				ExtendedTextValue2						is Text
				ExtendedBooleanValue2					is Boolean
				ExtendedTimeStampValue2					is TimeStamp

				ExtendedCompareField2					is Alpha 100
				ExtendedComparedToField2				is Alpha 100
				ExtendedCompareType2					is Numeric 1
				ExtendedRowConditionOperator 			is Numeric 1
				LinkedSetup								is like FileCreationSetup
				LinkedRow								is like FileCreationRowDetail
				Disable									is Boolean
				Subtotal								is Boolean
				SubtotalPlacement						is Numeric 1
    			SubtotalField							is Alpha 100
    			SubtotalLevel							is Numeric 2


				FieldName								is Alpha 40			
    			ColumnOrder								is Numeric 4
				DataType								is Numeric 1
				Length									is Numeric 4
				InputOption								is Numeric 1
				SourceRelation							is Alpha 100
				SourceFields							is Alpha 100
				NumberOfSourceFields					is Numeric 1
				Comments								is Text
				ShowAlphaDefaultField					is Boolean
				DefaultAlpha							is Alpha 150
				DefaultNumeric							is Numeric 17
				DefaultDecimal							is Decimal 24.8
				DefaultDate								is Date
				DefaultTime								is Time
				DefaultBoolean							is Boolean
				DefaultText								is Text
				DefaultTimeStamp						is TimeStamp
				UseCurrentSystemDate					is Boolean
				UseCurrentSystemTime					is Boolean
				UseCurrentSystemTimeStamp				is Boolean
				ConvertToUpperCase						is Boolean
				TruncateToLength						is Boolean
				SubstringStart							is Numeric 4
				SubstringEnd							is Numeric 4
				FileNameBoolean							is Boolean
				OneToManySequenceNumber					is Boolean
				RecordCount1							is Boolean
				RecordCount2							is Boolean
				RecordCount3							is Boolean
				RecordCount4							is Boolean
				RecordCount5							is Boolean
				RecordCount6							is Boolean
				JavaFormat								is Alpha 40
				ReplacementRegularExpression			is Alpha 50
				ReplacementReplaceWith					is Alpha 50
				DataMappingOption						is Numeric 1				
				FixedLengthFieldRange
				FixedLengthFieldRangeArray
				ApplyAdjustment							is Boolean
				DateAdjustmentOperator					is Numeric 1
				DateAdjustment							is a UnitsAndUnitType


				MappingOrder				is Numeric 3
				CompareType					is Numeric 1

				AlphaFromValue				is Alpha 150
				DateFromValue				is Date
				DecimalFromValue			is Decimal 24.8
				NumericFromValue			is Numeric 20
				TimeFromValue				is Time
				BooleanFromValue			is Boolean

				AlphaToValue				is Alpha 150
				DateToValue					is Date
				DecimalToValue				is Decimal 24.8
				NumericToValue				is Numeric 20
				TimeToValue					is Time
				
				DefaultMapping				is Boolean
				AutomaticLookFor			is Alpha 2
				TotalThisColumn				is Boolean
				TotalForRow					is like FileCreationRowDetail
				TotalForColumn				is like FileCreationColumnDetail
				LocalImportCountry			is like Country 


			Action Rules 
				TempText = SetupExport

				AutomaticLookFor = TempText
				if (AutomaticLookFor[1:1] = "0")
					AutomaticLookFor = "1"
				else
					AutomaticLookFor = "2"

				if (Separator.Caret)
					SplitSeparator = "\^"
					AutomaticLookFor += "^"
				else
				if (Separator.DoubleCaret)
					SplitSeparator = "\^\^"
					AutomaticLookFor += "^"
				else
				if (Separator.Pipe)
					SplitSeparator = "\|"
					AutomaticLookFor += "|"
				else
				if (Separator.DoublePipe)
					SplitSeparator = "\|\|"
					AutomaticLookFor += "|"

				if (EndOfLineCharacter.Automatic)
					I1 = 0

					for each TempText split on "\<FileCreationSetup.CarriageReturnNative>\<FileCreationSetup.LineFeedNative>"
						NewLine = each
						if (I1 = 1)
							if (NewLine = AutomaticLookFor)
								EndOfLineCharacter = EndOfLineCharacter.Both
							end for each
						I1 += 1
				if (EndOfLineCharacter.Automatic)
					I1 = 0
					for each TempText split on "<FileCreationSetup.NewLine2>"
						NewLine = each
						if (I1 = 1)
							if (NewLine = AutomaticLookFor)
								EndOfLineCharacter = EndOfLineCharacter.ServerDefault
							end for each
						I1 += 1
				if (EndOfLineCharacter.Automatic)
					I1 = 0
					for each TempText split on "<FileCreationSetup.CarriageReturnNative>"
						NewLine = each
						if (I1 = 1)
							if (NewLine = AutomaticLookFor)
								EndOfLineCharacter = EndOfLineCharacter.CarriageReturn
							end for each
						I1 += 1
				if (EndOfLineCharacter.Automatic)
					I1 = 0
					for each TempText split on "<FileCreationSetup.LineFeedNative>"
						NewLine = each
						if (I1 = 1)
							if (NewLine = AutomaticLookFor)
								EndOfLineCharacter = EndOfLineCharacter.LineFeed
							end for each
						I1 += 1

				if (EndOfLineCharacter.Both)
					NewLine = FileCreationSetup.CarriageReturnNative + FileCreationSetup.LineFeedNative
				else
				if (EndOfLineCharacter.CarriageReturn)
					NewLine = FileCreationSetup.CarriageReturnNative
				else
				if (EndOfLineCharacter.LineFeed)
					NewLine = FileCreationSetup.LineFeedNative
				else	
					NewLine = FileCreationSetup.NewLine2

				I2 = 1
				for each(Row) TempText split on "<NewLine>"
					I1 = 0
					Row = each(Row)
					for each(Column) Row split on "<SplitSeparator>"
						I1 += 1
						if (I1 = 1)
							RowType = each(Column)
						else

							if (RowType.Linked)
								LinkedSetupsExist = true

								if (I1 = 2)
									FileCreationSetupArray.SetupGroup[I2].Setup = each(Column)
								if (I1 = 3)
									FileCreationSetupArray.SetupGroup[I2].Row = each(Column)

								if (I1 = 4)
									I2 += 1
									FileCreationSetupArray.SetupGroup[I2].Setup = each(Column)
								if (I1 = 5)
									FileCreationSetupArray.SetupGroup[I2].Row = each(Column)

								if (I1 = 6)
									I2 += 1
									FileCreationSetupArray.SetupGroup[I2].Setup = each(Column)
								if (I1 = 7)
									FileCreationSetupArray.SetupGroup[I2].Row = each(Column)

								if (I1 = 8)
									I2 += 1
									FileCreationSetupArray.SetupGroup[I2].Setup = each(Column)
								if (I1 = 9)
									FileCreationSetupArray.SetupGroup[I2].Row = each(Column)

								if (I1 = 10)
									I2 += 1
									FileCreationSetupArray.SetupGroup[I2].Setup = each(Column)
								if (I1 = 11)
									FileCreationSetupArray.SetupGroup[I2].Row = each(Column)

								if (I1 = 12)
									I2 += 1
									FileCreationSetupArray.SetupGroup[I2].Setup = each(Column)
								if (I1 = 13)
									FileCreationSetupArray.SetupGroup[I2].Row = each(Column)

								if (I1 = 14)
									I2 += 1
									FileCreationSetupArray.SetupGroup[I2].Setup = each(Column)
								if (I1 = 15)
									FileCreationSetupArray.SetupGroup[I2].Row = each(Column)

								if (I1 = 16)
									I2 += 1
									FileCreationSetupArray.SetupGroup[I2].Setup = each(Column)
								if (I1 = 17)
									FileCreationSetupArray.SetupGroup[I2].Row = each(Column)

								if (I1 = 18)
									I2 += 1
									FileCreationSetupArray.SetupGroup[I2].Setup = each(Column)
								if (I1 = 19)
									FileCreationSetupArray.SetupGroup[I2].Row = each(Column)

								if (I1 = 20)
									I2 += 1
									FileCreationSetupArray.SetupGroup[I2].Setup = each(Column)
								if (I1 = 21)
									FileCreationSetupArray.SetupGroup[I2].Row = each(Column)

								if (I1 = 22)
									I2 += 1
									FileCreationSetupArray.SetupGroup[I2].Setup = each(Column)
								if (I1 = 23)
									FileCreationSetupArray.SetupGroup[I2].Row = each(Column)

								if (I1 = 24)
									I2 += 1
									FileCreationSetupArray.SetupGroup[I2].Setup = each(Column)
								if (I1 = 25)
									FileCreationSetupArray.SetupGroup[I2].Row = each(Column)

								if (I1 = 26)
									I2 += 1
									FileCreationSetupArray.SetupGroup[I2].Setup = each(Column)
								if (I1 = 27)
									FileCreationSetupArray.SetupGroup[I2].Row = each(Column)

								if (I1 = 28)
									I2 += 1
									FileCreationSetupArray.SetupGroup[I2].Setup = each(Column)
								if (I1 = 29)
									FileCreationSetupArray.SetupGroup[I2].Row = each(Column)

								if (I1 = 30)
									I2 += 1
									FileCreationSetupArray.SetupGroup[I2].Setup = each(Column)
								if (I1 = 31)
									FileCreationSetupArray.SetupGroup[I2].Row = each(Column)

								if (I1 = 32)
									I2 += 1
									FileCreationSetupArray.SetupGroup[I2].Setup = each(Column)
								if (I1 = 33)
									FileCreationSetupArray.SetupGroup[I2].Row = each(Column)

								if (I1 = 34)
									I2 += 1
									FileCreationSetupArray.SetupGroup[I2].Setup = each(Column)
								if (I1 = 35)
									FileCreationSetupArray.SetupGroup[I2].Row = each(Column)

								if (I1 = 36)
									I2 += 1
									FileCreationSetupArray.SetupGroup[I2].Setup = each(Column)
								if (I1 = 37)
									FileCreationSetupArray.SetupGroup[I2].Row = each(Column)

								if (I1 = 38)
									I2 += 1
									FileCreationSetupArray.SetupGroup[I2].Setup = each(Column)
								if (I1 = 39)
									FileCreationSetupArray.SetupGroup[I2].Row = each(Column)

								if (I1 = 40)
									I2 += 1
									FileCreationSetupArray.SetupGroup[I2].Setup = each(Column)
								if (I1 = 41)
									FileCreationSetupArray.SetupGroup[I2].Row = each(Column)
									

							if (RowType.Setup)
								if (I1 = 2)
									LocalFinanceEnterpriseGroup = FinanceEnterpriseGroup
								if (I1 = 3)
									FileCreationSetupOriginal = each(Column)
									if (UpdateExistingSetup entered)
										LocalFileCreationSetup = UpdateExistingSetup
									else
										LocalFileCreationSetup = each(Column)	
								if (I1 = 4)
									Description = each(Column)	
								if (I1 = 5)
									FieldSeparator = each(Column)	
								if (I1 = 6)
									IncludeSeparatorAtBeginningOfRow = each(Column)	
								if (I1 = 7)
									FieldDelimiter = each(Column)	
								if (I1 = 8)
									ExportFile = each(Column)	
								if (!ExcludeClientFields)
									if (I1 = 9)
										FlowToProcessFile = each(Column)
								if (I1 = 10)
									Active = each(Column)										
								if (I1 = 11)
									FileName = each(Column)	
								if (I1 = 12)
									AppendTimestampToFileName = each(Column)	
								if (I1 = 13)
									FileNameTimeStampFormat = each(Column)	
								if (I1 = 14)
									LastTimeStamp = each(Column)	
								if (I1 = 15)
									AllRecords = each(Column)	
								if (I1 = 16)
									FileHeaderText = each(Column)
									if (FileCreationSetupRel exists)
										invoke FormatVariable first FileCreationSetupRel
											invoked.PrmValidFormat			= "\~\*\*\*\~"
											invoked.PrmReplaceInvalidsWith	= FileCreationSetup.LineFeedNative
											invoked.PrmReplaceValue			= FileHeaderText
										FileHeaderText = first FileCreationSetupRel.ReplacedValue	
								if (I1 = 17)
									DCKey = each(Column)
									LocalDCKey = DCKey
								if (!ExcludeClientFields)
									if (I1 = 18)
										AutomaticallySendFileToION = each(Column)	
									if (I1 = 19)
										IONDocumentName = each(Column)	
									if (I1 = 20)
										IONInstanceCount = each(Column)	
									if (I1 = 21)
										IONSource = each(Column)	
									if (I1 = 22)
										IONDocumentID = each(Column)	
								if (I1 = 23)
									FileType = each(Column)	
								if (I1 = 24)
									FileSegmentLimit = each(Column)	
								if (I1 = 25)
									NumberOfRecordsBeforeNewFile = each(Column)	
								if (I1 = 26)
									NumberOfMegabytesBeforeNewFile = each(Column)	
								if (I1 = 27)
									TurnOffRecordAuditing = each(Column)	
								if (I1 = 28)
									GenerationBehaviorForNoOutput = each(Column)	
								if (I1 = 29)
									ThreadingMethod = each(Column)	
								if (I1 = 30)
									ExcludeSeparatorWhenEmpty = each(Column)
								if (I1 = 31)
									RecordEndOfLineCharacter = each(Column)
								if (I1 = 32)
									SortSourceFieldOne = each(Column)
								if (I1 = 33)
									SortFieldArray.SortField[1].FieldDataType = each(Column)
								if (I1 = 34)
									SortFieldArray.SortField[1].Length = each(Column)
								if (I1 = 35)
									SortSourceFieldTwo = each(Column)
								if (I1 = 36)
									SortFieldArray.SortField[2].FieldDataType = each(Column)
								if (I1 = 37)
									SortFieldArray.SortField[2].Length = each(Column)
								if (I1 = 38)
									SortSourceFieldThree = each(Column)
								if (I1 = 39)
									SortFieldArray.SortField[3].FieldDataType = each(Column)
								if (I1 = 40)
									SortFieldArray.SortField[3].Length = each(Column)
								if (I1 = 41)
									SortSourceFieldFour = each(Column)
								if (I1 = 42)
									SortFieldArray.SortField[4].FieldDataType = each(Column)
								if (I1 = 43)
									SortFieldArray.SortField[4].Length = each(Column)
								if (I1 = 44)
									SortSourceFieldFive = each(Column)
								if (I1 = 45)
									SortFieldArray.SortField[5].FieldDataType = each(Column)
								if (I1 = 46)
									SortFieldArray.SortField[5].Length = each(Column)
								if (I1 = 47)
									SortSourceFieldSix = each(Column)
								if (I1 = 48)
									SortFieldArray.SortField[6].FieldDataType = each(Column)
								if (I1 = 49)
									SortFieldArray.SortField[6].Length = each(Column)
								if (I1 = 50)
									SortSourceFieldSeven = each(Column)
								if (I1 = 51)
									SortFieldArray.SortField[7].FieldDataType = each(Column)
								if (I1 = 52)
									SortFieldArray.SortField[7].Length = each(Column)
								if (I1 = 53)
									SortSourceFieldEight = each(Column)
								if (I1 = 54)
									SortFieldArray.SortField[8].FieldDataType = each(Column)
								if (I1 = 55)
									SortFieldArray.SortField[8].Length = each(Column)
								if (I1 = 56)
									SortSourceFieldNine = each(Column)
								if (I1 = 57)
									SortFieldArray.SortField[9].FieldDataType = each(Column)
								if (I1 = 58)
									SortFieldArray.SortField[9].Length = each(Column)
								if (I1 = 59)
									SortSourceFieldTen = each(Column)
								if (I1 = 60)
									SortFieldArray.SortField[10].FieldDataType = each(Column)
								if (I1 = 61)
									SortFieldArray.SortField[10].Length = each(Column)
								if (I1 = 62)
									SortSourceFieldEleven = each(Column)
								if (I1 = 63)
									SortFieldArray.SortField[11].FieldDataType = each(Column)
								if (I1 = 64)
									SortFieldArray.SortField[11].Length = each(Column)
								if (I1 = 65)
									SortSourceFieldTwelve = each(Column)
								if (I1 = 66)
									SortFieldArray.SortField[12].FieldDataType = each(Column)
								if (I1 = 67)
									SortFieldArray.SortField[12].Length = each(Column)
								if (I1 = 68)
									OverrideNumberOfThreads = each(Column)
								if (I1 = 69)
									TabSeparator = each(Column)
								if (I1 = 70)
									EndOfLineCharacter = each(Column)
								if (I1 = 71)
									OutputTextForBlankDocument = each(Column)
									if (FileCreationSetupRel exists)
										invoke FormatVariable first FileCreationSetupRel
											invoked.PrmValidFormat			= "\~\*\*\*\~"
											invoked.PrmReplaceInvalidsWith	= FileCreationSetup.LineFeedNative
											invoked.PrmReplaceValue			= OutputTextForBlankDocument
										OutputTextForBlankDocument = first FileCreationSetupRel.ReplacedValue
								if (I1 = 72)
									UseAuditInformation = each(Column)
								if (I1 = 73)
									FileMimeType = each(Column)

							if (RowType.Row)
								if (I1 = 2)
									LocalFinanceEnterpriseGroup = FinanceEnterpriseGroup
								if (I1 = 3)
									FileCreationSetupOriginal = each(Column)
									if (UpdateExistingSetup entered)
										LocalFileCreationSetup = UpdateExistingSetup
									else
										LocalFileCreationSetup = SetupView.FileCreationSetup
								if (I1 = 4)
									FileCreationRowDetailOriginal = each(Column)
									LocalRow = each(Column)
								if (I1 = 5)
									Description = each(Column)	
								if (I1 = 6)
									RowOrder = each(Column)	
								if (I1 = 7)
									Header = each(Column)	
								if (I1 = 8)
									Trailer = each(Column)	
								if (I1 = 9)
									OneToMany = each(Column)	
								if (I1 = 10)
									OneToManyBusinessClassPayablesInvoice = each(Column)	
								if (I1 = 11)
									OneToManySequenceNumberStartingValue = each(Column)	
								if (I1 = 12)
									DoNotResetOneToManySequenceNumber = each(Column)	
								if (I1 = 13)
									ExtendsOneToManyRow = each(Column)	
								if (I1 = 14)
									IncludeInRecordCount1 = each(Column)	
								if (I1 = 15)
									IncludeInRecordCount2 = each(Column)	
								if (I1 = 16)
									IncludeInRecordCount3 = each(Column)	
								if (I1 = 17)
									RecordHasBeenChanged = each(Column)	
								if (I1 = 18)
									CompareFile1 = each(Column)	
								if (I1 = 19)
									CompareOperator1 = each(Column)	
								if (I1 = 20)
									DataType1 = each(Column)	
								if (I1 = 21)
									AlphaValue1 = each(Column)	
								if (I1 = 22)
									NumericValue1 = each(Column)	
								if (I1 = 23)
									DecimalValue1 = each(Column)	
								if (I1 = 24)
									DateValue1 = each(Column)	
								if (I1 = 25)
									TimeValue1 = each(Column)	
								if (I1 = 26)
									TextValue1 = each(Column)	
								if (I1 = 27)
									BooleanValue1 = each(Column)	
								if (I1 = 28)
									TimeStampValue1 = each(Column)	
								if (I1 = 29)
									CompareField1 = each(Column)	
								if (I1 = 30)
									CompareFile2 = each(Column)	
								if (I1 = 31)
									CompareOperator2 = each(Column)	
								if (I1 = 32)
									DataType2 = each(Column)	
								if (I1 = 33)
									AlphaValue2 = each(Column)	
								if (I1 = 34)
									NumericValue2 = each(Column)	
								if (I1 = 35)
									DecimalValue2 = each(Column)	
								if (I1 = 36)
									DateValue2 = each(Column)	
								if (I1 = 37)
									TimeValue2 = each(Column)	
								if (I1 = 38)
									TextValue2 = each(Column)	
								if (I1 = 39)
									BooleanValue2 = each(Column)	
								if (I1 = 40)
									TimeStampValue2 = each(Column)	
								if (I1 = 41)
									CompareField2 = each(Column)	
								if (I1 = 42)
									RowConditionOperator = each(Column)	
								if (I1 = 43)
									OTMCompareFile1 = each(Column)	
								if (I1 = 44)
									OTMCompareOperator1 = each(Column)	
								if (I1 = 45)
									OTMDataType1 = each(Column)	
								if (I1 = 46)
									OTMAlphaValue1 = each(Column)	
								if (I1 = 47)
									OTMNumericValue1 = each(Column)	
								if (I1 = 48)
									OTMDecimalValue1 = each(Column)	
								if (I1 = 49)
									OTMDateValue1 = each(Column)	
								if (I1 = 50)
									OTMTimeValue1 = each(Column)	
								if (I1 = 51)
									OTMTextValue1 = each(Column)	
								if (I1 = 52)
									OTMBooleanValue1 = each(Column)	
								if (I1 = 53)
									OTMTimeStampValue1 = each(Column)	
								if (I1 = 54)
									OneToManyCompareField1 = each(Column)	
								if (I1 = 55)
									OTMCompareFile2 = each(Column)	
								if (I1 = 56)
									OTMCompareOperator2 = each(Column)	
								if (I1 = 57)
									OTMDataType2 = each(Column)	
								if (I1 = 58)
									OTMAlphaValue2 = each(Column)	
								if (I1 = 59)
									OTMNumericValue2 = each(Column)	
								if (I1 = 60)
									OTMDecimalValue2 = each(Column)	
								if (I1 = 61)
									OTMDateValue2 = each(Column)	
								if (I1 = 62)
									OTMTimeValue2 = each(Column)	
								if (I1 = 63)
									OTMTextValue2 = each(Column)	
								if (I1 = 64)
									OTMBooleanValue2 = each(Column)	
								if (I1 = 65)
									OTMTimeStampValue2 = each(Column)	
								if (I1 = 66)
									OneToManyCompareField2 = each(Column)	
								if (I1 = 67)
									OneToManyRowConditionOperator = each(Column)	
								if (I1 = 68)
									ExtendedCompareFile1 = each(Column)	
								if (I1 = 69)
									ExtendedCompareOperator1 = each(Column)	
								if (I1 = 70)
									ExtendedDataType1 = each(Column)	
								if (I1 = 71)
									ExtendedAlphaValue1 = each(Column)	
								if (I1 = 72)
									ExtendedNumericValue1 = each(Column)	
								if (I1 = 73)
									ExtendedDecimalValue1 = each(Column)	
								if (I1 = 74)
									ExtendedDateValue1 = each(Column)	
								if (I1 = 75)
									ExtendedTimeValue1 = each(Column)	
								if (I1 = 76)
									ExtendedTextValue1 = each(Column)	
								if (I1 = 77)
									ExtendedBooleanValue1 = each(Column)	
								if (I1 = 78)
									ExtendedTimeStampValue1 = each(Column)	
								if (I1 = 79)
									ExtendedCompareField1 = each(Column)	
								if (I1 = 80)
									ExtendedCompareFile2 = each(Column)	
								if (I1 = 81)
									ExtendedCompareOperator2 = each(Column)	
								if (I1 = 82)
									ExtendedDataType2 = each(Column)	
								if (I1 = 83)
									ExtendedAlphaValue2 = each(Column)	
								if (I1 = 84)
									ExtendedNumericValue2 = each(Column)	
								if (I1 = 85)
									ExtendedDecimalValue2 = each(Column)	
								if (I1 = 86)
									ExtendedDateValue2 = each(Column)	
								if (I1 = 87)
									ExtendedTimeValue2 = each(Column)	
								if (I1 = 88)
									ExtendedTextValue2 = each(Column)	
								if (I1 = 89)
									ExtendedBooleanValue2 = each(Column)	
								if (I1 = 90)
									ExtendedTimeStampValue2 = each(Column)	
								if (I1 = 91)
									ExtendedCompareField2 = each(Column)	
								if (I1 = 92)
									ExtendedRowConditionOperator = each(Column)	
								if (I1 = 93)
									LocalDCKeyRow = each(Column)	
								if (I1 = 94)
									LinkedSetup = each(Column)
								if (I1 = 95)
									LinkedRow = each(Column)
									if (ImportOption.CreateNewSetup
									and LinkedSetupsExist)
										for each (Array) FileCreationSetupArray.SetupGroup
											if (each (Array).Setup = LinkedSetup
											and each (Array).Row = LinkedRow)
												LinkedSetup = each (Array).NewSetup
												LinkedRow 	= each (Array).NewRow
												end for each
 								if (I1 = 96)
									Disable = each(Column)	
								if (I1 = 97)
									CompareType1 = each(Column)
								if (I1 = 98)
									ComparedToField1 = each(Column)
								if (I1 = 99)
									CompareType2 = each(Column)
								if (I1 = 100)
									ComparedToField2 = each(Column)
								if (I1 = 101)
									OneToManyCompareType1 = each(Column)
								if (I1 = 102)
									OneToManyComparedToField1 = each(Column)
								if (I1 = 103)
									OneToManyCompareType2 = each(Column)
								if (I1 = 104)
									OneToManyComparedToField2 = each(Column)
								if (I1 = 105)
									ExtendedCompareType1 = each(Column)
								if (I1 = 106)
									ExtendedComparedToField1 = each(Column)
								if (I1 = 107)
									ExtendedCompareType2 = each(Column)
								if (I1 = 108)
									ExtendedComparedToField2 = each(Column)
								if (I1 = 109)
									LinkedSetupDCKey = each(Column)
								if (I1 = 110)
									LinkedRowDCKey = each(Column)
								if (I1 = 111)
									Subtotal = each(Column)
								if (I1 = 112)
									SubtotalField = each(Column)
								if (I1 = 113)
									SubtotalLevel = each(Column)
								if (I1 = 114)
									SubtotalPlacement = each(Column)
								if (I1 = 115)
									IncludeInRecordCount4 = each(Column)	
								if (I1 = 116)
									IncludeInRecordCount5 = each(Column)	
								if (I1 = 117)
									IncludeInRecordCount6 = each(Column)
								if (I1 = 118)
									OneToManyBusinessClassGeneralLedgerChartAccount = each(Column)
								if (I1 = 119)
									OneToManyBusinessClassAsset	= each(Column)
								if (I1 = 120)
									OneToManyBusinessClassBinGroup	= each(Column)
								if (I1 = 121)
									OneToManyBusinessClassContract	= each(Column)
								if (I1=122)
									OneToManyBusinessClassPurchaseOrder	= each(Column)
								if (I1=123)
									OneToManyBusinessClassVendor	= each(Column)

							if (RowType.Column)
								if (I1 = 2)
									LocalFinanceEnterpriseGroup = FinanceEnterpriseGroup
								if (I1 = 3)
									FileCreationSetupOriginal = each(Column)
									if (UpdateExistingSetup entered)
										LocalFileCreationSetup = UpdateExistingSetup
									else
										LocalFileCreationSetup = SetupView.FileCreationSetup
								if (I1 = 4)
									LocalRow = each(Column)
								if (I1 = 5)
									LocalColumn = each(Column)
								if (I1 = 6)
									FieldName = each(Column)
								if (I1 = 7)
									Description = each(Column)
								if (I1 = 8)
									ColumnOrder = each(Column)
								if (I1 = 9)
									DataType = each(Column)
								if (I1 = 10)
									Length = each(Column)
								if (I1 = 11)
									InputOption = each(Column)
								if (I1 = 12)
									SourceRelation = each(Column)
								if (I1 = 13)
									SourceFields = each(Column)
								if (I1 = 14)
									NumberOfSourceFields = each(Column)
								if (I1 = 15)
									Comments = each(Column)
									if (FileCreationSetupRel exists)
										invoke FormatVariable first FileCreationSetupRel
											invoked.PrmValidFormat			= "\~\*\*\*\~"
											invoked.PrmReplaceInvalidsWith	= FileCreationSetup.LineFeedNative
											invoked.PrmReplaceValue			= Comments
										Comments = first FileCreationSetupRel.ReplacedValue
								if (I1 = 16)
									ShowAlphaDefaultField = each(Column)
								if (I1 = 17)
									DefaultAlpha = each(Column)
								if (I1 = 18)
									DefaultNumeric = each(Column)
								if (I1 = 19)
									DefaultDecimal = each(Column)
								if (I1 = 20)
									DefaultDate = each(Column)
								if (I1 = 21)
									DefaultTime = each(Column)
								if (I1 = 22)
									DefaultBoolean = each(Column)
								if (I1 = 23)
									DefaultText = each(Column)
									if (FileCreationSetupRel exists)
										invoke FormatVariable first FileCreationSetupRel
											invoked.PrmValidFormat			= "\~\*\*\*\~"
											invoked.PrmReplaceInvalidsWith	= FileCreationSetup.LineFeedNative
											invoked.PrmReplaceValue			= DefaultText
										DefaultText = first FileCreationSetupRel.ReplacedValue
								if (I1 = 24)
									DefaultTimeStamp = each(Column)
								if (I1 = 25)
									UseCurrentSystemDate = each(Column)
								if (I1 = 26)
									UseCurrentSystemTime = each(Column)
								if (I1 = 27)
									UseCurrentSystemTimeStamp = each(Column)
								if (I1 = 28)
									ConvertToUpperCase = each(Column)
								if (I1 = 29)
									TruncateToLength = each(Column)
								if (I1 = 30)
									SubstringStart = each(Column)
								if (I1 = 31)
									SubstringEnd = each(Column)
								if (I1 = 32)
									FileNameBoolean = each(Column)
								if (I1 = 33)
									OneToMany = each(Column)
								if (I1 = 34)
									OneToManySequenceNumber = each(Column)
								if (I1 = 35)
									RecordCount1 = each(Column)
								if (I1 = 36)
									RecordCount2 = each(Column)
								if (I1 = 37)
									RecordCount3 = each(Column)
								if (I1 = 38)
									JavaFormat = each(Column)
								if (I1 = 39)
									ReplacementRegularExpression = each(Column)
								if (I1 = 40)
									ReplacementReplaceWith = each(Column)
								if (I1 = 41)
									DataMappingOption = each(Column)
								if (I1 = 42)
									RecordHasBeenChanged = each(Column)
								if (I1 = 43)
									LocalDCKeyColumn = each(Column)
								if (I1 = 44)
									FixedLengthFieldRange.BeginPosition = each(Column)
								if (I1 = 45)
									FixedLengthFieldRange.EndPosition = each(Column)
								if (I1 = 46)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[1].BeginPosition = each(Column)
								if (I1 = 47)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[1].EndPosition = each(Column)
								if (I1 = 48)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[2].BeginPosition = each(Column)
								if (I1 = 49)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[2].EndPosition = each(Column)
								if (I1 = 50)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[3].BeginPosition = each(Column)
								if (I1 = 51)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[3].EndPosition = each(Column)
								if (I1 = 52)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[4].BeginPosition = each(Column)
								if (I1 = 53)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[4].EndPosition = each(Column)
								if (I1 = 54)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[5].BeginPosition = each(Column)
								if (I1 = 55)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[5].EndPosition = each(Column)
								if (I1 = 56)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[6].BeginPosition = each(Column)
								if (I1 = 57)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[6].EndPosition = each(Column)
								if (I1 = 58)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[7].BeginPosition = each(Column)
								if (I1 = 59)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[7].EndPosition = each(Column)
								if (I1 = 60)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[8].BeginPosition = each(Column)
								if (I1 = 61)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[8].EndPosition = each(Column)
								if (I1 = 62)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[9].BeginPosition = each(Column)
								if (I1 = 63)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[9].EndPosition = each(Column)
								if (I1 = 64)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[10].BeginPosition = each(Column)
								if (I1 = 65)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[10].EndPosition = each(Column)
								if (I1 = 66)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[11].BeginPosition = each(Column)
								if (I1 = 67)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[11].EndPosition = each(Column)
								if (I1 = 68)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[12].BeginPosition = each(Column)
								if (I1 = 69)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[12].EndPosition = each(Column)
								if (I1 = 70)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[13].BeginPosition = each(Column)
								if (I1 = 71)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[13].EndPosition = each(Column)
								if (I1 = 72)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[14].BeginPosition = each(Column)
								if (I1 = 73)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[14].EndPosition = each(Column)
								if (I1 = 74)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[15].BeginPosition = each(Column)
								if (I1 = 75)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[15].EndPosition = each(Column)
								if (I1 = 76)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[16].BeginPosition = each(Column)
								if (I1 = 77)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[16].EndPosition = each(Column)
								if (I1 = 78)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[17].BeginPosition = each(Column)
								if (I1 = 79)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[17].EndPosition = each(Column)
								if (I1 = 80)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[18].BeginPosition = each(Column)
								if (I1 = 81)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[18].EndPosition = each(Column)
								if (I1 = 82)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[19].BeginPosition = each(Column)
								if (I1 = 83)
									FixedLengthFieldRangeArray.FixedLengthFieldRange[19].EndPosition = each(Column)
								if (I1 = 84)
									TotalThisColumn 		= each(Column)
								if (I1 = 85)
									TotalForRow 			= each(Column)
								if (I1 = 86)
									TotalForColumn 			= each(Column)
								if (I1 = 87)
									RecordCount4 			= each(Column)
								if (I1 = 88)
									RecordCount5 			= each(Column)
								if (I1 = 89)
									RecordCount6 			= each(Column)
								if (I1 = 90)
									ApplyAdjustment 		= each(Column)
								if (I1 = 91)
									DateAdjustmentOperator	= each(Column)
								if (I1 = 92)
									DateAdjustment			= each(Column)

							if (RowType.DataMapping)
								if (I1 = 2)
									LocalFinanceEnterpriseGroup = FinanceEnterpriseGroup
								if (I1 = 3)
									FileCreationSetupOriginal = each(Column)
									if (UpdateExistingSetup entered)
										LocalFileCreationSetup = UpdateExistingSetup
									else
										LocalFileCreationSetup = SetupView.FileCreationSetup
								if (I1 = 4)
									LocalRow = each(Column)
								if (I1 = 5)
									LocalColumn = each(Column)
								if (I1 = 6)
									LocalDataMapping = each(Column)
								if (I1 = 7)
									Description = each(Column)
								if (I1 = 8)
									MappingOrder = each(Column)
								if (I1 = 9)
									CompareType = each(Column)
								if (I1 = 10)
									AlphaFromValue = each(Column)
								if (I1 = 11)
									DateFromValue = each(Column)
								if (I1 = 12)
									DecimalFromValue = each(Column)
								if (I1 = 13)
									NumericFromValue = each(Column)
								if (I1 = 14)
									TimeFromValue = each(Column)
								if (I1 = 15)
									BooleanFromValue = each(Column)
								if (I1 = 16)
									AlphaToValue = each(Column)
								if (I1 = 17)
									DateToValue = each(Column)
								if (I1 = 18)
									DecimalToValue = each(Column)
								if (I1 = 19)
									NumericToValue = each(Column)
								if (I1 = 20)
									TimeToValue = each(Column)
								if (I1 = 21)
									RecordHasBeenChanged = each(Column)
								if (I1 = 22)
									LocalDCKeyDataMapping = each(Column)
								if (I1 = 23)
									DefaultMapping = each(Column)
					LinkedBoolean = false
					if (LinkedSetupsExist
					and not ImportOption.CreateNewSetup)
						for each (Linked) FileCreationSetupArray.SetupGroup
							if (each (Linked).Setup = FileCreationSetupOriginal)
								LinkedBoolean = true
								end for each


					if (RowType.Setup
					and (ImportOption.CreateNewSetup
					or   not LinkedBoolean))
						if (LocalDCKey entered
						and UpdateExistingSetup not entered
						and FileCreationSetupDCKeyRel exists)
							LocalFileCreationSetup = first FileCreationSetupDCKeyRel.FileCreationSetup
						if (ImportOption.CreateNewSetup)
							invoke Create FileCreationSetup
								assign result to SetupView
								invoked.FinanceEnterpriseGroup				= LocalFinanceEnterpriseGroup
								invoked.Description							= Description
								invoked.FieldSeparator						= FieldSeparator
								invoked.IncludeSeparatorAtBeginningOfRow	= IncludeSeparatorAtBeginningOfRow
								invoked.FieldDelimiter						= FieldDelimiter
								invoked.ExportFile							= ExportFile
								invoked.FlowToProcessFile					= FlowToProcessFile
								invoked.Active								= false 
								invoked.FileName							= FileName
								invoked.AppendTimestampToFileName			= AppendTimestampToFileName
								invoked.FileNameTimeStampFormat				= FileNameTimeStampFormat
								invoked.AllRecords							= AllRecords
								invoked.FileHeaderText						= FileHeaderText
								invoked.AutomaticallySendFileToION			= AutomaticallySendFileToION
								invoked.IONDocumentName						= IONDocumentName
								invoked.IONInstanceCount					= IONInstanceCount
								invoked.IONSource							= IONSource
								invoked.IONDocumentID						= IONDocumentID
								invoked.FileType							= FileType
								invoked.FileSegmentLimit					= FileSegmentLimit
								invoked.NumberOfRecordsBeforeNewFile		= NumberOfRecordsBeforeNewFile
								invoked.NumberOfMegabytesBeforeNewFile		= NumberOfMegabytesBeforeNewFile
								invoked.TurnOffRecordAuditing				= TurnOffRecordAuditing
								invoked.GenerationBehaviorForNoOutput		= GenerationBehaviorForNoOutput
								invoked.ThreadingMethod						= ThreadingMethod
								invoked.DCKey								= LocalDCKey
								invoked.ExcludeSeparatorWhenEmpty			= ExcludeSeparatorWhenEmpty
								invoked.RecordEndOfLineCharacter			= RecordEndOfLineCharacter
								invoked.SortFieldArray						= SortFieldArray
								invoked.SortSourceFieldOne					= SortSourceFieldOne
								invoked.SortSourceFieldTwo					= SortSourceFieldTwo
								invoked.SortSourceFieldThree				= SortSourceFieldThree
								invoked.SortSourceFieldFour					= SortSourceFieldFour
								invoked.SortSourceFieldFive					= SortSourceFieldFive
								invoked.SortSourceFieldSix					= SortSourceFieldSix
								invoked.SortSourceFieldSeven				= SortSourceFieldSeven
								invoked.SortSourceFieldEight				= SortSourceFieldEight
								invoked.SortSourceFieldNine					= SortSourceFieldNine
								invoked.SortSourceFieldTen					= SortSourceFieldTen
								invoked.SortSourceFieldEleven				= SortSourceFieldEleven
								invoked.SortSourceFieldTwelve				= SortSourceFieldTwelve
								invoked.OverrideNumberOfThreads				= OverrideNumberOfThreads	
								invoked.TabSeparator						= TabSeparator
								invoked.EndOfLineCharacter					= EndOfLineCharacter
								invoked.OutputTextForBlankDocument			= OutputTextForBlankDocument
								invoked.UseAuditInformation					= UseAuditInformation
								invoked.FileMimeType						= FileMimeType

							LocalFileCreationSetup = SetupView.FileCreationSetup

						else
						if (IgnoreDeltas)
							invoke Update FileCreationSetupOTORel
								invoked.Description							= Description
								invoked.FieldSeparator						= FieldSeparator
								invoked.IncludeSeparatorAtBeginningOfRow	= IncludeSeparatorAtBeginningOfRow
								invoked.FieldDelimiter						= FieldDelimiter
								invoked.ExportFile							= ExportFile
								invoked.FlowToProcessFile					= FlowToProcessFile
								invoked.FileName							= FileName
								invoked.AppendTimestampToFileName			= AppendTimestampToFileName
								invoked.FileNameTimeStampFormat				= FileNameTimeStampFormat
								invoked.AllRecords							= AllRecords
								invoked.FileHeaderText						= FileHeaderText
								invoked.AutomaticallySendFileToION			= AutomaticallySendFileToION
								invoked.IONDocumentName						= IONDocumentName
								invoked.IONInstanceCount					= IONInstanceCount
								invoked.IONSource							= IONSource
								invoked.IONDocumentID						= IONDocumentID
								invoked.FileType							= FileType
								invoked.FileSegmentLimit					= FileSegmentLimit
								invoked.NumberOfRecordsBeforeNewFile		= NumberOfRecordsBeforeNewFile
								invoked.NumberOfMegabytesBeforeNewFile		= NumberOfMegabytesBeforeNewFile
								invoked.TurnOffRecordAuditing				= TurnOffRecordAuditing
								invoked.GenerationBehaviorForNoOutput		= GenerationBehaviorForNoOutput
								invoked.ThreadingMethod						= ThreadingMethod
								invoked.ExcludeSeparatorWhenEmpty			= ExcludeSeparatorWhenEmpty
								invoked.RecordEndOfLineCharacter			= RecordEndOfLineCharacter
								invoked.SortFieldArray						= SortFieldArray
								invoked.SortSourceFieldOne					= SortSourceFieldOne
								invoked.SortSourceFieldTwo					= SortSourceFieldTwo
								invoked.SortSourceFieldThree				= SortSourceFieldThree
								invoked.SortSourceFieldFour					= SortSourceFieldFour
								invoked.SortSourceFieldFive					= SortSourceFieldFive
								invoked.SortSourceFieldSix					= SortSourceFieldSix
								invoked.SortSourceFieldSeven				= SortSourceFieldSeven
								invoked.SortSourceFieldEight				= SortSourceFieldEight
								invoked.SortSourceFieldNine					= SortSourceFieldNine
								invoked.SortSourceFieldTen					= SortSourceFieldTen
								invoked.SortSourceFieldEleven				= SortSourceFieldEleven
								invoked.SortSourceFieldTwelve				= SortSourceFieldTwelve
								invoked.OverrideNumberOfThreads				= OverrideNumberOfThreads
								invoked.TabSeparator						= TabSeparator
								invoked.EndOfLineCharacter					= EndOfLineCharacter
								invoked.OutputTextForBlankDocument			= OutputTextForBlankDocument
								invoked.UseAuditInformation					= UseAuditInformation
								invoked.FileMimeType						= FileMimeType
					

					if (RowType.Row
					and (ImportOption.CreateNewSetup
					or   not LinkedBoolean))
						if (LocalDCKeyRow entered
						and FileCreationRowDCKeyRel exists)
							LocalRow = first FileCreationRowDCKeyRel.FileCreationRowDetail
						if (LinkedSetupDCKey entered) 
							constraint (FileCreationLinkedSetupDCKeyRel exists)
								"UnableToFindLinkedSetupWithDCKey:<LinkedSetupDCKey>"
							LinkedSetup = FileCreationLinkedSetupDCKeyRel.FileCreationSetup
							LocalFileCreationSetup2 = LinkedSetup
							constraint (FileCreationLinkedRowDCKeyRel.FileCreationRowDetail exists) 
								"UnableToFindLinkedRowWithDCKey:<LinkedRowDCKey>"
							LinkedRow = FileCreationLinkedRowDCKeyRel.FileCreationRowDetail
							LocalRow2 = LinkedRow
						else
						if (LinkedSetup != 0)
							LocalFileCreationSetup2 = LinkedSetup
							LocalRow2				= LinkedRow
						else
							LinkedRow = 0
						if (LinkedSetup != 0
						and FileCreationRowDetailOTO2Rel not exist)	
							LinkedSetup = 0
							LinkedRow = 0
						if (ImportOption.CreateNewSetup
						or	FileCreationRowDetailOTORel not exist
						and (IgnoreDeltas))
							invoke ImportCreate FileCreationRowDetailOTORel
								assign result to RowView
								invoked.FinanceEnterpriseGroup								= LocalFinanceEnterpriseGroup
								invoked.FileCreationSetup									= LocalFileCreationSetup
						    	invoked.Description											= Description
						    	invoked.RowOrder											= RowOrder
						    	invoked.Header												= Header
						    	invoked.Trailer												= Trailer
						    	invoked.OneToMany											= OneToMany
						    	invoked.OneToManyBusinessClassPayablesInvoice				= OneToManyBusinessClassPayablesInvoice
						    	invoked.OneToManyBusinessClassGeneralLedgerChartAccount		= OneToManyBusinessClassGeneralLedgerChartAccount
								invoked.OneToManyBusinessClassAsset							= OneToManyBusinessClassAsset
								invoked.OneToManyBusinessClassBinGroup						= OneToManyBusinessClassBinGroup
								invoked.OneToManyBusinessClassContract						= OneToManyBusinessClassContract
								invoked.OneToManyBusinessClassPurchaseOrder					= OneToManyBusinessClassPurchaseOrder
								invoked.OneToManyBusinessClassVendor						= OneToManyBusinessClassVendor
								invoked.OneToManySequenceNumberStartingValue				= OneToManySequenceNumberStartingValue
								invoked.DoNotResetOneToManySequenceNumber					= DoNotResetOneToManySequenceNumber
								invoked.ExtendsOneToManyRow									= ExtendsOneToManyRow
						    	invoked.IncludeInRecordCount1								= IncludeInRecordCount1
						    	invoked.IncludeInRecordCount2								= IncludeInRecordCount2
						    	invoked.IncludeInRecordCount3								= IncludeInRecordCount3								

								invoked.RowCondition1.CompareFile							= CompareFile1
								invoked.RowCondition1.CompareOperator						= CompareOperator1
								invoked.RowCondition1.FieldDataType							= DataType1
								invoked.RowCondition1.AlphaValue							= AlphaValue1
								invoked.RowCondition1.NumericValue							= NumericValue1
								invoked.RowCondition1.DecimalValue							= DecimalValue1
								invoked.RowCondition1.DateValue								= DateValue1
								invoked.RowCondition1.TimeValue								= TimeValue1
								invoked.RowCondition1.TextValue								= TextValue1
								invoked.RowCondition1.BooleanValue							= BooleanValue1
								invoked.RowCondition1.TimeStampValue						= TimeStampValue1

								invoked.CompareField1										= CompareField1
								invoked.ComparedToField1									= ComparedToField1
								invoked.RowCondition1.CompareType							= CompareType1

								invoked.RowCondition2.CompareFile							= CompareFile2
								invoked.RowCondition2.CompareOperator						= CompareOperator2
								invoked.RowCondition2.FieldDataType							= DataType2
								invoked.RowCondition2.AlphaValue							= AlphaValue2
								invoked.RowCondition2.NumericValue							= NumericValue2
								invoked.RowCondition2.DecimalValue							= DecimalValue2
								invoked.RowCondition2.DateValue								= DateValue2
								invoked.RowCondition2.TimeValue								= TimeValue2
								invoked.RowCondition2.TextValue								= TextValue2
								invoked.RowCondition2.BooleanValue							= BooleanValue2
								invoked.RowCondition2.TimeStampValue						= TimeStampValue2

								invoked.CompareField2										= CompareField2
								invoked.ComparedToField2									= ComparedToField2
								invoked.RowCondition2.CompareType							= CompareType2
								invoked.RowConditionOperator								= RowConditionOperator

								invoked.OneToManyCondition1.CompareFile						= OTMCompareFile1
								invoked.OneToManyCondition1.CompareOperator					= OTMCompareOperator1
								invoked.OneToManyCondition1.FieldDataType					= OTMDataType1
								invoked.OneToManyCondition1.AlphaValue						= OTMAlphaValue1
								invoked.OneToManyCondition1.NumericValue					= OTMNumericValue1
								invoked.OneToManyCondition1.DecimalValue					= OTMDecimalValue1
								invoked.OneToManyCondition1.DateValue						= OTMDateValue1
								invoked.OneToManyCondition1.TimeValue						= OTMTimeValue1
								invoked.OneToManyCondition1.TextValue						= OTMTextValue1
								invoked.OneToManyCondition1.BooleanValue					= OTMBooleanValue1
								invoked.OneToManyCondition1.TimeStampValue					= OTMTimeStampValue1

								invoked.OneToManyCompareField1								= OneToManyCompareField1
								invoked.OneToManyComparedToField1							= OneToManyComparedToField1
								invoked.OneToManyCondition1.CompareType						= OneToManyCompareType1

								invoked.OneToManyCondition2.CompareFile						= OTMCompareFile2
								invoked.OneToManyCondition2.CompareOperator					= OTMCompareOperator2
								invoked.OneToManyCondition2.FieldDataType					= OTMDataType2
								invoked.OneToManyCondition2.AlphaValue						= OTMAlphaValue2
								invoked.OneToManyCondition2.NumericValue					= OTMNumericValue2
								invoked.OneToManyCondition2.DecimalValue					= OTMDecimalValue2
								invoked.OneToManyCondition2.DateValue						= OTMDateValue2
								invoked.OneToManyCondition2.TimeValue						= OTMTimeValue2
								invoked.OneToManyCondition2.TextValue						= OTMTextValue2
								invoked.OneToManyCondition2.BooleanValue					= OTMBooleanValue2
								invoked.OneToManyCondition2.TimeStampValue					= OTMTimeStampValue2

					 			invoked.OneToManyCompareField2								= OneToManyCompareField2
								invoked.OneToManyComparedToField2							= OneToManyComparedToField2
								invoked.OneToManyCondition2.CompareType						= OneToManyCompareType2
								invoked.OneToManyRowConditionOperator						= OneToManyRowConditionOperator

								invoked.ExtendedCondition1.CompareFile						= ExtendedCompareFile1
								invoked.ExtendedCondition1.CompareOperator					= ExtendedCompareOperator1
								invoked.ExtendedCondition1.FieldDataType						= ExtendedDataType1
								invoked.ExtendedCondition1.AlphaValue						= ExtendedAlphaValue1
								invoked.ExtendedCondition1.NumericValue						= ExtendedNumericValue1
								invoked.ExtendedCondition1.DecimalValue						= ExtendedDecimalValue1
								invoked.ExtendedCondition1.DateValue						= ExtendedDateValue1
								invoked.ExtendedCondition1.TimeValue						= ExtendedTimeValue1
								invoked.ExtendedCondition1.TextValue						= ExtendedTextValue1
								invoked.ExtendedCondition1.BooleanValue						= ExtendedBooleanValue1
								invoked.ExtendedCondition1.TimeStampValue					= ExtendedTimeStampValue1

								invoked.ExtendedCompareField1 								= ExtendedCompareField1
								invoked.ExtendedComparedToField1							= ExtendedComparedToField1
								invoked.ExtendedCondition1.CompareType						= ExtendedCompareType1

								invoked.ExtendedCondition2.CompareFile						= ExtendedCompareFile2
								invoked.ExtendedCondition2.CompareOperator					= ExtendedCompareOperator2
								invoked.ExtendedCondition2.FieldDataType					= ExtendedDataType2
								invoked.ExtendedCondition2.AlphaValue						= ExtendedAlphaValue2
								invoked.ExtendedCondition2.NumericValue						= ExtendedNumericValue2
								invoked.ExtendedCondition2.DecimalValue						= ExtendedDecimalValue2
								invoked.ExtendedCondition2.DateValue						= ExtendedDateValue2
								invoked.ExtendedCondition2.TimeValue						= ExtendedTimeValue2
								invoked.ExtendedCondition2.TextValue						= ExtendedTextValue2
								invoked.ExtendedCondition2.BooleanValue						= ExtendedBooleanValue2
								invoked.ExtendedCondition2.TimeStampValue					= ExtendedTimeStampValue2

								invoked.ExtendedCompareField2 								= ExtendedCompareField2
								invoked.ExtendedComparedToField2							= ExtendedComparedToField2
								invoked.ExtendedCondition2.CompareType						= ExtendedCompareType2
								invoked.ExtendedRowConditionOperator						= ExtendedRowConditionOperator
								invoked.LinkedSetup											= LinkedSetup
								invoked.LinkedRow											= LinkedRow
								invoked.Disable												= Disable
								invoked.DCKey												= LocalDCKeyRow
								invoked.Subtotal											= Subtotal
								invoked.SubtotalField										= SubtotalField
								invoked.SubtotalLevel										= SubtotalLevel
								invoked.SubtotalPlacement									= SubtotalPlacement
								invoked.IncludeInRecordCount4								= IncludeInRecordCount4
						    	invoked.IncludeInRecordCount5								= IncludeInRecordCount5
						    	invoked.IncludeInRecordCount6								= IncludeInRecordCount6
							LocalRow = RowView.FileCreationRowDetail
							if (ImportOption.CreateNewSetup
							and LinkedSetupsExist)
								for each (Array) FileCreationSetupArray.SetupGroup
									if (each (Array).Setup = FileCreationSetupOriginal
									and each (Array).Row = FileCreationRowDetailOriginal)
										each (Array).NewSetup = LocalFileCreationSetup
										each (Array).NewRow = LocalRow
										end for each							

						else
						if (IgnoreDeltas)

							invoke ImportUpdate FileCreationRowDetailOTORel
						    	invoked.Description											= Description
						    	invoked.RowOrder											= RowOrder
						    	invoked.Header												= Header
						    	invoked.Trailer												= Trailer
						    	invoked.OneToMany											= OneToMany
						    	invoked.OneToManyBusinessClassPayablesInvoice				= OneToManyBusinessClassPayablesInvoice
						    	invoked.OneToManyBusinessClassGeneralLedgerChartAccount		= OneToManyBusinessClassGeneralLedgerChartAccount
								invoked.OneToManyBusinessClassAsset							= OneToManyBusinessClassAsset
								invoked.OneToManyBusinessClassBinGroup						= OneToManyBusinessClassBinGroup
								invoked.OneToManyBusinessClassContract						= OneToManyBusinessClassContract
								invoked.OneToManyBusinessClassPurchaseOrder					= OneToManyBusinessClassPurchaseOrder
								invoked.OneToManyBusinessClassVendor						= OneToManyBusinessClassVendor
								invoked.OneToManySequenceNumberStartingValue				= OneToManySequenceNumberStartingValue
								invoked.DoNotResetOneToManySequenceNumber					= DoNotResetOneToManySequenceNumber
								invoked.ExtendsOneToManyRow									= ExtendsOneToManyRow
						    	invoked.IncludeInRecordCount1								= IncludeInRecordCount1
						    	invoked.IncludeInRecordCount2								= IncludeInRecordCount2
						    	invoked.IncludeInRecordCount3								= IncludeInRecordCount3

								invoked.RowCondition1.CompareFile							= CompareFile1
								invoked.RowCondition1.CompareOperator						= CompareOperator1
								invoked.RowCondition1.FieldDataType							= DataType1
								invoked.RowCondition1.AlphaValue							= AlphaValue1
								invoked.RowCondition1.NumericValue							= NumericValue1
								invoked.RowCondition1.DecimalValue							= DecimalValue1
								invoked.RowCondition1.DateValue								= DateValue1
								invoked.RowCondition1.TimeValue								= TimeValue1
								invoked.RowCondition1.TextValue								= TextValue1
								invoked.RowCondition1.BooleanValue							= BooleanValue1
								invoked.RowCondition1.TimeStampValue						= TimeStampValue1

								invoked.CompareField1										= CompareField1
								invoked.ComparedToField1									= ComparedToField1
								invoked.RowCondition1.CompareType							= CompareType1

								invoked.RowCondition2.CompareFile							= CompareFile2
								invoked.RowCondition2.CompareOperator						= CompareOperator2
								invoked.RowCondition2.FieldDataType							= DataType2
								invoked.RowCondition2.AlphaValue							= AlphaValue2
								invoked.RowCondition2.NumericValue							= NumericValue2
								invoked.RowCondition2.DecimalValue							= DecimalValue2
								invoked.RowCondition2.DateValue								= DateValue2
								invoked.RowCondition2.TimeValue								= TimeValue2
								invoked.RowCondition2.TextValue								= TextValue2
								invoked.RowCondition2.BooleanValue							= BooleanValue2
								invoked.RowCondition2.TimeStampValue						= TimeStampValue2

								invoked.CompareField2										= CompareField2
								invoked.ComparedToField2									= ComparedToField2
								invoked.RowCondition2.CompareType							= CompareType2
								invoked.RowConditionOperator								= RowConditionOperator

								invoked.OneToManyCondition1.CompareFile						= OTMCompareFile1
								invoked.OneToManyCondition1.CompareOperator					= OTMCompareOperator1
								invoked.OneToManyCondition1.FieldDataType					= OTMDataType1
								invoked.OneToManyCondition1.AlphaValue						= OTMAlphaValue1
								invoked.OneToManyCondition1.NumericValue					= OTMNumericValue1
								invoked.OneToManyCondition1.DecimalValue					= OTMDecimalValue1
								invoked.OneToManyCondition1.DateValue						= OTMDateValue1
								invoked.OneToManyCondition1.TimeValue						= OTMTimeValue1
								invoked.OneToManyCondition1.TextValue						= OTMTextValue1
								invoked.OneToManyCondition1.BooleanValue					= OTMBooleanValue1
								invoked.OneToManyCondition1.TimeStampValue					= OTMTimeStampValue1

								invoked.OneToManyCompareField1								= OneToManyCompareField1
								invoked.OneToManyComparedToField1							= OneToManyComparedToField1
								invoked.OneToManyCondition1.CompareType						= OneToManyCompareType1

								invoked.OneToManyCondition2.CompareFile						= OTMCompareFile2
								invoked.OneToManyCondition2.CompareOperator					= OTMCompareOperator2
								invoked.OneToManyCondition2.FieldDataType					= OTMDataType2
								invoked.OneToManyCondition2.AlphaValue						= OTMAlphaValue2
								invoked.OneToManyCondition2.NumericValue					= OTMNumericValue2
								invoked.OneToManyCondition2.DecimalValue					= OTMDecimalValue2
								invoked.OneToManyCondition2.DateValue						= OTMDateValue2
								invoked.OneToManyCondition2.TimeValue						= OTMTimeValue2
								invoked.OneToManyCondition2.TextValue						= OTMTextValue2
								invoked.OneToManyCondition2.BooleanValue					= OTMBooleanValue2
								invoked.OneToManyCondition2.TimeStampValue					= OTMTimeStampValue2

					 			invoked.OneToManyCompareField2								= OneToManyCompareField2
								invoked.OneToManyComparedToField2							= OneToManyComparedToField2
								invoked.OneToManyCondition2.CompareType						= OneToManyCompareType2
								invoked.OneToManyRowConditionOperator						= OneToManyRowConditionOperator

								invoked.ExtendedCondition1.CompareFile						= ExtendedCompareFile1
								invoked.ExtendedCondition1.CompareOperator					= ExtendedCompareOperator1
								invoked.ExtendedCondition1.FieldDataType					= ExtendedDataType1
								invoked.ExtendedCondition1.AlphaValue						= ExtendedAlphaValue1
								invoked.ExtendedCondition1.NumericValue						= ExtendedNumericValue1
								invoked.ExtendedCondition1.DecimalValue						= ExtendedDecimalValue1
								invoked.ExtendedCondition1.DateValue						= ExtendedDateValue1
								invoked.ExtendedCondition1.TimeValue						= ExtendedTimeValue1
								invoked.ExtendedCondition1.TextValue						= ExtendedTextValue1
								invoked.ExtendedCondition1.BooleanValue						= ExtendedBooleanValue1
								invoked.ExtendedCondition1.TimeStampValue					= ExtendedTimeStampValue1

								invoked.ExtendedCompareField1 								= ExtendedCompareField1
								invoked.ExtendedComparedToField1							= ExtendedComparedToField1
								invoked.ExtendedCondition1.CompareType						= ExtendedCompareType1

								invoked.ExtendedCondition2.CompareFile						= ExtendedCompareFile2
								invoked.ExtendedCondition2.CompareOperator					= ExtendedCompareOperator2
								invoked.ExtendedCondition2.FieldDataType					= ExtendedDataType2
								invoked.ExtendedCondition2.AlphaValue						= ExtendedAlphaValue2
								invoked.ExtendedCondition2.NumericValue						= ExtendedNumericValue2
								invoked.ExtendedCondition2.DecimalValue						= ExtendedDecimalValue2
								invoked.ExtendedCondition2.DateValue						= ExtendedDateValue2
								invoked.ExtendedCondition2.TimeValue						= ExtendedTimeValue2
								invoked.ExtendedCondition2.TextValue						= ExtendedTextValue2
								invoked.ExtendedCondition2.BooleanValue						= ExtendedBooleanValue2
								invoked.ExtendedCondition2.TimeStampValue					= ExtendedTimeStampValue2

								invoked.ExtendedCompareField2 								= ExtendedCompareField2
								invoked.ExtendedComparedToField2							= ExtendedComparedToField2
								invoked.ExtendedCondition2.CompareType						= ExtendedCompareType2
								invoked.ExtendedRowConditionOperator						= ExtendedRowConditionOperator
								invoked.Disable												= Disable
								invoked.Subtotal											= Subtotal
								invoked.SubtotalField										= SubtotalField
								invoked.SubtotalLevel										= SubtotalLevel
								invoked.SubtotalPlacement									= SubtotalPlacement
								invoked.IncludeInRecordCount4								= IncludeInRecordCount4
						    	invoked.IncludeInRecordCount5								= IncludeInRecordCount5
						    	invoked.IncludeInRecordCount6								= IncludeInRecordCount6
								if (LinkedSetupDCKey entered
								and LinkedSetup entered)
									invoked.LinkedSetup										= LinkedSetup
									invoked.LinkedRow										= LinkedRow

					initialize LinkedSetupDCKey
					initialize LinkedSetup
					initialize LocalFileCreationSetup2
					initialize LinkedRowDCKey
					initialize LinkedRow
					initialize LocalRow2


					if (RowType.Column
					and (ImportOption.CreateNewSetup
					or   not LinkedBoolean))
						if (LocalDCKeyColumn entered
						and FileCreationColumnDCKeyRel exists)
							LocalColumn = first FileCreationColumnDCKeyRel.FileCreationColumnDetail
						if (ImportOption.CreateNewSetup
						or	FileCreationColumnDetailOTORel not exist
						and (IgnoreDeltas))
							invoke ImportCreate FileCreationColumnDetailOTORel
								assign result to ColumnView
								invoked.FinanceEnterpriseGroup								= LocalFinanceEnterpriseGroup
								invoked.FileCreationSetup									= LocalFileCreationSetup
								invoked.FileCreationRowDetail								= LocalRow
						    	invoked.FieldName											= FieldName
						    	invoked.Description											= Description
						    	invoked.ColumnOrder											= ColumnOrder
						    	invoked.FieldDataType										= DataType
						    	invoked.Length												= Length
						    	invoked.InputOption											= InputOption
						    	invoked.SourceRelation										= SourceRelation
						    	invoked.SourceFields										= SourceFields
						    	invoked.NumberOfSourceFields								= NumberOfSourceFields
						    	invoked.Comments											= Comments
						    	invoked.ShowAlphaDefaultField								= ShowAlphaDefaultField
						    	invoked.DefaultAlpha										= DefaultAlpha
						    	invoked.DefaultNumeric										= DefaultNumeric
						    	invoked.DefaultDecimal										= DefaultDecimal
						    	invoked.DefaultDate											= DefaultDate
						    	invoked.DefaultTime											= DefaultTime
						    	invoked.DefaultBoolean										= DefaultBoolean
						    	invoked.DefaultText											= DefaultText
						    	invoked.DefaultTimeStamp									= DefaultTimeStamp
						    	invoked.UseCurrentSystemDate								= UseCurrentSystemDate
						    	invoked.UseCurrentSystemTime								= UseCurrentSystemTime
						    	invoked.UseCurrentSystemTimeStamp							= UseCurrentSystemTimeStamp
						    	invoked.ConvertToUpperCase									= ConvertToUpperCase
						    	invoked.TruncateToLength									= TruncateToLength
						    	invoked.SubstringStart										= SubstringStart
						    	invoked.SubstringEnd										= SubstringEnd
						    	invoked.FileName											= FileNameBoolean
						    	invoked.OneToMany											= OneToMany
						    	invoked.OneToManySequenceNumber								= OneToManySequenceNumber
						    	invoked.RecordCount1										= RecordCount1
						    	invoked.RecordCount2										= RecordCount2
						    	invoked.RecordCount3										= RecordCount3
						    	invoked.JavaFormat											= JavaFormat
						    	invoked.ReplacementRegularExpression						= ReplacementRegularExpression
						    	invoked.ReplacementReplaceWith								= ReplacementReplaceWith
						    	invoked.DataMappingOption									= DataMappingOption
						    	invoked.FixedLengthFieldRange								= FixedLengthFieldRange
						    	invoked.FixedLengthFieldRangeArray							= FixedLengthFieldRangeArray
								invoked.DCKey												= LocalDCKeyColumn
								invoked.SeqColumnOrder										= -1
								invoked.TotalThisColumn										= TotalThisColumn
								invoked.TotalForRow											= TotalForRow
								invoked.TotalForColumn										= TotalForColumn
								invoked.RecordCount4										= RecordCount4
						    	invoked.RecordCount5										= RecordCount5
						    	invoked.RecordCount6										= RecordCount6
						    	invoked.ApplyAdjustment										= ApplyAdjustment
						    	invoked.DateAdjustmentOperator								= DateAdjustmentOperator
						    	invoked.DateAdjustment										= DateAdjustment
							LocalColumn = ColumnView.FileCreationColumnDetail

						else
						if (IgnoreDeltas)
							invoke ImportUpdate FileCreationColumnDetailOTORel
								invoked.FieldName											= FieldName
								invoked.Description											= Description
								invoked.ColumnOrder											= ColumnOrder
								invoked.FieldDataType										= DataType
								invoked.Length												= Length
								invoked.InputOption											= InputOption
								invoked.SourceRelation										= SourceRelation
								invoked.SourceFields										= SourceFields
								invoked.NumberOfSourceFields								= NumberOfSourceFields
								invoked.Comments											= Comments
								invoked.ShowAlphaDefaultField								= ShowAlphaDefaultField
								invoked.DefaultAlpha										= DefaultAlpha
								invoked.DefaultNumeric										= DefaultNumeric
								invoked.DefaultDecimal										= DefaultDecimal
								invoked.DefaultDate											= DefaultDate
								invoked.DefaultTime											= DefaultTime
								invoked.DefaultBoolean										= DefaultBoolean
								invoked.DefaultText											= DefaultText
								invoked.DefaultTimeStamp									= DefaultTimeStamp
								invoked.UseCurrentSystemDate								= UseCurrentSystemDate
								invoked.UseCurrentSystemTime								= UseCurrentSystemTime
								invoked.UseCurrentSystemTimeStamp							= UseCurrentSystemTimeStamp
								invoked.ConvertToUpperCase									= ConvertToUpperCase
								invoked.TruncateToLength									= TruncateToLength
								invoked.SubstringStart										= SubstringStart
								invoked.SubstringEnd										= SubstringEnd
								invoked.FileName											= FileNameBoolean
								invoked.OneToMany											= OneToMany
								invoked.OneToManySequenceNumber								= OneToManySequenceNumber
								invoked.RecordCount1										= RecordCount1
								invoked.RecordCount2										= RecordCount2
								invoked.RecordCount3										= RecordCount3
								invoked.JavaFormat											= JavaFormat
								invoked.ReplacementRegularExpression						= ReplacementRegularExpression
								invoked.ReplacementReplaceWith								= ReplacementReplaceWith
								invoked.DataMappingOption									= DataMappingOption
								invoked.FixedLengthFieldRange								= FixedLengthFieldRange
								invoked.FixedLengthFieldRangeArray							= FixedLengthFieldRangeArray
								invoked.SeqColumnOrder										= -1
								invoked.TotalThisColumn										= TotalThisColumn
								invoked.TotalForRow											= TotalForRow
								invoked.TotalForColumn										= TotalForColumn
								invoked.RecordCount4										= RecordCount4
								invoked.RecordCount5										= RecordCount5
								invoked.RecordCount6										= RecordCount6
								invoked.ApplyAdjustment										= ApplyAdjustment
								invoked.DateAdjustmentOperator								= DateAdjustmentOperator
								invoked.DateAdjustment										= DateAdjustment


					if (RowType.DataMapping
					and (ImportOption.CreateNewSetup
					or   not LinkedBoolean))
						if (LocalDCKeyDataMapping entered
						and FileCreationDataMappingDCKeyRel exists)
							LocalDataMapping = FileCreationDataMappingDCKeyRel.FileCreationDataMapping
						if (ImportOption.CreateNewSetup
						or	FileCreationDataMappingOTORel not exist
						and (IgnoreDeltas))
							invoke ImportCreate FileCreationDataMappingOTORel
								invoked.FinanceEnterpriseGroup								= LocalFinanceEnterpriseGroup
								invoked.Description											= Description
								invoked.FileCreationSetup									= LocalFileCreationSetup
								invoked.FileCreationRowDetail								= LocalRow
								invoked.FileCreationColumnDetail							= LocalColumn
						    	invoked.MappingOrder										= MappingOrder
						    	invoked.CompareType											= CompareType
						    	invoked.AlphaFromValue										= AlphaFromValue
						    	invoked.DateFromValue										= DateFromValue
						    	invoked.DecimalFromValue									= DecimalFromValue
						    	invoked.NumericFromValue									= NumericFromValue
						    	invoked.TimeFromValue										= TimeFromValue
						    	invoked.BooleanFromValue									= BooleanFromValue
						    	invoked.AlphaToValue										= AlphaToValue
						    	invoked.DateToValue											= DateToValue
						    	invoked.DecimalToValue										= DecimalToValue
						    	invoked.NumericToValue										= NumericToValue
						    	invoked.TimeToValue											= TimeToValue
						    	invoked.DefaultMapping										= DefaultMapping
								invoked.DCKey												= LocalDCKeyDataMapping
						else
						if (IgnoreDeltas)
							invoke ImportUpdate FileCreationDataMappingOTORel
								invoked.MappingOrder										= MappingOrder
								invoked.Description											= Description
								invoked.CompareType											= CompareType
								invoked.AlphaFromValue										= AlphaFromValue
								invoked.DateFromValue										= DateFromValue
								invoked.DecimalFromValue									= DecimalFromValue
								invoked.NumericFromValue									= NumericFromValue
								invoked.TimeFromValue										= TimeFromValue
								invoked.BooleanFromValue									= BooleanFromValue
								invoked.AlphaToValue										= AlphaToValue
								invoked.DateToValue											= DateToValue
								invoked.DecimalToValue										= DecimalToValue
								invoked.NumericToValue										= NumericToValue
								invoked.TimeToValue											= TimeToValue
								invoked.DefaultMapping										= DefaultMapping
		
		SetRegenerateMappingsFlagToNotNeeded is an Instance Action
			restricted
			run in background
			
			Action Rules
				if (RegenerateMappingsFlag.Regenerating)
					RegenerateMappingsFlag = RegenerateMappingsFlag.NotNeeded

		SetRegenerateMappingsFlagToNeeded is an Instance Action
			restricted
			
			Action Rules
				RegenerateMappingsFlag = RegenerateMappingsFlag.Needed

		SetAllNeedToRegenerateMappingFlagsToNeeded is a Set Action
			restricted
				
			Action Rules
				Instance Rules
					if (!RegenerateMappingsFlag.Needed)
						RegenerateMappingsFlag = RegenerateMappingsFlag.Needed
