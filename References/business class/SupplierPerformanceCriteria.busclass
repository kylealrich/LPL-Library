SupplierPerformanceCriteria is a BusinessClass
    owned by procurement
    prefix is SPFCT
    sql name is SPERCRIT

    Ontology
    	symbolic key is SupplierPerformanceCriteria

    Persistent Fields
    	PerformanceCriteria
    	Criteria				is a Description
    	Description				is Text

   	Transient Fields

	Derived Fields
    	PerformanceRatingScore is a DerivedField
			type is like InternationalAmount
			return (first SupplierPerformanceCriteriaResponseRel.SupplierPerformanceCriteriaOption)

		ResponseAttachment is a DerivedField
			type is BinaryDocument
			return (first SupplierPerformanceCriteriaResponseRel.Attachment.File)

		ResponseComments is a DerivedField
			type is Text
            default label is "Comment"
			return (first SupplierPerformanceCriteriaResponseRel.Comments)

	Conditions
		HasResponse
			restricted
			when (first SupplierPerformanceCriteriaResponseRel.SupplierPerformanceCriteriaOption entered)
		
		DisplayAttachmentToSupplier
			restricted
			when (first SupplierPerformanceCriteriaResponseRel.DisplayAttachmentToSupplier)
		
		DisplayCommentsToSupplier
			restricted
			when (first SupplierPerformanceCriteriaResponseRel.DisplayCommentsToSupplier)

		IsApplicable
			restricted
			when (first SupplierPerformanceCriteriaResponseRel.SupplierPerformanceCriteriaOption < 6)

	Relations
		SupplierPerformanceCriteriaResponseRel is a SupplierPerformanceCriteriaResponse set

		PerformanceCriteriaOptionRel
			one-to-many relation to PerformanceCriteriaOption
			Field Mapping uses symbolic key
				related.SupplierGroup					= SupplierPerformanceEvaluation.PerformanceEvaluationTemplate.SupplierGroup
				related.PerformanceEvaluationTemplate 	= SupplierPerformanceEvaluation.PerformanceEvaluationTemplate
				related.PerformanceCriteriaGroup		= SupplierPerformanceCriteriaGroup.PerformanceCriteriaGroup
				related.PerformanceCriteria				= PerformanceCriteria
		
	Sets

	Field Rules
   		Criteria
   			required

	Attach Rules

	Actions
		Create is a Create Action
			Exit Rules
				for each PerformanceCriteriaOptionRel
					invoke Create SupplierPerformanceCriteriaOption
						invoked.SupplierGroup 						= this instance.SupplierGroup
						invoked.Supplier 							= this instance.Supplier
						invoked.PerformanceEvaluationTemplate 		= this instance.SupplierPerformanceEvaluation.PerformanceEvaluationTemplate
						invoked.SupplierPerformanceEvaluation 		= this instance.SupplierPerformanceEvaluation
						invoked.PerformanceCriteriaGroup			= this instance.SupplierPerformanceCriteriaGroup.PerformanceCriteriaGroup
						invoked.SupplierPerformanceCriteriaGroup 	= this instance.SupplierPerformanceCriteriaGroup
						invoked.SupplierPerformanceCriteria 		= this instance.SupplierPerformanceCriteria
						invoked.SupplierPerformanceCriteriaOption	= each.PerformanceCriteriaOption
						invoked.Description							= each.Description
						invoked.Contract							= Contract

		Update is an Action
			valid when (!SupplierPerformanceEvaluation.IsEvaluationComplete)

		Delete is an Action
