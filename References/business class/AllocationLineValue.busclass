AllocationLineValue is a BusinessClass
    owned by Allocations
    prefix is ALLLV

    Ontology
    	symbolic key is AllocationLineValue

	Patterns
        disable Auditing
        disable EffectiveDated

    Persistent Fields
        AccountingEntity
        AccountingUnit
        GeneralLedgerChartAccount
        	default label is "GlobalLedgerChartAccount"
        Project
        FinanceDimension1
		FinanceDimension2
		FinanceDimension3
		FinanceDimension4
		FinanceDimension5
		FinanceDimension6
		FinanceDimension7
		FinanceDimension8
		FinanceDimension9
		FinanceDimension10

		CurrentValue						is an InternationalAmount
		TransactionAmount					is an InternationalAmount
		FunctionalAmount					is an InternationalAmount
		ProjectAmount						is an InternationalAmount
		AlternateAmount						is an InternationalAmount
		AlternateAmount2					is an InternationalAmount
		AlternateAmount3					is an InternationalAmount
		ReportAmount1						is an InternationalAmount
		ReportAmount2						is an InternationalAmount
		ReportAmount3						is an InternationalAmount
		ReportAmount4						is an InternationalAmount
		ReportAmount5						is an InternationalAmount
		
		TransactionCurrency					is a Currency

	Sets
		ByAllocationRun
			duplicates			
			Sort Order
				FinanceEnterpriseGroup				
				AllocationRun
			
    Relations
		AccountingEntitySecurityGroupMemberRel
			one-to-one relation to AccountingEntityGroupMember
			Field Mapping uses part of key
				related.FinanceEnterpriseGroup	= FinanceEnterpriseGroup
				related.AccountingEntityGroup   = actor.context.AccountingEntitySecurityGroup.FinanceDimensionStructure
				related.AccountingEntity        = AccountingEntity
								
	Field Rules

	Conditions
		SecurityGroupAllowsAccess
			when (actor.context.AccountingEntitySecurityGroup = blank
			or   (AccountingEntitySecurityGroupMemberRel exists))
	
	Actions
 		Create is an Action
 			restricted
 		Update is an Action
 			restricted
 		Delete is an Action
 			restricted
 		UpdateAmounts is an Instance Action
 			restricted
 			Parameters
 				Value			is an InternationalAmount
 			Action Rules
 				CurrentValue		+= Value
 				
    	DeleteAllForRun is a Set Action
    		restricted
    		Parameters
    			PrmEnterpriseGroup		is a FinanceEnterpriseGroup
    				default label is "FinanceEnterpriseGroup"
    			PrmAllocationRun		is a AllocationRun
    				default label is "AllocationRun"
			Sort Order
				FinanceEnterpriseGroup				
				AllocationRun
    		Instance Selection
				where (FinanceEnterpriseGroup	= PrmEnterpriseGroup
				and    AllocationRun			= PrmAllocationRun)
			Action Rules
				Instance Rules
					invoke Delete
