ContractTierMemberQualifier is a BusinessClass
	owned by po
	prefix is CTMQf

	Ontology
		symbolic key is ContractTierMemberQualifier

	Patterns
		implements DynamicCreation

	Persistent Fields
		Tier									is a ContractTier
		CurrentTotalAllPurchases				is an InternationalAmount
		TotalPurchasesTimeStamp					is TimeStamp
		CurrentPercentOfAllPurchases			is Percent 6.2

	Conditions
		CompanyOnlyMember
			restricted
			when (ContractTierMember.Company	entered
			and   ContractTierMember.Location	not entered
			and   ContractTierMember.RequestingLocation		not entered)
		CompanyLocationMember
			restricted
			when (ContractTierMember.Company	entered
			and   ContractTierMember.Location	entered
			and   ContractTierMember.RequestingLocation		not entered)
		CompanyRqLocMember
			restricted
			when (ContractTierMember.Company	entered
			and   ContractTierMember.Location	not entered
			and   ContractTierMember.RequestingLocation		entered)
	
	Relations
		ContractLinesRel		is a ContractLine set
		
		PolineFactsCompanyAllRel
			one-to-many relation to PolineFact
			Field Mapping uses ByCompanyItem
				related.PurchasingCompany				= ContractTierMember.Company
			Instance Selection
				where (related.PoDate			>= Contract.EffectiveDate
				and    related.Item             = ContractLinesRel.ItemNumber)

		PolineFactsCompanyLocationAllRel
			one-to-many relation to PolineFact
			Field Mapping uses ByCompLocItem
				related.PurchasingCompany				= ContractTierMember.Company
				related.Location				= ContractTierMember.Location
			Instance Selection
				where (related.PoDate			>= Contract.EffectiveDate
				and    related.Item             = ContractLinesRel.ItemNumber)

		PolineFactsCompanyRqLocAllRel
			one-to-many relation to PolineFact
			Field Mapping uses ByCmpRqLcItem
				related.PurchasingCompany				= ContractTierMember.Company
				related.RequestingLocation		= ContractTierMember.RequestingLocation
			Instance Selection
				where (related.PoDate			>= Contract.EffectiveDate
				and    related.Item             = ContractLinesRel.ItemNumber)

		PolineFactsCompanyForContractRel
			one-to-many relation to PolineFact
			Field Mapping uses ByCompanyItem
				related.PurchasingCompany				= ContractTierMember.Company
				related.CmContract				= Contract
			Instance Selection
				where (related.PoDate			>= Contract.EffectiveDate
				and    related.Item             = ContractLinesRel.ItemNumber)

		PolineFactsCompanyLocationForContractRel
			one-to-many relation to PolineFact
			Field Mapping uses ByCompLocItem
				related.PurchasingCompany				= ContractTierMember.Company
				related.Location				= ContractTierMember.Location
				related.CmContract				= Contract
			Instance Selection
				where (related.PoDate			>= Contract.EffectiveDate
				and    related.Item             = ContractLinesRel.ItemNumber)

		PolineFactsCompanyRqLocForContractRel
			one-to-many relation to PolineFact
			Field Mapping uses ByCmpRqLcItem
				related.PurchasingCompany				= ContractTierMember.Company
				related.RequestingLocation		= ContractTierMember.RequestingLocation
				related.CmContract				= Contract
			Instance Selection
				where (related.PoDate			>= Contract.EffectiveDate
				and    related.Item             = ContractLinesRel.ItemNumber)

		TierQualifierCodesRel
			one-to-many relation to ContractTierQualifierCode
			Field Mapping uses symbolic key
          		related.ContractGroup 			= ContractGroup
           		related.Contract				= Contract
           		related.ContractTier  			= Tier
				related.ContractTierQualifier	= ContractTierQualifier
					
		PolineFactsAllMemberRel
			if (CompanyOnlyMember)
				PolineFactsCompanyAllRel
			else
			if (CompanyLocationMember)
				PolineFactsCompanyLocationAllRel
			else
			if (CompanyRqLocMember)
				PolineFactsCompanyRqLocAllRel
			else
				PolineFactsCompanyAllRel
