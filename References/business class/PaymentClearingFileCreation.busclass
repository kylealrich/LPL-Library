PaymentClearingFileCreation is a BusinessTask
    owned by ap
 
    Patterns
        implements ManualTransaction
        implements StaticJava
            Reports
                PaymentClearingFileCreationReport
                PaymentClearingFileCheck
                PaymentClearingFileIatError
                PaymentClearingFileRemit
                PaymentClearingErrorReport

    Parameters
    	VendorGroup
        PayGroup                
        PaymentCode             is a BankTransactionCode
        ProcGrp                 is a PayablesProcessGroup
        CashCode
        CashCodeGrp             is a CashCodeGroup
        PaymentCreationDefaults													

        CheckDate               is Date
        EffectiveDate           is Date
        StartTransNbr           is AlphaUpper size 18 
        PrintRemit              is AlphaUpper size 1
            States
                Yes value is "Y"
                No  value is "N"
        CreatePrenot            is AlphaUpper size 1
            States
                Yes value is "Y"
                No  value is "N"
        BacsSerialNbr           is AlphaRight size 6
        DocCurrency             is AlphaUpper size 1
            States
                AccountCurrency value is "A"
                InvoiceCurrency value is "I"
        PrintComments           is AlphaUpper size 1
            States
                No  value is "N"
                Yes value is "Y"
        UseAp150SortOpt         is AlphaUpper size 1
            States
                Yes value is "Y"
                No  value is "N"
        SendBankType            is Numeric size 1
            States
                BankId value is 0
                    default label is "Bank ID"
                Other  value is 1
        RecreateOption          is AlphaUpper size 1
            States
                Yes value is "Y"
                No  value is "N"
        SerialNum               is Numeric size 8
        TapeName                is AlphaUpper size 15
        RemitName               is Alpha size 15
        CreateLabelsOpt         is AlphaUpper size 1
            States
                Yes value is "Y"
                No  value is "N"
        Format                  is AlphaUpper size 1
            States
                Ppd value is "P"
                    default label is "PPD"
                PpdPlus value is "R"
                    default label is "PPD+"
                Ccd value is "C"
                    default label is "CCD"
                CcdPlus value is "D"
                    default label is "CCD+"
                Iat value is "I"
                    default label is "IAT"
        BalancedTape            is AlphaUpper size 1
            States
                Yes value is "Y"
                No  value is "N"
        Healthcare				is AlphaUpper size 1
            States
                Yes value is "Y"
                No  value is "N"
        FileName				is AlphaUpper size 50
        SuppressNoPaymentError  is Boolean
			default label is "SuppressNoPaymentError"
		PayablesElectronicTransferID		
		ImmediateOriginName	 is AlphaUpper size 1
			States
				Bank value is "B"
				PayGroup value is "P"
		SkipMonitor				is Boolean				

	Parameter Rules
		VendorGroup
			required
		PayGroup
			required
		PaymentCode
			required
        CheckDate
            initial value is PaymentCreationDefaults.DerivedPaymentDate	    	
            default to PaymentCreationDefaults.DerivedPaymentDate
            if (RecreateOption.Yes)
                initialize CheckDate
		EffectiveDate
            initial value is PaymentCreationDefaults.DerivedEffectiveDate		
            default to PaymentCreationDefaults.DerivedEffectiveDate
			required
		PrintRemit
            initial value is PaymentCreationDefaults.PrintRemit				    

            default to PaymentCreationDefaults.PrintRemit
			default to "Y"
			required
		CreatePrenot
            initial value is PaymentCreationDefaults.CreatePrenot				

            default to PaymentCreationDefaults.CreatePrenot
			default to "N"
		DocCurrency
            initial value is PaymentCreationDefaults.DocCurrency				

            default to PaymentCreationDefaults.DocCurrency
			default to "A"
		PrintComments
            initial value is PaymentCreationDefaults.PrintComments				

            default to PaymentCreationDefaults.PrintComments
			if (VendorGroup.VendorOffset)		
				PrintComments = "Y"
		UseAp150SortOpt
            initial value is PaymentCreationDefaults.UseAp150SortOpt			

            default to PaymentCreationDefaults.UseAp150SortOpt
			default to "N"
		SendBankType
            initial value is PaymentCreationDefaults.SendBankType			    

            default to PaymentCreationDefaults.SendBankType
			default to 0
		RecreateOption
			initial value is "N"
			default to "N"
			required
		CreateLabelsOpt
            initial value is PaymentCreationDefaults.CreateLabelsOpt			

            default to PaymentCreationDefaults.CreateLabelsOpt
			default to "Y"
			required
		Format
            initial value is PaymentCreationDefaults.Format         			

            default to PaymentCreationDefaults.Format
			default to "P"
			required
		BalancedTape
            initial value is PaymentCreationDefaults.BalancedTape      			

            default to PaymentCreationDefaults.BalancedTape
			default to "Y"
			required
		Healthcare
            initial value is PaymentCreationDefaults.Healthcare    			    

            default to PaymentCreationDefaults.Healthcare
			default to "N"
			required
		FileName		
			initial value is PayablesElectronicTransferID.PaymentOutputFileName
		SuppressNoPaymentError
            initial value is PaymentCreationDefaults.SuppressNoPaymentError		
            default to PaymentCreationDefaults.SuppressNoPaymentError
			if (CashCodeGrp not entered)
				SuppressNoPaymentError = false
		ImmediateOriginName
            initial value is PaymentCreationDefaults.ImmediateOriginName		

            default to PaymentCreationDefaults.ImmediateOriginName
			default to "B"
        BacsSerialNbr                                                           
            initial value is PaymentCreationDefaults.BacsSerialNbr
            default to PaymentCreationDefaults.BacsSerialNbr
	
    Actions
		PaymentClearingFileCreation is a Set Action
			allow unlimited concurrency
