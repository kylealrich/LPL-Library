FinanceTeam is a BusinessClass
	owned by sharedfinance
	prefix is FiTea
	
	Ontology
		symbolic key is FinanceTeam

	Patterns

	Persistent Fields
		Description						is Alpha 100
			translatable

	Local Fields
		LocalResource					is a FinanceResource
		FinanceTeamMember
		LocalGroupingForTeam			is Numeric 9
		LocalResourceList				is Alpha 250
		LocalFirstResourceFound			is Boolean

	Context Fields
		FinanceResource
							
	Field Rules

	Rule Blocks
		BuildResourceList
			LocalResourceList = ""
			LocalFirstResourceFound = false
			for each FinanceTeamMemberRel
				if (LocalFirstResourceFound)
					LocalResourceList = LocalResourceList + "," + each.FinanceTeamMember.TeamMember
				else
					LocalResourceList = each.FinanceTeamMember.TeamMember
					LocalFirstResourceFound = true

	Derived Fields
		DerivedResourceList is a DerivedField
			type is Alpha 250
			restricted
			include BuildResourceList
			return LocalResourceList

		NumberOfMembers is a ComputeField
			type is Numeric 6
			restricted
			(instance count of FinanceTeamMemberRel)

		DerivedFirstTeamMemberName is a DerivedField
			type is Alpha 230
			return first FinanceTeamMemberRel.FinanceTeamMember.TeamMember.PreferredSimplePresentationName





			



















			









			














			




		



















		




			




		
		NotOnTeam is a DerivedField
			type is Boolean
			restricted
			if (!FinanceResource in context)
				return true 
			LocalResource = FinanceResource 
			FinanceTeamMember.TeamMember = FinanceResource
			if (!FinanceTeamMember exists)
				return true	
				
	Conditions
		HasMembers
			restricted
			when (NumberOfMembers > 0)
		HasNoMembers
			restricted
			when (NumberOfMembers < 1)












		ShowTeamMembers
			restricted
			when (FinanceTeamMember set exists)	
		ResourceNotOnTeam
			restricted
			when (NotOnTeam)
		HasInactiveMembers
			restricted
			when (InactiveFinanceTeamMemberRel exists)
		ActiveTeamMemberExists
			restricted
			when (ActiveTeamMemberRel exists)

	Relations
		FinanceResourceRel is a FinanceResource set

		FinanceTeamMemberRel is a FinanceTeamMember set

		InactiveFinanceTeamMemberRel is a FinanceTeamMember set
			Instance Selection
				where (!related.ActiveResource)

		ActiveTeamMemberRel is a FinanceTeamMember set
			Instance Selection
				where (related.ActiveResource)

		NotOnTeamRel 
			one-to-many relation to FinanceResource
			Field Mapping uses symbolic key
				related.HROrganization = FinanceEnterpriseGroup.HROrganization
			Instance Selection 
				where (ResourceNotOnTeam)		

		FinanceTeamMemberBySearchNameRel
            one-to-many relation to FinanceTeamMember
            Field Mapping uses BySearchName
                related.FinanceEnterpriseGroup 	= FinanceEnterpriseGroup
				related.FinanceTeam 			= FinanceTeam	
				
								














				















































				







				







						
	Sets
		ByDescription
			Sort Order
				Description
				FinanceEnterpriseGroup
				FinanceTeam

	Attach Rules

    Actions
		Create is a Create Action
			
		Update is an Update Action
			
		Delete is a Delete Action
			Action Rules 
				constraint (HasNoMembers)
					"PleaseRemoveAllMembersFromTheTeamAndThenDeleteTheTeam"
					 					
		Purge is a Purge Action
				
		AddMember is an Instance Action
			Parameters
				LocalResource					is a FinanceResource
			Action Rules
				invoke AddMember FinanceTeamMember
					invoked.FinanceEnterpriseGroup 			= FinanceEnterpriseGroup
					invoked.FinanceTeamMember.TeamMember 	= LocalResource
					invoked.FinanceTeam 					= FinanceTeam
