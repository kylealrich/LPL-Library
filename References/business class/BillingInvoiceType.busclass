BillingInvoiceType is a BusinessClass
    owned by bl
    prefix is OIN
    classic name is OEINVCTYPE

    Ontology
        symbolic key is BillingInvoiceType
            classic set name is OINSET1
            classic name is INVC-TYPE

    Patterns
        implements StaticJava
        disable AuditIndex

    Persistent Fields

        Description
            classic name is INVC-DESC
       	InUse            is Boolean
            classic name is INVC-USED-FL
		Credit			 is Boolean	
			classic name is INVC-CRED-FL
        Returns	         is Boolean
            classic name is INVC-RTRN-FL
        Active           is Boolean
            classic name is INVC-ACT-FL
        Format			 is Boolean
            classic name is FORMAT-FL
        Summary			 is Boolean
            classic name is SUMMARY-FL
        SummaryTopComment1    is a StdComm
            classic name is SUMM-TOP-COMM1
        SummaryTopComment2    is a StdComm
            classic name is SUMM-TOP-COMM2
        SummaryTopComment3    is a StdComm
            classic name is SUMM-TOP-COMM3
        SummaryBottomComment1 is a StdComm
            classic name is SUMM-TRL-COMM1
        SummaryBottomComment2 is a StdComm
            classic name is SUMM-TRL-COMM2
        SummaryBottomComment3 is a StdComm
            classic name is SUMM-TRL-COMM3
        BillingInvoiceTypeIDMTemplate is an IDMTemplate
        	default label is "BillingInvoiceIDMTemplate"
        BillingInvoiceDocument
        	default label is "BillingInvoiceTemplate"
 		BillingInvoiceEmailTemplate			is an IDMTemplate
			default label is "BillingInvoiceIDMEmailTemplate"
		BillingInvoiceEmailSubject			is Alpha size 255
			default label is "BillingInvoiceIDMEmailSubject"
			Text Variables
				CompanyName
				InvoiceNumber
				InvoiceDate	
	
	Local Fields
		LocalBillingInvoiceIDMEmailSubject	is Alpha size 255
			Text Variables
				CompanyName			  value is Company.Name
				InvoiceNumber		  value is "IL1234"
				InvoiceDate			  value is current corporate date			

    Conditions

        IsCreditYes
        	restricted
            when (Credit)

        IsReturnYes
        	restricted
            when (Returns)

        IsTypeUsed
        	restricted
            when (not InUse)

		IsDebit
			restricted
			when (not Credit)
    
    Relations
		BillingInvoiceRel
			one-to-many relation to BillingInvoice
			Field Mapping uses symbolic key
				related.Company						= Company
			Instance Selection
				where (related.BillingInvoiceType	= BillingInvoiceType)
       	
       	SummaryTopComment1Rel
            one-to-one relation to BillingStandardCommentHeader
            Field Mapping uses symbolic key
                related.Company                      = Company
                related.BillingStandardCommentHeader = SummaryTopComment1

       	SummaryTopComment2Rel
            one-to-one relation to BillingStandardCommentHeader
            Field Mapping uses symbolic key
                related.Company                      = Company
                related.BillingStandardCommentHeader = SummaryTopComment2

        SummaryTopComment3Rel
            one-to-one relation to BillingStandardCommentHeader
            Field Mapping uses symbolic key
                related.Company                      = Company
                related.BillingStandardCommentHeader = SummaryTopComment3

        SummaryBottomComment1Rel
            one-to-one relation to BillingStandardCommentHeader
            Field Mapping uses symbolic key
                related.Company                      = Company
                related.BillingStandardCommentHeader = SummaryBottomComment1

        SummaryBottomComment2Rel
            one-to-one relation to BillingStandardCommentHeader
            Field Mapping uses symbolic key
                related.Company                      = Company
                related.BillingStandardCommentHeader = SummaryBottomComment2

        SummaryBottomComment3Rel
            one-to-one relation to BillingStandardCommentHeader
            Field Mapping uses symbolic key
                related.Company                      = Company
                related.BillingStandardCommentHeader = SummaryBottomComment3

    Field Rules

        Active
            default to true

		Credit
			if (InUse)
				cannot be changed
					"CannotChangeCreditIfInvoiceTypeIsUsed"			

        Returns
			if (Returns)
				constraint (Credit)
					"CreditMustBeSelectedWhenReturnsIsSelected"	
			
			if (InUse)
				cannot be changed
					"CannotChangeReturnIfInvoiceTypeIsUsed"			
			
		Description
			required

		BillingInvoiceTypeIDMTemplate
			constraint (BillingInvoiceTypeIDMTemplate.IDMDocumentType.BillingInvoice)
				"InvalidTemplate"

		BillingInvoiceEmailTemplate
			constraint (BillingInvoiceEmailTemplate.IDMDocumentType.BillingInvoiceEmail)
				"InvalidTemplate"
	
		InUse
    		if (BillingInvoiceRel exists)
    			InUse = true
			else
				initialize InUse
    			
	Attach Rules
		
		constraint (Active)
			"InvoiceTypeIsInactive"		


	Derived Fields
        RepresentativeText is a StringField
			type is Text
			default label is "BillingInvoiceType"
			BillingInvoiceType " - " Description

		DerivedBillingInvoiceIDMEmailSubject	is a DerivedField
			type is AlphaUpper size 255
			restricted
			LocalBillingInvoiceIDMEmailSubject		=	BillingInvoiceEmailSubject
			return LocalBillingInvoiceIDMEmailSubject text		

		
	Actions
		Create is a Create Action
		
		Delete is a Delete Action
		
		Update is an Update Action			
				
				
				
				
				
				
