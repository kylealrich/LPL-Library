PurchaseAndSalesReportBelgiumOutputHeader is a BusinessClass
    owned by tx
    prefix is PBOH
    sql name is PASRBOHeader

    Ontology
        symbolic key is PurchaseAndSalesReportBelgiumOutputHeader

    Patterns
        implements StaticJava
        disable AuditIndex

    Persistent Fields
    	FileName					is AlphaUpper 50
		CreateDate					is TimeStamp

        Company                 	is a GeneralLedgerCompany	
        TaxCalendar       
        TaxCalendarPeriod
        UpdateOption				is Boolean
        	default label is "Update"
        Rerun                   	is Boolean
    	DetailFile					is a PaymentAttachment

	Transient Fields
    
    Local Fields
		    
    Derived Fields
		TotalRecordCount is a ComputeField
			type is Numeric 5
			(instance count of PurchaseAndSalesReportBelgiumOutputDetail set)

    Conditions
		HasDetailAttachment
			restricted
			when (DetailFile entered)

    Relations

    Sets
    	ByCreateDate
    		Sort Order
    			CreateDate				descending
    			FinanceEnterpriseGroup
    			PurchaseAndSalesReportBelgiumOutputHeader

    Field Rules
        CreateDate
            default to current timestamp 

		FileName
			default to "PurchaseAndSalesReportBelgium"            

		
	Actions
		Create is a Create Action
			restricted
				
		Update is an Update Action
			restricted
		
		Delete is a Delete Action
			restricted
		
		Purge is a Purge Action
			restricted

		FinishProcessing is an Instance Action
			restricted
			Action Rules
				trigger "PurchaseAndSalesReportBelgiumFile" PA service
					resume on error
					title is "CreatePurchaseAndSalesReportBelgiumFiles"
					Variables
						FinanceEnterpriseGroup
						PurchaseAndSalesReportBelgiumOutputHeader
						FileName

		CreateOutputFile is an Instance Action
			Action Rules
				trigger "PurchaseAndSalesReportBelgiumFile" PA service
					resume on error
					title is "CreatePurchaseAndSalesReportBelgiumFile"
					Variables
						FinanceEnterpriseGroup
						PurchaseAndSalesReportBelgiumOutputHeader
						FileName
			
		PurgeHeaders is a Set Action
			run in foreground
			completion message is "PurgeCompleted"
			Parameters
				PrmFinanceEnterpriseGroup	is a FinanceEnterpriseGroup
				PrmCreateDateRange			is a DateRange 
				
			Parameter Rules
				PrmCreateDateRange
					required
				FinanceEnterpriseGroup
					required
			Instance Selection
				where (CreateDate date within PrmCreateDateRange
				and    FinanceEnterpriseGroup = PrmFinanceEnterpriseGroup)
	
			Action Rules
				Instance Rules
					invoke Purge
						
