VertexFlexibleFields is a BusinessClass					
    owned by tx
	prefix is Flexf

    Ontology
        symbolic key is VertexFlexibleFields

    Patterns
        disable Auditing
        disable EffectiveDated
        disable UniqueID

	Persistent Fields
		UniqueIdOfRelatedObject is UniqueID			 
		Description 			is Alpha 60
		DisplayFlexibleFields 	is RichText
		 

	Relations		

		VertexFlexibleCodeRel
			one-to-many relation to VertexFlexibleCode
			delete cascades
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup			= FinanceEnterpriseGroup 
			Instance Selection	
				where (related.VertexFlexibleFields 	= VertexFlexibleFields)			

		VertexFlexibleNumericRel
			one-to-many relation to VertexFlexibleNumeric
			delete cascades
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup			= FinanceEnterpriseGroup 
			Instance Selection	
				where (related.VertexFlexibleFields 	= VertexFlexibleFields)	

		VertexFlexibleDateRel
			one-to-many relation to VertexFlexibleDate
			delete cascades
			Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup			= FinanceEnterpriseGroup 
			Instance Selection	
				where (related.VertexFlexibleFields 	= VertexFlexibleFields)	
				
				
	Transient Fields
		FlexibleFields 			is a VertexAttributeGroup	 
		
	Local Fields
		FieldIdAlpha 			is Alpha 3

		FlexNumericNbrOfDec		is Alpha 2
		Flexible				is Alpha 8	

		FieldId 	 			is Numeric 3		 
		FlexValue	 			is Alpha 250				 
		ExternalValue	 		is a DynamicField
		FlexDesc	 			is Alpha 30		
		StringTableValues	 	is Text
		LocalFlexibleFields 	is a VertexAttributeGroup	 
		FlxLineIdx				is Numeric 3

		
	Field Rules
	
	Conditions		 
		VertexFlexibleFieldExist
			restricted
			when (VertexFlexibleCodeRel exist
			or    VertexFlexibleNumericRel exist
			or    VertexFlexibleDateRel exist)		 
			
	Derived Fields



		TableStyle2 is a StringField
			type is Text
			restricted
			"	<style>                                    "
			"	table, th, td {                            "
			"		font-family: courier, serif;           "
			"		border: 2px solid black;               "		 
			"		border-collapse: collapse;             "
			"	}                                          "
			"	</style>                                   "
		BeginFlexibleFields is a StringField	
			type is Text 
			restricted			
			TableStyle2											 
			"<table>"          		
			" <h1> "
			"  <tr>                                        "
			"	<th colspan=6>Vertex Flexible Fields</th>"	 
			"  </tr>                                       "
			" </h1> "
			"  <tr>                                        "
			"	<th>Field Id</th>"	 			
			"	<th>Field Value</th>"	
			"	<th>External Value</th>"	 
			"	<th>Dynamic Type</th>"	 			
			"	<th>Description</th>"	 			
			"	<th> </th>"	 			
			"  </tr>                                       "		
		FlexibleFieldsHeader is a StringField	
			type is Text   	
			" <h2> "
			"  <tr>                                        "
			"	<th>Field Id</th>"	 			
			"	<th>Field Value</th>"	
			"	<th>External Value</th>"	 
			"	<th>Dynamic Type</th>"	 			
			"	<th>Description</th>"	 			
			"	<th> </th>"	 			
			"  </tr>                                       "
			" </h2> "	
		CodeBanner is a StringField	 
			type is Text  
			" <h1> "
			"  <tr>                                        "
			"	<th colspan=6; text-align: left;>Codes</th> "	
			"  </tr>                                       "
			" </h1> "			
		NumericBanner is a StringField	 
			type is Text   						 
			" <h1> "
			"  <tr>                                        "
			"	<th colspan=6; text-align: left;>Numerics</th> "	
			"  </tr>                                       "
			" </h1> "						
		FlexibleNumericsHeader is a StringField	 
			type is Text    		
			" <h2> "
			"  <tr>                                        "	
			"	<th> </th>"	 
			"	<th> </th>"	 
			"	<th> </th>"	 
			"	<th> </th>"	 	
			"	<th> </th>"	 				
			"	<th>Decimals</th>"	 						
			"  </tr>                                       "
			" </h2> "
		DateBanner is a StringField	 
			type is Text   							 
			" <h1> "
			"  <tr>                                        "
			"	<th colspan=6; text-align: left;>Dates</th> "			
			"  </tr>                                       "
			" </h1> "									
		DetailHeader is a StringField
			type is Text   
			restricted		
			"  <tr>                                        	"			
			"	<td>FieldId</td>                  			"
			"	<td>FieldValue</td>                			"
			"	<td>ExternalValue</td> "
			"	<td>DynamicType</td>              			"					
			"	<td>Description</td> "
			"	<td>       </td>             			    "			
			"  </tr>                                       	"
		FlexibleFieldDetail is a StringField
			type is Text  
			restricted		
			"  <tr>                            	 "			
			"	<td>" FieldIdAlpha		      "</td> "
			"	<td width: 50%;>" FlexValue	  "</td> "
			"	<td>" DynamicFieldLabel	 	  "</td> "		
			"	<td>" DynamicTypeLabel        "</td> "			
			"	<td>" FlexDesc	 		  "</td> "
			"	<td>" FlexNumericNbrOfDec "</td> "			
			"  </tr>    					     "
		EndFlexFieldsTable is a StringField	 
			type is Text 
			restricted
			"</table>"
			"</pre>"	

		DynamicFieldLabel is a MessageField 
			restricted
			"<ExternalValue.ValueIs>"		

		DynamicTypeLabel is a MessageField	
			restricted		
			"<ExternalValue.DynamicType>" 		 
			
		DisplayLineItemFlexibleFields is a DerivedField	 
			type is Text
			restricted
			default label is untranslatable			
			initialize StringTableValues
			StringTableValues = StringTableValues + BeginFlexibleFields 
			StringTableValues = StringTableValues + CodeBanner			

			FlxLineIdx = 0			
			for each VertexFlexibleCodeRel
				FlxLineIdx +=1 
				LocalFlexibleFields.VertexCodes.FlexibleCode[FlxLineIdx].FieldId = each.VertexFlexibleCode.FieldId
				FlexNumericNbrOfDec = blank
				FieldIdAlpha = each.VertexFlexibleCode.FieldId
				FlexValue = each.Code
				ExternalValue = each.ExternalValue 
				FlexDesc = each.Description
				StringTableValues = StringTableValues + FlexibleFieldDetail


			StringTableValues = StringTableValues + DateBanner
			for each VertexFlexibleDateRel	
				FlexNumericNbrOfDec = blank
				FieldIdAlpha = each.VertexFlexibleDate.FieldId
				FlexValue = each.DateAlpha10MMDDCCYY
				ExternalValue = each.ExternalValue 
				FlexDesc = each.Description
				StringTableValues = StringTableValues + FlexibleFieldDetail
						

			StringTableValues = StringTableValues + NumericBanner
			StringTableValues = StringTableValues + FlexibleNumericsHeader								
			for each VertexFlexibleNumericRel	
				FlexNumericNbrOfDec = each.NumberOfDecimals
				FieldIdAlpha = each.VertexFlexibleNumeric.FieldId
				if (each.ExternalValue entered
				and each.ExternalValue.DynamicType.Numeric)
					each.ConvertNumericValue 		= 900.50
					each.ConvertNumberOfDecimals	= each.NumberOfDecimals	 
					FlexValue 						= each.ConvertNumericsDerivedField
				else
					FlexValue = each.DerivedDecimalValue
				ExternalValue = each.ExternalValue 
				FlexDesc = each.Description
				StringTableValues = StringTableValues + FlexibleFieldDetail
									
			StringTableValues = StringTableValues + EndFlexFieldsTable  
																				
			return StringTableValues					

		LoadFieldsToLocalArray2 is a DerivedField	  
			type is Text
			restricted			 
			default label is untranslatable			
			initialize StringTableValues
			StringTableValues = StringTableValues + BeginFlexibleFields 
			StringTableValues = StringTableValues + CodeBanner			



			FlxLineIdx = 0			
			for each VertexFlexibleCodeRel
				FlxLineIdx +=1 
				LocalFlexibleFields.VertexCodes.FlexibleCode[FlxLineIdx].FieldId 		= each.VertexFlexibleCode.FieldId
				LocalFlexibleFields.VertexCodes.FlexibleCode[FlxLineIdx].Code 			= each.Code			 
				LocalFlexibleFields.VertexCodes.FlexibleCode[FlxLineIdx].ExternalValue 	= each.ExternalValue	 
				LocalFlexibleFields.VertexCodes.FlexibleCode[FlxLineIdx].Description	= each.Description	 



				FlexNumericNbrOfDec 			= blank
				FieldIdAlpha 					= LocalFlexibleFields.VertexCodes.FlexibleCode[FlxLineIdx].FieldId 
				FlexValue 						= LocalFlexibleFields.VertexCodes.FlexibleCode[FlxLineIdx].Code
				ExternalValue 					= LocalFlexibleFields.VertexCodes.FlexibleCode[FlxLineIdx].ExternalValue 
				FlexDesc 						= LocalFlexibleFields.VertexCodes.FlexibleCode[FlxLineIdx].Description	
				StringTableValues = StringTableValues + FlexibleFieldDetail
				



			FlxLineIdx = 0			
			StringTableValues = StringTableValues + DateBanner
			for each VertexFlexibleDateRel
				FlxLineIdx +=1 
				LocalFlexibleFields.VertexDates.FlexibleDate[FlxLineIdx].FieldId 			= each.VertexFlexibleDate.FieldId
				LocalFlexibleFields.VertexDates.FlexibleDate[FlxLineIdx].DateValue 			= each.DateValue			 
				LocalFlexibleFields.VertexDates.FlexibleDate[FlxLineIdx].ExternalValue 		= each.ExternalValue	 
				LocalFlexibleFields.VertexDates.FlexibleDate[FlxLineIdx].Description		= each.Description	 



				FlexNumericNbrOfDec 			= blank
				FieldIdAlpha 					= LocalFlexibleFields.VertexDates.FlexibleDate[FlxLineIdx].FieldId 
				FlexValue 						= LocalFlexibleFields.VertexDates.FlexibleDate[FlxLineIdx].DateAlpha10MMDDCCYY
				ExternalValue 					= LocalFlexibleFields.VertexDates.FlexibleDate[FlxLineIdx].ExternalValue 
				FlexDesc 						= LocalFlexibleFields.VertexDates.FlexibleDate[FlxLineIdx].Description	
				StringTableValues = StringTableValues + FlexibleFieldDetail
				



			FlxLineIdx = 0			
			StringTableValues = StringTableValues + NumericBanner
			StringTableValues = StringTableValues + FlexibleNumericsHeader	
			for each VertexFlexibleNumericRel
				FlxLineIdx +=1 
				LocalFlexibleFields.VertexNumerics.FlexibleNumeric[FlxLineIdx].FieldId 			= each.VertexFlexibleNumeric.FieldId
				LocalFlexibleFields.VertexNumerics.FlexibleNumeric[FlxLineIdx].NumericValue 	= each.OutputNumericValue	 
				LocalFlexibleFields.VertexNumerics.FlexibleNumeric[FlxLineIdx].NumberOfDecimals = each.NumberOfDecimals						
				LocalFlexibleFields.VertexNumerics.FlexibleNumeric[FlxLineIdx].ExternalValue 	= each.ExternalValue	   	 
				LocalFlexibleFields.VertexNumerics.FlexibleNumeric[FlxLineIdx].Description		= each.Description	 



				FieldIdAlpha 					= LocalFlexibleFields.VertexNumerics.FlexibleNumeric[FlxLineIdx].FieldId 
				FlexValue 						= LocalFlexibleFields.VertexNumerics.FlexibleNumeric[FlxLineIdx].OutputNumericValue	 
				ExternalValue 					= LocalFlexibleFields.VertexNumerics.FlexibleNumeric[FlxLineIdx].ExternalValue 
				FlexDesc 						= LocalFlexibleFields.VertexNumerics.FlexibleNumeric[FlxLineIdx].Description
				FlexNumericNbrOfDec 			= LocalFlexibleFields.VertexNumerics.FlexibleNumeric[FlxLineIdx].NumberOfDecimals				
				StringTableValues = StringTableValues + FlexibleFieldDetail	

			StringTableValues = StringTableValues + EndFlexFieldsTable  	
			FlexibleFields = LocalFlexibleFields			
			return StringTableValues	

		LoadFieldsToLocalArray is a DerivedField	  
			type is Text
			restricted			 
			default label is untranslatable			
			initialize StringTableValues
			StringTableValues = StringTableValues + BeginFlexibleFields 
			StringTableValues = StringTableValues + CodeBanner			



			FlxLineIdx = 0			
			for each VertexFlexibleCodeRel
				FlxLineIdx +=1 
				LocalFlexibleFields.VertexCodes.FlexibleCode[FlxLineIdx].FieldId 		= each.VertexFlexibleCode.FieldId
				if (each.ExternalValue entered)
					if (each.ExternalValue.ValueIs.TaxEntity)
						LocalFlexibleFields.VertexCodes.FlexibleCode[FlxLineIdx].Code	= "1234"
					else	
					if (each.ExternalValue.ValueIs.Company)
						LocalFlexibleFields.VertexCodes.FlexibleCode[FlxLineIdx].Code	= "4567"
					else
					if (each.ExternalValue.ValueIs.Vendor)
						LocalFlexibleFields.VertexCodes.FlexibleCode[FlxLineIdx].Code	= "VendorABC"
					else						
					if (each.ExternalValue.DynamicType.Numeric)
						LocalFlexibleFields.VertexCodes.FlexibleCode[FlxLineIdx].Code	= 1000	
					else
					if (each.ExternalValue.DynamicType.Date)		
						LocalFlexibleFields.VertexCodes.FlexibleCode[FlxLineIdx].Code	= current corporate date					
				else
					LocalFlexibleFields.VertexCodes.FlexibleCode[FlxLineIdx].Code 		= each.Code			 
				LocalFlexibleFields.VertexCodes.FlexibleCode[FlxLineIdx].ExternalValue 	= each.ExternalValue	 
				LocalFlexibleFields.VertexCodes.FlexibleCode[FlxLineIdx].Description	= each.Description	 



				FlexNumericNbrOfDec 			= blank
				FieldIdAlpha 					= LocalFlexibleFields.VertexCodes.FlexibleCode[FlxLineIdx].FieldId 
				FlexValue 						= LocalFlexibleFields.VertexCodes.FlexibleCode[FlxLineIdx].Code
				ExternalValue 					= LocalFlexibleFields.VertexCodes.FlexibleCode[FlxLineIdx].ExternalValue 
				FlexDesc 						= LocalFlexibleFields.VertexCodes.FlexibleCode[FlxLineIdx].Description	
				StringTableValues = StringTableValues + FlexibleFieldDetail
				



			FlxLineIdx = 0			
			StringTableValues = StringTableValues + DateBanner
			for each VertexFlexibleDateRel
				FlxLineIdx +=1 
				LocalFlexibleFields.VertexDates.FlexibleDate[FlxLineIdx].FieldId 			= each.VertexFlexibleDate.FieldId
				if (each.ExternalValue entered)
					if (each.ExternalValue.DynamicType.Date)
						LocalFlexibleFields.VertexDates.FlexibleDate[FlxLineIdx].DateValue	= current corporate date					
				else
					LocalFlexibleFields.VertexDates.FlexibleDate[FlxLineIdx].DateValue 		= each.DateValue			 
				LocalFlexibleFields.VertexDates.FlexibleDate[FlxLineIdx].ExternalValue 		= each.ExternalValue	 
				LocalFlexibleFields.VertexDates.FlexibleDate[FlxLineIdx].Description		= each.Description	 



				FlexNumericNbrOfDec 			= blank
				FieldIdAlpha 					= LocalFlexibleFields.VertexDates.FlexibleDate[FlxLineIdx].FieldId 
				FlexValue 						= LocalFlexibleFields.VertexDates.FlexibleDate[FlxLineIdx].DateAlpha10MMDDCCYY
				ExternalValue 					= LocalFlexibleFields.VertexDates.FlexibleDate[FlxLineIdx].ExternalValue 
				FlexDesc 						= LocalFlexibleFields.VertexDates.FlexibleDate[FlxLineIdx].Description	
				StringTableValues = StringTableValues + FlexibleFieldDetail
				



			FlxLineIdx = 0			
			StringTableValues = StringTableValues + NumericBanner
			StringTableValues = StringTableValues + FlexibleNumericsHeader	
			for each VertexFlexibleNumericRel
				FlxLineIdx +=1 
				LocalFlexibleFields.VertexNumerics.FlexibleNumeric[FlxLineIdx].FieldId 				= each.VertexFlexibleNumeric.FieldId
				if (each.ExternalValue entered)
					if (each.ExternalValue.DynamicType.Numeric)
						LocalFlexibleFields.VertexNumerics.FlexibleNumeric[FlxLineIdx].NumericValue	= 900.50					
				else
					LocalFlexibleFields.VertexNumerics.FlexibleNumeric[FlxLineIdx].NumericValue 	= each.OutputNumericValue	
				LocalFlexibleFields.VertexNumerics.FlexibleNumeric[FlxLineIdx].NumberOfDecimals 	= each.NumberOfDecimals						
				LocalFlexibleFields.VertexNumerics.FlexibleNumeric[FlxLineIdx].ExternalValue 		= each.ExternalValue	
				LocalFlexibleFields.VertexNumerics.FlexibleNumeric[FlxLineIdx].Description			= each.Description	 



				FieldIdAlpha 					= LocalFlexibleFields.VertexNumerics.FlexibleNumeric[FlxLineIdx].FieldId 
				FlexValue 						= LocalFlexibleFields.VertexNumerics.FlexibleNumeric[FlxLineIdx].OutputNumericValue	 
				ExternalValue 					= LocalFlexibleFields.VertexNumerics.FlexibleNumeric[FlxLineIdx].ExternalValue 
				FlexDesc 						= LocalFlexibleFields.VertexNumerics.FlexibleNumeric[FlxLineIdx].Description
				FlexNumericNbrOfDec 			= LocalFlexibleFields.VertexNumerics.FlexibleNumeric[FlxLineIdx].NumberOfDecimals				
				StringTableValues = StringTableValues + FlexibleFieldDetail	

			StringTableValues = StringTableValues + EndFlexFieldsTable  	
			FlexibleFields = LocalFlexibleFields			
			return StringTableValues	
			
	Actions
		Create is a Create Action
			restricted					 
		Update is an Update Action
		Delete is a Delete Action


		DisplayAllFields  is an Instance Action	 						 
			Action Rules
				initialize DisplayFlexibleFields
				DisplayFlexibleFields =  DisplayLineItemFlexibleFields	
				
		LoadFieldsToArray is an Instance Action	 
			restricted								 
			Action Rules
				initialize DisplayFlexibleFields
				DisplayFlexibleFields = LoadFieldsToLocalArray
				FlexibleFields = LocalFlexibleFields				 
				
