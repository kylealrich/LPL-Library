ManufacturerContractPivot is a BusinessClass
    owned by po
    prefix is MFGP
    
    Ontology
  		symbolic key is ManufacturerContractPivot

    Persistent Fields
    	
    Local Fields
     	LocalMfgContract			is a Contract       
        LocalMfgCompany     		is an InventoryCompany
        LocalMfgLocation    		is an InventoryLocation
        LocalMfgReqLocation 		is a RequestingLocation
        LocalDistributorContract 	is a Contract
        LocalPricingGroup           is a PricingGroup
        
	Relations
		ContractRel
			one-to-one relation to Contract
			Field Mapping uses symbolic key
				related.ContractGroup = ContractGroup
				related.Contract      = ManufacturerContractPivot
				
		MfgContractRel
			one-to-one relation to ManufacturerContract
			Field Mapping uses ByPivotId
				related.ContractGroup 				= ContractGroup
				related.Contract      				= LocalMfgContract
				related.ManufacturerContractNumber  = ManufacturerContractPivot
				
		PricingMembersRel
			one-to-one relation to ContractDistributorPricingMember
			Field Mapping uses symbolic key
				related.ContractGroup 								 		= ContractGroup
				related.Contract      								 		= LocalMfgContract
				related.ContractDistributorPricingMember.Company	 		= LocalMfgCompany
				related.ContractDistributorPricingMember.Location	 		= LocalMfgLocation
				related.ContractDistributorPricingMember.RequestingLocation	= LocalMfgReqLocation
				related.ContractDistributorPricingMember.PricingGroup       = LocalPricingGroup
				related.ContractDistributorPricingMember.ManufacturerContract = ManufacturerContractPivot
				
		DefaultPricingRel
			one-to-many relation to ContractDistributorPricing
			Field Mapping uses symbolic key
				related.ContractGroup 									= ContractGroup
				related.Contract      									= LocalDistributorContract
            Instance Selection
            	where (related.DefaultDistributorPricing		= "Y")
		
  	Field Rules
  			
  	
  	Actions     	 	
 		Create is a Create Action
 			restricted
 		
 		Update is an Update Action
 			restricted
 		
 		Delete is a Delete Action
 			restricted
 			
 		PurgeClosedContract is a Purge Action
 			restricted
 			Entrance Rules
 				invoke Purge MfgContractMemberPivot set
 				invoke Purge MfgContractLinePivot set
 			Action Rules
							
		AttachMfgToContract is an Instance Action
			Parameters
				Contract 
			Parameter Rules
				Contract
					required
			Action Rules
    			constraint (ContractRel.ContractTierMember set exists)
					"CannotAttachManufacturerContract;NoTierMembersExist"
				constraint (!ContractRel.NoTierMemberRel exists)
					"CannotAttachManufacturerContract;NotAllMembersHaveBeenAssignedTiers"
				constraint (ContractRel.TierMemberPurchaseFromDistributorRels exists)
					"CannotAttachManufacturerContract;NoTierMembersExistForDistributorContract"
				LocalMfgContract								= Contract
				constraint (!MfgContractRel exists)
					"CannotAttachManufacturerContract;AlreadyAttachedToDistributorContract"
				if (!MfgContractRel exists)
					invoke Create ManufacturerContract
						invoked.ContractGroup   				= ContractGroup
						invoked.Contract      		    		= Contract
						invoked.ManufacturerContractNumber		= ContractRel.Contract
		      	else
					invoke Update MfgContractRel
						invoked.ContractGroup   				= ContractGroup
						invoked.Contract      		    		= Contract
						invoked.ManufacturerContractNumber		= ContractRel.Contract
		      	

