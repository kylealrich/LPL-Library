POInterfaceResult is a BusinessClass
	owned by po
	prefix is POIR
	
	Ontology
		symbolic key is POInterfaceResult
	
	Patterns
        disable AuditIndex
       	disable EffectiveDated
       	disable Auditing
	
	Persistent Fields
		RunDateStart				is TimeStamp
			default label is "RunTime"
		RunDateEnd					is TimeStamp
		ProcessedCount				is Numeric 9
			default label is "ProcessedRequests"
		RejectedCount				is Numeric 9
			default label is "RejectedRequests"
		PurchaseOrderCount			is Numeric 9
			default label is "CreatedPurchaseOrders"
		Actor
		Status						is Numeric 1
			States
				InProcess       value is 0
				Complete		value is 1
				Incomplete 		value is 2


		Company						is like PurchasingCompany 
        ProcessByProcurementGroup 	is Boolean 
			default label is "ProcessAllCompaniesInProcurementGroup"
		ProcurementGroup			is like GeneralLedgerCompanyGroup
        DefaultBuyer				is like Buyer
        IncludeAllCostOptions		is AlphaUpper size 1
            States
                Yes 				value is "Y"
                CostRequiredOnly  	value is "N"
        DefaultDeliveryDays			is Numeric size 3
        ReleasePurchaseOrder		is Boolean
        PrintPOComments				is Boolean
        CombineOnPOLine             is Boolean
        OneShipToPerPO				is Boolean
        ReportLevel             	is Numeric size 1
            States
                Summary		value is 1
                Detail 		value is 2
        MaximumPOLines				is like RequisitionLine
        PrintByPOStatus				is Numeric size 1
            States
                All    		value is 0
                Unreleased 	value is 1
                Released	value is 2
        PrintExceptionReport		is Numeric size 1
            States
                DoNotPrintExceptionReport	value is 0
                    default label is "Do not print Exception Report"
                SortByVendorPurchFr			value is 1
                    default label is "Sort by Vendor/Purchase From"
                SortByItem					value is 2
                    default label is "Sort by Item"
                SortBySourceDocument		value is 3
                    default label is "Sort by Source Document"
                SortByBuyerCode				value is 4
                    default label is "Sort by Buyer Code"
        SystemCode              	is AlphaUpper size 2
            States
                InventoryControl  value is "IC"
                Requisitions      value is "RQ"
                OrderEntry        value is "OE"
                CaseCarts         value is "CX"
                StrategicSourcing value is "SS"
        VendorOption          		is AlphaUpper size 1
            States
                Include 	value is "I"
                Exclude 	value is "E"
        Vendor						is like VendorArray
        FilterBuyer            		is like Buyer
        BuyerOnPurchasingClasses	is Boolean
        BuyerOnVendor				is Boolean
        BuyerOnLocation				is Boolean
        BuyerOnRequestingLocation	is Boolean
        FilterDeliveryDays			is Numeric size 3
        FilterFromPriority			is Numeric size 2
        FilterToPriority			is Numeric size 2
        FilterLocation				is like InventoryLocation
        FilterReportGroup			is like InventoryReportGroup
        POCodeOption				is AlphaUpper size 1
            States
                Include 	value is "I"
                Exclude 	value is "E"
        FilterPOCode				is like POCodeArray
        FilterMajorPurchasingClass	is like MajorPurchasingClass
        FilterMinorPurchasingClass	is like MinorPurchasingClass
        FilterRequestingCompany		is like InventoryCompany
        FilterRequestingLocation	is like RequestingLocation
        FilterRequisition			is Numeric size 7
  		FilterItem					is like Item	
        FilterItemType				is AlphaUpper size 1
            States
                Inventory 	value is "I"
                Nonstock  	value is "N"
                Special   	value is "X"
                Service   	value is "S"
        FilterManufacturer			is like Manufacturer
        FilterProcurementTemplate	is Numeric size 8
        BillCodeOption				is AlphaUpper size 1
            States
                Include 	value is "I"
                Exclude 	value is "E"
        FilterConsignCode			is like ConsignCodeArray
        FilterAccountingUnit		is like AccountingUnit
        FilterActivity				is like Project
        FilterCostCode				is like CostCode	
        
    Local Fields
    	LocalPOCount				is Numeric 9
		LocalActor					is an Actor		

	Sets
		ByRunTime
			Sort Order
				RunDateStart descending
				FinanceEnterpriseGroup
				Company

	Conditions
		HasProcessed
			restricted
			when (ProcessedPOInterfaceResultDetailRel exists)

		NoRecords
			restricted
			when (not HasProcessed
			and	  not HasRejected
			and   Status.Complete)
			
		HasRejected
			restricted
			when (RejectedPOInterfaceResultDetailRel exists)

		HasError
			restricted
			when (ErrorPOInterfaceResultDetailRel exists)
			
		RunComplete
			restricted
			when (Status.Complete)


		PrintSummaryReport
			restricted
			when (HasProcessed
			and   ReportLevel.Summary)
		PrintDetailReport
			restricted
			when (HasProcessed
			and   ReportLevel.Detail)


		CompanySecurityGroupAllowsAccess
			restricted
			when (actor.context.CompanySecurityGroup = blank
			or    CompanySecurityGroupMemberRel exists)
			
		SecurityGroupAllowsAccess
			restricted
			when (Company !entered
			or   (Company entered
			and   CompanySecurityGroupAllowsAccess))
		
	Derived Fields
		NoRecordsProcessed is a MessageField
			restricted
			"NoRecordsAreProcessed"

        CompleteMessage is a MessageField
        	restricted
        	"Complete"
        	
        IncompleteMessage is a MessageField
        	restricted
        	"Incomplete"
        	
        InProcessMessage is a MessageField
        	restricted
        	"InProcess"
        
        DerivedStatus is a DerivedField
        	type is Alpha 50
        	if (Status.InProcess)
        		return InProcessMessage
        	else
        	if (Status.Complete)
        		return CompleteMessage


		DerivedPOCreated is a DerivedField
			type is Numeric 10



			return 0

			
	Relations
		ProcessedPOInterfaceResultDetailRel
            one-to-many relation to POInterfaceResultDetail
            Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup		= FinanceEnterpriseGroup
				related.POInterfaceResult			= POInterfaceResult
			Instance Selection
				where (related.HasPurchaseOrderLineDetails)

		RejectedPOInterfaceResultDetailRel
            one-to-many relation to POInterfaceResultDetail
            Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup		= FinanceEnterpriseGroup
				related.POInterfaceResult			= POInterfaceResult
			Instance Selection
				where (related.RecordType.Rejected)

		ErrorPOInterfaceResultDetailRel
            one-to-many relation to POInterfaceResultDetail
            Field Mapping uses symbolic key
				related.FinanceEnterpriseGroup		= FinanceEnterpriseGroup
				related.POInterfaceResult			= POInterfaceResult
			Instance Selection
				where (related.RecordType.Error)

		SummaryPOInterfaceResultDetailRel
            one-to-many relation to POInterfaceResultDetail
            Field Mapping uses ByCompany
				related.FinanceEnterpriseGroup		= FinanceEnterpriseGroup
				related.POInterfaceResult			= POInterfaceResult
			Instance Selection
				where (related.IsSummary)


		UniquePurchaseOrderPOInterfaceResultDetailRel
            one-to-many relation to POInterfaceResultDetail
            Field Mapping uses symbolic key






		CompanySecurityGroupMemberRel
			one-to-one relation to GeneralLedgerCompanyGroupMember
			Field Mapping uses symbolic key
				related.GeneralLedgerCompanyGroup	= actor.context.CompanySecurityGroup.FinanceDimensionStructure
				related.Company                     = Company
	
	Actions
		Create is a Create Action
			restricted
			Action Rules
			Exit Rules








		Update is an Update Action
			restricted

		Delete is a Delete Action
			restricted
				
		SendCompletedProcessPurchaseRequestNotification is an Instance Action
			run in background
			restricted
			Action Rules
				RunDateEnd 	= current timestamp
				Status		= Status.Complete
				LocalActor = actor
				send notification
					to LocalActor
					description is "ProcessPurchaseRequestIsNowComplete.ID<POInterfaceResult>"
					priority is medium
					detail is "ProcessPurchaseRequestIsNowComplete.YouMayNowViewProcessPurchaseRequestResults.ResultID<POInterfaceResult>"


									


		SendProcessPurchaseRequestNotification is an Instance Action
			restricted


			
