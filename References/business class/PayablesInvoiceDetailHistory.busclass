PayablesInvoiceDetailHistory is a BusinessClass
    owned by ma
    prefix is MH1
    classic name is MAMADHIST

    Ontology
        symbolic key is PayablesInvoiceDetailHistory
            classic set name is MH1SET0
            classic name is SEQ-NBR
            classic name for PurchaseOrderLine is LINE-NBR

    Patterns
        implements StaticJava
        disable AuditIndex
        implements Archivable

    Persistent Fields
		Vendor						is a snapshot of PayablesInvoice.Vendor
        AddOnCharge
            classic name is AOC-CODE
        ItemType
        Item
        VendorItem
            classic name is VEN-ITEM
        ItemDescription             is a Description
            classic name is ITEM-DESC
        MatchedQuantity             is a Quantity
            classic name is MATCHED-QTY
        MatchUnitCost               is an InternationalCost
            classic name is MATCH-UNIT-CST
        VendorPriceUOM              is a UnitOfMeasure
            classic name is VPRI-UOM
        VendorPriceUOMMultiplier    is an UOMMultiplier
            classic name is VPRI-UOM-MULT
        EnteredQuantity             is a Quantity
            classic name is ENTERED-QTY
        EnteredUnitCost             is an InternationalCost
            classic name is ENT-UNIT-CST
        TaxCode
        TaxType                     is AlphaUpper size 1
        TaxAmount                   is an InternationalAmount
        BuyUOMMatchedQuantity       is a Quantity
            classic name is VBUY-MATCH-QTY
        VendorBuyUOM                is a UnitOfMeasure
            classic name is VBUY-UOM
        VendorBuyUOMMultiplier      is an UOMMultiplier
            classic name is VBUY-UOM-MULT
        InvoiceLineTaxable          is Boolean
            classic name is NO-TAX-FLAG
        MatchDetailKey
            classic name is MATCH-DTL-KEY
        RetailUnitCost              is an InternationalCost
            classic name is RTL-UNIT-COST
        Location                    is an InventoryLocation
        MatchObjectID               is an ObjId
            classic name is MATCH-OBJ-ID
        EnteredUOM                  is a UnitOfMeasure
            classic name is ENT-UOM
        EnteredUOMMultiplier        is an UOMMultiplier
            classic name is ENT-UOM-MULT
        TransactionNumberOfDecimals is an AcctNd
            classic name is TRAN-ND
        RecordSource                is a RecSource
            classic name is REC-SOURCE
        TotalDistributionAmount     is an InternationalAmount
            classic name is TOT-DIST-AMT
        TotalBaseAmount             is an InternationalAmount
        	default label is "TotalFunctionalAmount"
            classic name is TOT-BASE-AMT
        Status                      is Numeric size 1


        PurchaseOrderReceipt
            classic name is MA-REC-NBR
        PurchaseOrderReceiptLine    is a LineNumber
            classic name is MA-LINE-NBR
        MatchSequence
            classic name is MATCH-SEQ-NBR
        ExcessQuantityProcess       is a MtchExcProc
            classic name is MTCH-EXC-PROC
        InvoiceType					is a PayablesInvoiceType
        DistributionDate            is Date
            classic name is DISTRIB-DATE
        UpdateDate                  is TimeStamp
        TaxUsageCode
            classic name is TAX-USAGE-CD
        ICNCode
        SupplementaryQuantity       is a Quantity
            classic name is SUPLMNTARY-QTY
        StockWeight
            classic name is WEIGHT
        TermCode					is a TermsCode
            classic name is TERMS-CD
        DiscountRate
            classic name is DISC-RATE
        DiscountDate                is Date
            classic name is DISC-DATE
        FlexibleTermsFlag           is Boolean
            classic name is FLEX-FLAG


        CrossReferenceVendor
            classic name is XREF-VENDOR
        MatchErrorType              is Numeric size 2
            classic name is MATCH-ERR-TYPE
        CatchWeightCost             is an InternationalCost
            classic name is CATCH-WGT-COST
        ReasonCode                  is a ProcurementReasonCode


        IrDiffAmt                   is an InternationalAmount

        LastMessageSequence         is a Sequence
            classic name is LAST-MSG-SEQ
        SupplementaryUOM            is a UnitOfMeasure
            classic name is SUPLMNTARY-UOM
        PrepayUnitCost              is an InternationalCost
            classic name is PRPY-UNIT-CST
        PrepayTaxCode
            classic name is PRPY-TAX-CODE
        PrepayTaxAmount             is an InternationalAmount
            classic name is PRPY-TAX-AMT
        PrepayRetailUnitCost        is an InternationalCost
            classic name is PRPY-RTL-UCST

        InvoicedTaxAmount           is an InternationalAmount
            classic name is INVC-TAX-AMT
        AccruedTaxAmount            is an InternationalAmount
            classic name is ACCR-TAX-AMT
        CommodityCode				is a CommCodes
        ProductTaxCategory
            classic name is PROD-TAX-CAT
        ItemGTIN
            classic name is GTIN
        MatchUpdateDate            	is Date

    Derived Fields
        MatchExtendedAmount is a DerivedField
            type is like InternationalAmount
            classic name is MATCH-EXT-COST
            restricted
            return (MatchedQuantity * MatchUnitCost)

    Conditions
        LineStatusNotZero
            classic name is MATCHED
            restricted
            when (Status = 1)

        NonInventoryItem
            classic name is NON-INVENTORY
            restricted
            when (not ItemType.Inventoried)

    Relations
        ApapihistRel
            one-to-one relation to PayablesInvoiceHistory
            required
            Field Mapping uses symbolic key
                related.Company                               = Company
                related.Vendor                                = Vendor
                related.PayablesInvoiceHistory.Invoice        = PayablesInvoice.Invoice
                related.PayablesInvoiceHistory.Suffix         = PayablesInvoice.Suffix
                related.PayablesInvoiceHistory.CancelSequence = blank
                related.PayablesInvoiceHistory.PayablesInvoiceDate = PayablesInvoice.InvoiceDate        

        MaaoihistRel
            one-to-one relation to MatchPurchaseOrderInvoiceHistory
            Field Mapping uses symbolic key
                related.Company                     = Company
                related.PayablesInvoice             = PayablesInvoice
                related.PurchaseOrder			 	= PurchaseOrder
                related.Vendor                  	= Vendor

        PolineRel
            one-to-one relation to PurchaseOrderLine
            Field Mapping uses symbolic key
                related.Company                 = Company
                related.PurchaseOrder			= PurchaseOrder
                related.PurchaseOrderLine       = PurchaseOrderLine

    Sets













        Set2
            indexed
            Sort Order
                Company
                PurchaseOrder
                PurchaseOrderLine
                Contract 
                ContractLine
				PayablesInvoice		
                Vendor
				PayablesInvoiceDetailHistory
                AddOnCharge

        Set8
            indexed
            Sort Order
                Company

                PayablesInvoice
                PurchaseOrder
                Location
                MatchDetailKey
                PurchaseOrderLine
                Contract 
                ContractLine
                AddOnCharge
                PayablesInvoiceDetailHistory















        Set1
            not indexed
            Sort Order
                Company
				PayablesInvoice		
                Vendor
				PayablesInvoiceDetailHistory
				PurchaseOrder
                PurchaseOrderLine
                Contract 
                ContractLine
                AddOnCharge

		ByCompanyVendorPayablesInvoice
			Sort Order
				Company
				Vendor
				PayablesInvoice

	Actions
		Create is a Create Action
			restricted		
		Update is an Update Action
			restricted		
		Delete is a Delete Action
			restricted		

		UpdateSnapshotFields is an Instance Action
			restricted
			Action Rules
				Vendor		= PayablesInvoice.Vendor


		UpdateSnapshotFieldsSet is a Set Action			
			default label is untranslatable
			restricted
			Parameters
				PrmCompany		is a MatchCompany
				PrmInvoice		is a PayablesInvoice
			Parameter Rules
				PrmCompany
				PrmInvoice
				
			Instance Selection
				where (Company 			= PrmCompany
				and    PayablesInvoice	= PrmInvoice)
				
			Action Rules
				Instance Rules
					Vendor				= PrmInvoice.Vendor
									
		Purge is a Purge Action
			restricted
										
