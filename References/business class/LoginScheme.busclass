LoginScheme is a BusinessClass
    prefix is LGN
    stored in environment
	contains environment data
	disable data area copy
		preserve target data

    Ontology
        symbolic key is LoginScheme

    Patterns
        implements CRUD
        implements SecurityCache
        disable AuditIndex

    Persistent Fields
        Description is a LSDescription
        SchemeType is Alpha 20
            States
                WebUPLogin value is "WebUPLogin"
					default label is "WebUsernameAndPasswordLogin"
                OSLogin value is "OSLogin"
                NTLogin value is "NTLogin"
                DBLogin value is "DBLogin"
                NoLogin value is "NoLogin"
                BlackBoxUPLogin value is "BlackBoxUPLogin"
					default label is "BlackBoxUsernameAndPasswordLogin"
                GreyBoxUPLogin value is "GreyBoxUPLogin"
					default label is "GreyBoxUsernameAndPasswordLogin"
                DelegatedLogin value is "DelegatedLogin"
                OAuth10 value is "OAuth10"
                    default label is "O\Auth10"





        MinIdentAttributes
        MinCredAttributes
        MinOtherAttributes

        MinIdentArrSize is Numeric 2
			default label is untranslatable
        MinCredArrSize is Numeric 2	
			default label is untranslatable
        MinOtherArrSize is Numeric 2
			default label is untranslatable

        AllowedServiceTypes is Alpha 255 
        SupportsTimeOut is Boolean
        SupportsSessions is Boolean
		IgnoreIdentityCase is Boolean
		
		LoginProcedure is Alpha 20
            States
                LDAPBind value is "LDAPBind"
                XRefLookup value is "XRefLookup"
                PrivilegedId value is "USE_PRIVILEGED_ID"
                UserId value is "USE_USER_ID"
                UserAndPrivilegedId value is "USE_USER_AND_PRIVILEGED_ID"
                IBMWAS value is "IBMWAS"
                JAAS value is "JAAS"
                NTLM value is "NTLM"
                AS400 value is "AS400"
                Delegated value is "DELEGATED"
                Kerberos value is "Kerberos"
                ClaimBased value is "ClaimBased"
                OAuth10 value is "OAuth10"
                    default label is "O\Auth10"

        LDAPBindProperties

        SpnegoProperties

        Kerberos

		NTDomain
        
		NTDomainArrSize is Numeric 2
		
		AS400Server is Alpha 255
		
		DelegatedServletURL is Alpha 255
		
		DelegatedLoginURL is Alpha 255
		
		DelegatedLogoutURL is Alpha 255
		
		DelegatedLoggedoutURL is Alpha 255
		    default label is "DelegatedLogoutURL"

		DelegatedUsernameField is Alpha 255
		
		DelegatedPasswordField is Alpha 255
		
		LoginSuccessfulHeaderKey is Alpha 128
		
		LoginSuccessfulHeaderRegex is Alpha 255
		
		LoginSuccessfulResponseRegex is Alpha 255
		
		LoginUnsuccessfulHeaderKey is Alpha 128
		
		LoginUnsuccessfulHeaderRegex is Alpha 255
		
		LoginUnsuccessfulResponseRegex is Alpha 255
		
		LogoutSuccessfulHeaderKey is Alpha 128
		
		LogoutSuccessfulHeaderRegex is Alpha 255
		
		LogoutSuccessfulResponseRegex is Alpha 255
        
    Field Rules

		LDAPBindProperties.MultipleContainer
			default to false
			
		LDAPBindProperties.ReferralProperty
			default to "follow"
			if(LDAPBindProperties.MultipleContainer)
				required
			
		LDAPBindProperties.DerefAliasProperty
			default to "always"
			if(LDAPBindProperties.MultipleContainer)
				required

		LDAPBindProperties.SearchFilter
			if(LDAPBindProperties.MultipleContainer)
				required
				
		LDAPBindProperties.SearchStructClass
			if(LDAPBindProperties.MultipleContainer)
				required
				
		NTDomainArrSize
			default to 1

	Transient Fields
		SearchPrivIdentity is Alpha size 200
			default label is "SearchPrivilegedIdentity"
		SearchPrivPassword is Password
			default label is "SearchPrivilegedPassword"
		
		
	Relations
		LoginSchemeServiceRel is a Service set
			Instance Selection
				where (related.LoginScheme = LoginScheme)
		LdapSearchIdentityRel
			one-to-one relation to LdapSearchIdentity
			Field Mapping uses symbolic key
				related.LoginScheme = LoginScheme
				



            				
    Actions

        Create is an Action
            Action Rules
                if (SchemeType = SchemeType.WebUPLogin)
                    MinIdentAttributes.MinIdentAttribute[0] = "user"
                    MinIdentArrSize = 1
                    MinCredAttributes.MinCredAttribute[0] = "password"
                    MinCredArrSize = 1
                    MinOtherArrSize = 0
                if (SchemeType = SchemeType.OSLogin)
                    MinIdentAttributes.MinIdentAttribute[0] = "login"
                    MinIdentArrSize = 1
                    MinCredAttributes.MinCredAttribute[0] = "password"
                    MinCredArrSize = 1
                    MinOtherAttributes.MinOtherAttribute[0] = "homedir"
                    MinOtherArrSize = 1

        Update is an Action
            Action Rules
                if (SchemeType = SchemeType.WebUPLogin)
                    MinIdentAttributes.MinIdentAttribute[0] = "user"
                    MinIdentArrSize = 1
                    MinCredAttributes.MinCredAttribute[0] = "password"
                    MinCredArrSize = 1
                    MinOtherArrSize = 0
                if (SchemeType = SchemeType.OSLogin)
                    MinIdentAttributes.MinIdentAttribute[0] = "login"
                    MinIdentArrSize = 1
                    MinCredAttributes.MinCredAttribute[0] = "password"
                    MinCredArrSize = 1
                    MinOtherAttributes.MinOtherAttribute[0] = "homedir"
                    MinOtherArrSize = 1

        Delete is an Action
        
        CreateLDAPBindLoginScheme is a Create Action
       		Action Rules
        	   	if (SchemeType = SchemeType.WebUPLogin)
                    MinIdentAttributes.MinIdentAttribute[0] = "user"
                    MinIdentArrSize = 1
                    MinCredAttributes.MinCredAttribute[0] = "password"
                    MinCredArrSize = 1
                    MinOtherArrSize = 0
                if (SchemeType = SchemeType.OSLogin)
                    MinIdentAttributes.MinIdentAttribute[0] = "login"
                    MinIdentArrSize = 1
                    MinCredAttributes.MinCredAttribute[0] = "password"
                    MinCredArrSize = 1
                    MinOtherAttributes.MinOtherAttribute[0] = "homedir"
            	if (LDAPBindProperties.MultipleContainer)
            		constraint(LDAPBindProperties.SearchFilter entered)
            			"SearchFilterRequiredForMultipleContainer"
            		constraint(LDAPBindProperties.SearchStructClass entered)
            			"SearchStructureClassRequiredForMultipleContainer"
            		constraint(LDAPBindProperties.ReferralProperty entered)
            			"ReferralPropertyRequiredForMultipleContainer"
            		constraint(LDAPBindProperties.DerefAliasProperty entered)
            			"DerefAliasPropertyRequiredForMultipleContainer"
            		constraint(SearchPrivIdentity entered)
            			"SearchPrivilegedIdentityRequiredForMultipleContainer"
            		constraint(SearchPrivPassword entered)
            			"SearchPrivilegedPasswordRequiredForMultipleContainer"
            Exit Rules
            	if (SearchPrivIdentity != "" and SearchPrivPassword != "" )
	            	invoke Create LdapSearchIdentity
	            		invoked.LoginScheme = LoginScheme
	            		invoked.SearchPrivIdentity = SearchPrivIdentity
	            		invoked.SearchPrivPassword = SearchPrivPassword
            	
	
		ViewFullSummary is an Update Action
		
