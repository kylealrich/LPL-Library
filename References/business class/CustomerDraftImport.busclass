CustomerDraftImport is a BusinessClass
    owned by dt
    prefix is DTI
    classic name is DTIDRAFTS

    Ontology
        symbolic key is CustomerDraftImport
            classic set name is DTISET1

    Patterns
        implements StaticJava
        disable AuditIndex
		disable Auditing 
       	disable EffectiveDated

    Persistent Fields

        Status            is Numeric size 1
            States
                Created       value is 0
                CreatedUnreal value is 5
                    default label is "Created/Unreleased"
                Cancelled     value is 8
        DraftAmount       is an InternationalAmount
        Currency
            classic name is CURRENCY-CODE
        DraftDate         is Date
        MaturityDate      is Date
        ProcessLevel	  is a ReceivableProcessLevel	
        BankTransactionCode
            classic name is BANK-INST-CODE
        JournalBook
            classic name is JRNL-BOOK-NBR
            restricted
        BankEntity

        BankAccountNumber							is AlphaUpper size 35
            classic name is BANK-ACCT-NBR
        CurrencyRate                                is an OrigRate
            classic name is ORIG-RATE
        PayerReference								is AlphaUpper size 10
			classic name is PAYER-REF
        XrefNbr

	Transient Fields
		RIBKey

	Local Fields
		VerifyRIBKey
		
	Derived Fields											
		RepresentativeText is a StringField
			type is Text
			default label is "Company"
			Company " - " Company.GeneralLedgerCompany.Name

		CustomerRepresentativeText is a StringField
			type is Text
			default label is "Customer"
			Customer " - " Customer.Name	

	Field Rules
		BankEntity
			if (BankEntity entered)
				constraint (CustomerDraftBankRel exists)
					"BankAccountOrNumberNotValid"
			else
				default to CustomerDraftBankDefaultRel.CustomerDraftBank.BOEEFTBank

		BankAccountNumber
			if (BankAccountNumber entered)
				constraint (CustomerDraftBankRel exists)
					"BankAccountOrNumberNotValid"
			else
				default to CustomerDraftBankDefaultRel.CustomerDraftBank.BOEEFTBankAccount

		RIBKey
            initialize VerifyRIBKey
            VerifyRIBKey.BankEntity        		= BankEntity
            VerifyRIBKey.BankAccountNumber 		= BankAccountNumber
            VerifyRIBKey.RIBKey            		= RIBKey
            constraint (VerifyRIBKey.PerformVerifyRIBKey)
                "R\I\B_\KeyInvalid,VendorBankAndAccountNumberNumberDoNotEqualCalculatedKey" 

	Relations
        CustomerDraftBankRel
            one-to-one relation to CustomerDraftBank
            required
            Field Mapping uses symbolic key
                related.CustomerGroup           					= Company.CustomerGroupField.CustomerGroup	
                related.Company  									= Company
                related.Customer 									= CustomerDraftImport.Customer


            	related.CustomerDraftBank.BOEEFTBank				= BankEntity
            	related.CustomerDraftBank.BOEEFTBankAccount			= BankAccountNumber


                
        CustomerDraftBankDefaultRel
            one-to-many relation to CustomerDraftBank
            Field Mapping uses Set2
                related.CustomerGroup           = Company.CustomerGroupField.CustomerGroup	
                related.Company  				= Company
                related.Customer 				= CustomerDraftImport.Customer
                
			
        
