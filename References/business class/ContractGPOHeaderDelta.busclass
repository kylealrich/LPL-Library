ContractGPOHeaderDelta is a BusinessClass  
	owned by po
	
	prefix is CCPD
	
	Ontology
		symbolic key is ContractGPOHeaderDelta 
		
	Patterns
        disable AuditIndex
		disable Auditing 
       	disable EffectiveDated
	
	Persistent Fields
		ContractNumber                 is a GPOContractNumber            
		ContractCycleNumber				is Numeric 10
		ContractAmendmentNumber			is Numeric 10
		ContractVendorNumber        	is a GPOSupplierID              
			default label is "VendorNumber"
		ContractVendorName              is Alpha size 80       
	    	default label is "VendorName"
		ContractVendorLegalName			is Alpha size 80
		ContractVendorTaxIDNumber		is Alpha size 9
		ContractDescription         	is a Description3                
		OriginalContractEffectiveDate   is Date                         
		ContractCycleEffectiveDate      is Date                         
			default label is "EffectiveDate"
		ContractCycleExpireDate			is Date                         
			default label is "ExpirationDate"                           
		ContractAwardStatus             is Alpha size 32   
		ContractType                    is Alpha size 32   				
		HPGContractType					is Alpha size 32
		DepartmentName                  is Alpha size 50
		ClassOfTrade                    is Alpha size 255                
		FacilityELOCIndicator           is Boolean                       
		GroupELOCIndicator              is Boolean                       
		FacilitySIPIndicator            is Boolean                       
		GroupSIPIndicator               is Boolean                       
		RebateEligibleIndicator         is Boolean                       
		TieredContractIndicator			is Boolean
		ContractVendorDiversityIndicator is Boolean
		DisintermediatedIndicator		is Boolean
		S2EligibleIndicator				is Boolean	
		NationalContractNumber			is Alpha size 120
		FirmPricingDescription			is Alpha size 32
		FOBTerms                        is Alpha size 255
		PaymentTerms				    is Text
		NetPaymentTerms                 is Numeric 3          
		PaymentDiscount                 is Decimal size 7.4
		PaymentDiscountDays             is Numeric 3
	    PurchasingChannel               is Alpha size 32
		PrimaryContactName				is Alpha size 255
		PrimaryContactPhoneNumber		is Alpha size 50
		PrimaryContactEmailAddress		is an EmailAddress 
			holds pii
		RecordModifiedTimestamp         is Alpha size 20
		OperationFlag                   is Alpha size 10				

	Local Fields

		LocalGPOContractNumber      	is like GPOContractNumber
		LocalContractCycleNumber		is Numeric 10
		LocalContractAmendmentNumber    is Numeric 10
		LocalContractGroup              is like ContractGroup

	Derived Fields
	
	Conditions
		
	Relations
		
		ContractGPOHeaderRel
		 	one-to-many relation to ContractGPOHeader
		 	Field Mapping uses ByGPOContractNumber
		 		related.GPOContractNumber  = LocalGPOContractNumber

		ContractGPOHeaderSameCycleRel
		 	one-to-many relation to ContractGPOHeader
		 	Field Mapping uses ByGPOContractNumber
		 		related.GPOContractNumber  = LocalGPOContractNumber
			Instance Selection 
				where (related.ContractCycleNumber 		= LocalContractCycleNumber
				and    related.ContractAmendmentNumber	= LocalContractAmendmentNumber)

		ContractImportRel
			one-to-one relation to ContractImport
			Field Mapping uses ByGPOContractNumber
				related.GPOContractNumber 	= LocalGPOContractNumber
				related.ContractGroup       = LocalContractGroup	

	Sets
	
		ByGPOContractNumber
			Sort Order
				ContractNumber
				ContractGPOHeaderDelta

	Field Rules
	
	Actions
	
		Create is a Create Action
			restricted
		
		Update is an Update Action
			restricted
		
		Delete is a Delete Action
			restricted
		
		MassHeaderDelete is a Set Action
			disable checkpoint
			
			Action Rules
			
				Instance Rules
				
					invoke Purge 

		Purge is a Purge Action 		

		CopyRecordToGPOHeader is an Instance Action   
			Action Rules

				invoke Create ContractGPOHeader 
					invoked.GPOContractNumber 				= ContractNumber
					invoked.ContractCycleNumber         	= ContractCycleNumber 
					invoked.ContractAmendmentNumber     	= ContractAmendmentNumber
					invoked.ManufacturerSupplier 			= ContractVendorNumber    
					invoked.ContractVendorName          	= ContractVendorName
					invoked.ContractVendorLegalName     	= ContractVendorLegalName
					invoked.ContractVendorTaxIDNumber   	= ContractVendorTaxIDNumber
					invoked.ContractDescription         	= ContractDescription
					invoked.OriginalEffectiveDate       	= OriginalContractEffectiveDate
					invoked.StartDate                   	= ContractCycleEffectiveDate
					invoked.EndDate                     	= ContractCycleExpireDate                                 
					invoked.ContractAwardStatus             = ContractAwardStatus   
					invoked.HPGContractTypeCode             = ContractType   				
					invoked.HPGContractType					= HPGContractType		
					invoked.DepartmentName                  = DepartmentName   
					invoked.ClassOfTradeList                = ClassOfTrade               
					invoked.FacilityLOCRequired             = FacilityELOCIndicator         
					invoked.GroupLOCAvailable               = GroupELOCIndicator                
					invoked.FacilitySIPAvailable            = FacilitySIPIndicator    
					invoked.GroupSIPAvailable               = GroupSIPIndicator        
					invoked.RebateIndicator                 = RebateEligibleIndicator       
					invoked.TieredContractIndicator			= TieredContractIndicator
					invoked.ContractVendorDiversityIndicator = ContractVendorDiversityIndicator
					invoked.DisintermediatedIndicator		= DisintermediatedIndicator	
					invoked.S2EligibleIndicator			    = S2EligibleIndicator		
					invoked.NationalContractNumber			= NationalContractNumber
					invoked.FirmPricingDescription			= FirmPricingDescription
					invoked.FOBTerms                        = FOBTerms
					invoked.PaymentTerms				    = PaymentTerms
					invoked.NetPaymentTerms                 = NetPaymentTerms          
					invoked.PaymentDiscount                 = PaymentDiscount
					invoked.PaymentDiscountDays             = PaymentDiscountDays
					invoked.PurchasingChannel               = PurchasingChannel               
					invoked.PrimaryContactName				= PrimaryContactName
					invoked.PrimaryContactPhoneNumber		= PrimaryContactPhoneNumber
					invoked.PrimaryContactEmailAddress		= PrimaryContactEmailAddress								
					invoked.RecordModifiedTimestamp     	= RecordModifiedTimestamp	

		LoadHeaderRecords is a Set Action 
			restricted 
			Parameters 
				ParmContractGroup		is a ContractGroup
			
			Sort Order
				ContractNumber
				ContractGPOHeaderDelta
			
			Action Rules 

				Instance Rules 

					LocalContractGroup              = ParmContractGroup
					LocalGPOContractNumber 			= ContractNumber
				    LocalContractCycleNumber        = ContractCycleNumber
					LocalContractAmendmentNumber    = ContractAmendmentNumber

					if (OperationFlag = "Add")
						if (ContractGPOHeaderSameCycleRel !exists)
							invoke Create ContractGPOHeader 
								invoked.GPOContractNumber 				= ContractNumber
								invoked.ContractCycleNumber         	= ContractCycleNumber 
								invoked.ContractAmendmentNumber     	= ContractAmendmentNumber
								invoked.ManufacturerSupplier 			= ContractVendorNumber    
								invoked.ContractVendorName          	= ContractVendorName
								invoked.ContractVendorLegalName     	= ContractVendorLegalName
								invoked.ContractVendorTaxIDNumber   	= ContractVendorTaxIDNumber
								invoked.ContractDescription         	= ContractDescription
								invoked.OriginalEffectiveDate       	= OriginalContractEffectiveDate
								invoked.StartDate                   	= ContractCycleEffectiveDate
								invoked.EndDate                     	= ContractCycleExpireDate                                 
								invoked.ContractAwardStatus             = ContractAwardStatus   
								invoked.HPGContractTypeCode             = ContractType   				
								invoked.HPGContractType					= HPGContractType		
								invoked.DepartmentName                  = DepartmentName   
								invoked.ClassOfTradeList                = ClassOfTrade               
								invoked.FacilityLOCRequired             = FacilityELOCIndicator         
								invoked.GroupLOCAvailable               = GroupELOCIndicator                
								invoked.FacilitySIPAvailable            = FacilitySIPIndicator    
								invoked.GroupSIPAvailable               = GroupSIPIndicator        
								invoked.RebateIndicator                 = RebateEligibleIndicator       
								invoked.TieredContractIndicator			= TieredContractIndicator
								invoked.ContractVendorDiversityIndicator = ContractVendorDiversityIndicator
								invoked.DisintermediatedIndicator		= DisintermediatedIndicator	
								invoked.S2EligibleIndicator			    = S2EligibleIndicator		
								invoked.NationalContractNumber			= NationalContractNumber
								invoked.FirmPricingDescription			= FirmPricingDescription
								invoked.FOBTerms                        = FOBTerms
								invoked.PaymentTerms				    = PaymentTerms
								invoked.NetPaymentTerms                 = NetPaymentTerms          
								invoked.PaymentDiscount                 = PaymentDiscount
								invoked.PaymentDiscountDays             = PaymentDiscountDays
								invoked.PurchasingChannel               = PurchasingChannel               
								invoked.PrimaryContactName				= PrimaryContactName
								invoked.PrimaryContactPhoneNumber		= PrimaryContactPhoneNumber
								invoked.PrimaryContactEmailAddress		= PrimaryContactEmailAddress								
								invoked.RecordModifiedTimestamp     	= RecordModifiedTimestamp		
							
							if (ContractImportRel exists)
								invoke FastUpdate ContractImportRel 
									invoked.HeaderUpdated = true  


					else 
					if (OperationFlag = "Update")
						if (ContractGPOHeaderSameCycleRel exists)
							invoke Update ContractGPOHeaderSameCycleRel 
								invoked.ManufacturerSupplier 			= ContractVendorNumber    
								invoked.ContractVendorName          	= ContractVendorName
								invoked.ContractVendorLegalName     	= ContractVendorLegalName
								invoked.ContractVendorTaxIDNumber   	= ContractVendorTaxIDNumber
								invoked.ContractDescription         	= ContractDescription
								invoked.OriginalEffectiveDate       	= OriginalContractEffectiveDate
								invoked.StartDate                   	= ContractCycleEffectiveDate
								invoked.EndDate                     	= ContractCycleExpireDate                                 
								invoked.ContractAwardStatus             = ContractAwardStatus   
								invoked.HPGContractTypeCode             = ContractType   				
								invoked.HPGContractType					= HPGContractType		
								invoked.DepartmentName                  = DepartmentName   
								invoked.ClassOfTradeList                = ClassOfTrade               
								invoked.FacilityLOCRequired             = FacilityELOCIndicator         
								invoked.GroupLOCAvailable               = GroupELOCIndicator                
								invoked.FacilitySIPAvailable            = FacilitySIPIndicator    
								invoked.GroupSIPAvailable               = GroupSIPIndicator        
								invoked.RebateIndicator                 = RebateEligibleIndicator       
								invoked.TieredContractIndicator			= TieredContractIndicator
								invoked.ContractVendorDiversityIndicator = ContractVendorDiversityIndicator
								invoked.DisintermediatedIndicator		= DisintermediatedIndicator	
								invoked.S2EligibleIndicator			    = S2EligibleIndicator		
								invoked.NationalContractNumber			= NationalContractNumber
								invoked.FirmPricingDescription			= FirmPricingDescription
								invoked.FOBTerms                        = FOBTerms
								invoked.PaymentTerms				    = PaymentTerms
								invoked.NetPaymentTerms                 = NetPaymentTerms          
								invoked.PaymentDiscount                 = PaymentDiscount
								invoked.PaymentDiscountDays             = PaymentDiscountDays
								invoked.PurchasingChannel               = PurchasingChannel               
								invoked.PrimaryContactName				= PrimaryContactName
								invoked.PrimaryContactPhoneNumber		= PrimaryContactPhoneNumber
								invoked.PrimaryContactEmailAddress		= PrimaryContactEmailAddress								
								invoked.RecordModifiedTimestamp     	= RecordModifiedTimestamp	

							if (ContractImportRel exists)
								invoke FastUpdate ContractImportRel 
									invoked.HeaderUpdated = true 

					else 
					if (OperationFlag = "DEL")
						if (ContractGPOHeaderSameCycleRel exists)
							invoke Delete ContractGPOHeaderSameCycleRel 


										

	
