FinanceCompany is a BusinessClass
	owned by sharedfinance
	prefix is FiCom

	representative image is CompanyLogo.File
		missing image is missingphotoPerson	

	Ontology
		symbolic key is FinanceCompany

	Patterns

	Persistent Fields
		FinanceGroup
		CompanyIdentifier			 			is Alpha 10
		LongDescription							is Alpha up to 250
			default label is "Description"
		ShowDiscountedAmount					is Boolean
		CompanyLogo								is an AlternateAttachment
		ChartSection							is Alpha 1
			States
				BalanceSheet			value is "1"
				IncomeStatement			value is "2"
				AllAccounts				value is "3"
		ReconciliationLevel						is Alpha 1
			States
				Company					value is "1"
				PostingAccountingUnit	value is "2"
		DirectForecastProcessesCompleted		is Numeric 3
		HasReconciliationsForAccountingUnits	is Boolean
			
	Context Fields

	Local Fields
		LocalChartSection				is Alpha 1





		LocalFinanceResource			is a FinanceResource
		LocalAttributeCtr   			is Numeric 2

    Derived Fields













	Field Rules
		FinanceGroup
			default to actor.context.FinanceGroup
			required
			cannot be changed
				"FinanceGroupCannotBeChanged"




			
		LongDescription
			initial value is Company.Name
			default to Company.Name
										 
	Relations







					
		GLCompanyRel
			one-to-one relation to GeneralLedgerCompany
			Field Mapping uses symbolic key
				related.Company	= Company
	

									
		AccountingUnitRel is a AccountingUnit set
















	


















	

		
		EmployeeRel is a Employee set







		











































		LocalEnterpriseCompanyRel is a EnterpriseCompany set

















		FinanceResourceHelperRel 
			one-to-many relation to FinanceResource
			Field Mapping uses symbolic key
				related.HROrganization = FinanceGroup.HROrganization





















		ReconManagerRel
			one-to-many relation to ActorRole
			Field Mapping uses symbolic key
				related.Actor		= actor
			Instance Selection
				where (related.ActorRole	= "RECONManager_ST"
				or     related.ActorRole	= "RECONAdministrator_ST"
				or     related.ActorRole	= "OOFAdmin_ST")

	Conditions







			



			







	



			



		
		ShowCompanyLogo
			restricted
			when (CompanyLogo entered)		
			
		CanBeViewedInList
			restricted
			when ((actor.context.FinanceGroup	!= ""
			and    FinanceGroup = actor.context.FinanceGroup)
			or     actor.context.FinanceGroup	= "")		







		CanViewReconciliationAccountButtons
			restricted
			when (ReconManagerRel 		exists)

	Create Rules  
		include IDM.CreateRules 
			replace AttachmentField with CompanyLogo
							
	Delete Rules
		include IDM.DeleteNoArchiveRules
			replace AttachmentField with CompanyLogo

	Commit Rules
		include IDM.CommitRules
			replace AttachmentField with CompanyLogo	

	Sets
		ByFinanceGroup
			Sort Order
				FinanceGroup
				Company
	
	Actions
		Create is a Create Action	
			Exit Rules
				if (!LocalEnterpriseCompanyRel exists)				
					invoke Create EnterpriseCompany
						invoked.EnterpriseGroup = FinanceGroup
						invoked.Company 		= Company
						invoked.Name			= Company.Name	
				else
					invoke Update LocalEnterpriseCompanyRel
						invoked.EnterpriseGroup	= FinanceGroup
						invoked.Name			= Company.Name	
											

		Update is an Update Action
		
		Delete is a Delete Action

		UploadToIDM is an Instance Action  
			valid when (CompanyLogo.ValidForIDMUpload)
			Action Rules
				include IDM.MoveAttachmentsToIDM
					replace AttachmentField   with CompanyLogo	
														
		MoveAttachmentsToIDM is a Set Action
			restricted
			Instance Selection
				where (CompanyLogo.IsLocal)
			
			Accumulators
				InstanceCount

			Action Rules
				Instance Rules
					increment InstanceCount	

					include IDM.MoveAttachmentsToIDM
						replace AttachmentField   with CompanyLogo

					commit transaction

					if (InstanceCount = config.IDM_MOVE_ATTACHMENTS_LIMIT)
						end set action instance loop





















































































































































































